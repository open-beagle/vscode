{"version":3,"file":"contextmenu.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/base/parts/contextmenu/electron-main/contextmenu.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;IAMhG,SAAgB,2BAA2B;QAC1C,kBAAO,CAAC,EAAE,CAAC,kCAAoB,EAAE,CAAC,KAAmB,EAAE,aAAqB,EAAE,KAAqC,EAAE,cAAsB,EAAE,OAAuB,EAAE,EAAE;YACvK,MAAM,IAAI,GAAG,UAAU,CAAC,KAAK,EAAE,cAAc,EAAE,KAAK,CAAC,CAAC;YAEtD,IAAI,CAAC,KAAK,CAAC;gBACV,MAAM,EAAE,CAAA,GAAA,2BAAmB,CAAA,CAAC,wBAAa,CAAC,eAAe,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;gBACxE,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS;gBAClC,CAAC,EAAE,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS;gBAClC,eAAe,EAAE,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,eAAe,CAAC,CAAC,CAAC,SAAS;gBAC9D,QAAQ,EAAE,GAAG,EAAE;oBACd,kEAAkE;oBAClE,kEAAkE;oBAClE,mEAAmE;oBACnE,IAAI,IAAI,EAAE;wBACT,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,wCAA0B,EAAE,aAAa,CAAC,CAAC;qBAC7D;gBACF,CAAC;aACD,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;IACJ,CAAC;IAnBD,kEAmBC;IAED,SAAS,UAAU,CAAC,KAAmB,EAAE,cAAsB,EAAE,KAAqC;QACrG,MAAM,IAAI,GAAG,IAAI,eAAI,EAAE,CAAC;QAExB,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACpB,IAAI,QAAkB,CAAC;YAEvB,YAAY;YACZ,IAAI,IAAI,CAAC,IAAI,KAAK,WAAW,EAAE;gBAC9B,QAAQ,GAAG,IAAI,mBAAQ,CAAC;oBACvB,IAAI,EAAE,IAAI,CAAC,IAAI;iBACf,CAAC,CAAC;aACH;YAED,WAAW;iBACN,IAAI,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;gBACrC,QAAQ,GAAG,IAAI,mBAAQ,CAAC;oBACvB,OAAO,EAAE,UAAU,CAAC,KAAK,EAAE,cAAc,EAAE,IAAI,CAAC,OAAO,CAAC;oBACxD,KAAK,EAAE,IAAI,CAAC,KAAK;iBACjB,CAAC,CAAC;aACH;YAED,mBAAmB;iBACd;gBACJ,QAAQ,GAAG,IAAI,mBAAQ,CAAC;oBACvB,KAAK,EAAE,IAAI,CAAC,KAAK;oBACjB,IAAI,EAAE,IAAI,CAAC,IAAI;oBACf,WAAW,EAAE,IAAI,CAAC,WAAW;oBAC7B,OAAO,EAAE,IAAI,CAAC,OAAO;oBACrB,OAAO,EAAE,IAAI,CAAC,OAAO;oBACrB,OAAO,EAAE,IAAI,CAAC,OAAO;oBACrB,KAAK,EAAE,CAAC,QAAQ,EAAE,GAAG,EAAE,gBAAgB,EAAE,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,EAAE,EAAE,gBAAgB,CAAC;iBACxG,CAAC,CAAC;aACH;YAED,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;QACvB,CAAC,CAAC,CAAC;QAEH,OAAO,IAAI,CAAC;IACb,CAAC","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Menu, MenuItem, BrowserWindow, ipcMain, IpcMainEvent } from 'electron';\nimport { ISerializableContextMenuItem, CONTEXT_MENU_CLOSE_CHANNEL, CONTEXT_MENU_CHANNEL, IPopupOptions } from 'vs/base/parts/contextmenu/common/contextmenu';\nimport { withNullAsUndefined } from 'vs/base/common/types';\n\nexport function registerContextMenuListener(): void {\n\tipcMain.on(CONTEXT_MENU_CHANNEL, (event: IpcMainEvent, contextMenuId: number, items: ISerializableContextMenuItem[], onClickChannel: string, options?: IPopupOptions) => {\n\t\tconst menu = createMenu(event, onClickChannel, items);\n\n\t\tmenu.popup({\n\t\t\twindow: withNullAsUndefined(BrowserWindow.fromWebContents(event.sender)),\n\t\t\tx: options ? options.x : undefined,\n\t\t\ty: options ? options.y : undefined,\n\t\t\tpositioningItem: options ? options.positioningItem : undefined,\n\t\t\tcallback: () => {\n\t\t\t\t// Workaround for https://github.com/microsoft/vscode/issues/72447\n\t\t\t\t// It turns out that the menu gets GC'ed if not referenced anymore\n\t\t\t\t// As such we drag it into this scope so that it is not being GC'ed\n\t\t\t\tif (menu) {\n\t\t\t\t\tevent.sender.send(CONTEXT_MENU_CLOSE_CHANNEL, contextMenuId);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n}\n\nfunction createMenu(event: IpcMainEvent, onClickChannel: string, items: ISerializableContextMenuItem[]): Menu {\n\tconst menu = new Menu();\n\n\titems.forEach(item => {\n\t\tlet menuitem: MenuItem;\n\n\t\t// Separator\n\t\tif (item.type === 'separator') {\n\t\t\tmenuitem = new MenuItem({\n\t\t\t\ttype: item.type,\n\t\t\t});\n\t\t}\n\n\t\t// Sub Menu\n\t\telse if (Array.isArray(item.submenu)) {\n\t\t\tmenuitem = new MenuItem({\n\t\t\t\tsubmenu: createMenu(event, onClickChannel, item.submenu),\n\t\t\t\tlabel: item.label\n\t\t\t});\n\t\t}\n\n\t\t// Normal Menu Item\n\t\telse {\n\t\t\tmenuitem = new MenuItem({\n\t\t\t\tlabel: item.label,\n\t\t\t\ttype: item.type,\n\t\t\t\taccelerator: item.accelerator,\n\t\t\t\tchecked: item.checked,\n\t\t\t\tenabled: item.enabled,\n\t\t\t\tvisible: item.visible,\n\t\t\t\tclick: (menuItem, win, contextmenuEvent) => event.sender.send(onClickChannel, item.id, contextmenuEvent)\n\t\t\t});\n\t\t}\n\n\t\tmenu.append(menuitem);\n\t});\n\n\treturn menu;\n}\n"]}