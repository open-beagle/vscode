{"version":3,"file":"asyncDataTree.test.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/base/test/browser/ui/tree/asyncDataTree.test.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { ITreeNode, ITreeRenderer, IAsyncDataSource } from 'vs/base/browser/ui/tree/tree';\nimport { AsyncDataTree } from 'vs/base/browser/ui/tree/asyncDataTree';\nimport { IListVirtualDelegate, IIdentityProvider } from 'vs/base/browser/ui/list/list';\nimport { timeout } from 'vs/base/common/async';\n\ninterface Element {\n\tid: string;\n\tsuffix?: string;\n\tchildren?: Element[];\n}\n\nfunction find(element: Element, id: string): Element | undefined {\n\tif (element.id === id) {\n\t\treturn element;\n\t}\n\n\tif (!element.children) {\n\t\treturn undefined;\n\t}\n\n\tfor (const child of element.children) {\n\t\tconst result = find(child, id);\n\n\t\tif (result) {\n\t\t\treturn result;\n\t\t}\n\t}\n\n\treturn undefined;\n}\n\nclass Renderer implements ITreeRenderer<Element, void, HTMLElement> {\n\treadonly templateId = 'default';\n\trenderTemplate(container: HTMLElement): HTMLElement {\n\t\treturn container;\n\t}\n\trenderElement(element: ITreeNode<Element, void>, index: number, templateData: HTMLElement): void {\n\t\ttemplateData.textContent = element.element.id + (element.element.suffix || '');\n\t}\n\tdisposeTemplate(templateData: HTMLElement): void {\n\t\t// noop\n\t}\n}\n\nclass IdentityProvider implements IIdentityProvider<Element> {\n\tgetId(element: Element) {\n\t\treturn element.id;\n\t}\n}\n\nclass VirtualDelegate implements IListVirtualDelegate<Element> {\n\tgetHeight() { return 20; }\n\tgetTemplateId(element: Element): string { return 'default'; }\n}\n\nclass DataSource implements IAsyncDataSource<Element, Element> {\n\thasChildren(element: Element): boolean {\n\t\treturn !!element.children && element.children.length > 0;\n\t}\n\tgetChildren(element: Element): Promise<Element[]> {\n\t\treturn Promise.resolve(element.children || []);\n\t}\n}\n\nclass Model {\n\n\tconstructor(readonly root: Element) { }\n\n\tget(id: string): Element {\n\t\tconst result = find(this.root, id);\n\n\t\tif (!result) {\n\t\t\tthrow new Error('element not found');\n\t\t}\n\n\t\treturn result;\n\t}\n}\n\nsuite('AsyncDataTree', function () {\n\n\ttest('Collapse state should be preserved across refresh calls', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a'\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() });\n\t\ttree.layout(200);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 0);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\t\tlet twistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\n\t\tmodel.get('a').children = [\n\t\t\t{ id: 'aa' },\n\t\t\t{ id: 'ab' },\n\t\t\t{ id: 'ac' }\n\t\t];\n\n\t\tawait tree.updateChildren(model.root);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\n\t\tawait tree.expand(model.get('a'));\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 4);\n\n\t\tmodel.get('a').children = [];\n\t\tawait tree.updateChildren(model.root);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\t});\n\n\ttest('issue #68648', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst getChildrenCalls: string[] = [];\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tgetChildren(element: Element): Promise<Element[]> {\n\t\t\t\tgetChildrenCalls.push(element.id);\n\t\t\t\treturn Promise.resolve(element.children || []);\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a'\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() });\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root']);\n\n\t\tlet twistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\t\tassert(tree.getNode().children[0].collapsed);\n\n\t\tmodel.get('a').children = [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }];\n\t\tawait tree.updateChildren(model.root);\n\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'root']);\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(twistie.classList.contains('collapsible'));\n\t\tassert(twistie.classList.contains('collapsed'));\n\t\tassert(tree.getNode().children[0].collapsed);\n\n\t\tmodel.get('a').children = [];\n\t\tawait tree.updateChildren(model.root);\n\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'root', 'root']);\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\t\tassert(tree.getNode().children[0].collapsed);\n\n\t\tmodel.get('a').children = [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }];\n\t\tawait tree.updateChildren(model.root);\n\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'root', 'root', 'root']);\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(twistie.classList.contains('collapsible'));\n\t\tassert(twistie.classList.contains('collapsed'));\n\t\tassert(tree.getNode().children[0].collapsed);\n\t});\n\n\ttest('issue #67722 - once resolved, refreshed collapsed nodes should only get children when expanded', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst getChildrenCalls: string[] = [];\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tgetChildren(element: Element): Promise<Element[]> {\n\t\t\t\tgetChildrenCalls.push(element.id);\n\t\t\t\treturn Promise.resolve(element.children || []);\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() });\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert(tree.getNode(model.get('a')).collapsed);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root']);\n\n\t\tawait tree.expand(model.get('a'));\n\t\tassert(!tree.getNode(model.get('a')).collapsed);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'a']);\n\n\t\ttree.collapse(model.get('a'));\n\t\tassert(tree.getNode(model.get('a')).collapsed);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'a']);\n\n\t\tawait tree.updateChildren();\n\t\tassert(tree.getNode(model.get('a')).collapsed);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'a', 'root'], 'a should not be refreshed, since it\\' collapsed');\n\t});\n\n\ttest('resolved collapsed nodes which lose children should lose twistie as well', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() });\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tawait tree.expand(model.get('a'));\n\n\t\tlet twistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\t\tassert(!tree.getNode(model.get('a')).collapsed);\n\n\t\ttree.collapse(model.get('a'));\n\t\tmodel.get('a').children = [];\n\t\tawait tree.updateChildren(model.root);\n\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\t\tassert(tree.getNode(model.get('a')).collapsed);\n\t});\n\n\ttest('support default collapse state per element', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst getChildrenCalls: string[] = [];\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tgetChildren(element: Element): Promise<Element[]> {\n\t\t\t\tgetChildrenCalls.push(element.id);\n\t\t\t\treturn Promise.resolve(element.children || []);\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{ id: 'aa' }, { id: 'ab' }, { id: 'ac' }]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, {\n\t\t\tcollapseByDefault: el => el.id !== 'a'\n\t\t});\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert(!tree.getNode(model.get('a')).collapsed);\n\t\tassert.deepStrictEqual(getChildrenCalls, ['root', 'a']);\n\t});\n\n\ttest('issue #80098 - concurrent refresh and expand', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst calls: Function[] = [];\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tgetChildren(element: Element): Promise<Element[]> {\n\t\t\t\treturn new Promise(c => calls.push(() => c(element.children || [])));\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{\n\t\t\t\t\tid: 'aa'\n\t\t\t\t}]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() });\n\t\ttree.layout(200);\n\n\t\tconst pSetInput = tree.setInput(model.root);\n\t\tcalls.pop()!(); // resolve getChildren(root)\n\t\tawait pSetInput;\n\n\t\tconst pUpdateChildrenA = tree.updateChildren(model.get('a'));\n\t\tconst pExpandA = tree.expand(model.get('a'));\n\t\tassert.strictEqual(calls.length, 1, 'expand(a) still hasn\\'t called getChildren(a)');\n\n\t\tcalls.pop()!();\n\t\tassert.strictEqual(calls.length, 0, 'no pending getChildren calls');\n\n\t\tawait pUpdateChildrenA;\n\t\tassert.strictEqual(calls.length, 0, 'expand(a) should not have forced a second refresh');\n\n\t\tconst result = await pExpandA;\n\t\tassert.strictEqual(result, true, 'expand(a) should be done');\n\t});\n\n\ttest('issue #80098 - first expand should call getChildren', async () => {\n\t\tconst container = document.createElement('div');\n\n\t\tconst calls: Function[] = [];\n\t\tconst dataSource = new class implements IAsyncDataSource<Element, Element> {\n\t\t\thasChildren(element: Element): boolean {\n\t\t\t\treturn !!element.children && element.children.length > 0;\n\t\t\t}\n\t\t\tgetChildren(element: Element): Promise<Element[]> {\n\t\t\t\treturn new Promise(c => calls.push(() => c(element.children || [])));\n\t\t\t}\n\t\t};\n\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a', children: [{\n\t\t\t\t\tid: 'aa'\n\t\t\t\t}]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], dataSource, { identityProvider: new IdentityProvider() });\n\t\ttree.layout(200);\n\n\t\tconst pSetInput = tree.setInput(model.root);\n\t\tcalls.pop()!(); // resolve getChildren(root)\n\t\tawait pSetInput;\n\n\t\tconst pExpandA = tree.expand(model.get('a'));\n\t\tassert.strictEqual(calls.length, 1, 'expand(a) should\\'ve called getChildren(a)');\n\n\t\tlet race = await Promise.race([pExpandA.then(() => 'expand'), timeout(1).then(() => 'timeout')]);\n\t\tassert.strictEqual(race, 'timeout', 'expand(a) should not be yet done');\n\n\t\tcalls.pop()!();\n\t\tassert.strictEqual(calls.length, 0, 'no pending getChildren calls');\n\n\t\trace = await Promise.race([pExpandA.then(() => 'expand'), timeout(1).then(() => 'timeout')]);\n\t\tassert.strictEqual(race, 'expand', 'expand(a) should now be done');\n\t});\n\n\ttest('issue #78388 - tree should react to hasChildren toggles', async () => {\n\t\tconst container = document.createElement('div');\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a'\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() });\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\n\t\tlet twistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\n\t\tmodel.get('a').children = [{ id: 'aa' }];\n\t\tawait tree.updateChildren(model.get('a'), false);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(twistie.classList.contains('collapsible'));\n\t\tassert(twistie.classList.contains('collapsed'));\n\n\t\tmodel.get('a').children = [];\n\t\tawait tree.updateChildren(model.get('a'), false);\n\t\tassert.strictEqual(container.querySelectorAll('.monaco-list-row').length, 1);\n\t\ttwistie = container.querySelector('.monaco-list-row:first-child .monaco-tl-twistie') as HTMLElement;\n\t\tassert(!twistie.classList.contains('collapsible'));\n\t\tassert(!twistie.classList.contains('collapsed'));\n\t});\n\n\ttest('issues #84569, #82629 - rerender', async () => {\n\t\tconst container = document.createElement('div');\n\t\tconst model = new Model({\n\t\t\tid: 'root',\n\t\t\tchildren: [{\n\t\t\t\tid: 'a',\n\t\t\t\tchildren: [{\n\t\t\t\t\tid: 'b',\n\t\t\t\t\tsuffix: '1'\n\t\t\t\t}]\n\t\t\t}]\n\t\t});\n\n\t\tconst tree = new AsyncDataTree<Element, Element>('test', container, new VirtualDelegate(), [new Renderer()], new DataSource(), { identityProvider: new IdentityProvider() });\n\t\ttree.layout(200);\n\n\t\tawait tree.setInput(model.root);\n\t\tawait tree.expand(model.get('a'));\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'b1']);\n\n\t\tconst a = model.get('a');\n\t\tconst b = model.get('b');\n\t\ta.children?.splice(0, 1, { id: 'b', suffix: '2' });\n\n\t\tawait Promise.all([\n\t\t\ttree.updateChildren(a, true, true),\n\t\t\ttree.updateChildren(b, true, true)\n\t\t]);\n\n\t\tassert.deepStrictEqual(Array.from(container.querySelectorAll('.monaco-list-row')).map(e => e.textContent), ['a', 'b2']);\n\t});\n});\n"]}