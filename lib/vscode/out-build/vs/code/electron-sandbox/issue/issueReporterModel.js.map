{"version":3,"file":"issueReporterModel.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/code/electron-sandbox/issue/issueReporterModel.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IssueType, ISettingSearchResult, IssueReporterExtensionData } from 'vs/platform/issue/common/issue';\nimport { SystemInfo, isRemoteDiagnosticError } from 'vs/platform/diagnostics/common/diagnostics';\n\nexport interface IssueReporterData {\n\tissueType: IssueType;\n\tissueDescription?: string;\n\n\tversionInfo?: any;\n\tsystemInfo?: SystemInfo;\n\tprocessInfo?: any;\n\tworkspaceInfo?: any;\n\n\tincludeSystemInfo: boolean;\n\tincludeWorkspaceInfo: boolean;\n\tincludeProcessInfo: boolean;\n\tincludeExtensions: boolean;\n\tincludeExperiments: boolean;\n\n\tnumberOfThemeExtesions?: number;\n\tallExtensions: IssueReporterExtensionData[];\n\tenabledNonThemeExtesions?: IssueReporterExtensionData[];\n\textensionsDisabled?: boolean;\n\tfileOnExtension?: boolean;\n\tfileOnMarketplace?: boolean;\n\tselectedExtension?: IssueReporterExtensionData;\n\tactualSearchResults?: ISettingSearchResult[];\n\tquery?: string;\n\tfilterResultCount?: number;\n\texperimentInfo?: string;\n}\n\nexport class IssueReporterModel {\n\tprivate readonly _data: IssueReporterData;\n\n\tconstructor(initialData?: Partial<IssueReporterData>) {\n\t\tconst defaultData = {\n\t\t\tissueType: IssueType.Bug,\n\t\t\tincludeSystemInfo: true,\n\t\t\tincludeWorkspaceInfo: true,\n\t\t\tincludeProcessInfo: true,\n\t\t\tincludeExtensions: true,\n\t\t\tincludeExperiments: true,\n\t\t\tallExtensions: []\n\t\t};\n\n\t\tthis._data = initialData ? Object.assign(defaultData, initialData) : defaultData;\n\t}\n\n\tgetData(): IssueReporterData {\n\t\treturn this._data;\n\t}\n\n\tupdate(newData: Partial<IssueReporterData>): void {\n\t\tObject.assign(this._data, newData);\n\t}\n\n\tserialize(): string {\n\t\treturn `\nIssue Type: <b>${this.getIssueTypeTitle()}</b>\n\n${this._data.issueDescription}\n${this.getExtensionVersion()}\nVS Code version: ${this._data.versionInfo && this._data.versionInfo.vscodeVersion}\nOS version: ${this._data.versionInfo && this._data.versionInfo.os}\n${this.getRemoteOSes()}\n${this.getInfos()}\n<!-- generated by issue reporter -->`;\n\t}\n\n\tprivate getRemoteOSes(): string {\n\t\tif (this._data.systemInfo && this._data.systemInfo.remoteData.length) {\n\t\t\treturn this._data.systemInfo.remoteData\n\t\t\t\t.map(remote => isRemoteDiagnosticError(remote) ? remote.errorMessage : `Remote OS version: ${remote.machineInfo.os}`).join('\\n') + '\\n';\n\t\t}\n\n\t\treturn '';\n\t}\n\n\tfileOnExtension(): boolean | undefined {\n\t\tconst fileOnExtensionSupported = this._data.issueType === IssueType.Bug\n\t\t\t|| this._data.issueType === IssueType.PerformanceIssue\n\t\t\t|| this._data.issueType === IssueType.FeatureRequest;\n\n\t\treturn fileOnExtensionSupported && this._data.fileOnExtension;\n\t}\n\n\tprivate getExtensionVersion(): string {\n\t\tif (this.fileOnExtension() && this._data.selectedExtension) {\n\t\t\treturn `\\nExtension version: ${this._data.selectedExtension.version}`;\n\t\t} else {\n\t\t\treturn '';\n\t\t}\n\t}\n\n\tprivate getIssueTypeTitle(): string {\n\t\tif (this._data.issueType === IssueType.Bug) {\n\t\t\treturn 'Bug';\n\t\t} else if (this._data.issueType === IssueType.PerformanceIssue) {\n\t\t\treturn 'Performance Issue';\n\t\t} else {\n\t\t\treturn 'Feature Request';\n\t\t}\n\t}\n\n\tprivate getInfos(): string {\n\t\tlet info = '';\n\n\t\tif (this._data.issueType === IssueType.Bug || this._data.issueType === IssueType.PerformanceIssue) {\n\t\t\tif (!this._data.fileOnMarketplace && this._data.includeSystemInfo && this._data.systemInfo) {\n\t\t\t\tinfo += this.generateSystemInfoMd();\n\t\t\t}\n\t\t}\n\n\t\tif (this._data.issueType === IssueType.PerformanceIssue) {\n\n\t\t\tif (!this._data.fileOnMarketplace && this._data.includeProcessInfo) {\n\t\t\t\tinfo += this.generateProcessInfoMd();\n\t\t\t}\n\n\t\t\tif (!this._data.fileOnMarketplace && this._data.includeWorkspaceInfo) {\n\t\t\t\tinfo += this.generateWorkspaceInfoMd();\n\t\t\t}\n\t\t}\n\n\t\tif (this._data.issueType === IssueType.Bug || this._data.issueType === IssueType.PerformanceIssue) {\n\t\t\tif (!this._data.fileOnMarketplace && !this._data.fileOnExtension && this._data.includeExtensions) {\n\t\t\t\tinfo += this.generateExtensionsMd();\n\t\t\t}\n\t\t}\n\n\t\tif (this._data.issueType === IssueType.Bug || this._data.issueType === IssueType.PerformanceIssue) {\n\t\t\tif (!this._data.fileOnMarketplace && this._data.includeExperiments && this._data.experimentInfo) {\n\t\t\t\tinfo += this.generateExperimentsInfoMd();\n\t\t\t}\n\t\t}\n\n\t\treturn info;\n\t}\n\n\tprivate generateSystemInfoMd(): string {\n\t\tlet md = `<details>\n<summary>System Info</summary>\n\n|Item|Value|\n|---|---|\n`;\n\n\t\tif (this._data.systemInfo) {\n\n\t\t\tmd += `|CPUs|${this._data.systemInfo.cpus}|\n|GPU Status|${Object.keys(this._data.systemInfo.gpuStatus).map(key => `${key}: ${this._data.systemInfo!.gpuStatus[key]}`).join('<br>')}|\n|Load (avg)|${this._data.systemInfo.load}|\n|Memory (System)|${this._data.systemInfo.memory}|\n|Process Argv|${this._data.systemInfo.processArgs.replace(/\\\\/g, '\\\\\\\\')}|\n|Screen Reader|${this._data.systemInfo.screenReader}|\n|VM|${this._data.systemInfo.vmHint}|`;\n\n\t\t\tif (this._data.systemInfo.linuxEnv) {\n\t\t\t\tmd += `\\n|DESKTOP_SESSION|${this._data.systemInfo.linuxEnv.desktopSession}|\n|XDG_CURRENT_DESKTOP|${this._data.systemInfo.linuxEnv.xdgCurrentDesktop}|\n|XDG_SESSION_DESKTOP|${this._data.systemInfo.linuxEnv.xdgSessionDesktop}|\n|XDG_SESSION_TYPE|${this._data.systemInfo.linuxEnv.xdgSessionType}|`;\n\t\t\t}\n\n\t\t\tthis._data.systemInfo.remoteData.forEach(remote => {\n\t\t\t\tif (isRemoteDiagnosticError(remote)) {\n\t\t\t\t\tmd += `\\n\\n${remote.errorMessage}`;\n\t\t\t\t} else {\n\t\t\t\t\tmd += `\n\n|Item|Value|\n|---|---|\n|Remote|${remote.hostName}|\n|OS|${remote.machineInfo.os}|\n|CPUs|${remote.machineInfo.cpus}|\n|Memory (System)|${remote.machineInfo.memory}|\n|VM|${remote.machineInfo.vmHint}|`;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tmd += '\\n</details>';\n\n\t\treturn md;\n\t}\n\n\tprivate generateProcessInfoMd(): string {\n\t\treturn `<details>\n<summary>Process Info</summary>\n\n\\`\\`\\`\n${this._data.processInfo}\n\\`\\`\\`\n\n</details>\n`;\n\t}\n\n\tprivate generateWorkspaceInfoMd(): string {\n\t\treturn `<details>\n<summary>Workspace Info</summary>\n\n\\`\\`\\`\n${this._data.workspaceInfo};\n\\`\\`\\`\n\n</details>\n`;\n\t}\n\n\tprivate generateExperimentsInfoMd(): string {\n\t\treturn `<details>\n<summary>A/B Experiments</summary>\n\n\\`\\`\\`\n${this._data.experimentInfo}\n\\`\\`\\`\n\n</details>\n`;\n\t}\n\n\tprivate generateExtensionsMd(): string {\n\t\tif (this._data.extensionsDisabled) {\n\t\t\treturn 'Extensions disabled';\n\t\t}\n\n\t\tconst themeExclusionStr = this._data.numberOfThemeExtesions ? `\\n(${this._data.numberOfThemeExtesions} theme extensions excluded)` : '';\n\n\t\tif (!this._data.enabledNonThemeExtesions) {\n\t\t\treturn 'Extensions: none' + themeExclusionStr;\n\t\t}\n\n\t\tconst tableHeader = `Extension|Author (truncated)|Version\n---|---|---`;\n\t\tconst table = this._data.enabledNonThemeExtesions.map(e => {\n\t\t\treturn `${e.name}|${e.publisher?.substr(0, 3) ?? 'N/A'}|${e.version}`;\n\t\t}).join('\\n');\n\n\t\treturn `<details><summary>Extensions (${this._data.enabledNonThemeExtesions.length})</summary>\n\n${tableHeader}\n${table}\n${themeExclusionStr}\n\n</details>`;\n\t}\n}\n"]}