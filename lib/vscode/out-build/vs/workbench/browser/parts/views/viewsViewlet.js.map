{"version":3,"file":"viewsViewlet.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/browser/parts/views/viewsViewlet.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IExtensionService } from 'vs/workbench/services/extensions/common/extensions';\nimport { IContextMenuService } from 'vs/platform/contextview/browser/contextView';\nimport { IViewDescriptor, IViewDescriptorService, IAddedViewDescriptorRef } from 'vs/workbench/common/views';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { IThemeService } from 'vs/platform/theme/common/themeService';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IStorageService } from 'vs/platform/storage/common/storage';\nimport { IWorkspaceContextService } from 'vs/platform/workspace/common/workspace';\nimport { ViewPaneContainer } from 'vs/workbench/browser/parts/views/viewPaneContainer';\nimport { ViewPane, IViewPaneOptions } from 'vs/workbench/browser/parts/views/viewPane';\nimport { Event } from 'vs/base/common/event';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IWorkbenchLayoutService } from 'vs/workbench/services/layout/browser/layoutService';\n\nexport interface IViewletViewOptions extends IViewPaneOptions {\n}\n\nexport abstract class FilterViewPaneContainer extends ViewPaneContainer {\n\tprivate constantViewDescriptors: Map<string, IViewDescriptor> = new Map();\n\tprivate allViews: Map<string, Map<string, IViewDescriptor>> = new Map();\n\tprivate filterValue: string[] | undefined;\n\n\tconstructor(\n\t\tviewletId: string,\n\t\tonDidChangeFilterValue: Event<string[]>,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IWorkbenchLayoutService layoutService: IWorkbenchLayoutService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IExtensionService extensionService: IExtensionService,\n\t\t@IWorkspaceContextService contextService: IWorkspaceContextService,\n\t\t@IViewDescriptorService viewDescriptorService: IViewDescriptorService\n\t) {\n\n\t\tsuper(viewletId, { mergeViewWithContainerWhenSingleView: false }, instantiationService, configurationService, layoutService, contextMenuService, telemetryService, extensionService, themeService, storageService, contextService, viewDescriptorService);\n\t\tthis._register(onDidChangeFilterValue(newFilterValue => {\n\t\t\tthis.filterValue = newFilterValue;\n\t\t\tthis.onFilterChanged(newFilterValue);\n\t\t}));\n\n\t\tthis._register(this.onDidChangeViewVisibility(view => {\n\t\t\tconst descriptorMap = Array.from(this.allViews.entries()).find(entry => entry[1].has(view.id));\n\t\t\tif (descriptorMap && !this.filterValue?.includes(descriptorMap[0])) {\n\t\t\t\tthis.setFilter(descriptorMap[1].get(view.id)!);\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.viewContainerModel.onDidChangeActiveViewDescriptors(() => {\n\t\t\tthis.updateAllViews(this.viewContainerModel.activeViewDescriptors);\n\t\t}));\n\t}\n\n\tprivate updateAllViews(viewDescriptors: ReadonlyArray<IViewDescriptor>) {\n\t\tviewDescriptors.forEach(descriptor => {\n\t\t\tlet filterOnValue = this.getFilterOn(descriptor);\n\t\t\tif (!filterOnValue) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (!this.allViews.has(filterOnValue)) {\n\t\t\t\tthis.allViews.set(filterOnValue, new Map());\n\t\t\t}\n\t\t\tthis.allViews.get(filterOnValue)!.set(descriptor.id, descriptor);\n\t\t\tif (this.filterValue && !this.filterValue.includes(filterOnValue)) {\n\t\t\t\tthis.viewContainerModel.setVisible(descriptor.id, false);\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected addConstantViewDescriptors(constantViewDescriptors: IViewDescriptor[]) {\n\t\tconstantViewDescriptors.forEach(viewDescriptor => this.constantViewDescriptors.set(viewDescriptor.id, viewDescriptor));\n\t}\n\n\tprotected abstract getFilterOn(viewDescriptor: IViewDescriptor): string | undefined;\n\n\tprotected abstract setFilter(viewDescriptor: IViewDescriptor): void;\n\n\tprivate onFilterChanged(newFilterValue: string[]) {\n\t\tif (this.allViews.size === 0) {\n\t\t\tthis.updateAllViews(this.viewContainerModel.activeViewDescriptors);\n\t\t}\n\t\tthis.getViewsNotForTarget(newFilterValue).forEach(item => this.viewContainerModel.setVisible(item.id, false));\n\t\tthis.getViewsForTarget(newFilterValue).forEach(item => this.viewContainerModel.setVisible(item.id, true));\n\t}\n\n\tprivate getViewsForTarget(target: string[]): IViewDescriptor[] {\n\t\tconst views: IViewDescriptor[] = [];\n\t\tfor (let i = 0; i < target.length; i++) {\n\t\t\tif (this.allViews.has(target[i])) {\n\t\t\t\tviews.push(...Array.from(this.allViews.get(target[i])!.values()));\n\t\t\t}\n\t\t}\n\n\t\treturn views;\n\t}\n\n\tprivate getViewsNotForTarget(target: string[]): IViewDescriptor[] {\n\t\tconst iterable = this.allViews.keys();\n\t\tlet key = iterable.next();\n\t\tlet views: IViewDescriptor[] = [];\n\t\twhile (!key.done) {\n\t\t\tlet isForTarget: boolean = false;\n\t\t\ttarget.forEach(value => {\n\t\t\t\tif (key.value === value) {\n\t\t\t\t\tisForTarget = true;\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (!isForTarget) {\n\t\t\t\tviews = views.concat(this.getViewsForTarget([key.value]));\n\t\t\t}\n\n\t\t\tkey = iterable.next();\n\t\t}\n\t\treturn views;\n\t}\n\n\toverride onDidAddViewDescriptors(added: IAddedViewDescriptorRef[]): ViewPane[] {\n\t\tconst panes: ViewPane[] = super.onDidAddViewDescriptors(added);\n\t\tfor (let i = 0; i < added.length; i++) {\n\t\t\tif (this.constantViewDescriptors.has(added[i].viewDescriptor.id)) {\n\t\t\t\tpanes[i].setExpanded(false);\n\t\t\t}\n\t\t}\n\t\t// Check that allViews is ready\n\t\tif (this.allViews.size === 0) {\n\t\t\tthis.updateAllViews(this.viewContainerModel.activeViewDescriptors);\n\t\t}\n\t\treturn panes;\n\t}\n\n\tabstract override getTitle(): string;\n\n}\n"]}