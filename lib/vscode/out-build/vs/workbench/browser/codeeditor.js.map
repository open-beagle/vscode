{"version":3,"sources":["vs/workbench/browser/codeeditor.ts"],"names":[],"mappings":"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","file":"codeeditor.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Widget } from 'vs/base/browser/ui/widget';\nimport { IOverlayWidget, ICodeEditor, IOverlayWidgetPosition, OverlayWidgetPositionPreference, isCodeEditor, isCompositeEditor } from 'vs/editor/browser/editorBrowser';\nimport { Emitter } from 'vs/base/common/event';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { IThemeService } from 'vs/platform/theme/common/themeService';\nimport { $, append, clearNode } from 'vs/base/browser/dom';\nimport { attachStylerCallback } from 'vs/platform/theme/common/styler';\nimport { buttonBackground, buttonForeground, editorBackground, editorForeground, contrastBorder } from 'vs/platform/theme/common/colorRegistry';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IHostService } from 'vs/workbench/services/host/browser/host';\nimport { IWorkspaceContextService, WorkbenchState } from 'vs/platform/workspace/common/workspace';\nimport { hasWorkspaceFileExtension } from 'vs/platform/workspaces/common/workspaces';\nimport { Disposable, DisposableStore, dispose } from 'vs/base/common/lifecycle';\nimport { localize } from 'vs/nls';\nimport { IEditorContribution } from 'vs/editor/common/editorCommon';\nimport { isEqual } from 'vs/base/common/resources';\nimport { IFileService } from 'vs/platform/files/common/files';\nimport { URI } from 'vs/base/common/uri';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\nimport { IRange } from 'vs/editor/common/core/range';\nimport { CursorChangeReason, ICursorPositionChangedEvent } from 'vs/editor/common/controller/cursorEvents';\nimport { ModelDecorationOptions } from 'vs/editor/common/model/textModel';\nimport { TrackedRangeStickiness, IModelDecorationsChangeAccessor } from 'vs/editor/common/model';\nimport { EditorOption } from 'vs/editor/common/config/editorOptions';\n\nexport interface IRangeHighlightDecoration {\n\tresource: URI;\n\trange: IRange;\n\tisWholeLine?: boolean;\n}\n\nexport class RangeHighlightDecorations extends Disposable {\n\n\tprivate readonly _onHighlightRemoved = this._register(new Emitter<void>());\n\treadonly onHighlightRemoved = this._onHighlightRemoved.event;\n\n\tprivate rangeHighlightDecorationId: string | null = null;\n\tprivate editor: ICodeEditor | null = null;\n\tprivate readonly editorDisposables = this._register(new DisposableStore());\n\n\tconstructor(@IEditorService private readonly editorService: IEditorService) {\n\t\tsuper();\n\t}\n\n\tremoveHighlightRange() {\n\t\tif (this.editor?.getModel() && this.rangeHighlightDecorationId) {\n\t\t\tthis.editor.deltaDecorations([this.rangeHighlightDecorationId], []);\n\t\t\tthis._onHighlightRemoved.fire();\n\t\t}\n\n\t\tthis.rangeHighlightDecorationId = null;\n\t}\n\n\thighlightRange(range: IRangeHighlightDecoration, editor?: any) {\n\t\teditor = editor ?? this.getEditor(range);\n\t\tif (isCodeEditor(editor)) {\n\t\t\tthis.doHighlightRange(editor, range);\n\t\t} else if (isCompositeEditor(editor) && isCodeEditor(editor.activeCodeEditor)) {\n\t\t\tthis.doHighlightRange(editor.activeCodeEditor, range);\n\t\t}\n\t}\n\n\tprivate doHighlightRange(editor: ICodeEditor, selectionRange: IRangeHighlightDecoration) {\n\t\tthis.removeHighlightRange();\n\n\t\teditor.changeDecorations((changeAccessor: IModelDecorationsChangeAccessor) => {\n\t\t\tthis.rangeHighlightDecorationId = changeAccessor.addDecoration(selectionRange.range, this.createRangeHighlightDecoration(selectionRange.isWholeLine));\n\t\t});\n\n\t\tthis.setEditor(editor);\n\t}\n\n\tprivate getEditor(resourceRange: IRangeHighlightDecoration): ICodeEditor | undefined {\n\t\tconst resource = this.editorService.activeEditor?.resource;\n\t\tif (resource && isEqual(resource, resourceRange.resource) && isCodeEditor(this.editorService.activeTextEditorControl)) {\n\t\t\treturn this.editorService.activeTextEditorControl;\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate setEditor(editor: ICodeEditor) {\n\t\tif (this.editor !== editor) {\n\t\t\tthis.editorDisposables.clear();\n\t\t\tthis.editor = editor;\n\t\t\tthis.editorDisposables.add(this.editor.onDidChangeCursorPosition((e: ICursorPositionChangedEvent) => {\n\t\t\t\tif (\n\t\t\t\t\te.reason === CursorChangeReason.NotSet\n\t\t\t\t\t|| e.reason === CursorChangeReason.Explicit\n\t\t\t\t\t|| e.reason === CursorChangeReason.Undo\n\t\t\t\t\t|| e.reason === CursorChangeReason.Redo\n\t\t\t\t) {\n\t\t\t\t\tthis.removeHighlightRange();\n\t\t\t\t}\n\t\t\t}));\n\t\t\tthis.editorDisposables.add(this.editor.onDidChangeModel(() => { this.removeHighlightRange(); }));\n\t\t\tthis.editorDisposables.add(this.editor.onDidDispose(() => {\n\t\t\t\tthis.removeHighlightRange();\n\t\t\t\tthis.editor = null;\n\t\t\t}));\n\t\t}\n\t}\n\n\tprivate static readonly _WHOLE_LINE_RANGE_HIGHLIGHT = ModelDecorationOptions.register({\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tclassName: 'rangeHighlight',\n\t\tisWholeLine: true\n\t});\n\n\tprivate static readonly _RANGE_HIGHLIGHT = ModelDecorationOptions.register({\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tclassName: 'rangeHighlight'\n\t});\n\n\tprivate createRangeHighlightDecoration(isWholeLine: boolean = true): ModelDecorationOptions {\n\t\treturn (isWholeLine ? RangeHighlightDecorations._WHOLE_LINE_RANGE_HIGHLIGHT : RangeHighlightDecorations._RANGE_HIGHLIGHT);\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\n\t\tif (this.editor?.getModel()) {\n\t\t\tthis.removeHighlightRange();\n\t\t\tthis.editor = null;\n\t\t}\n\t}\n}\n\nexport class FloatingClickWidget extends Widget implements IOverlayWidget {\n\n\tprivate readonly _onClick = this._register(new Emitter<void>());\n\treadonly onClick = this._onClick.event;\n\n\tprivate _domNode: HTMLElement;\n\n\tconstructor(\n\t\tprivate editor: ICodeEditor,\n\t\tprivate label: string,\n\t\tkeyBindingAction: string | null,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IThemeService private readonly themeService: IThemeService\n\t) {\n\t\tsuper();\n\n\t\tthis._domNode = $('.floating-click-widget');\n\t\tthis._domNode.style.padding = '10px';\n\t\tthis._domNode.style.cursor = 'pointer';\n\n\t\tif (keyBindingAction) {\n\t\t\tconst keybinding = keybindingService.lookupKeybinding(keyBindingAction);\n\t\t\tif (keybinding) {\n\t\t\t\tthis.label += ` (${keybinding.getLabel()})`;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetId(): string {\n\t\treturn 'editor.overlayWidget.floatingClickWidget';\n\t}\n\n\tgetDomNode(): HTMLElement {\n\t\treturn this._domNode;\n\t}\n\n\tgetPosition(): IOverlayWidgetPosition {\n\t\treturn {\n\t\t\tpreference: OverlayWidgetPositionPreference.BOTTOM_RIGHT_CORNER\n\t\t};\n\t}\n\n\trender() {\n\t\tclearNode(this._domNode);\n\n\t\tthis._register(attachStylerCallback(this.themeService, { buttonBackground, buttonForeground, editorBackground, editorForeground, contrastBorder }, colors => {\n\t\t\tconst backgroundColor = colors.buttonBackground ? colors.buttonBackground : colors.editorBackground;\n\t\t\tif (backgroundColor) {\n\t\t\t\tthis._domNode.style.backgroundColor = backgroundColor.toString();\n\t\t\t}\n\n\t\t\tconst foregroundColor = colors.buttonForeground ? colors.buttonForeground : colors.editorForeground;\n\t\t\tif (foregroundColor) {\n\t\t\t\tthis._domNode.style.color = foregroundColor.toString();\n\t\t\t}\n\n\t\t\tconst borderColor = colors.contrastBorder ? colors.contrastBorder.toString() : '';\n\t\t\tthis._domNode.style.borderWidth = borderColor ? '1px' : '';\n\t\t\tthis._domNode.style.borderStyle = borderColor ? 'solid' : '';\n\t\t\tthis._domNode.style.borderColor = borderColor;\n\t\t}));\n\n\t\tappend(this._domNode, $('')).textContent = this.label;\n\n\t\tthis.onclick(this._domNode, e => this._onClick.fire());\n\n\t\tthis.editor.addOverlayWidget(this);\n\t}\n\n\toverride dispose(): void {\n\t\tthis.editor.removeOverlayWidget(this);\n\n\t\tsuper.dispose();\n\t}\n}\n\nexport class OpenWorkspaceButtonContribution extends Disposable implements IEditorContribution {\n\n\tstatic get(editor: ICodeEditor): OpenWorkspaceButtonContribution {\n\t\treturn editor.getContribution<OpenWorkspaceButtonContribution>(OpenWorkspaceButtonContribution.ID);\n\t}\n\n\tpublic static readonly ID = 'editor.contrib.openWorkspaceButton';\n\n\tprivate openWorkspaceButton: FloatingClickWidget | undefined;\n\n\tconstructor(\n\t\tprivate editor: ICodeEditor,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IHostService private readonly hostService: IHostService,\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService,\n\t\t@IFileService private readonly fileService: IFileService\n\t) {\n\t\tsuper();\n\n\t\tthis.update();\n\t\tthis.registerListeners();\n\t}\n\n\tprivate registerListeners(): void {\n\t\tthis._register(this.editor.onDidChangeModel(e => this.update()));\n\t}\n\n\tprivate update(): void {\n\t\tif (!this.shouldShowButton(this.editor)) {\n\t\t\tthis.disposeOpenWorkspaceWidgetRenderer();\n\t\t\treturn;\n\t\t}\n\n\t\tthis.createOpenWorkspaceWidgetRenderer();\n\t}\n\n\tprivate shouldShowButton(editor: ICodeEditor): boolean {\n\t\tconst model = editor.getModel();\n\t\tif (!model) {\n\t\t\treturn false; // we need a model\n\t\t}\n\n\t\tif (!hasWorkspaceFileExtension(model.uri)) {\n\t\t\treturn false; // we need a workspace file\n\t\t}\n\n\t\tif (!this.fileService.canHandleResource(model.uri)) {\n\t\t\treturn false; // needs to be backed by a file service\n\t\t}\n\n\t\tif (this.contextService.getWorkbenchState() === WorkbenchState.WORKSPACE) {\n\t\t\tconst workspaceConfiguration = this.contextService.getWorkspace().configuration;\n\t\t\tif (workspaceConfiguration && isEqual(workspaceConfiguration, model.uri)) {\n\t\t\t\treturn false; // already inside workspace\n\t\t\t}\n\t\t}\n\n\t\tif (editor.getOption(EditorOption.inDiffEditor)) {\n\t\t\t// in diff editor\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprivate createOpenWorkspaceWidgetRenderer(): void {\n\t\tif (!this.openWorkspaceButton) {\n\t\t\tthis.openWorkspaceButton = this.instantiationService.createInstance(FloatingClickWidget, this.editor, localize('openWorkspace', \"Open Workspace\"), null);\n\t\t\tthis._register(this.openWorkspaceButton.onClick(() => {\n\t\t\t\tconst model = this.editor.getModel();\n\t\t\t\tif (model) {\n\t\t\t\t\tthis.hostService.openWindow([{ workspaceUri: model.uri }]);\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tthis.openWorkspaceButton.render();\n\t\t}\n\t}\n\n\tprivate disposeOpenWorkspaceWidgetRenderer(): void {\n\t\tdispose(this.openWorkspaceButton);\n\t\tthis.openWorkspaceButton = undefined;\n\t}\n\n\toverride dispose(): void {\n\t\tthis.disposeOpenWorkspaceWidgetRenderer();\n\n\t\tsuper.dispose();\n\t}\n}\n"]}