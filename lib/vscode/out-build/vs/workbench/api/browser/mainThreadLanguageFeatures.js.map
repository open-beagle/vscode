{"version":3,"file":"mainThreadLanguageFeatures.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/api/browser/mainThreadLanguageFeatures.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { ITextModel, ISingleEditOperation } from 'vs/editor/common/model';\nimport * as modes from 'vs/editor/common/modes';\nimport * as search from 'vs/workbench/contrib/search/common/search';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { Position as EditorPosition } from 'vs/editor/common/core/position';\nimport { Range as EditorRange, IRange } from 'vs/editor/common/core/range';\nimport { ExtHostContext, MainThreadLanguageFeaturesShape, ExtHostLanguageFeaturesShape, MainContext, IExtHostContext, ILanguageConfigurationDto, IRegExpDto, IIndentationRuleDto, IOnEnterRuleDto, ILocationDto, IWorkspaceSymbolDto, reviveWorkspaceEditDto, IDocumentFilterDto, IDefinitionLinkDto, ISignatureHelpProviderMetadataDto, ILinkDto, ICallHierarchyItemDto, ISuggestDataDto, ICodeActionDto, ISuggestDataDtoField, ISuggestResultDtoField, ICodeActionProviderMetadataDto, ILanguageWordDefinitionDto } from '../common/extHost.protocol';\nimport { LanguageConfigurationRegistry } from 'vs/editor/common/modes/languageConfigurationRegistry';\nimport { LanguageConfiguration, IndentationRule, OnEnterRule } from 'vs/editor/common/modes/languageConfiguration';\nimport { IModeService } from 'vs/editor/common/services/modeService';\nimport { extHostNamedCustomer } from 'vs/workbench/api/common/extHostCustomers';\nimport { URI } from 'vs/base/common/uri';\nimport { Selection } from 'vs/editor/common/core/selection';\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\nimport * as callh from 'vs/workbench/contrib/callHierarchy/common/callHierarchy';\nimport { mixin } from 'vs/base/common/objects';\nimport { decodeSemanticTokensDto } from 'vs/editor/common/services/semanticTokensDto';\n\n@extHostNamedCustomer(MainContext.MainThreadLanguageFeatures)\nexport class MainThreadLanguageFeatures implements MainThreadLanguageFeaturesShape {\n\n\tprivate readonly _proxy: ExtHostLanguageFeaturesShape;\n\tprivate readonly _modeService: IModeService;\n\tprivate readonly _registrations = new Map<number, IDisposable>();\n\n\tconstructor(\n\t\textHostContext: IExtHostContext,\n\t\t@IModeService modeService: IModeService,\n\t) {\n\t\tthis._proxy = extHostContext.getProxy(ExtHostContext.ExtHostLanguageFeatures);\n\t\tthis._modeService = modeService;\n\n\t\tif (this._modeService) {\n\t\t\tconst updateAllWordDefinitions = () => {\n\t\t\t\tconst langWordPairs = LanguageConfigurationRegistry.getWordDefinitions();\n\t\t\t\tlet wordDefinitionDtos: ILanguageWordDefinitionDto[] = [];\n\t\t\t\tfor (const [languageId, wordDefinition] of langWordPairs) {\n\t\t\t\t\tconst language = this._modeService.getLanguageIdentifier(languageId);\n\t\t\t\t\tif (!language) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\twordDefinitionDtos.push({\n\t\t\t\t\t\tlanguageId: language.language,\n\t\t\t\t\t\tregexSource: wordDefinition.source,\n\t\t\t\t\t\tregexFlags: wordDefinition.flags\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tthis._proxy.$setWordDefinitions(wordDefinitionDtos);\n\t\t\t};\n\t\t\tLanguageConfigurationRegistry.onDidChange((e) => {\n\t\t\t\tconst wordDefinition = LanguageConfigurationRegistry.getWordDefinition(e.languageIdentifier.id);\n\t\t\t\tthis._proxy.$setWordDefinitions([{\n\t\t\t\t\tlanguageId: e.languageIdentifier.language,\n\t\t\t\t\tregexSource: wordDefinition.source,\n\t\t\t\t\tregexFlags: wordDefinition.flags\n\t\t\t\t}]);\n\t\t\t});\n\t\t\tupdateAllWordDefinitions();\n\t\t}\n\t}\n\n\tdispose(): void {\n\t\tfor (const registration of this._registrations.values()) {\n\t\t\tregistration.dispose();\n\t\t}\n\t\tthis._registrations.clear();\n\t}\n\n\t$unregister(handle: number): void {\n\t\tconst registration = this._registrations.get(handle);\n\t\tif (registration) {\n\t\t\tregistration.dispose();\n\t\t\tthis._registrations.delete(handle);\n\t\t}\n\t}\n\n\t//#region --- revive functions\n\n\tprivate static _reviveLocationDto(data?: ILocationDto): modes.Location;\n\tprivate static _reviveLocationDto(data?: ILocationDto[]): modes.Location[];\n\tprivate static _reviveLocationDto(data: ILocationDto | ILocationDto[] | undefined): modes.Location | modes.Location[] | undefined {\n\t\tif (!data) {\n\t\t\treturn data;\n\t\t} else if (Array.isArray(data)) {\n\t\t\tdata.forEach(l => MainThreadLanguageFeatures._reviveLocationDto(l));\n\t\t\treturn <modes.Location[]>data;\n\t\t} else {\n\t\t\tdata.uri = URI.revive(data.uri);\n\t\t\treturn <modes.Location>data;\n\t\t}\n\t}\n\n\tprivate static _reviveLocationLinkDto(data: IDefinitionLinkDto): modes.LocationLink;\n\tprivate static _reviveLocationLinkDto(data: IDefinitionLinkDto[]): modes.LocationLink[];\n\tprivate static _reviveLocationLinkDto(data: IDefinitionLinkDto | IDefinitionLinkDto[]): modes.LocationLink | modes.LocationLink[] {\n\t\tif (!data) {\n\t\t\treturn <modes.LocationLink>data;\n\t\t} else if (Array.isArray(data)) {\n\t\t\tdata.forEach(l => MainThreadLanguageFeatures._reviveLocationLinkDto(l));\n\t\t\treturn <modes.LocationLink[]>data;\n\t\t} else {\n\t\t\tdata.uri = URI.revive(data.uri);\n\t\t\treturn <modes.LocationLink>data;\n\t\t}\n\t}\n\n\tprivate static _reviveWorkspaceSymbolDto(data: IWorkspaceSymbolDto): search.IWorkspaceSymbol;\n\tprivate static _reviveWorkspaceSymbolDto(data: IWorkspaceSymbolDto[]): search.IWorkspaceSymbol[];\n\tprivate static _reviveWorkspaceSymbolDto(data: undefined): undefined;\n\tprivate static _reviveWorkspaceSymbolDto(data: IWorkspaceSymbolDto | IWorkspaceSymbolDto[] | undefined): search.IWorkspaceSymbol | search.IWorkspaceSymbol[] | undefined {\n\t\tif (!data) {\n\t\t\treturn <undefined>data;\n\t\t} else if (Array.isArray(data)) {\n\t\t\tdata.forEach(MainThreadLanguageFeatures._reviveWorkspaceSymbolDto);\n\t\t\treturn <search.IWorkspaceSymbol[]>data;\n\t\t} else {\n\t\t\tdata.location = MainThreadLanguageFeatures._reviveLocationDto(data.location);\n\t\t\treturn <search.IWorkspaceSymbol>data;\n\t\t}\n\t}\n\n\tprivate static _reviveCodeActionDto(data: ReadonlyArray<ICodeActionDto>): modes.CodeAction[] {\n\t\tif (data) {\n\t\t\tdata.forEach(code => reviveWorkspaceEditDto(code.edit));\n\t\t}\n\t\treturn <modes.CodeAction[]>data;\n\t}\n\n\tprivate static _reviveLinkDTO(data: ILinkDto): modes.ILink {\n\t\tif (data.url && typeof data.url !== 'string') {\n\t\t\tdata.url = URI.revive(data.url);\n\t\t}\n\t\treturn <modes.ILink>data;\n\t}\n\n\tprivate static _reviveCallHierarchyItemDto(data: ICallHierarchyItemDto | undefined): callh.CallHierarchyItem {\n\t\tif (data) {\n\t\t\tdata.uri = URI.revive(data.uri);\n\t\t}\n\t\treturn data as callh.CallHierarchyItem;\n\t}\n\n\t//#endregion\n\n\t// --- outline\n\n\t$registerDocumentSymbolProvider(handle: number, selector: IDocumentFilterDto[], displayName: string): void {\n\t\tthis._registrations.set(handle, modes.DocumentSymbolProviderRegistry.register(selector, <modes.DocumentSymbolProvider>{\n\t\t\tdisplayName,\n\t\t\tprovideDocumentSymbols: (model: ITextModel, token: CancellationToken): Promise<modes.DocumentSymbol[] | undefined> => {\n\t\t\t\treturn this._proxy.$provideDocumentSymbols(handle, model.uri, token);\n\t\t\t}\n\t\t}));\n\t}\n\n\t// --- code lens\n\n\t$registerCodeLensSupport(handle: number, selector: IDocumentFilterDto[], eventHandle: number | undefined): void {\n\n\t\tconst provider = <modes.CodeLensProvider>{\n\t\t\tprovideCodeLenses: async (model: ITextModel, token: CancellationToken): Promise<modes.CodeLensList | undefined> => {\n\t\t\t\tconst listDto = await this._proxy.$provideCodeLenses(handle, model.uri, token);\n\t\t\t\tif (!listDto) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tlenses: listDto.lenses,\n\t\t\t\t\tdispose: () => listDto.cacheId && this._proxy.$releaseCodeLenses(handle, listDto.cacheId)\n\t\t\t\t};\n\t\t\t},\n\t\t\tresolveCodeLens: (_model: ITextModel, codeLens: modes.CodeLens, token: CancellationToken): Promise<modes.CodeLens | undefined> => {\n\t\t\t\treturn this._proxy.$resolveCodeLens(handle, codeLens, token);\n\t\t\t}\n\t\t};\n\n\t\tif (typeof eventHandle === 'number') {\n\t\t\tconst emitter = new Emitter<modes.CodeLensProvider>();\n\t\t\tthis._registrations.set(eventHandle, emitter);\n\t\t\tprovider.onDidChange = emitter.event;\n\t\t}\n\n\t\tthis._registrations.set(handle, modes.CodeLensProviderRegistry.register(selector, provider));\n\t}\n\n\t$emitCodeLensEvent(eventHandle: number, event?: any): void {\n\t\tconst obj = this._registrations.get(eventHandle);\n\t\tif (obj instanceof Emitter) {\n\t\t\tobj.fire(event);\n\t\t}\n\t}\n\n\t// --- declaration\n\n\t$registerDefinitionSupport(handle: number, selector: IDocumentFilterDto[]): void {\n\t\tthis._registrations.set(handle, modes.DefinitionProviderRegistry.register(selector, <modes.DefinitionProvider>{\n\t\t\tprovideDefinition: (model, position, token): Promise<modes.LocationLink[]> => {\n\t\t\t\treturn this._proxy.$provideDefinition(handle, model.uri, position, token).then(MainThreadLanguageFeatures._reviveLocationLinkDto);\n\t\t\t}\n\t\t}));\n\t}\n\n\t$registerDeclarationSupport(handle: number, selector: IDocumentFilterDto[]): void {\n\t\tthis._registrations.set(handle, modes.DeclarationProviderRegistry.register(selector, <modes.DeclarationProvider>{\n\t\t\tprovideDeclaration: (model, position, token) => {\n\t\t\t\treturn this._proxy.$provideDeclaration(handle, model.uri, position, token).then(MainThreadLanguageFeatures._reviveLocationLinkDto);\n\t\t\t}\n\t\t}));\n\t}\n\n\t$registerImplementationSupport(handle: number, selector: IDocumentFilterDto[]): void {\n\t\tthis._registrations.set(handle, modes.ImplementationProviderRegistry.register(selector, <modes.ImplementationProvider>{\n\t\t\tprovideImplementation: (model, position, token): Promise<modes.LocationLink[]> => {\n\t\t\t\treturn this._proxy.$provideImplementation(handle, model.uri, position, token).then(MainThreadLanguageFeatures._reviveLocationLinkDto);\n\t\t\t}\n\t\t}));\n\t}\n\n\t$registerTypeDefinitionSupport(handle: number, selector: IDocumentFilterDto[]): void {\n\t\tthis._registrations.set(handle, modes.TypeDefinitionProviderRegistry.register(selector, <modes.TypeDefinitionProvider>{\n\t\t\tprovideTypeDefinition: (model, position, token): Promise<modes.LocationLink[]> => {\n\t\t\t\treturn this._proxy.$provideTypeDefinition(handle, model.uri, position, token).then(MainThreadLanguageFeatures._reviveLocationLinkDto);\n\t\t\t}\n\t\t}));\n\t}\n\n\t// --- extra info\n\n\t$registerHoverProvider(handle: number, selector: IDocumentFilterDto[]): void {\n\t\tthis._registrations.set(handle, modes.HoverProviderRegistry.register(selector, <modes.HoverProvider>{\n\t\t\tprovideHover: (model: ITextModel, position: EditorPosition, token: CancellationToken): Promise<modes.Hover | undefined> => {\n\t\t\t\treturn this._proxy.$provideHover(handle, model.uri, position, token);\n\t\t\t}\n\t\t}));\n\t}\n\n\t// --- debug hover\n\n\t$registerEvaluatableExpressionProvider(handle: number, selector: IDocumentFilterDto[]): void {\n\t\tthis._registrations.set(handle, modes.EvaluatableExpressionProviderRegistry.register(selector, <modes.EvaluatableExpressionProvider>{\n\t\t\tprovideEvaluatableExpression: (model: ITextModel, position: EditorPosition, token: CancellationToken): Promise<modes.EvaluatableExpression | undefined> => {\n\t\t\t\treturn this._proxy.$provideEvaluatableExpression(handle, model.uri, position, token);\n\t\t\t}\n\t\t}));\n\t}\n\n\t// --- inline values\n\n\t$registerInlineValuesProvider(handle: number, selector: IDocumentFilterDto[], eventHandle: number | undefined): void {\n\t\tconst provider = <modes.InlineValuesProvider>{\n\t\t\tprovideInlineValues: (model: ITextModel, viewPort: EditorRange, context: modes.InlineValueContext, token: CancellationToken): Promise<modes.InlineValue[] | undefined> => {\n\t\t\t\treturn this._proxy.$provideInlineValues(handle, model.uri, viewPort, context, token);\n\t\t\t}\n\t\t};\n\n\t\tif (typeof eventHandle === 'number') {\n\t\t\tconst emitter = new Emitter<void>();\n\t\t\tthis._registrations.set(eventHandle, emitter);\n\t\t\tprovider.onDidChangeInlineValues = emitter.event;\n\t\t}\n\n\t\tthis._registrations.set(handle, modes.InlineValuesProviderRegistry.register(selector, provider));\n\t}\n\n\t$emitInlineValuesEvent(eventHandle: number, event?: any): void {\n\t\tconst obj = this._registrations.get(eventHandle);\n\t\tif (obj instanceof Emitter) {\n\t\t\tobj.fire(event);\n\t\t}\n\t}\n\n\t// --- occurrences\n\n\t$registerDocumentHighlightProvider(handle: number, selector: IDocumentFilterDto[]): void {\n\t\tthis._registrations.set(handle, modes.DocumentHighlightProviderRegistry.register(selector, <modes.DocumentHighlightProvider>{\n\t\t\tprovideDocumentHighlights: (model: ITextModel, position: EditorPosition, token: CancellationToken): Promise<modes.DocumentHighlight[] | undefined> => {\n\t\t\t\treturn this._proxy.$provideDocumentHighlights(handle, model.uri, position, token);\n\t\t\t}\n\t\t}));\n\t}\n\n\t// --- linked editing\n\n\t$registerLinkedEditingRangeProvider(handle: number, selector: IDocumentFilterDto[]): void {\n\t\tthis._registrations.set(handle, modes.LinkedEditingRangeProviderRegistry.register(selector, <modes.LinkedEditingRangeProvider>{\n\t\t\tprovideLinkedEditingRanges: async (model: ITextModel, position: EditorPosition, token: CancellationToken): Promise<modes.LinkedEditingRanges | undefined> => {\n\t\t\t\tconst res = await this._proxy.$provideLinkedEditingRanges(handle, model.uri, position, token);\n\t\t\t\tif (res) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tranges: res.ranges,\n\t\t\t\t\t\twordPattern: res.wordPattern ? MainThreadLanguageFeatures._reviveRegExp(res.wordPattern) : undefined\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}));\n\t}\n\n\t// --- references\n\n\t$registerReferenceSupport(handle: number, selector: IDocumentFilterDto[]): void {\n\t\tthis._registrations.set(handle, modes.ReferenceProviderRegistry.register(selector, <modes.ReferenceProvider>{\n\t\t\tprovideReferences: (model: ITextModel, position: EditorPosition, context: modes.ReferenceContext, token: CancellationToken): Promise<modes.Location[]> => {\n\t\t\t\treturn this._proxy.$provideReferences(handle, model.uri, position, context, token).then(MainThreadLanguageFeatures._reviveLocationDto);\n\t\t\t}\n\t\t}));\n\t}\n\n\t// --- quick fix\n\n\t$registerQuickFixSupport(handle: number, selector: IDocumentFilterDto[], metadata: ICodeActionProviderMetadataDto, displayName: string, supportsResolve: boolean): void {\n\t\tconst provider: modes.CodeActionProvider = {\n\t\t\tprovideCodeActions: async (model: ITextModel, rangeOrSelection: EditorRange | Selection, context: modes.CodeActionContext, token: CancellationToken): Promise<modes.CodeActionList | undefined> => {\n\t\t\t\tconst listDto = await this._proxy.$provideCodeActions(handle, model.uri, rangeOrSelection, context, token);\n\t\t\t\tif (!listDto) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\treturn <modes.CodeActionList>{\n\t\t\t\t\tactions: MainThreadLanguageFeatures._reviveCodeActionDto(listDto.actions),\n\t\t\t\t\tdispose: () => {\n\t\t\t\t\t\tif (typeof listDto.cacheId === 'number') {\n\t\t\t\t\t\t\tthis._proxy.$releaseCodeActions(handle, listDto.cacheId);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t},\n\t\t\tprovidedCodeActionKinds: metadata.providedKinds,\n\t\t\tdocumentation: metadata.documentation,\n\t\t\tdisplayName\n\t\t};\n\n\t\tif (supportsResolve) {\n\t\t\tprovider.resolveCodeAction = async (codeAction: modes.CodeAction, token: CancellationToken): Promise<modes.CodeAction> => {\n\t\t\t\tconst data = await this._proxy.$resolveCodeAction(handle, (<ICodeActionDto>codeAction).cacheId!, token);\n\t\t\t\tcodeAction.edit = reviveWorkspaceEditDto(data);\n\t\t\t\treturn codeAction;\n\t\t\t};\n\t\t}\n\n\t\tthis._registrations.set(handle, modes.CodeActionProviderRegistry.register(selector, provider));\n\t}\n\n\t// --- formatting\n\n\t$registerDocumentFormattingSupport(handle: number, selector: IDocumentFilterDto[], extensionId: ExtensionIdentifier, displayName: string): void {\n\t\tthis._registrations.set(handle, modes.DocumentFormattingEditProviderRegistry.register(selector, <modes.DocumentFormattingEditProvider>{\n\t\t\textensionId,\n\t\t\tdisplayName,\n\t\t\tprovideDocumentFormattingEdits: (model: ITextModel, options: modes.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined> => {\n\t\t\t\treturn this._proxy.$provideDocumentFormattingEdits(handle, model.uri, options, token);\n\t\t\t}\n\t\t}));\n\t}\n\n\t$registerRangeFormattingSupport(handle: number, selector: IDocumentFilterDto[], extensionId: ExtensionIdentifier, displayName: string): void {\n\t\tthis._registrations.set(handle, modes.DocumentRangeFormattingEditProviderRegistry.register(selector, <modes.DocumentRangeFormattingEditProvider>{\n\t\t\textensionId,\n\t\t\tdisplayName,\n\t\t\tprovideDocumentRangeFormattingEdits: (model: ITextModel, range: EditorRange, options: modes.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined> => {\n\t\t\t\treturn this._proxy.$provideDocumentRangeFormattingEdits(handle, model.uri, range, options, token);\n\t\t\t}\n\t\t}));\n\t}\n\n\t$registerOnTypeFormattingSupport(handle: number, selector: IDocumentFilterDto[], autoFormatTriggerCharacters: string[], extensionId: ExtensionIdentifier): void {\n\t\tthis._registrations.set(handle, modes.OnTypeFormattingEditProviderRegistry.register(selector, <modes.OnTypeFormattingEditProvider>{\n\t\t\textensionId,\n\t\t\tautoFormatTriggerCharacters,\n\t\t\tprovideOnTypeFormattingEdits: (model: ITextModel, position: EditorPosition, ch: string, options: modes.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined> => {\n\t\t\t\treturn this._proxy.$provideOnTypeFormattingEdits(handle, model.uri, position, ch, options, token);\n\t\t\t}\n\t\t}));\n\t}\n\n\t// --- navigate type\n\n\t$registerNavigateTypeSupport(handle: number): void {\n\t\tlet lastResultId: number | undefined;\n\t\tthis._registrations.set(handle, search.WorkspaceSymbolProviderRegistry.register(<search.IWorkspaceSymbolProvider>{\n\t\t\tprovideWorkspaceSymbols: (search: string, token: CancellationToken): Promise<search.IWorkspaceSymbol[]> => {\n\t\t\t\treturn this._proxy.$provideWorkspaceSymbols(handle, search, token).then(result => {\n\t\t\t\t\tif (lastResultId !== undefined) {\n\t\t\t\t\t\tthis._proxy.$releaseWorkspaceSymbols(handle, lastResultId);\n\t\t\t\t\t}\n\t\t\t\t\tlastResultId = result._id;\n\t\t\t\t\treturn MainThreadLanguageFeatures._reviveWorkspaceSymbolDto(result.symbols);\n\t\t\t\t});\n\t\t\t},\n\t\t\tresolveWorkspaceSymbol: (item: search.IWorkspaceSymbol, token: CancellationToken): Promise<search.IWorkspaceSymbol | undefined> => {\n\t\t\t\treturn this._proxy.$resolveWorkspaceSymbol(handle, item, token).then(i => {\n\t\t\t\t\tif (i) {\n\t\t\t\t\t\treturn MainThreadLanguageFeatures._reviveWorkspaceSymbolDto(i);\n\t\t\t\t\t}\n\t\t\t\t\treturn undefined;\n\t\t\t\t});\n\t\t\t}\n\t\t}));\n\t}\n\n\t// --- rename\n\n\t$registerRenameSupport(handle: number, selector: IDocumentFilterDto[], supportResolveLocation: boolean): void {\n\t\tthis._registrations.set(handle, modes.RenameProviderRegistry.register(selector, <modes.RenameProvider>{\n\t\t\tprovideRenameEdits: (model: ITextModel, position: EditorPosition, newName: string, token: CancellationToken) => {\n\t\t\t\treturn this._proxy.$provideRenameEdits(handle, model.uri, position, newName, token).then(reviveWorkspaceEditDto);\n\t\t\t},\n\t\t\tresolveRenameLocation: supportResolveLocation\n\t\t\t\t? (model: ITextModel, position: EditorPosition, token: CancellationToken): Promise<modes.RenameLocation | undefined> => this._proxy.$resolveRenameLocation(handle, model.uri, position, token)\n\t\t\t\t: undefined\n\t\t}));\n\t}\n\n\t// --- semantic tokens\n\n\t$registerDocumentSemanticTokensProvider(handle: number, selector: IDocumentFilterDto[], legend: modes.SemanticTokensLegend, eventHandle: number | undefined): void {\n\t\tlet event: Event<void> | undefined = undefined;\n\t\tif (typeof eventHandle === 'number') {\n\t\t\tconst emitter = new Emitter<void>();\n\t\t\tthis._registrations.set(eventHandle, emitter);\n\t\t\tevent = emitter.event;\n\t\t}\n\t\tthis._registrations.set(handle, modes.DocumentSemanticTokensProviderRegistry.register(selector, new MainThreadDocumentSemanticTokensProvider(this._proxy, handle, legend, event)));\n\t}\n\n\t$emitDocumentSemanticTokensEvent(eventHandle: number): void {\n\t\tconst obj = this._registrations.get(eventHandle);\n\t\tif (obj instanceof Emitter) {\n\t\t\tobj.fire(undefined);\n\t\t}\n\t}\n\n\t$registerDocumentRangeSemanticTokensProvider(handle: number, selector: IDocumentFilterDto[], legend: modes.SemanticTokensLegend): void {\n\t\tthis._registrations.set(handle, modes.DocumentRangeSemanticTokensProviderRegistry.register(selector, new MainThreadDocumentRangeSemanticTokensProvider(this._proxy, handle, legend)));\n\t}\n\n\t// --- suggest\n\n\tprivate static _inflateSuggestDto(defaultRange: IRange | { insert: IRange, replace: IRange }, data: ISuggestDataDto): modes.CompletionItem {\n\n\t\treturn {\n\t\t\tlabel: data[ISuggestDataDtoField.label2] ?? data[ISuggestDataDtoField.label],\n\t\t\tkind: data[ISuggestDataDtoField.kind] ?? modes.CompletionItemKind.Property,\n\t\t\ttags: data[ISuggestDataDtoField.kindModifier],\n\t\t\tdetail: data[ISuggestDataDtoField.detail],\n\t\t\tdocumentation: data[ISuggestDataDtoField.documentation],\n\t\t\tsortText: data[ISuggestDataDtoField.sortText],\n\t\t\tfilterText: data[ISuggestDataDtoField.filterText],\n\t\t\tpreselect: data[ISuggestDataDtoField.preselect],\n\t\t\tinsertText: typeof data.h === 'undefined' ? data[ISuggestDataDtoField.label] : data.h,\n\t\t\trange: data[ISuggestDataDtoField.range] ?? defaultRange,\n\t\t\tinsertTextRules: data[ISuggestDataDtoField.insertTextRules],\n\t\t\tcommitCharacters: data[ISuggestDataDtoField.commitCharacters],\n\t\t\tadditionalTextEdits: data[ISuggestDataDtoField.additionalTextEdits],\n\t\t\tcommand: data[ISuggestDataDtoField.command],\n\t\t\t// not-standard\n\t\t\t_id: data.x,\n\t\t};\n\t}\n\n\t$registerSuggestSupport(handle: number, selector: IDocumentFilterDto[], triggerCharacters: string[], supportsResolveDetails: boolean, displayName: string): void {\n\t\tconst provider: modes.CompletionItemProvider = {\n\t\t\ttriggerCharacters,\n\t\t\t_debugDisplayName: displayName,\n\t\t\tprovideCompletionItems: async (model: ITextModel, position: EditorPosition, context: modes.CompletionContext, token: CancellationToken): Promise<modes.CompletionList | undefined> => {\n\t\t\t\tconst result = await this._proxy.$provideCompletionItems(handle, model.uri, position, context, token);\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: result[ISuggestResultDtoField.completions].map(d => MainThreadLanguageFeatures._inflateSuggestDto(result[ISuggestResultDtoField.defaultRanges], d)),\n\t\t\t\t\tincomplete: result[ISuggestResultDtoField.isIncomplete] || false,\n\t\t\t\t\tduration: result[ISuggestResultDtoField.duration],\n\t\t\t\t\tdispose: () => {\n\t\t\t\t\t\tif (typeof result.x === 'number') {\n\t\t\t\t\t\t\tthis._proxy.$releaseCompletionItems(handle, result.x);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t\tif (supportsResolveDetails) {\n\t\t\tprovider.resolveCompletionItem = (suggestion, token) => {\n\t\t\t\treturn this._proxy.$resolveCompletionItem(handle, suggestion._id!, token).then(result => {\n\t\t\t\t\tif (!result) {\n\t\t\t\t\t\treturn suggestion;\n\t\t\t\t\t}\n\n\t\t\t\t\tlet newSuggestion = MainThreadLanguageFeatures._inflateSuggestDto(suggestion.range, result);\n\t\t\t\t\treturn mixin(suggestion, newSuggestion, true);\n\t\t\t\t});\n\t\t\t};\n\t\t}\n\t\tthis._registrations.set(handle, modes.CompletionProviderRegistry.register(selector, provider));\n\t}\n\n\t// --- parameter hints\n\n\t$registerSignatureHelpProvider(handle: number, selector: IDocumentFilterDto[], metadata: ISignatureHelpProviderMetadataDto): void {\n\t\tthis._registrations.set(handle, modes.SignatureHelpProviderRegistry.register(selector, <modes.SignatureHelpProvider>{\n\n\t\t\tsignatureHelpTriggerCharacters: metadata.triggerCharacters,\n\t\t\tsignatureHelpRetriggerCharacters: metadata.retriggerCharacters,\n\n\t\t\tprovideSignatureHelp: async (model: ITextModel, position: EditorPosition, token: CancellationToken, context: modes.SignatureHelpContext): Promise<modes.SignatureHelpResult | undefined> => {\n\t\t\t\tconst result = await this._proxy.$provideSignatureHelp(handle, model.uri, position, context, token);\n\t\t\t\tif (!result) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tvalue: result,\n\t\t\t\t\tdispose: () => {\n\t\t\t\t\t\tthis._proxy.$releaseSignatureHelp(handle, result.id);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t}));\n\t}\n\n\t// --- inline hints\n\n\t$registerInlineHintsProvider(handle: number, selector: IDocumentFilterDto[], eventHandle: number | undefined): void {\n\t\tconst provider = <modes.InlineHintsProvider>{\n\t\t\tprovideInlineHints: async (model: ITextModel, range: EditorRange, token: CancellationToken): Promise<modes.InlineHint[] | undefined> => {\n\t\t\t\tconst result = await this._proxy.$provideInlineHints(handle, model.uri, range, token);\n\t\t\t\treturn result?.hints;\n\t\t\t}\n\t\t};\n\n\t\tif (typeof eventHandle === 'number') {\n\t\t\tconst emitter = new Emitter<void>();\n\t\t\tthis._registrations.set(eventHandle, emitter);\n\t\t\tprovider.onDidChangeInlineHints = emitter.event;\n\t\t}\n\n\t\tthis._registrations.set(handle, modes.InlineHintsProviderRegistry.register(selector, provider));\n\t}\n\n\t$emitInlineHintsEvent(eventHandle: number, event?: any): void {\n\t\tconst obj = this._registrations.get(eventHandle);\n\t\tif (obj instanceof Emitter) {\n\t\t\tobj.fire(event);\n\t\t}\n\t}\n\n\t// --- links\n\n\t$registerDocumentLinkProvider(handle: number, selector: IDocumentFilterDto[], supportsResolve: boolean): void {\n\t\tconst provider: modes.LinkProvider = {\n\t\t\tprovideLinks: (model, token) => {\n\t\t\t\treturn this._proxy.$provideDocumentLinks(handle, model.uri, token).then(dto => {\n\t\t\t\t\tif (!dto) {\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t}\n\t\t\t\t\treturn {\n\t\t\t\t\t\tlinks: dto.links.map(MainThreadLanguageFeatures._reviveLinkDTO),\n\t\t\t\t\t\tdispose: () => {\n\t\t\t\t\t\t\tif (typeof dto.id === 'number') {\n\t\t\t\t\t\t\t\tthis._proxy.$releaseDocumentLinks(handle, dto.id);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t}\n\t\t};\n\t\tif (supportsResolve) {\n\t\t\tprovider.resolveLink = (link, token) => {\n\t\t\t\tconst dto: ILinkDto = link;\n\t\t\t\tif (!dto.cacheId) {\n\t\t\t\t\treturn link;\n\t\t\t\t}\n\t\t\t\treturn this._proxy.$resolveDocumentLink(handle, dto.cacheId, token).then(obj => {\n\t\t\t\t\treturn obj && MainThreadLanguageFeatures._reviveLinkDTO(obj);\n\t\t\t\t});\n\t\t\t};\n\t\t}\n\t\tthis._registrations.set(handle, modes.LinkProviderRegistry.register(selector, provider));\n\t}\n\n\t// --- colors\n\n\t$registerDocumentColorProvider(handle: number, selector: IDocumentFilterDto[]): void {\n\t\tconst proxy = this._proxy;\n\t\tthis._registrations.set(handle, modes.ColorProviderRegistry.register(selector, <modes.DocumentColorProvider>{\n\t\t\tprovideDocumentColors: (model, token) => {\n\t\t\t\treturn proxy.$provideDocumentColors(handle, model.uri, token)\n\t\t\t\t\t.then(documentColors => {\n\t\t\t\t\t\treturn documentColors.map(documentColor => {\n\t\t\t\t\t\t\tconst [red, green, blue, alpha] = documentColor.color;\n\t\t\t\t\t\t\tconst color = {\n\t\t\t\t\t\t\t\tred: red,\n\t\t\t\t\t\t\t\tgreen: green,\n\t\t\t\t\t\t\t\tblue: blue,\n\t\t\t\t\t\t\t\talpha\n\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tcolor,\n\t\t\t\t\t\t\t\trange: documentColor.range\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t},\n\n\t\t\tprovideColorPresentations: (model, colorInfo, token) => {\n\t\t\t\treturn proxy.$provideColorPresentations(handle, model.uri, {\n\t\t\t\t\tcolor: [colorInfo.color.red, colorInfo.color.green, colorInfo.color.blue, colorInfo.color.alpha],\n\t\t\t\t\trange: colorInfo.range\n\t\t\t\t}, token);\n\t\t\t}\n\t\t}));\n\t}\n\n\t// --- folding\n\n\t$registerFoldingRangeProvider(handle: number, selector: IDocumentFilterDto[], eventHandle: number | undefined): void {\n\t\tconst provider = <modes.FoldingRangeProvider>{\n\t\t\tprovideFoldingRanges: (model, context, token) => {\n\t\t\t\treturn this._proxy.$provideFoldingRanges(handle, model.uri, context, token);\n\t\t\t}\n\t\t};\n\n\t\tif (typeof eventHandle === 'number') {\n\t\t\tconst emitter = new Emitter<modes.FoldingRangeProvider>();\n\t\t\tthis._registrations.set(eventHandle, emitter);\n\t\t\tprovider.onDidChange = emitter.event;\n\t\t}\n\n\t\tthis._registrations.set(handle, modes.FoldingRangeProviderRegistry.register(selector, provider));\n\t}\n\n\t$emitFoldingRangeEvent(eventHandle: number, event?: any): void {\n\t\tconst obj = this._registrations.get(eventHandle);\n\t\tif (obj instanceof Emitter) {\n\t\t\tobj.fire(event);\n\t\t}\n\t}\n\n\t// -- smart select\n\n\t$registerSelectionRangeProvider(handle: number, selector: IDocumentFilterDto[]): void {\n\t\tthis._registrations.set(handle, modes.SelectionRangeRegistry.register(selector, {\n\t\t\tprovideSelectionRanges: (model, positions, token) => {\n\t\t\t\treturn this._proxy.$provideSelectionRanges(handle, model.uri, positions, token);\n\t\t\t}\n\t\t}));\n\t}\n\n\t// --- call hierarchy\n\n\t$registerCallHierarchyProvider(handle: number, selector: IDocumentFilterDto[]): void {\n\t\tthis._registrations.set(handle, callh.CallHierarchyProviderRegistry.register(selector, {\n\n\t\t\tprepareCallHierarchy: async (document, position, token) => {\n\t\t\t\tconst items = await this._proxy.$prepareCallHierarchy(handle, document.uri, position, token);\n\t\t\t\tif (!items) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tdispose: () => {\n\t\t\t\t\t\tfor (const item of items) {\n\t\t\t\t\t\t\tthis._proxy.$releaseCallHierarchy(handle, item._sessionId);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\troots: items.map(MainThreadLanguageFeatures._reviveCallHierarchyItemDto)\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tprovideOutgoingCalls: async (item, token) => {\n\t\t\t\tconst outgoing = await this._proxy.$provideCallHierarchyOutgoingCalls(handle, item._sessionId, item._itemId, token);\n\t\t\t\tif (!outgoing) {\n\t\t\t\t\treturn outgoing;\n\t\t\t\t}\n\t\t\t\toutgoing.forEach(value => {\n\t\t\t\t\tvalue.to = MainThreadLanguageFeatures._reviveCallHierarchyItemDto(value.to);\n\t\t\t\t});\n\t\t\t\treturn <any>outgoing;\n\t\t\t},\n\t\t\tprovideIncomingCalls: async (item, token) => {\n\t\t\t\tconst incoming = await this._proxy.$provideCallHierarchyIncomingCalls(handle, item._sessionId, item._itemId, token);\n\t\t\t\tif (!incoming) {\n\t\t\t\t\treturn incoming;\n\t\t\t\t}\n\t\t\t\tincoming.forEach(value => {\n\t\t\t\t\tvalue.from = MainThreadLanguageFeatures._reviveCallHierarchyItemDto(value.from);\n\t\t\t\t});\n\t\t\t\treturn <any>incoming;\n\t\t\t}\n\t\t}));\n\t}\n\n\t// --- configuration\n\n\tprivate static _reviveRegExp(regExp: IRegExpDto): RegExp {\n\t\treturn new RegExp(regExp.pattern, regExp.flags);\n\t}\n\n\tprivate static _reviveIndentationRule(indentationRule: IIndentationRuleDto): IndentationRule {\n\t\treturn {\n\t\t\tdecreaseIndentPattern: MainThreadLanguageFeatures._reviveRegExp(indentationRule.decreaseIndentPattern),\n\t\t\tincreaseIndentPattern: MainThreadLanguageFeatures._reviveRegExp(indentationRule.increaseIndentPattern),\n\t\t\tindentNextLinePattern: indentationRule.indentNextLinePattern ? MainThreadLanguageFeatures._reviveRegExp(indentationRule.indentNextLinePattern) : undefined,\n\t\t\tunIndentedLinePattern: indentationRule.unIndentedLinePattern ? MainThreadLanguageFeatures._reviveRegExp(indentationRule.unIndentedLinePattern) : undefined,\n\t\t};\n\t}\n\n\tprivate static _reviveOnEnterRule(onEnterRule: IOnEnterRuleDto): OnEnterRule {\n\t\treturn {\n\t\t\tbeforeText: MainThreadLanguageFeatures._reviveRegExp(onEnterRule.beforeText),\n\t\t\tafterText: onEnterRule.afterText ? MainThreadLanguageFeatures._reviveRegExp(onEnterRule.afterText) : undefined,\n\t\t\tpreviousLineText: onEnterRule.previousLineText ? MainThreadLanguageFeatures._reviveRegExp(onEnterRule.previousLineText) : undefined,\n\t\t\taction: onEnterRule.action\n\t\t};\n\t}\n\n\tprivate static _reviveOnEnterRules(onEnterRules: IOnEnterRuleDto[]): OnEnterRule[] {\n\t\treturn onEnterRules.map(MainThreadLanguageFeatures._reviveOnEnterRule);\n\t}\n\n\t$setLanguageConfiguration(handle: number, languageId: string, _configuration: ILanguageConfigurationDto): void {\n\n\t\tconst configuration: LanguageConfiguration = {\n\t\t\tcomments: _configuration.comments,\n\t\t\tbrackets: _configuration.brackets,\n\t\t\twordPattern: _configuration.wordPattern ? MainThreadLanguageFeatures._reviveRegExp(_configuration.wordPattern) : undefined,\n\t\t\tindentationRules: _configuration.indentationRules ? MainThreadLanguageFeatures._reviveIndentationRule(_configuration.indentationRules) : undefined,\n\t\t\tonEnterRules: _configuration.onEnterRules ? MainThreadLanguageFeatures._reviveOnEnterRules(_configuration.onEnterRules) : undefined,\n\n\t\t\tautoClosingPairs: undefined,\n\t\t\tsurroundingPairs: undefined,\n\t\t\t__electricCharacterSupport: undefined\n\t\t};\n\n\t\tif (_configuration.__characterPairSupport) {\n\t\t\t// backwards compatibility\n\t\t\tconfiguration.autoClosingPairs = _configuration.__characterPairSupport.autoClosingPairs;\n\t\t}\n\n\t\tif (_configuration.__electricCharacterSupport && _configuration.__electricCharacterSupport.docComment) {\n\t\t\tconfiguration.__electricCharacterSupport = {\n\t\t\t\tdocComment: {\n\t\t\t\t\topen: _configuration.__electricCharacterSupport.docComment.open,\n\t\t\t\t\tclose: _configuration.__electricCharacterSupport.docComment.close\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\n\t\tconst languageIdentifier = this._modeService.getLanguageIdentifier(languageId);\n\t\tif (languageIdentifier) {\n\t\t\tthis._registrations.set(handle, LanguageConfigurationRegistry.register(languageIdentifier, configuration, 100));\n\t\t}\n\t}\n\n}\n\nexport class MainThreadDocumentSemanticTokensProvider implements modes.DocumentSemanticTokensProvider {\n\n\tconstructor(\n\t\tprivate readonly _proxy: ExtHostLanguageFeaturesShape,\n\t\tprivate readonly _handle: number,\n\t\tprivate readonly _legend: modes.SemanticTokensLegend,\n\t\tpublic readonly onDidChange: Event<void> | undefined,\n\t) {\n\t}\n\n\tpublic releaseDocumentSemanticTokens(resultId: string | undefined): void {\n\t\tif (resultId) {\n\t\t\tthis._proxy.$releaseDocumentSemanticTokens(this._handle, parseInt(resultId, 10));\n\t\t}\n\t}\n\n\tpublic getLegend(): modes.SemanticTokensLegend {\n\t\treturn this._legend;\n\t}\n\n\tasync provideDocumentSemanticTokens(model: ITextModel, lastResultId: string | null, token: CancellationToken): Promise<modes.SemanticTokens | modes.SemanticTokensEdits | null> {\n\t\tconst nLastResultId = lastResultId ? parseInt(lastResultId, 10) : 0;\n\t\tconst encodedDto = await this._proxy.$provideDocumentSemanticTokens(this._handle, model.uri, nLastResultId, token);\n\t\tif (!encodedDto) {\n\t\t\treturn null;\n\t\t}\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn null;\n\t\t}\n\t\tconst dto = decodeSemanticTokensDto(encodedDto);\n\t\tif (dto.type === 'full') {\n\t\t\treturn {\n\t\t\t\tresultId: String(dto.id),\n\t\t\t\tdata: dto.data\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\tresultId: String(dto.id),\n\t\t\tedits: dto.deltas\n\t\t};\n\t}\n}\n\nexport class MainThreadDocumentRangeSemanticTokensProvider implements modes.DocumentRangeSemanticTokensProvider {\n\n\tconstructor(\n\t\tprivate readonly _proxy: ExtHostLanguageFeaturesShape,\n\t\tprivate readonly _handle: number,\n\t\tprivate readonly _legend: modes.SemanticTokensLegend,\n\t) {\n\t}\n\n\tpublic getLegend(): modes.SemanticTokensLegend {\n\t\treturn this._legend;\n\t}\n\n\tasync provideDocumentRangeSemanticTokens(model: ITextModel, range: EditorRange, token: CancellationToken): Promise<modes.SemanticTokens | null> {\n\t\tconst encodedDto = await this._proxy.$provideDocumentRangeSemanticTokens(this._handle, model.uri, range, token);\n\t\tif (!encodedDto) {\n\t\t\treturn null;\n\t\t}\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn null;\n\t\t}\n\t\tconst dto = decodeSemanticTokensDto(encodedDto);\n\t\tif (dto.type === 'full') {\n\t\t\treturn {\n\t\t\t\tresultId: String(dto.id),\n\t\t\t\tdata: dto.data\n\t\t\t};\n\t\t}\n\t\tthrow new Error(`Unexpected`);\n\t}\n}\n"]}