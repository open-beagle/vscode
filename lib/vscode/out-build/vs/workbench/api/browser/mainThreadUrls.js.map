{"version":3,"file":"mainThreadUrls.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/api/browser/mainThreadUrls.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;;;;IAUhG,MAAM,mBAAmB;QAExB,YACkB,KAAuB,EACvB,MAAc,EACtB,WAAgC;YAFxB,UAAK,GAAL,KAAK,CAAkB;YACvB,WAAM,GAAN,MAAM,CAAQ;YACtB,gBAAW,GAAX,WAAW,CAAqB;QACtC,CAAC;QAEL,SAAS,CAAC,GAAQ,EAAE,OAAyB;YAC5C,IAAI,CAAC,gCAAmB,CAAC,MAAM,CAAC,IAAI,CAAC,WAAW,EAAE,GAAG,CAAC,SAAS,CAAC,EAAE;gBACjE,OAAO,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;aAC9B;YAED,OAAO,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,kBAAkB,CAAC,IAAI,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC;QAC1F,CAAC;KACD;IAGD,IAAa,cAAc,GAA3B,MAAa,cAAc;QAK1B,YACC,OAAwB,EACM,UAAuB,EACd,mBAAyC;YADlD,eAAU,GAAV,UAAU,CAAa;YACd,wBAAmB,GAAnB,mBAAmB,CAAsB;YALzE,aAAQ,GAAG,IAAI,GAAG,EAAyE,CAAC;YAOnG,IAAI,CAAC,KAAK,GAAG,OAAO,CAAC,QAAQ,CAAC,iCAAc,CAAC,WAAW,CAAC,CAAC;QAC3D,CAAC;QAED,mBAAmB,CAAC,MAAc,EAAE,WAAgC;YACnE,MAAM,OAAO,GAAG,IAAI,mBAAmB,CAAC,IAAI,CAAC,KAAK,EAAE,MAAM,EAAE,WAAW,CAAC,CAAC;YACzE,MAAM,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,eAAe,CAAC,OAAO,CAAC,CAAC;YAE5D,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,MAAM,EAAE,EAAE,WAAW,EAAE,UAAU,EAAE,CAAC,CAAC;YACvD,IAAI,CAAC,mBAAmB,CAAC,wBAAwB,CAAC,WAAW,EAAE,OAAO,CAAC,CAAC;YAExE,OAAO,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;QACnC,CAAC;QAED,qBAAqB,CAAC,MAAc;YACnC,MAAM,KAAK,GAAG,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC;YAExC,IAAI,CAAC,KAAK,EAAE;gBACX,OAAO,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;aAClC;YAED,MAAM,EAAE,WAAW,EAAE,UAAU,EAAE,GAAG,KAAK,CAAC;YAE1C,IAAI,CAAC,mBAAmB,CAAC,0BAA0B,CAAC,WAAW,CAAC,CAAC;YACjE,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;YAC7B,UAAU,CAAC,OAAO,EAAE,CAAC;YAErB,OAAO,OAAO,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;QACnC,CAAC;QAED,KAAK,CAAC,aAAa,CAAC,GAAkB;YACrC,OAAO,IAAI,CAAC,UAAU,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;QACpC,CAAC;QAED,OAAO;YACN,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC,EAAE,UAAU,EAAE,EAAE,EAAE,CAAC,UAAU,CAAC,OAAO,EAAE,CAAC,CAAC;YAChE,IAAI,CAAC,QAAQ,CAAC,KAAK,EAAE,CAAC;QACvB,CAAC;KACD,CAAA;IA/CY,cAAc;QAD1B,CAAA,GAAA,uCAAoB,CAAA,CAAC,8BAAW,CAAC,cAAc,CAAC;QAQ9C,WAAA,iBAAW,CAAA;QACX,WAAA,0CAAoB,CAAA;OARV,cAAc,CA+C1B;IA/CY,wCAAc","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ExtHostContext, IExtHostContext, MainContext, MainThreadUrlsShape, ExtHostUrlsShape } from 'vs/workbench/api/common/extHost.protocol';\nimport { extHostNamedCustomer } from '../common/extHostCustomers';\nimport { IURLService, IURLHandler, IOpenURLOptions } from 'vs/platform/url/common/url';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { IExtensionUrlHandler } from 'vs/workbench/services/extensions/browser/extensionUrlHandler';\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\n\nclass ExtensionUrlHandler implements IURLHandler {\n\n\tconstructor(\n\t\tprivate readonly proxy: ExtHostUrlsShape,\n\t\tprivate readonly handle: number,\n\t\treadonly extensionId: ExtensionIdentifier\n\t) { }\n\n\thandleURL(uri: URI, options?: IOpenURLOptions): Promise<boolean> {\n\t\tif (!ExtensionIdentifier.equals(this.extensionId, uri.authority)) {\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\n\t\treturn Promise.resolve(this.proxy.$handleExternalUri(this.handle, uri)).then(() => true);\n\t}\n}\n\n@extHostNamedCustomer(MainContext.MainThreadUrls)\nexport class MainThreadUrls implements MainThreadUrlsShape {\n\n\tprivate readonly proxy: ExtHostUrlsShape;\n\tprivate handlers = new Map<number, { extensionId: ExtensionIdentifier, disposable: IDisposable }>();\n\n\tconstructor(\n\t\tcontext: IExtHostContext,\n\t\t@IURLService private readonly urlService: IURLService,\n\t\t@IExtensionUrlHandler private readonly extensionUrlHandler: IExtensionUrlHandler\n\t) {\n\t\tthis.proxy = context.getProxy(ExtHostContext.ExtHostUrls);\n\t}\n\n\t$registerUriHandler(handle: number, extensionId: ExtensionIdentifier): Promise<void> {\n\t\tconst handler = new ExtensionUrlHandler(this.proxy, handle, extensionId);\n\t\tconst disposable = this.urlService.registerHandler(handler);\n\n\t\tthis.handlers.set(handle, { extensionId, disposable });\n\t\tthis.extensionUrlHandler.registerExtensionHandler(extensionId, handler);\n\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\t$unregisterUriHandler(handle: number): Promise<void> {\n\t\tconst tuple = this.handlers.get(handle);\n\n\t\tif (!tuple) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tconst { extensionId, disposable } = tuple;\n\n\t\tthis.extensionUrlHandler.unregisterExtensionHandler(extensionId);\n\t\tthis.handlers.delete(handle);\n\t\tdisposable.dispose();\n\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\tasync $createAppUri(uri: UriComponents): Promise<URI> {\n\t\treturn this.urlService.create(uri);\n\t}\n\n\tdispose(): void {\n\t\tthis.handlers.forEach(({ disposable }) => disposable.dispose());\n\t\tthis.handlers.clear();\n\t}\n}\n"]}