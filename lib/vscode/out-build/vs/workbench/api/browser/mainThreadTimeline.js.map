{"version":3,"file":"mainThreadTimeline.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/api/browser/mainThreadTimeline.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;;;;IAWhG,IAAa,kBAAkB,GAA/B,MAAa,kBAAkB;QAI9B,YACC,OAAwB,EACM,UAAuB,EAClB,gBAAkC;YADvC,eAAU,GAAV,UAAU,CAAa;YAClB,qBAAgB,GAAhB,gBAAgB,CAAkB;YALrD,sBAAiB,GAAG,IAAI,GAAG,EAAwC,CAAC;YAOpF,IAAI,CAAC,MAAM,GAAG,OAAO,CAAC,QAAQ,CAAC,iCAAc,CAAC,eAAe,CAAC,CAAC;QAChE,CAAC;QAED,yBAAyB,CAAC,QAAoC;YAC7D,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,mDAAmD,QAAQ,CAAC,EAAE,EAAE,CAAC,CAAC;YAExF,MAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC;YAE1B,MAAM,QAAQ,GAAG,IAAI,CAAC,iBAAiB,CAAC;YACxC,IAAI,WAAW,GAAG,QAAQ,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;YAC5C,IAAI,WAAW,KAAK,SAAS,EAAE;gBAC9B,WAAW,GAAG,IAAI,eAAO,EAAuB,CAAC;gBACjD,QAAQ,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,EAAE,WAAW,CAAC,CAAC;aACvC;YAED,IAAI,CAAC,gBAAgB,CAAC,wBAAwB,iCAC1C,QAAQ,KACX,WAAW,EAAE,WAAW,CAAC,KAAK,EAC9B,eAAe,CAAC,GAAQ,EAAE,OAAwB,EAAE,KAAwB,EAAE,eAAyC;oBACtH,OAAO,KAAK,CAAC,YAAY,CAAC,QAAQ,CAAC,EAAE,EAAE,GAAG,EAAE,OAAO,EAAE,KAAK,EAAE,eAAe,CAAC,CAAC;gBAC9E,CAAC;gBACD,OAAO;oBACN,QAAQ,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;oBAC7B,WAAW,aAAX,WAAW,uBAAX,WAAW,CAAE,OAAO,EAAE,CAAC;gBACxB,CAAC,IACA,CAAC;QACJ,CAAC;QAED,2BAA2B,CAAC,EAAU;YACrC,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,qDAAqD,EAAE,EAAE,CAAC,CAAC;YAEjF,IAAI,CAAC,gBAAgB,CAAC,0BAA0B,CAAC,EAAE,CAAC,CAAC;QACtD,CAAC;QAED,wBAAwB,CAAC,CAAsB;;YAC9C,IAAI,CAAC,UAAU,CAAC,KAAK,CAAC,0CAA0C,CAAC,CAAC,EAAE,SAAS,MAAA,CAAC,CAAC,GAAG,0CAAE,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAEtG,MAAM,OAAO,GAAG,IAAI,CAAC,iBAAiB,CAAC,GAAG,CAAC,CAAC,CAAC,EAAG,CAAC,CAAC;YAClD,OAAO,aAAP,OAAO,uBAAP,OAAO,CAAE,IAAI,CAAC,CAAC,CAAC,CAAC;QAClB,CAAC;QAED,OAAO;YACN,OAAO;QACR,CAAC;KACD,CAAA;IArDY,kBAAkB;QAD9B,CAAA,GAAA,uCAAoB,CAAA,CAAC,8BAAW,CAAC,kBAAkB,CAAC;QAOlD,WAAA,iBAAW,CAAA;QACX,WAAA,2BAAgB,CAAA;OAPN,kBAAkB,CAqD9B;IArDY,gDAAkB","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Emitter } from 'vs/base/common/event';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { URI } from 'vs/base/common/uri';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { MainContext, MainThreadTimelineShape, IExtHostContext, ExtHostTimelineShape, ExtHostContext } from 'vs/workbench/api/common/extHost.protocol';\nimport { extHostNamedCustomer } from 'vs/workbench/api/common/extHostCustomers';\nimport { TimelineChangeEvent, TimelineOptions, TimelineProviderDescriptor, ITimelineService, InternalTimelineOptions } from 'vs/workbench/contrib/timeline/common/timeline';\n\n@extHostNamedCustomer(MainContext.MainThreadTimeline)\nexport class MainThreadTimeline implements MainThreadTimelineShape {\n\tprivate readonly _proxy: ExtHostTimelineShape;\n\tprivate readonly _providerEmitters = new Map<string, Emitter<TimelineChangeEvent>>();\n\n\tconstructor(\n\t\tcontext: IExtHostContext,\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@ITimelineService private readonly _timelineService: ITimelineService\n\t) {\n\t\tthis._proxy = context.getProxy(ExtHostContext.ExtHostTimeline);\n\t}\n\n\t$registerTimelineProvider(provider: TimelineProviderDescriptor): void {\n\t\tthis.logService.trace(`MainThreadTimeline#registerTimelineProvider: id=${provider.id}`);\n\n\t\tconst proxy = this._proxy;\n\n\t\tconst emitters = this._providerEmitters;\n\t\tlet onDidChange = emitters.get(provider.id);\n\t\tif (onDidChange === undefined) {\n\t\t\tonDidChange = new Emitter<TimelineChangeEvent>();\n\t\t\temitters.set(provider.id, onDidChange);\n\t\t}\n\n\t\tthis._timelineService.registerTimelineProvider({\n\t\t\t...provider,\n\t\t\tonDidChange: onDidChange.event,\n\t\t\tprovideTimeline(uri: URI, options: TimelineOptions, token: CancellationToken, internalOptions?: InternalTimelineOptions) {\n\t\t\t\treturn proxy.$getTimeline(provider.id, uri, options, token, internalOptions);\n\t\t\t},\n\t\t\tdispose() {\n\t\t\t\temitters.delete(provider.id);\n\t\t\t\tonDidChange?.dispose();\n\t\t\t}\n\t\t});\n\t}\n\n\t$unregisterTimelineProvider(id: string): void {\n\t\tthis.logService.trace(`MainThreadTimeline#unregisterTimelineProvider: id=${id}`);\n\n\t\tthis._timelineService.unregisterTimelineProvider(id);\n\t}\n\n\t$emitTimelineChangeEvent(e: TimelineChangeEvent): void {\n\t\tthis.logService.trace(`MainThreadTimeline#emitChangeEvent: id=${e.id}, uri=${e.uri?.toString(true)}`);\n\n\t\tconst emitter = this._providerEmitters.get(e.id!);\n\t\temitter?.fire(e);\n\t}\n\n\tdispose(): void {\n\t\t// noop\n\t}\n}\n"]}