{"version":3,"file":"mainThreadTreeViews.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/api/browser/mainThreadTreeViews.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { ExtHostContext, MainThreadTreeViewsShape, ExtHostTreeViewsShape, MainContext, IExtHostContext } from 'vs/workbench/api/common/extHost.protocol';\nimport { ITreeViewDataProvider, ITreeItem, IViewsService, ITreeView, IViewsRegistry, ITreeViewDescriptor, IRevealOptions, Extensions, ResolvableTreeItem } from 'vs/workbench/common/views';\nimport { extHostNamedCustomer } from 'vs/workbench/api/common/extHostCustomers';\nimport { distinct } from 'vs/base/common/arrays';\nimport { INotificationService } from 'vs/platform/notification/common/notification';\nimport { isUndefinedOrNull, isNumber } from 'vs/base/common/types';\nimport { Registry } from 'vs/platform/registry/common/platform';\nimport { IExtensionService } from 'vs/workbench/services/extensions/common/extensions';\nimport { ILogService } from 'vs/platform/log/common/log';\n\n@extHostNamedCustomer(MainContext.MainThreadTreeViews)\nexport class MainThreadTreeViews extends Disposable implements MainThreadTreeViewsShape {\n\n\tprivate readonly _proxy: ExtHostTreeViewsShape;\n\tprivate readonly _dataProviders: Map<string, TreeViewDataProvider> = new Map<string, TreeViewDataProvider>();\n\n\tconstructor(\n\t\textHostContext: IExtHostContext,\n\t\t@IViewsService private readonly viewsService: IViewsService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@IExtensionService private readonly extensionService: IExtensionService,\n\t\t@ILogService private readonly logService: ILogService\n\t) {\n\t\tsuper();\n\t\tthis._proxy = extHostContext.getProxy(ExtHostContext.ExtHostTreeViews);\n\t}\n\n\tasync $registerTreeViewDataProvider(treeViewId: string, options: { showCollapseAll: boolean, canSelectMany: boolean }): Promise<void> {\n\t\tthis.logService.trace('MainThreadTreeViews#$registerTreeViewDataProvider', treeViewId, options);\n\n\t\tthis.extensionService.whenInstalledExtensionsRegistered().then(() => {\n\t\t\tconst dataProvider = new TreeViewDataProvider(treeViewId, this._proxy, this.notificationService);\n\t\t\tthis._dataProviders.set(treeViewId, dataProvider);\n\t\t\tconst viewer = this.getTreeView(treeViewId);\n\t\t\tif (viewer) {\n\t\t\t\t// Order is important here. The internal tree isn't created until the dataProvider is set.\n\t\t\t\t// Set all other properties first!\n\t\t\t\tviewer.showCollapseAllAction = !!options.showCollapseAll;\n\t\t\t\tviewer.canSelectMany = !!options.canSelectMany;\n\t\t\t\tviewer.dataProvider = dataProvider;\n\t\t\t\tthis.registerListeners(treeViewId, viewer);\n\t\t\t\tthis._proxy.$setVisible(treeViewId, viewer.visible);\n\t\t\t} else {\n\t\t\t\tthis.notificationService.error('No view is registered with id: ' + treeViewId);\n\t\t\t}\n\t\t});\n\t}\n\n\t$reveal(treeViewId: string, itemInfo: { item: ITreeItem, parentChain: ITreeItem[] } | undefined, options: IRevealOptions): Promise<void> {\n\t\tthis.logService.trace('MainThreadTreeViews#$reveal', treeViewId, itemInfo?.item, itemInfo?.parentChain, options);\n\n\t\treturn this.viewsService.openView(treeViewId, options.focus)\n\t\t\t.then(() => {\n\t\t\t\tconst viewer = this.getTreeView(treeViewId);\n\t\t\t\tif (viewer && itemInfo) {\n\t\t\t\t\treturn this.reveal(viewer, this._dataProviders.get(treeViewId)!, itemInfo.item, itemInfo.parentChain, options);\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t});\n\t}\n\n\t$refresh(treeViewId: string, itemsToRefreshByHandle: { [treeItemHandle: string]: ITreeItem }): Promise<void> {\n\t\tthis.logService.trace('MainThreadTreeViews#$refresh', treeViewId, itemsToRefreshByHandle);\n\n\t\tconst viewer = this.getTreeView(treeViewId);\n\t\tconst dataProvider = this._dataProviders.get(treeViewId);\n\t\tif (viewer && dataProvider) {\n\t\t\tconst itemsToRefresh = dataProvider.getItemsToRefresh(itemsToRefreshByHandle);\n\t\t\treturn viewer.refresh(itemsToRefresh.length ? itemsToRefresh : undefined);\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\t$setMessage(treeViewId: string, message: string): void {\n\t\tthis.logService.trace('MainThreadTreeViews#$setMessage', treeViewId, message);\n\n\t\tconst viewer = this.getTreeView(treeViewId);\n\t\tif (viewer) {\n\t\t\tviewer.message = message;\n\t\t}\n\t}\n\n\t$setTitle(treeViewId: string, title: string, description: string | undefined): void {\n\t\tthis.logService.trace('MainThreadTreeViews#$setTitle', treeViewId, title, description);\n\n\t\tconst viewer = this.getTreeView(treeViewId);\n\t\tif (viewer) {\n\t\t\tviewer.title = title;\n\t\t\tviewer.description = description;\n\t\t}\n\t}\n\n\tprivate async reveal(treeView: ITreeView, dataProvider: TreeViewDataProvider, itemIn: ITreeItem, parentChain: ITreeItem[], options: IRevealOptions): Promise<void> {\n\t\toptions = options ? options : { select: false, focus: false };\n\t\tconst select = isUndefinedOrNull(options.select) ? false : options.select;\n\t\tconst focus = isUndefinedOrNull(options.focus) ? false : options.focus;\n\t\tlet expand = Math.min(isNumber(options.expand) ? options.expand : options.expand === true ? 1 : 0, 3);\n\n\t\tif (dataProvider.isEmpty()) {\n\t\t\t// Refresh if empty\n\t\t\tawait treeView.refresh();\n\t\t}\n\t\tfor (const parent of parentChain) {\n\t\t\tconst parentItem = dataProvider.getItem(parent.handle);\n\t\t\tif (parentItem) {\n\t\t\t\tawait treeView.expand(parentItem);\n\t\t\t}\n\t\t}\n\t\tconst item = dataProvider.getItem(itemIn.handle);\n\t\tif (item) {\n\t\t\tawait treeView.reveal(item);\n\t\t\tif (select) {\n\t\t\t\ttreeView.setSelection([item]);\n\t\t\t}\n\t\t\tif (focus) {\n\t\t\t\ttreeView.setFocus(item);\n\t\t\t}\n\t\t\tlet itemsToExpand = [item];\n\t\t\tfor (; itemsToExpand.length > 0 && expand > 0; expand--) {\n\t\t\t\tawait treeView.expand(itemsToExpand);\n\t\t\t\titemsToExpand = itemsToExpand.reduce((result, itemValue) => {\n\t\t\t\t\tconst item = dataProvider.getItem(itemValue.handle);\n\t\t\t\t\tif (item && item.children && item.children.length) {\n\t\t\t\t\t\tresult.push(...item.children);\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t}, [] as ITreeItem[]);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate registerListeners(treeViewId: string, treeView: ITreeView): void {\n\t\tthis._register(treeView.onDidExpandItem(item => this._proxy.$setExpanded(treeViewId, item.handle, true)));\n\t\tthis._register(treeView.onDidCollapseItem(item => this._proxy.$setExpanded(treeViewId, item.handle, false)));\n\t\tthis._register(treeView.onDidChangeSelection(items => this._proxy.$setSelection(treeViewId, items.map(({ handle }) => handle))));\n\t\tthis._register(treeView.onDidChangeVisibility(isVisible => this._proxy.$setVisible(treeViewId, isVisible)));\n\t}\n\n\tprivate getTreeView(treeViewId: string): ITreeView | null {\n\t\tconst viewDescriptor: ITreeViewDescriptor = <ITreeViewDescriptor>Registry.as<IViewsRegistry>(Extensions.ViewsRegistry).getView(treeViewId);\n\t\treturn viewDescriptor ? viewDescriptor.treeView : null;\n\t}\n\n\toverride dispose(): void {\n\t\tthis._dataProviders.forEach((dataProvider, treeViewId) => {\n\t\t\tconst treeView = this.getTreeView(treeViewId);\n\t\t\tif (treeView) {\n\t\t\t\ttreeView.dataProvider = undefined;\n\t\t\t}\n\t\t});\n\t\tthis._dataProviders.clear();\n\t\tsuper.dispose();\n\t}\n}\n\ntype TreeItemHandle = string;\n\nclass TreeViewDataProvider implements ITreeViewDataProvider {\n\n\tprivate readonly itemsMap: Map<TreeItemHandle, ITreeItem> = new Map<TreeItemHandle, ITreeItem>();\n\tprivate hasResolve: Promise<boolean>;\n\n\tconstructor(private readonly treeViewId: string,\n\t\tprivate readonly _proxy: ExtHostTreeViewsShape,\n\t\tprivate readonly notificationService: INotificationService\n\t) {\n\t\tthis.hasResolve = this._proxy.$hasResolve(this.treeViewId);\n\t}\n\n\tgetChildren(treeItem?: ITreeItem): Promise<ITreeItem[]> {\n\t\treturn Promise.resolve(this._proxy.$getChildren(this.treeViewId, treeItem ? treeItem.handle : undefined)\n\t\t\t.then(\n\t\t\t\tchildren => this.postGetChildren(children),\n\t\t\t\terr => {\n\t\t\t\t\tthis.notificationService.error(err);\n\t\t\t\t\treturn [];\n\t\t\t\t}));\n\t}\n\n\tgetItemsToRefresh(itemsToRefreshByHandle: { [treeItemHandle: string]: ITreeItem }): ITreeItem[] {\n\t\tconst itemsToRefresh: ITreeItem[] = [];\n\t\tif (itemsToRefreshByHandle) {\n\t\t\tfor (const treeItemHandle of Object.keys(itemsToRefreshByHandle)) {\n\t\t\t\tconst currentTreeItem = this.getItem(treeItemHandle);\n\t\t\t\tif (currentTreeItem) { // Refresh only if the item exists\n\t\t\t\t\tconst treeItem = itemsToRefreshByHandle[treeItemHandle];\n\t\t\t\t\t// Update the current item with refreshed item\n\t\t\t\t\tthis.updateTreeItem(currentTreeItem, treeItem);\n\t\t\t\t\tif (treeItemHandle === treeItem.handle) {\n\t\t\t\t\t\titemsToRefresh.push(currentTreeItem);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Update maps when handle is changed and refresh parent\n\t\t\t\t\t\tthis.itemsMap.delete(treeItemHandle);\n\t\t\t\t\t\tthis.itemsMap.set(currentTreeItem.handle, currentTreeItem);\n\t\t\t\t\t\tconst parent = treeItem.parentHandle ? this.itemsMap.get(treeItem.parentHandle) : null;\n\t\t\t\t\t\tif (parent) {\n\t\t\t\t\t\t\titemsToRefresh.push(parent);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn itemsToRefresh;\n\t}\n\n\tgetItem(treeItemHandle: string): ITreeItem | undefined {\n\t\treturn this.itemsMap.get(treeItemHandle);\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn this.itemsMap.size === 0;\n\t}\n\n\tprivate async postGetChildren(elements: ITreeItem[]): Promise<ResolvableTreeItem[]> {\n\t\tconst result: ResolvableTreeItem[] = [];\n\t\tconst hasResolve = await this.hasResolve;\n\t\tif (elements) {\n\t\t\tfor (const element of elements) {\n\t\t\t\tconst resolvable = new ResolvableTreeItem(element, hasResolve ? (token) => {\n\t\t\t\t\treturn this._proxy.$resolve(this.treeViewId, element.handle, token);\n\t\t\t\t} : undefined);\n\t\t\t\tthis.itemsMap.set(element.handle, resolvable);\n\t\t\t\tresult.push(resolvable);\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate updateTreeItem(current: ITreeItem, treeItem: ITreeItem): void {\n\t\ttreeItem.children = treeItem.children ? treeItem.children : undefined;\n\t\tif (current) {\n\t\t\tconst properties = distinct([...Object.keys(current instanceof ResolvableTreeItem ? current.asTreeItem() : current),\n\t\t\t...Object.keys(treeItem)]);\n\t\t\tfor (const property of properties) {\n\t\t\t\t(<any>current)[property] = (<any>treeItem)[property];\n\t\t\t}\n\t\t\tif (current instanceof ResolvableTreeItem) {\n\t\t\t\tcurrent.resetResolve();\n\t\t\t}\n\t\t}\n\t}\n}\n"]}