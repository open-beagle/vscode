{"version":3,"file":"extHostSCM.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/api/common/extHostSCM.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { debounce } from 'vs/base/common/decorators';\nimport { DisposableStore, IDisposable, MutableDisposable } from 'vs/base/common/lifecycle';\nimport { asPromise } from 'vs/base/common/async';\nimport { ExtHostCommands } from 'vs/workbench/api/common/extHostCommands';\nimport { MainContext, MainThreadSCMShape, SCMRawResource, SCMRawResourceSplice, SCMRawResourceSplices, IMainContext, ExtHostSCMShape, ICommandDto, MainThreadTelemetryShape, SCMGroupFeatures } from './extHost.protocol';\nimport { sortedDiff, equals } from 'vs/base/common/arrays';\nimport { comparePaths } from 'vs/base/common/comparers';\nimport type * as vscode from 'vscode';\nimport { ISplice } from 'vs/base/common/sequence';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { checkProposedApiEnabled } from 'vs/workbench/services/extensions/common/extensions';\n\ntype ProviderHandle = number;\ntype GroupHandle = number;\ntype ResourceStateHandle = number;\n\nfunction getIconResource(decorations?: vscode.SourceControlResourceThemableDecorations): vscode.Uri | undefined {\n\tif (!decorations) {\n\t\treturn undefined;\n\t} else if (typeof decorations.iconPath === 'string') {\n\t\treturn URI.file(decorations.iconPath);\n\t} else {\n\t\treturn decorations.iconPath;\n\t}\n}\n\nfunction compareResourceThemableDecorations(a: vscode.SourceControlResourceThemableDecorations, b: vscode.SourceControlResourceThemableDecorations): number {\n\tif (!a.iconPath && !b.iconPath) {\n\t\treturn 0;\n\t} else if (!a.iconPath) {\n\t\treturn -1;\n\t} else if (!b.iconPath) {\n\t\treturn 1;\n\t}\n\n\tconst aPath = typeof a.iconPath === 'string' ? a.iconPath : a.iconPath.fsPath;\n\tconst bPath = typeof b.iconPath === 'string' ? b.iconPath : b.iconPath.fsPath;\n\treturn comparePaths(aPath, bPath);\n}\n\nfunction compareResourceStatesDecorations(a: vscode.SourceControlResourceDecorations, b: vscode.SourceControlResourceDecorations): number {\n\tlet result = 0;\n\n\tif (a.strikeThrough !== b.strikeThrough) {\n\t\treturn a.strikeThrough ? 1 : -1;\n\t}\n\n\tif (a.faded !== b.faded) {\n\t\treturn a.faded ? 1 : -1;\n\t}\n\n\tif (a.tooltip !== b.tooltip) {\n\t\treturn (a.tooltip || '').localeCompare(b.tooltip || '');\n\t}\n\n\tresult = compareResourceThemableDecorations(a, b);\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.light && b.light) {\n\t\tresult = compareResourceThemableDecorations(a.light, b.light);\n\t} else if (a.light) {\n\t\treturn 1;\n\t} else if (b.light) {\n\t\treturn -1;\n\t}\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.dark && b.dark) {\n\t\tresult = compareResourceThemableDecorations(a.dark, b.dark);\n\t} else if (a.dark) {\n\t\treturn 1;\n\t} else if (b.dark) {\n\t\treturn -1;\n\t}\n\n\treturn result;\n}\n\nfunction compareCommands(a: vscode.Command, b: vscode.Command): number {\n\tif (a.command !== b.command) {\n\t\treturn a.command < b.command ? -1 : 1;\n\t}\n\n\tif (a.title !== b.title) {\n\t\treturn a.title < b.title ? -1 : 1;\n\t}\n\n\tif (a.tooltip !== b.tooltip) {\n\t\tif (a.tooltip !== undefined && b.tooltip !== undefined) {\n\t\t\treturn a.tooltip < b.tooltip ? -1 : 1;\n\t\t} else if (a.tooltip !== undefined) {\n\t\t\treturn 1;\n\t\t} else if (b.tooltip !== undefined) {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tif (a.arguments === b.arguments) {\n\t\treturn 0;\n\t} else if (!a.arguments) {\n\t\treturn -1;\n\t} else if (!b.arguments) {\n\t\treturn 1;\n\t} else if (a.arguments.length !== b.arguments.length) {\n\t\treturn a.arguments.length - b.arguments.length;\n\t}\n\n\tfor (let i = 0; i < a.arguments.length; i++) {\n\t\tconst aArg = a.arguments[i];\n\t\tconst bArg = b.arguments[i];\n\n\t\tif (aArg === bArg) {\n\t\t\tcontinue;\n\t\t}\n\n\t\treturn aArg < bArg ? -1 : 1;\n\t}\n\n\treturn 0;\n}\n\nfunction compareResourceStates(a: vscode.SourceControlResourceState, b: vscode.SourceControlResourceState): number {\n\tlet result = comparePaths(a.resourceUri.fsPath, b.resourceUri.fsPath, true);\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.command && b.command) {\n\t\tresult = compareCommands(a.command, b.command);\n\t} else if (a.command) {\n\t\treturn 1;\n\t} else if (b.command) {\n\t\treturn -1;\n\t}\n\n\tif (result !== 0) {\n\t\treturn result;\n\t}\n\n\tif (a.decorations && b.decorations) {\n\t\tresult = compareResourceStatesDecorations(a.decorations, b.decorations);\n\t} else if (a.decorations) {\n\t\treturn 1;\n\t} else if (b.decorations) {\n\t\treturn -1;\n\t}\n\n\treturn result;\n}\n\nfunction compareArgs(a: any[], b: any[]): boolean {\n\tfor (let i = 0; i < a.length; i++) {\n\t\tif (a[i] !== b[i]) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n}\n\nfunction commandEquals(a: vscode.Command, b: vscode.Command): boolean {\n\treturn a.command === b.command\n\t\t&& a.title === b.title\n\t\t&& a.tooltip === b.tooltip\n\t\t&& (a.arguments && b.arguments ? compareArgs(a.arguments, b.arguments) : a.arguments === b.arguments);\n}\n\nfunction commandListEquals(a: readonly vscode.Command[], b: readonly vscode.Command[]): boolean {\n\treturn equals(a, b, commandEquals);\n}\n\nexport interface IValidateInput {\n\t(value: string, cursorPosition: number): vscode.ProviderResult<vscode.SourceControlInputBoxValidation | undefined | null>;\n}\n\nexport class ExtHostSCMInputBox implements vscode.SourceControlInputBox {\n\n\tprivate _value: string = '';\n\n\tget value(): string {\n\t\treturn this._value;\n\t}\n\n\tset value(value: string) {\n\t\tthis._proxy.$setInputBoxValue(this._sourceControlHandle, value);\n\t\tthis.updateValue(value);\n\t}\n\n\tprivate readonly _onDidChange = new Emitter<string>();\n\n\tget onDidChange(): Event<string> {\n\t\treturn this._onDidChange.event;\n\t}\n\n\tprivate _placeholder: string = '';\n\n\tget placeholder(): string {\n\t\treturn this._placeholder;\n\t}\n\n\tset placeholder(placeholder: string) {\n\t\tthis._proxy.$setInputBoxPlaceholder(this._sourceControlHandle, placeholder);\n\t\tthis._placeholder = placeholder;\n\t}\n\n\tprivate _validateInput: IValidateInput | undefined;\n\n\tget validateInput(): IValidateInput | undefined {\n\t\tcheckProposedApiEnabled(this._extension);\n\n\t\treturn this._validateInput;\n\t}\n\n\tset validateInput(fn: IValidateInput | undefined) {\n\t\tcheckProposedApiEnabled(this._extension);\n\n\t\tif (fn && typeof fn !== 'function') {\n\t\t\tthrow new Error(`[${this._extension.identifier.value}]: Invalid SCM input box validation function`);\n\t\t}\n\n\t\tthis._validateInput = fn;\n\t\tthis._proxy.$setValidationProviderIsEnabled(this._sourceControlHandle, !!fn);\n\t}\n\n\tprivate _visible: boolean = true;\n\n\tget visible(): boolean {\n\t\treturn this._visible;\n\t}\n\n\tset visible(visible: boolean) {\n\t\tvisible = !!visible;\n\n\t\tif (this._visible === visible) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._visible = visible;\n\t\tthis._proxy.$setInputBoxVisibility(this._sourceControlHandle, visible);\n\t}\n\n\tconstructor(private _extension: IExtensionDescription, private _proxy: MainThreadSCMShape, private _sourceControlHandle: number) {\n\t\t// noop\n\t}\n\n\tfocus(): void {\n\t\tcheckProposedApiEnabled(this._extension);\n\n\t\tif (!this._visible) {\n\t\t\tthis.visible = true;\n\t\t}\n\n\t\tthis._proxy.$setInputBoxFocus(this._sourceControlHandle);\n\t}\n\n\tshowValidationMessage(message: string, type: vscode.SourceControlInputBoxValidationType) {\n\t\tcheckProposedApiEnabled(this._extension);\n\n\t\tthis._proxy.$showValidationMessage(this._sourceControlHandle, message, type as any);\n\t}\n\n\t$onInputBoxValueChange(value: string): void {\n\t\tthis.updateValue(value);\n\t}\n\n\tprivate updateValue(value: string): void {\n\t\tthis._value = value;\n\t\tthis._onDidChange.fire(value);\n\t}\n}\n\nclass ExtHostSourceControlResourceGroup implements vscode.SourceControlResourceGroup {\n\n\tprivate static _handlePool: number = 0;\n\tprivate _resourceHandlePool: number = 0;\n\tprivate _resourceStates: vscode.SourceControlResourceState[] = [];\n\n\tprivate _resourceStatesMap = new Map<ResourceStateHandle, vscode.SourceControlResourceState>();\n\tprivate _resourceStatesCommandsMap = new Map<ResourceStateHandle, vscode.Command>();\n\tprivate _resourceStatesDisposablesMap = new Map<ResourceStateHandle, IDisposable>();\n\n\tprivate readonly _onDidUpdateResourceStates = new Emitter<void>();\n\treadonly onDidUpdateResourceStates = this._onDidUpdateResourceStates.event;\n\n\tprivate _disposed = false;\n\tget disposed(): boolean { return this._disposed; }\n\tprivate readonly _onDidDispose = new Emitter<void>();\n\treadonly onDidDispose = this._onDidDispose.event;\n\n\tprivate _handlesSnapshot: number[] = [];\n\tprivate _resourceSnapshot: vscode.SourceControlResourceState[] = [];\n\n\tget id(): string { return this._id; }\n\n\tget label(): string { return this._label; }\n\tset label(label: string) {\n\t\tthis._label = label;\n\t\tthis._proxy.$updateGroupLabel(this._sourceControlHandle, this.handle, label);\n\t}\n\n\tprivate _hideWhenEmpty: boolean | undefined = undefined;\n\tget hideWhenEmpty(): boolean | undefined { return this._hideWhenEmpty; }\n\tset hideWhenEmpty(hideWhenEmpty: boolean | undefined) {\n\t\tthis._hideWhenEmpty = hideWhenEmpty;\n\t\tthis._proxy.$updateGroup(this._sourceControlHandle, this.handle, this.features);\n\t}\n\n\tget features(): SCMGroupFeatures {\n\t\treturn {\n\t\t\thideWhenEmpty: this.hideWhenEmpty\n\t\t};\n\t}\n\n\tget resourceStates(): vscode.SourceControlResourceState[] { return [...this._resourceStates]; }\n\tset resourceStates(resources: vscode.SourceControlResourceState[]) {\n\t\tthis._resourceStates = [...resources];\n\t\tthis._onDidUpdateResourceStates.fire();\n\t}\n\n\treadonly handle = ExtHostSourceControlResourceGroup._handlePool++;\n\n\tconstructor(\n\t\tprivate _proxy: MainThreadSCMShape,\n\t\tprivate _commands: ExtHostCommands,\n\t\tprivate _sourceControlHandle: number,\n\t\tprivate _id: string,\n\t\tprivate _label: string,\n\t) { }\n\n\tgetResourceState(handle: number): vscode.SourceControlResourceState | undefined {\n\t\treturn this._resourceStatesMap.get(handle);\n\t}\n\n\t$executeResourceCommand(handle: number, preserveFocus: boolean): Promise<void> {\n\t\tconst command = this._resourceStatesCommandsMap.get(handle);\n\n\t\tif (!command) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn asPromise(() => this._commands.executeCommand(command.command, ...(command.arguments || []), preserveFocus));\n\t}\n\n\t_takeResourceStateSnapshot(): SCMRawResourceSplice[] {\n\t\tconst snapshot = [...this._resourceStates].sort(compareResourceStates);\n\t\tconst diffs = sortedDiff(this._resourceSnapshot, snapshot, compareResourceStates);\n\n\t\tconst splices = diffs.map<ISplice<{ rawResource: SCMRawResource, handle: number }>>(diff => {\n\t\t\tconst toInsert = diff.toInsert.map(r => {\n\t\t\t\tconst handle = this._resourceHandlePool++;\n\t\t\t\tthis._resourceStatesMap.set(handle, r);\n\n\t\t\t\tconst sourceUri = r.resourceUri;\n\t\t\t\tconst iconUri = getIconResource(r.decorations);\n\t\t\t\tconst lightIconUri = r.decorations && getIconResource(r.decorations.light) || iconUri;\n\t\t\t\tconst darkIconUri = r.decorations && getIconResource(r.decorations.dark) || iconUri;\n\t\t\t\tconst icons: UriComponents[] = [];\n\t\t\t\tlet command: ICommandDto | undefined;\n\n\t\t\t\tif (r.command) {\n\t\t\t\t\tif (r.command.command === 'vscode.open' || r.command.command === 'vscode.diff') {\n\t\t\t\t\t\tconst disposables = new DisposableStore();\n\t\t\t\t\t\tcommand = this._commands.converter.toInternal(r.command, disposables);\n\t\t\t\t\t\tthis._resourceStatesDisposablesMap.set(handle, disposables);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._resourceStatesCommandsMap.set(handle, r.command);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (lightIconUri) {\n\t\t\t\t\ticons.push(lightIconUri);\n\t\t\t\t}\n\n\t\t\t\tif (darkIconUri && (darkIconUri.toString() !== lightIconUri?.toString())) {\n\t\t\t\t\ticons.push(darkIconUri);\n\t\t\t\t}\n\n\t\t\t\tconst tooltip = (r.decorations && r.decorations.tooltip) || '';\n\t\t\t\tconst strikeThrough = r.decorations && !!r.decorations.strikeThrough;\n\t\t\t\tconst faded = r.decorations && !!r.decorations.faded;\n\t\t\t\tconst contextValue = r.contextValue || '';\n\n\t\t\t\tconst rawResource = [handle, sourceUri, icons, tooltip, strikeThrough, faded, contextValue, command] as SCMRawResource;\n\n\t\t\t\treturn { rawResource, handle };\n\t\t\t});\n\n\t\t\treturn { start: diff.start, deleteCount: diff.deleteCount, toInsert };\n\t\t});\n\n\t\tconst rawResourceSplices = splices\n\t\t\t.map(({ start, deleteCount, toInsert }) => [start, deleteCount, toInsert.map(i => i.rawResource)] as SCMRawResourceSplice);\n\n\t\tconst reverseSplices = splices.reverse();\n\n\t\tfor (const { start, deleteCount, toInsert } of reverseSplices) {\n\t\t\tconst handles = toInsert.map(i => i.handle);\n\t\t\tconst handlesToDelete = this._handlesSnapshot.splice(start, deleteCount, ...handles);\n\n\t\t\tfor (const handle of handlesToDelete) {\n\t\t\t\tthis._resourceStatesMap.delete(handle);\n\t\t\t\tthis._resourceStatesCommandsMap.delete(handle);\n\t\t\t\tthis._resourceStatesDisposablesMap.get(handle)?.dispose();\n\t\t\t\tthis._resourceStatesDisposablesMap.delete(handle);\n\t\t\t}\n\t\t}\n\n\t\tthis._resourceSnapshot = snapshot;\n\t\treturn rawResourceSplices;\n\t}\n\n\tdispose(): void {\n\t\tthis._disposed = true;\n\t\tthis._onDidDispose.fire();\n\t}\n}\n\nclass ExtHostSourceControl implements vscode.SourceControl {\n\n\tprivate static _handlePool: number = 0;\n\tprivate _groups: Map<GroupHandle, ExtHostSourceControlResourceGroup> = new Map<GroupHandle, ExtHostSourceControlResourceGroup>();\n\n\tget id(): string {\n\t\treturn this._id;\n\t}\n\n\tget label(): string {\n\t\treturn this._label;\n\t}\n\n\tget rootUri(): vscode.Uri | undefined {\n\t\treturn this._rootUri;\n\t}\n\n\tprivate _inputBox: ExtHostSCMInputBox;\n\tget inputBox(): ExtHostSCMInputBox { return this._inputBox; }\n\n\tprivate _count: number | undefined = undefined;\n\n\tget count(): number | undefined {\n\t\treturn this._count;\n\t}\n\n\tset count(count: number | undefined) {\n\t\tif (this._count === count) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._count = count;\n\t\tthis._proxy.$updateSourceControl(this.handle, { count });\n\t}\n\n\tprivate _quickDiffProvider: vscode.QuickDiffProvider | undefined = undefined;\n\n\tget quickDiffProvider(): vscode.QuickDiffProvider | undefined {\n\t\treturn this._quickDiffProvider;\n\t}\n\n\tset quickDiffProvider(quickDiffProvider: vscode.QuickDiffProvider | undefined) {\n\t\tthis._quickDiffProvider = quickDiffProvider;\n\t\tthis._proxy.$updateSourceControl(this.handle, { hasQuickDiffProvider: !!quickDiffProvider });\n\t}\n\n\tprivate _commitTemplate: string | undefined = undefined;\n\n\tget commitTemplate(): string | undefined {\n\t\treturn this._commitTemplate;\n\t}\n\n\tset commitTemplate(commitTemplate: string | undefined) {\n\t\tif (commitTemplate === this._commitTemplate) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._commitTemplate = commitTemplate;\n\t\tthis._proxy.$updateSourceControl(this.handle, { commitTemplate });\n\t}\n\n\tprivate _acceptInputDisposables = new MutableDisposable<DisposableStore>();\n\tprivate _acceptInputCommand: vscode.Command | undefined = undefined;\n\n\tget acceptInputCommand(): vscode.Command | undefined {\n\t\treturn this._acceptInputCommand;\n\t}\n\n\tset acceptInputCommand(acceptInputCommand: vscode.Command | undefined) {\n\t\tthis._acceptInputDisposables.value = new DisposableStore();\n\n\t\tthis._acceptInputCommand = acceptInputCommand;\n\n\t\tconst internal = this._commands.converter.toInternal(acceptInputCommand, this._acceptInputDisposables.value);\n\t\tthis._proxy.$updateSourceControl(this.handle, { acceptInputCommand: internal });\n\t}\n\n\tprivate _statusBarDisposables = new MutableDisposable<DisposableStore>();\n\tprivate _statusBarCommands: vscode.Command[] | undefined = undefined;\n\n\tget statusBarCommands(): vscode.Command[] | undefined {\n\t\treturn this._statusBarCommands;\n\t}\n\n\tset statusBarCommands(statusBarCommands: vscode.Command[] | undefined) {\n\t\tif (this._statusBarCommands && statusBarCommands && commandListEquals(this._statusBarCommands, statusBarCommands)) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._statusBarDisposables.value = new DisposableStore();\n\n\t\tthis._statusBarCommands = statusBarCommands;\n\n\t\tconst internal = (statusBarCommands || []).map(c => this._commands.converter.toInternal(c, this._statusBarDisposables.value!)) as ICommandDto[];\n\t\tthis._proxy.$updateSourceControl(this.handle, { statusBarCommands: internal });\n\t}\n\n\tprivate _selected: boolean = false;\n\n\tget selected(): boolean {\n\t\treturn this._selected;\n\t}\n\n\tprivate readonly _onDidChangeSelection = new Emitter<boolean>();\n\treadonly onDidChangeSelection = this._onDidChangeSelection.event;\n\n\tprivate handle: number = ExtHostSourceControl._handlePool++;\n\n\tconstructor(\n\t\t_extension: IExtensionDescription,\n\t\tprivate _proxy: MainThreadSCMShape,\n\t\tprivate _commands: ExtHostCommands,\n\t\tprivate _id: string,\n\t\tprivate _label: string,\n\t\tprivate _rootUri?: vscode.Uri\n\t) {\n\t\tthis._inputBox = new ExtHostSCMInputBox(_extension, this._proxy, this.handle);\n\t\tthis._proxy.$registerSourceControl(this.handle, _id, _label, _rootUri);\n\t}\n\n\tprivate createdResourceGroups = new Map<ExtHostSourceControlResourceGroup, IDisposable>();\n\tprivate updatedResourceGroups = new Set<ExtHostSourceControlResourceGroup>();\n\n\tcreateResourceGroup(id: string, label: string): ExtHostSourceControlResourceGroup {\n\t\tconst group = new ExtHostSourceControlResourceGroup(this._proxy, this._commands, this.handle, id, label);\n\t\tconst disposable = Event.once(group.onDidDispose)(() => this.createdResourceGroups.delete(group));\n\t\tthis.createdResourceGroups.set(group, disposable);\n\t\tthis.eventuallyAddResourceGroups();\n\t\treturn group;\n\t}\n\n\t@debounce(100)\n\teventuallyAddResourceGroups(): void {\n\t\tconst groups: [number /*handle*/, string /*id*/, string /*label*/, SCMGroupFeatures][] = [];\n\t\tconst splices: SCMRawResourceSplices[] = [];\n\n\t\tfor (const [group, disposable] of this.createdResourceGroups) {\n\t\t\tdisposable.dispose();\n\n\t\t\tconst updateListener = group.onDidUpdateResourceStates(() => {\n\t\t\t\tthis.updatedResourceGroups.add(group);\n\t\t\t\tthis.eventuallyUpdateResourceStates();\n\t\t\t});\n\n\t\t\tEvent.once(group.onDidDispose)(() => {\n\t\t\t\tthis.updatedResourceGroups.delete(group);\n\t\t\t\tupdateListener.dispose();\n\t\t\t\tthis._groups.delete(group.handle);\n\t\t\t\tthis._proxy.$unregisterGroup(this.handle, group.handle);\n\t\t\t});\n\n\t\t\tgroups.push([group.handle, group.id, group.label, group.features]);\n\n\t\t\tconst snapshot = group._takeResourceStateSnapshot();\n\n\t\t\tif (snapshot.length > 0) {\n\t\t\t\tsplices.push([group.handle, snapshot]);\n\t\t\t}\n\n\t\t\tthis._groups.set(group.handle, group);\n\t\t}\n\n\t\tthis._proxy.$registerGroups(this.handle, groups, splices);\n\t\tthis.createdResourceGroups.clear();\n\t}\n\n\t@debounce(100)\n\teventuallyUpdateResourceStates(): void {\n\t\tconst splices: SCMRawResourceSplices[] = [];\n\n\t\tthis.updatedResourceGroups.forEach(group => {\n\t\t\tconst snapshot = group._takeResourceStateSnapshot();\n\n\t\t\tif (snapshot.length === 0) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tsplices.push([group.handle, snapshot]);\n\t\t});\n\n\t\tif (splices.length > 0) {\n\t\t\tthis._proxy.$spliceResourceStates(this.handle, splices);\n\t\t}\n\n\t\tthis.updatedResourceGroups.clear();\n\t}\n\n\tgetResourceGroup(handle: GroupHandle): ExtHostSourceControlResourceGroup | undefined {\n\t\treturn this._groups.get(handle);\n\t}\n\n\tsetSelectionState(selected: boolean): void {\n\t\tthis._selected = selected;\n\t\tthis._onDidChangeSelection.fire(selected);\n\t}\n\n\tdispose(): void {\n\t\tthis._acceptInputDisposables.dispose();\n\t\tthis._statusBarDisposables.dispose();\n\n\t\tthis._groups.forEach(group => group.dispose());\n\t\tthis._proxy.$unregisterSourceControl(this.handle);\n\t}\n}\n\nexport class ExtHostSCM implements ExtHostSCMShape {\n\n\tprivate static _handlePool: number = 0;\n\n\tprivate _proxy: MainThreadSCMShape;\n\tprivate readonly _telemetry: MainThreadTelemetryShape;\n\tprivate _sourceControls: Map<ProviderHandle, ExtHostSourceControl> = new Map<ProviderHandle, ExtHostSourceControl>();\n\tprivate _sourceControlsByExtension: Map<string, ExtHostSourceControl[]> = new Map<string, ExtHostSourceControl[]>();\n\n\tprivate readonly _onDidChangeActiveProvider = new Emitter<vscode.SourceControl>();\n\tget onDidChangeActiveProvider(): Event<vscode.SourceControl> { return this._onDidChangeActiveProvider.event; }\n\n\tprivate _selectedSourceControlHandle: number | undefined;\n\n\tconstructor(\n\t\tmainContext: IMainContext,\n\t\tprivate _commands: ExtHostCommands,\n\t\t@ILogService private readonly logService: ILogService\n\t) {\n\t\tthis._proxy = mainContext.getProxy(MainContext.MainThreadSCM);\n\t\tthis._telemetry = mainContext.getProxy(MainContext.MainThreadTelemetry);\n\n\t\t_commands.registerArgumentProcessor({\n\t\t\tprocessArgument: arg => {\n\t\t\t\tif (arg && arg.$mid === 3) {\n\t\t\t\t\tconst sourceControl = this._sourceControls.get(arg.sourceControlHandle);\n\n\t\t\t\t\tif (!sourceControl) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst group = sourceControl.getResourceGroup(arg.groupHandle);\n\n\t\t\t\t\tif (!group) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn group.getResourceState(arg.handle);\n\t\t\t\t} else if (arg && arg.$mid === 4) {\n\t\t\t\t\tconst sourceControl = this._sourceControls.get(arg.sourceControlHandle);\n\n\t\t\t\t\tif (!sourceControl) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn sourceControl.getResourceGroup(arg.groupHandle);\n\t\t\t\t} else if (arg && arg.$mid === 5) {\n\t\t\t\t\tconst sourceControl = this._sourceControls.get(arg.handle);\n\n\t\t\t\t\tif (!sourceControl) {\n\t\t\t\t\t\treturn arg;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn sourceControl;\n\t\t\t\t}\n\n\t\t\t\treturn arg;\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateSourceControl(extension: IExtensionDescription, id: string, label: string, rootUri: vscode.Uri | undefined): vscode.SourceControl {\n\t\tthis.logService.trace('ExtHostSCM#createSourceControl', extension.identifier.value, id, label, rootUri);\n\n\t\ttype TEvent = { extensionId: string; };\n\t\ttype TMeta = { extensionId: { classification: 'SystemMetaData', purpose: 'FeatureInsight' }; };\n\t\tthis._telemetry.$publicLog2<TEvent, TMeta>('api/scm/createSourceControl', {\n\t\t\textensionId: extension.identifier.value,\n\t\t});\n\n\t\tconst handle = ExtHostSCM._handlePool++;\n\t\tconst sourceControl = new ExtHostSourceControl(extension, this._proxy, this._commands, id, label, rootUri);\n\t\tthis._sourceControls.set(handle, sourceControl);\n\n\t\tconst sourceControls = this._sourceControlsByExtension.get(ExtensionIdentifier.toKey(extension.identifier)) || [];\n\t\tsourceControls.push(sourceControl);\n\t\tthis._sourceControlsByExtension.set(ExtensionIdentifier.toKey(extension.identifier), sourceControls);\n\n\t\treturn sourceControl;\n\t}\n\n\t// Deprecated\n\tgetLastInputBox(extension: IExtensionDescription): ExtHostSCMInputBox | undefined {\n\t\tthis.logService.trace('ExtHostSCM#getLastInputBox', extension.identifier.value);\n\n\t\tconst sourceControls = this._sourceControlsByExtension.get(ExtensionIdentifier.toKey(extension.identifier));\n\t\tconst sourceControl = sourceControls && sourceControls[sourceControls.length - 1];\n\t\treturn sourceControl && sourceControl.inputBox;\n\t}\n\n\t$provideOriginalResource(sourceControlHandle: number, uriComponents: UriComponents, token: CancellationToken): Promise<UriComponents | null> {\n\t\tconst uri = URI.revive(uriComponents);\n\t\tthis.logService.trace('ExtHostSCM#$provideOriginalResource', sourceControlHandle, uri.toString());\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl || !sourceControl.quickDiffProvider || !sourceControl.quickDiffProvider.provideOriginalResource) {\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\treturn asPromise(() => sourceControl.quickDiffProvider!.provideOriginalResource!(uri, token))\n\t\t\t.then<UriComponents | null>(r => r || null);\n\t}\n\n\t$onInputBoxValueChange(sourceControlHandle: number, value: string): Promise<void> {\n\t\tthis.logService.trace('ExtHostSCM#$onInputBoxValueChange', sourceControlHandle);\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tsourceControl.inputBox.$onInputBoxValueChange(value);\n\t\treturn Promise.resolve(undefined);\n\t}\n\n\t$executeResourceCommand(sourceControlHandle: number, groupHandle: number, handle: number, preserveFocus: boolean): Promise<void> {\n\t\tthis.logService.trace('ExtHostSCM#$executeResourceCommand', sourceControlHandle, groupHandle, handle);\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tconst group = sourceControl.getResourceGroup(groupHandle);\n\n\t\tif (!group) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn group.$executeResourceCommand(handle, preserveFocus);\n\t}\n\n\t$validateInput(sourceControlHandle: number, value: string, cursorPosition: number): Promise<[string, number] | undefined> {\n\t\tthis.logService.trace('ExtHostSCM#$validateInput', sourceControlHandle);\n\n\t\tconst sourceControl = this._sourceControls.get(sourceControlHandle);\n\n\t\tif (!sourceControl) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tif (!sourceControl.inputBox.validateInput) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\treturn asPromise(() => sourceControl.inputBox.validateInput!(value, cursorPosition)).then(result => {\n\t\t\tif (!result) {\n\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t}\n\n\t\t\treturn Promise.resolve<[string, number]>([result.message, result.type]);\n\t\t});\n\t}\n\n\t$setSelectedSourceControl(selectedSourceControlHandle: number | undefined): Promise<void> {\n\t\tthis.logService.trace('ExtHostSCM#$setSelectedSourceControl', selectedSourceControlHandle);\n\n\t\tif (selectedSourceControlHandle !== undefined) {\n\t\t\tthis._sourceControls.get(selectedSourceControlHandle)?.setSelectionState(true);\n\t\t}\n\n\t\tif (this._selectedSourceControlHandle !== undefined) {\n\t\t\tthis._sourceControls.get(this._selectedSourceControlHandle)?.setSelectionState(false);\n\t\t}\n\n\t\tthis._selectedSourceControlHandle = selectedSourceControlHandle;\n\t\treturn Promise.resolve(undefined);\n\t}\n}\n"]}