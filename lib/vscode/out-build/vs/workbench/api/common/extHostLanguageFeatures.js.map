{"version":3,"file":"extHostLanguageFeatures.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/api/common/extHostLanguageFeatures.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { mixin } from 'vs/base/common/objects';\nimport type * as vscode from 'vscode';\nimport * as typeConvert from 'vs/workbench/api/common/extHostTypeConverters';\nimport { Range, Disposable, CompletionList, SnippetString, CodeActionKind, SymbolInformation, DocumentSymbol, SemanticTokensEdits, SemanticTokens, SemanticTokensEdit } from 'vs/workbench/api/common/extHostTypes';\nimport { ISingleEditOperation } from 'vs/editor/common/model';\nimport * as modes from 'vs/editor/common/modes';\nimport { ExtHostDocuments } from 'vs/workbench/api/common/extHostDocuments';\nimport { ExtHostCommands, CommandsConverter } from 'vs/workbench/api/common/extHostCommands';\nimport { ExtHostDiagnostics } from 'vs/workbench/api/common/extHostDiagnostics';\nimport { asPromise } from 'vs/base/common/async';\nimport * as extHostProtocol from './extHost.protocol';\nimport { regExpLeadsToEndlessLoop, regExpFlags } from 'vs/base/common/strings';\nimport { IPosition } from 'vs/editor/common/core/position';\nimport { IRange, Range as EditorRange } from 'vs/editor/common/core/range';\nimport { isFalsyOrEmpty, isNonEmptyArray, coalesce, asArray } from 'vs/base/common/arrays';\nimport { isObject } from 'vs/base/common/types';\nimport { ISelection, Selection } from 'vs/editor/common/core/selection';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { ExtensionIdentifier, IExtensionDescription } from 'vs/platform/extensions/common/extensions';\nimport { IURITransformer } from 'vs/base/common/uriIpc';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { VSBuffer } from 'vs/base/common/buffer';\nimport { encodeSemanticTokensDto } from 'vs/editor/common/services/semanticTokensDto';\nimport { IdGenerator } from 'vs/base/common/idGenerator';\nimport { IExtHostApiDeprecationService } from 'vs/workbench/api/common/extHostApiDeprecationService';\nimport { Cache } from './cache';\nimport { StopWatch } from 'vs/base/common/stopwatch';\nimport { CancellationError } from 'vs/base/common/errors';\n\n// --- adapter\n\nclass DocumentSymbolAdapter {\n\n\tprivate _documents: ExtHostDocuments;\n\tprivate _provider: vscode.DocumentSymbolProvider;\n\n\tconstructor(documents: ExtHostDocuments, provider: vscode.DocumentSymbolProvider) {\n\t\tthis._documents = documents;\n\t\tthis._provider = provider;\n\t}\n\n\tprovideDocumentSymbols(resource: URI, token: CancellationToken): Promise<modes.DocumentSymbol[] | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\treturn asPromise(() => this._provider.provideDocumentSymbols(doc, token)).then(value => {\n\t\t\tif (isFalsyOrEmpty(value)) {\n\t\t\t\treturn undefined;\n\t\t\t} else if (value![0] instanceof DocumentSymbol) {\n\t\t\t\treturn (<DocumentSymbol[]>value).map(typeConvert.DocumentSymbol.from);\n\t\t\t} else {\n\t\t\t\treturn DocumentSymbolAdapter._asDocumentSymbolTree(<SymbolInformation[]>value);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate static _asDocumentSymbolTree(infos: SymbolInformation[]): modes.DocumentSymbol[] {\n\t\t// first sort by start (and end) and then loop over all elements\n\t\t// and build a tree based on containment.\n\t\tinfos = infos.slice(0).sort((a, b) => {\n\t\t\tlet res = a.location.range.start.compareTo(b.location.range.start);\n\t\t\tif (res === 0) {\n\t\t\t\tres = b.location.range.end.compareTo(a.location.range.end);\n\t\t\t}\n\t\t\treturn res;\n\t\t});\n\t\tconst res: modes.DocumentSymbol[] = [];\n\t\tconst parentStack: modes.DocumentSymbol[] = [];\n\t\tfor (const info of infos) {\n\t\t\tconst element: modes.DocumentSymbol = {\n\t\t\t\tname: info.name || '!!MISSING: name!!',\n\t\t\t\tkind: typeConvert.SymbolKind.from(info.kind),\n\t\t\t\ttags: info.tags?.map(typeConvert.SymbolTag.from) || [],\n\t\t\t\tdetail: '',\n\t\t\t\tcontainerName: info.containerName,\n\t\t\t\trange: typeConvert.Range.from(info.location.range),\n\t\t\t\tselectionRange: typeConvert.Range.from(info.location.range),\n\t\t\t\tchildren: []\n\t\t\t};\n\n\t\t\twhile (true) {\n\t\t\t\tif (parentStack.length === 0) {\n\t\t\t\t\tparentStack.push(element);\n\t\t\t\t\tres.push(element);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tconst parent = parentStack[parentStack.length - 1];\n\t\t\t\tif (EditorRange.containsRange(parent.range, element.range) && !EditorRange.equalsRange(parent.range, element.range)) {\n\t\t\t\t\tif (parent.children) {\n\t\t\t\t\t\tparent.children.push(element);\n\t\t\t\t\t}\n\t\t\t\t\tparentStack.push(element);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tparentStack.pop();\n\t\t\t}\n\t\t}\n\t\treturn res;\n\t}\n}\n\nclass CodeLensAdapter {\n\n\tprivate static _badCmd: vscode.Command = { command: 'missing', title: '!!MISSING: command!!' };\n\n\tprivate readonly _cache = new Cache<vscode.CodeLens>('CodeLens');\n\tprivate readonly _disposables = new Map<number, DisposableStore>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _commands: CommandsConverter,\n\t\tprivate readonly _provider: vscode.CodeLensProvider\n\t) { }\n\n\tasync provideCodeLenses(resource: URI, token: CancellationToken): Promise<extHostProtocol.ICodeLensListDto | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\n\t\tconst lenses = await this._provider.provideCodeLenses(doc, token);\n\t\tif (!lenses || token.isCancellationRequested) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst cacheId = this._cache.add(lenses);\n\t\tconst disposables = new DisposableStore();\n\t\tthis._disposables.set(cacheId, disposables);\n\t\tconst result: extHostProtocol.ICodeLensListDto = {\n\t\t\tcacheId,\n\t\t\tlenses: [],\n\t\t};\n\t\tfor (let i = 0; i < lenses.length; i++) {\n\t\t\tresult.lenses.push({\n\t\t\t\tcacheId: [cacheId, i],\n\t\t\t\trange: typeConvert.Range.from(lenses[i].range),\n\t\t\t\tcommand: this._commands.toInternal(lenses[i].command, disposables)\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t}\n\n\tasync resolveCodeLens(symbol: extHostProtocol.ICodeLensDto, token: CancellationToken): Promise<extHostProtocol.ICodeLensDto | undefined> {\n\n\t\tconst lens = symbol.cacheId && this._cache.get(...symbol.cacheId);\n\t\tif (!lens) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tlet resolvedLens: vscode.CodeLens | undefined | null;\n\t\tif (typeof this._provider.resolveCodeLens !== 'function' || lens.isResolved) {\n\t\t\tresolvedLens = lens;\n\t\t} else {\n\t\t\tresolvedLens = await this._provider.resolveCodeLens(lens, token);\n\t\t}\n\t\tif (!resolvedLens) {\n\t\t\tresolvedLens = lens;\n\t\t}\n\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst disposables = symbol.cacheId && this._disposables.get(symbol.cacheId[0]);\n\t\tif (!disposables) {\n\t\t\t// disposed in the meantime\n\t\t\treturn undefined;\n\t\t}\n\t\tsymbol.command = this._commands.toInternal(resolvedLens.command ?? CodeLensAdapter._badCmd, disposables);\n\t\treturn symbol;\n\t}\n\n\treleaseCodeLenses(cachedId: number): void {\n\t\tthis._disposables.get(cachedId)?.dispose();\n\t\tthis._disposables.delete(cachedId);\n\t\tthis._cache.delete(cachedId);\n\t}\n}\n\nfunction convertToLocationLinks(value: vscode.Location | vscode.Location[] | vscode.LocationLink[] | undefined | null): modes.LocationLink[] {\n\tif (Array.isArray(value)) {\n\t\treturn (<any>value).map(typeConvert.DefinitionLink.from);\n\t} else if (value) {\n\t\treturn [typeConvert.DefinitionLink.from(value)];\n\t}\n\treturn [];\n}\n\nclass DefinitionAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DefinitionProvider\n\t) { }\n\n\tprovideDefinition(resource: URI, position: IPosition, token: CancellationToken): Promise<modes.LocationLink[]> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\treturn asPromise(() => this._provider.provideDefinition(doc, pos, token)).then(convertToLocationLinks);\n\t}\n}\n\nclass DeclarationAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DeclarationProvider\n\t) { }\n\n\tprovideDeclaration(resource: URI, position: IPosition, token: CancellationToken): Promise<modes.LocationLink[]> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\treturn asPromise(() => this._provider.provideDeclaration(doc, pos, token)).then(convertToLocationLinks);\n\t}\n}\n\nclass ImplementationAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.ImplementationProvider\n\t) { }\n\n\tprovideImplementation(resource: URI, position: IPosition, token: CancellationToken): Promise<modes.LocationLink[]> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\treturn asPromise(() => this._provider.provideImplementation(doc, pos, token)).then(convertToLocationLinks);\n\t}\n}\n\nclass TypeDefinitionAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.TypeDefinitionProvider\n\t) { }\n\n\tprovideTypeDefinition(resource: URI, position: IPosition, token: CancellationToken): Promise<modes.LocationLink[]> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\treturn asPromise(() => this._provider.provideTypeDefinition(doc, pos, token)).then(convertToLocationLinks);\n\t}\n}\n\nclass HoverAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.HoverProvider,\n\t) { }\n\n\tpublic provideHover(resource: URI, position: IPosition, token: CancellationToken): Promise<modes.Hover | undefined> {\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\treturn asPromise(() => this._provider.provideHover(doc, pos, token)).then(value => {\n\t\t\tif (!value || isFalsyOrEmpty(value.contents)) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tif (!value.range) {\n\t\t\t\tvalue.range = doc.getWordRangeAtPosition(pos);\n\t\t\t}\n\t\t\tif (!value.range) {\n\t\t\t\tvalue.range = new Range(pos, pos);\n\t\t\t}\n\n\t\t\treturn typeConvert.Hover.from(value);\n\t\t});\n\t}\n}\n\nclass EvaluatableExpressionAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.EvaluatableExpressionProvider,\n\t) { }\n\n\tpublic provideEvaluatableExpression(resource: URI, position: IPosition, token: CancellationToken): Promise<modes.EvaluatableExpression | undefined> {\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\treturn asPromise(() => this._provider.provideEvaluatableExpression(doc, pos, token)).then(value => {\n\t\t\tif (value) {\n\t\t\t\treturn typeConvert.EvaluatableExpression.from(value);\n\t\t\t}\n\t\t\treturn undefined;\n\t\t});\n\t}\n}\n\nclass InlineValuesAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.InlineValuesProvider,\n\t) { }\n\n\tpublic provideInlineValues(resource: URI, viewPort: IRange, context: extHostProtocol.IInlineValueContextDto, token: CancellationToken): Promise<modes.InlineValue[] | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\treturn asPromise(() => this._provider.provideInlineValues(doc, typeConvert.Range.to(viewPort), typeConvert.InlineValueContext.to(context), token)).then(value => {\n\t\t\tif (Array.isArray(value)) {\n\t\t\t\treturn value.map(iv => typeConvert.InlineValue.from(iv));\n\t\t\t}\n\t\t\treturn undefined;\n\t\t});\n\t}\n}\n\nclass DocumentHighlightAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentHighlightProvider\n\t) { }\n\n\tprovideDocumentHighlights(resource: URI, position: IPosition, token: CancellationToken): Promise<modes.DocumentHighlight[] | undefined> {\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\treturn asPromise(() => this._provider.provideDocumentHighlights(doc, pos, token)).then(value => {\n\t\t\tif (Array.isArray(value)) {\n\t\t\t\treturn value.map(typeConvert.DocumentHighlight.from);\n\t\t\t}\n\t\t\treturn undefined;\n\t\t});\n\t}\n}\n\nclass LinkedEditingRangeAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.LinkedEditingRangeProvider\n\t) { }\n\n\tprovideLinkedEditingRanges(resource: URI, position: IPosition, token: CancellationToken): Promise<modes.LinkedEditingRanges | undefined> {\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\treturn asPromise(() => this._provider.provideLinkedEditingRanges(doc, pos, token)).then(value => {\n\t\t\tif (value && Array.isArray(value.ranges)) {\n\t\t\t\treturn {\n\t\t\t\t\tranges: coalesce(value.ranges.map(typeConvert.Range.from)),\n\t\t\t\t\twordPattern: value.wordPattern\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn undefined;\n\t\t});\n\t}\n}\n\nclass ReferenceAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.ReferenceProvider\n\t) { }\n\n\tprovideReferences(resource: URI, position: IPosition, context: modes.ReferenceContext, token: CancellationToken): Promise<modes.Location[] | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\treturn asPromise(() => this._provider.provideReferences(doc, pos, context, token)).then(value => {\n\t\t\tif (Array.isArray(value)) {\n\t\t\t\treturn value.map(typeConvert.location.from);\n\t\t\t}\n\t\t\treturn undefined;\n\t\t});\n\t}\n}\n\nexport interface CustomCodeAction extends extHostProtocol.ICodeActionDto {\n\t_isSynthetic?: boolean;\n}\n\nclass CodeActionAdapter {\n\tprivate static readonly _maxCodeActionsPerFile: number = 1000;\n\n\tprivate readonly _cache = new Cache<vscode.CodeAction | vscode.Command>('CodeAction');\n\tprivate readonly _disposables = new Map<number, DisposableStore>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _commands: CommandsConverter,\n\t\tprivate readonly _diagnostics: ExtHostDiagnostics,\n\t\tprivate readonly _provider: vscode.CodeActionProvider,\n\t\tprivate readonly _logService: ILogService,\n\t\tprivate readonly _extension: IExtensionDescription,\n\t\tprivate readonly _apiDeprecation: IExtHostApiDeprecationService,\n\t) { }\n\n\tprovideCodeActions(resource: URI, rangeOrSelection: IRange | ISelection, context: modes.CodeActionContext, token: CancellationToken): Promise<extHostProtocol.ICodeActionListDto | undefined> {\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst ran = Selection.isISelection(rangeOrSelection)\n\t\t\t? <vscode.Selection>typeConvert.Selection.to(rangeOrSelection)\n\t\t\t: <vscode.Range>typeConvert.Range.to(rangeOrSelection);\n\t\tconst allDiagnostics: vscode.Diagnostic[] = [];\n\n\t\tfor (const diagnostic of this._diagnostics.getDiagnostics(resource)) {\n\t\t\tif (ran.intersection(diagnostic.range)) {\n\t\t\t\tconst newLen = allDiagnostics.push(diagnostic);\n\t\t\t\tif (newLen > CodeActionAdapter._maxCodeActionsPerFile) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst codeActionContext: vscode.CodeActionContext = {\n\t\t\tdiagnostics: allDiagnostics,\n\t\t\tonly: context.only ? new CodeActionKind(context.only) : undefined,\n\t\t\ttriggerKind: typeConvert.CodeActionTriggerKind.to(context.trigger),\n\t\t};\n\n\t\treturn asPromise(() => this._provider.provideCodeActions(doc, ran, codeActionContext, token)).then((commandsOrActions): extHostProtocol.ICodeActionListDto | undefined => {\n\t\t\tif (!isNonEmptyArray(commandsOrActions) || token.isCancellationRequested) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tconst cacheId = this._cache.add(commandsOrActions);\n\t\t\tconst disposables = new DisposableStore();\n\t\t\tthis._disposables.set(cacheId, disposables);\n\n\t\t\tconst actions: CustomCodeAction[] = [];\n\t\t\tfor (let i = 0; i < commandsOrActions.length; i++) {\n\t\t\t\tconst candidate = commandsOrActions[i];\n\t\t\t\tif (!candidate) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif (CodeActionAdapter._isCommand(candidate)) {\n\t\t\t\t\t// old school: synthetic code action\n\n\t\t\t\t\tthis._apiDeprecation.report('CodeActionProvider.provideCodeActions - return commands', this._extension,\n\t\t\t\t\t\t`Return 'CodeAction' instances instead.`);\n\n\t\t\t\t\tactions.push({\n\t\t\t\t\t\t_isSynthetic: true,\n\t\t\t\t\t\ttitle: candidate.title,\n\t\t\t\t\t\tcommand: this._commands.toInternal(candidate, disposables),\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tif (codeActionContext.only) {\n\t\t\t\t\t\tif (!candidate.kind) {\n\t\t\t\t\t\t\tthis._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${codeActionContext.only.value} 'requested but returned code action does not have a 'kind'. Code action will be dropped. Please set 'CodeAction.kind'.`);\n\t\t\t\t\t\t} else if (!codeActionContext.only.contains(candidate.kind)) {\n\t\t\t\t\t\t\tthis._logService.warn(`${this._extension.identifier.value} - Code actions of kind '${codeActionContext.only.value} 'requested but returned code action is of kind '${candidate.kind.value}'. Code action will be dropped. Please check 'CodeActionContext.only' to only return requested code actions.`);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// new school: convert code action\n\t\t\t\t\tactions.push({\n\t\t\t\t\t\tcacheId: [cacheId, i],\n\t\t\t\t\t\ttitle: candidate.title,\n\t\t\t\t\t\tcommand: candidate.command && this._commands.toInternal(candidate.command, disposables),\n\t\t\t\t\t\tdiagnostics: candidate.diagnostics && candidate.diagnostics.map(typeConvert.Diagnostic.from),\n\t\t\t\t\t\tedit: candidate.edit && typeConvert.WorkspaceEdit.from(candidate.edit),\n\t\t\t\t\t\tkind: candidate.kind && candidate.kind.value,\n\t\t\t\t\t\tisPreferred: candidate.isPreferred,\n\t\t\t\t\t\tdisabled: candidate.disabled?.reason\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn { cacheId, actions };\n\t\t});\n\t}\n\n\tpublic async resolveCodeAction(id: extHostProtocol.ChainedCacheId, token: CancellationToken): Promise<extHostProtocol.IWorkspaceEditDto | undefined> {\n\t\tconst [sessionId, itemId] = id;\n\t\tconst item = this._cache.get(sessionId, itemId);\n\t\tif (!item || CodeActionAdapter._isCommand(item)) {\n\t\t\treturn undefined; // code actions only!\n\t\t}\n\t\tif (!this._provider.resolveCodeAction) {\n\t\t\treturn; // this should not happen...\n\t\t}\n\t\tconst resolvedItem = (await this._provider.resolveCodeAction(item, token)) ?? item;\n\t\treturn resolvedItem?.edit\n\t\t\t? typeConvert.WorkspaceEdit.from(resolvedItem.edit)\n\t\t\t: undefined;\n\t}\n\n\tpublic releaseCodeActions(cachedId: number): void {\n\t\tthis._disposables.get(cachedId)?.dispose();\n\t\tthis._disposables.delete(cachedId);\n\t\tthis._cache.delete(cachedId);\n\t}\n\n\tprivate static _isCommand(thing: any): thing is vscode.Command {\n\t\treturn typeof (<vscode.Command>thing).command === 'string' && typeof (<vscode.Command>thing).title === 'string';\n\t}\n}\n\nclass DocumentFormattingAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentFormattingEditProvider\n\t) { }\n\n\tprovideDocumentFormattingEdits(resource: URI, options: modes.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined> {\n\n\t\tconst document = this._documents.getDocument(resource);\n\n\t\treturn asPromise(() => this._provider.provideDocumentFormattingEdits(document, <any>options, token)).then(value => {\n\t\t\tif (Array.isArray(value)) {\n\t\t\t\treturn value.map(typeConvert.TextEdit.from);\n\t\t\t}\n\t\t\treturn undefined;\n\t\t});\n\t}\n}\n\nclass RangeFormattingAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentRangeFormattingEditProvider\n\t) { }\n\n\tprovideDocumentRangeFormattingEdits(resource: URI, range: IRange, options: modes.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined> {\n\n\t\tconst document = this._documents.getDocument(resource);\n\t\tconst ran = typeConvert.Range.to(range);\n\n\t\treturn asPromise(() => this._provider.provideDocumentRangeFormattingEdits(document, ran, <any>options, token)).then(value => {\n\t\t\tif (Array.isArray(value)) {\n\t\t\t\treturn value.map(typeConvert.TextEdit.from);\n\t\t\t}\n\t\t\treturn undefined;\n\t\t});\n\t}\n}\n\nclass OnTypeFormattingAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.OnTypeFormattingEditProvider\n\t) { }\n\n\tautoFormatTriggerCharacters: string[] = []; // not here\n\n\tprovideOnTypeFormattingEdits(resource: URI, position: IPosition, ch: string, options: modes.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined> {\n\n\t\tconst document = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\treturn asPromise(() => this._provider.provideOnTypeFormattingEdits(document, pos, ch, <any>options, token)).then(value => {\n\t\t\tif (Array.isArray(value)) {\n\t\t\t\treturn value.map(typeConvert.TextEdit.from);\n\t\t\t}\n\t\t\treturn undefined;\n\t\t});\n\t}\n}\n\nclass NavigateTypeAdapter {\n\n\tprivate readonly _symbolCache = new Map<number, vscode.SymbolInformation>();\n\tprivate readonly _resultCache = new Map<number, [number, number]>();\n\n\tconstructor(\n\t\tprivate readonly _provider: vscode.WorkspaceSymbolProvider,\n\t\tprivate readonly _logService: ILogService\n\t) { }\n\n\tprovideWorkspaceSymbols(search: string, token: CancellationToken): Promise<extHostProtocol.IWorkspaceSymbolsDto> {\n\t\tconst result: extHostProtocol.IWorkspaceSymbolsDto = extHostProtocol.IdObject.mixin({ symbols: [] });\n\t\treturn asPromise(() => this._provider.provideWorkspaceSymbols(search, token)).then(value => {\n\t\t\tif (isNonEmptyArray(value)) {\n\t\t\t\tfor (const item of value) {\n\t\t\t\t\tif (!item) {\n\t\t\t\t\t\t// drop\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif (!item.name) {\n\t\t\t\t\t\tthis._logService.warn('INVALID SymbolInformation, lacks name', item);\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tconst symbol = extHostProtocol.IdObject.mixin(typeConvert.WorkspaceSymbol.from(item));\n\t\t\t\t\tthis._symbolCache.set(symbol._id!, item);\n\t\t\t\t\tresult.symbols.push(symbol);\n\t\t\t\t}\n\t\t\t}\n\t\t}).then(() => {\n\t\t\tif (result.symbols.length > 0) {\n\t\t\t\tthis._resultCache.set(result._id!, [result.symbols[0]._id!, result.symbols[result.symbols.length - 1]._id!]);\n\t\t\t}\n\t\t\treturn result;\n\t\t});\n\t}\n\n\tasync resolveWorkspaceSymbol(symbol: extHostProtocol.IWorkspaceSymbolDto, token: CancellationToken): Promise<extHostProtocol.IWorkspaceSymbolDto | undefined> {\n\t\tif (typeof this._provider.resolveWorkspaceSymbol !== 'function') {\n\t\t\treturn symbol;\n\t\t}\n\n\t\tconst item = this._symbolCache.get(symbol._id!);\n\t\tif (item) {\n\t\t\tconst value = await asPromise(() => this._provider.resolveWorkspaceSymbol!(item, token));\n\t\t\treturn value && mixin(symbol, typeConvert.WorkspaceSymbol.from(value), true);\n\t\t}\n\t\treturn undefined;\n\t}\n\n\treleaseWorkspaceSymbols(id: number): any {\n\t\tconst range = this._resultCache.get(id);\n\t\tif (range) {\n\t\t\tfor (let [from, to] = range; from <= to; from++) {\n\t\t\t\tthis._symbolCache.delete(from);\n\t\t\t}\n\t\t\tthis._resultCache.delete(id);\n\t\t}\n\t}\n}\n\nclass RenameAdapter {\n\n\tstatic supportsResolving(provider: vscode.RenameProvider): boolean {\n\t\treturn typeof provider.prepareRename === 'function';\n\t}\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.RenameProvider,\n\t\tprivate readonly _logService: ILogService\n\t) { }\n\n\tprovideRenameEdits(resource: URI, position: IPosition, newName: string, token: CancellationToken): Promise<extHostProtocol.IWorkspaceEditDto | undefined> {\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\treturn asPromise(() => this._provider.provideRenameEdits(doc, pos, newName, token)).then(value => {\n\t\t\tif (!value) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn typeConvert.WorkspaceEdit.from(value);\n\t\t}, err => {\n\t\t\tconst rejectReason = RenameAdapter._asMessage(err);\n\t\t\tif (rejectReason) {\n\t\t\t\treturn <extHostProtocol.IWorkspaceEditDto>{ rejectReason, edits: undefined! };\n\t\t\t} else {\n\t\t\t\t// generic error\n\t\t\t\treturn Promise.reject<extHostProtocol.IWorkspaceEditDto>(err);\n\t\t\t}\n\t\t});\n\t}\n\n\tresolveRenameLocation(resource: URI, position: IPosition, token: CancellationToken): Promise<(modes.RenameLocation & modes.Rejection) | undefined> {\n\t\tif (typeof this._provider.prepareRename !== 'function') {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\treturn asPromise(() => this._provider.prepareRename!(doc, pos, token)).then(rangeOrLocation => {\n\n\t\t\tlet range: vscode.Range | undefined;\n\t\t\tlet text: string | undefined;\n\t\t\tif (Range.isRange(rangeOrLocation)) {\n\t\t\t\trange = rangeOrLocation;\n\t\t\t\ttext = doc.getText(rangeOrLocation);\n\n\t\t\t} else if (isObject(rangeOrLocation)) {\n\t\t\t\trange = rangeOrLocation.range;\n\t\t\t\ttext = rangeOrLocation.placeholder;\n\t\t\t}\n\n\t\t\tif (!range) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\tif (range.start.line > pos.line || range.end.line < pos.line) {\n\t\t\t\tthis._logService.warn('INVALID rename location: position line must be within range start/end lines');\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn { range: typeConvert.Range.from(range), text };\n\t\t}, err => {\n\t\t\tconst rejectReason = RenameAdapter._asMessage(err);\n\t\t\tif (rejectReason) {\n\t\t\t\treturn <modes.RenameLocation & modes.Rejection>{ rejectReason, range: undefined!, text: undefined! };\n\t\t\t} else {\n\t\t\t\treturn Promise.reject<any>(err);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate static _asMessage(err: any): string | undefined {\n\t\tif (typeof err === 'string') {\n\t\t\treturn err;\n\t\t} else if (err instanceof Error && typeof err.message === 'string') {\n\t\t\treturn err.message;\n\t\t} else {\n\t\t\treturn undefined;\n\t\t}\n\t}\n}\n\nclass SemanticTokensPreviousResult {\n\tconstructor(\n\t\tpublic readonly resultId: string | undefined,\n\t\tpublic readonly tokens?: Uint32Array,\n\t) { }\n}\n\ntype RelaxedSemanticTokens = { readonly resultId?: string; readonly data: number[]; };\ntype RelaxedSemanticTokensEdit = { readonly start: number; readonly deleteCount: number; readonly data?: number[]; };\ntype RelaxedSemanticTokensEdits = { readonly resultId?: string; readonly edits: RelaxedSemanticTokensEdit[]; };\n\ntype ProvidedSemanticTokens = vscode.SemanticTokens | RelaxedSemanticTokens;\ntype ProvidedSemanticTokensEdits = vscode.SemanticTokensEdits | RelaxedSemanticTokensEdits;\n\nexport class DocumentSemanticTokensAdapter {\n\n\tprivate readonly _previousResults: Map<number, SemanticTokensPreviousResult>;\n\tprivate _nextResultId = 1;\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentSemanticTokensProvider,\n\t) {\n\t\tthis._previousResults = new Map<number, SemanticTokensPreviousResult>();\n\t}\n\n\tprovideDocumentSemanticTokens(resource: URI, previousResultId: number, token: CancellationToken): Promise<VSBuffer | null> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst previousResult = (previousResultId !== 0 ? this._previousResults.get(previousResultId) : null);\n\t\treturn asPromise(() => {\n\t\t\tif (previousResult && typeof previousResult.resultId === 'string' && typeof this._provider.provideDocumentSemanticTokensEdits === 'function') {\n\t\t\t\treturn this._provider.provideDocumentSemanticTokensEdits(doc, previousResult.resultId, token);\n\t\t\t}\n\t\t\treturn this._provider.provideDocumentSemanticTokens(doc, token);\n\t\t}).then((value: ProvidedSemanticTokens | ProvidedSemanticTokensEdits | null | undefined) => {\n\t\t\tif (previousResult) {\n\t\t\t\tthis._previousResults.delete(previousResultId);\n\t\t\t}\n\t\t\tif (!value) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tvalue = DocumentSemanticTokensAdapter._fixProvidedSemanticTokens(value);\n\t\t\treturn this._send(DocumentSemanticTokensAdapter._convertToEdits(previousResult, value), value);\n\t\t});\n\t}\n\n\tasync releaseDocumentSemanticColoring(semanticColoringResultId: number): Promise<void> {\n\t\tthis._previousResults.delete(semanticColoringResultId);\n\t}\n\n\tprivate static _fixProvidedSemanticTokens(v: ProvidedSemanticTokens | ProvidedSemanticTokensEdits): vscode.SemanticTokens | vscode.SemanticTokensEdits {\n\t\tif (DocumentSemanticTokensAdapter._isSemanticTokens(v)) {\n\t\t\tif (DocumentSemanticTokensAdapter._isCorrectSemanticTokens(v)) {\n\t\t\t\treturn v;\n\t\t\t}\n\t\t\treturn new SemanticTokens(new Uint32Array(v.data), v.resultId);\n\t\t} else if (DocumentSemanticTokensAdapter._isSemanticTokensEdits(v)) {\n\t\t\tif (DocumentSemanticTokensAdapter._isCorrectSemanticTokensEdits(v)) {\n\t\t\t\treturn v;\n\t\t\t}\n\t\t\treturn new SemanticTokensEdits(v.edits.map(edit => new SemanticTokensEdit(edit.start, edit.deleteCount, edit.data ? new Uint32Array(edit.data) : edit.data)), v.resultId);\n\t\t}\n\t\treturn v;\n\t}\n\n\tprivate static _isSemanticTokens(v: ProvidedSemanticTokens | ProvidedSemanticTokensEdits): v is ProvidedSemanticTokens {\n\t\treturn v && !!((v as ProvidedSemanticTokens).data);\n\t}\n\n\tprivate static _isCorrectSemanticTokens(v: ProvidedSemanticTokens): v is vscode.SemanticTokens {\n\t\treturn (v.data instanceof Uint32Array);\n\t}\n\n\tprivate static _isSemanticTokensEdits(v: ProvidedSemanticTokens | ProvidedSemanticTokensEdits): v is ProvidedSemanticTokensEdits {\n\t\treturn v && Array.isArray((v as ProvidedSemanticTokensEdits).edits);\n\t}\n\n\tprivate static _isCorrectSemanticTokensEdits(v: ProvidedSemanticTokensEdits): v is vscode.SemanticTokensEdits {\n\t\tfor (const edit of v.edits) {\n\t\t\tif (!(edit.data instanceof Uint32Array)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate static _convertToEdits(previousResult: SemanticTokensPreviousResult | null | undefined, newResult: vscode.SemanticTokens | vscode.SemanticTokensEdits): vscode.SemanticTokens | vscode.SemanticTokensEdits {\n\t\tif (!DocumentSemanticTokensAdapter._isSemanticTokens(newResult)) {\n\t\t\treturn newResult;\n\t\t}\n\t\tif (!previousResult || !previousResult.tokens) {\n\t\t\treturn newResult;\n\t\t}\n\t\tconst oldData = previousResult.tokens;\n\t\tconst oldLength = oldData.length;\n\t\tconst newData = newResult.data;\n\t\tconst newLength = newData.length;\n\n\t\tlet commonPrefixLength = 0;\n\t\tconst maxCommonPrefixLength = Math.min(oldLength, newLength);\n\t\twhile (commonPrefixLength < maxCommonPrefixLength && oldData[commonPrefixLength] === newData[commonPrefixLength]) {\n\t\t\tcommonPrefixLength++;\n\t\t}\n\n\t\tif (commonPrefixLength === oldLength && commonPrefixLength === newLength) {\n\t\t\t// complete overlap!\n\t\t\treturn new SemanticTokensEdits([], newResult.resultId);\n\t\t}\n\n\t\tlet commonSuffixLength = 0;\n\t\tconst maxCommonSuffixLength = maxCommonPrefixLength - commonPrefixLength;\n\t\twhile (commonSuffixLength < maxCommonSuffixLength && oldData[oldLength - commonSuffixLength - 1] === newData[newLength - commonSuffixLength - 1]) {\n\t\t\tcommonSuffixLength++;\n\t\t}\n\n\t\treturn new SemanticTokensEdits([{\n\t\t\tstart: commonPrefixLength,\n\t\t\tdeleteCount: (oldLength - commonPrefixLength - commonSuffixLength),\n\t\t\tdata: newData.subarray(commonPrefixLength, newLength - commonSuffixLength)\n\t\t}], newResult.resultId);\n\t}\n\n\tprivate _send(value: vscode.SemanticTokens | vscode.SemanticTokensEdits, original: vscode.SemanticTokens | vscode.SemanticTokensEdits): VSBuffer | null {\n\t\tif (DocumentSemanticTokensAdapter._isSemanticTokens(value)) {\n\t\t\tconst myId = this._nextResultId++;\n\t\t\tthis._previousResults.set(myId, new SemanticTokensPreviousResult(value.resultId, value.data));\n\t\t\treturn encodeSemanticTokensDto({\n\t\t\t\tid: myId,\n\t\t\t\ttype: 'full',\n\t\t\t\tdata: value.data\n\t\t\t});\n\t\t}\n\n\t\tif (DocumentSemanticTokensAdapter._isSemanticTokensEdits(value)) {\n\t\t\tconst myId = this._nextResultId++;\n\t\t\tif (DocumentSemanticTokensAdapter._isSemanticTokens(original)) {\n\t\t\t\t// store the original\n\t\t\t\tthis._previousResults.set(myId, new SemanticTokensPreviousResult(original.resultId, original.data));\n\t\t\t} else {\n\t\t\t\tthis._previousResults.set(myId, new SemanticTokensPreviousResult(value.resultId));\n\t\t\t}\n\t\t\treturn encodeSemanticTokensDto({\n\t\t\t\tid: myId,\n\t\t\t\ttype: 'delta',\n\t\t\t\tdeltas: (value.edits || []).map(edit => ({ start: edit.start, deleteCount: edit.deleteCount, data: edit.data }))\n\t\t\t});\n\t\t}\n\n\t\treturn null;\n\t}\n}\n\nexport class DocumentRangeSemanticTokensAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentRangeSemanticTokensProvider,\n\t) {\n\t}\n\n\tprovideDocumentRangeSemanticTokens(resource: URI, range: IRange, token: CancellationToken): Promise<VSBuffer | null> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\treturn asPromise(() => this._provider.provideDocumentRangeSemanticTokens(doc, typeConvert.Range.to(range), token)).then(value => {\n\t\t\tif (!value) {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn this._send(value);\n\t\t});\n\t}\n\n\tprivate _send(value: vscode.SemanticTokens): VSBuffer | null {\n\t\treturn encodeSemanticTokensDto({\n\t\t\tid: 0,\n\t\t\ttype: 'full',\n\t\t\tdata: value.data\n\t\t});\n\t}\n}\n\nclass SuggestAdapter {\n\n\tstatic supportsResolving(provider: vscode.CompletionItemProvider): boolean {\n\t\treturn typeof provider.resolveCompletionItem === 'function';\n\t}\n\n\tprivate _cache = new Cache<vscode.CompletionItem>('CompletionItem');\n\tprivate _disposables = new Map<number, DisposableStore>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _commands: CommandsConverter,\n\t\tprivate readonly _provider: vscode.CompletionItemProvider,\n\t\tprivate readonly _apiDeprecation: IExtHostApiDeprecationService,\n\t\tprivate readonly _extension: IExtensionDescription,\n\t) { }\n\n\tasync provideCompletionItems(resource: URI, position: IPosition, context: modes.CompletionContext, token: CancellationToken): Promise<extHostProtocol.ISuggestResultDto | undefined> {\n\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\t// The default insert/replace ranges. It's important to compute them\n\t\t// before asynchronously asking the provider for its results. See\n\t\t// https://github.com/microsoft/vscode/issues/83400#issuecomment-546851421\n\t\tconst replaceRange = doc.getWordRangeAtPosition(pos) || new Range(pos, pos);\n\t\tconst insertRange = replaceRange.with({ end: pos });\n\n\t\tconst sw = new StopWatch(true);\n\t\tconst itemsOrList = await asPromise(() => this._provider.provideCompletionItems(doc, pos, token, typeConvert.CompletionContext.to(context)));\n\n\t\tif (!itemsOrList) {\n\t\t\t// undefined and null are valid results\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (token.isCancellationRequested) {\n\t\t\t// cancelled -> return without further ado, esp no caching\n\t\t\t// of results as they will leak\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst list = Array.isArray(itemsOrList) ? new CompletionList(itemsOrList) : itemsOrList;\n\n\t\t// keep result for providers that support resolving\n\t\tconst pid: number = SuggestAdapter.supportsResolving(this._provider) ? this._cache.add(list.items) : this._cache.add([]);\n\t\tconst disposables = new DisposableStore();\n\t\tthis._disposables.set(pid, disposables);\n\n\t\tconst completions: extHostProtocol.ISuggestDataDto[] = [];\n\t\tconst result: extHostProtocol.ISuggestResultDto = {\n\t\t\tx: pid,\n\t\t\t[extHostProtocol.ISuggestResultDtoField.completions]: completions,\n\t\t\t[extHostProtocol.ISuggestResultDtoField.defaultRanges]: { replace: typeConvert.Range.from(replaceRange), insert: typeConvert.Range.from(insertRange) },\n\t\t\t[extHostProtocol.ISuggestResultDtoField.isIncomplete]: list.isIncomplete || undefined,\n\t\t\t[extHostProtocol.ISuggestResultDtoField.duration]: sw.elapsed()\n\t\t};\n\n\t\tfor (let i = 0; i < list.items.length; i++) {\n\t\t\tconst item = list.items[i];\n\t\t\t// check for bad completion item first\n\t\t\tconst dto = this._convertCompletionItem(item, [pid, i], insertRange, replaceRange);\n\t\t\tcompletions.push(dto);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tasync resolveCompletionItem(id: extHostProtocol.ChainedCacheId, token: CancellationToken): Promise<extHostProtocol.ISuggestDataDto | undefined> {\n\n\t\tif (typeof this._provider.resolveCompletionItem !== 'function') {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst item = this._cache.get(...id);\n\t\tif (!item) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst resolvedItem = await asPromise(() => this._provider.resolveCompletionItem!(item, token));\n\n\t\tif (!resolvedItem) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn this._convertCompletionItem(resolvedItem, id);\n\t}\n\n\treleaseCompletionItems(id: number): any {\n\t\tthis._disposables.get(id)?.dispose();\n\t\tthis._disposables.delete(id);\n\t\tthis._cache.delete(id);\n\t}\n\n\tprivate _convertCompletionItem(item: vscode.CompletionItem, id: extHostProtocol.ChainedCacheId, defaultInsertRange?: vscode.Range, defaultReplaceRange?: vscode.Range): extHostProtocol.ISuggestDataDto {\n\n\t\tconst disposables = this._disposables.get(id[0]);\n\t\tif (!disposables) {\n\t\t\tthrow Error('DisposableStore is missing...');\n\t\t}\n\n\t\tconst result: extHostProtocol.ISuggestDataDto = {\n\t\t\t//\n\t\t\tx: id,\n\t\t\t//\n\t\t\t[extHostProtocol.ISuggestDataDtoField.label]: item.label ?? '',\n\t\t\t[extHostProtocol.ISuggestDataDtoField.label2]: item.label2,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.kind]: item.kind !== undefined ? typeConvert.CompletionItemKind.from(item.kind) : undefined,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.kindModifier]: item.tags && item.tags.map(typeConvert.CompletionItemTag.from),\n\t\t\t[extHostProtocol.ISuggestDataDtoField.detail]: item.detail,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.documentation]: typeof item.documentation === 'undefined' ? undefined : typeConvert.MarkdownString.fromStrict(item.documentation),\n\t\t\t[extHostProtocol.ISuggestDataDtoField.sortText]: item.sortText !== item.label ? item.sortText : undefined,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.filterText]: item.filterText !== item.label ? item.filterText : undefined,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.preselect]: item.preselect || undefined,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.insertTextRules]: item.keepWhitespace ? modes.CompletionItemInsertTextRule.KeepWhitespace : 0,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.commitCharacters]: item.commitCharacters,\n\t\t\t[extHostProtocol.ISuggestDataDtoField.additionalTextEdits]: item.additionalTextEdits && item.additionalTextEdits.map(typeConvert.TextEdit.from),\n\t\t\t[extHostProtocol.ISuggestDataDtoField.command]: this._commands.toInternal(item.command, disposables),\n\t\t};\n\n\t\t// 'insertText'-logic\n\t\tif (item.textEdit) {\n\t\t\tthis._apiDeprecation.report('CompletionItem.textEdit', this._extension, `Use 'CompletionItem.insertText' and 'CompletionItem.range' instead.`);\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.insertText] = item.textEdit.newText;\n\n\t\t} else if (typeof item.insertText === 'string') {\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.insertText] = item.insertText;\n\n\t\t} else if (item.insertText instanceof SnippetString) {\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.insertText] = item.insertText.value;\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.insertTextRules]! |= modes.CompletionItemInsertTextRule.InsertAsSnippet;\n\t\t}\n\n\t\t// 'overwrite[Before|After]'-logic\n\t\tlet range: vscode.Range | { inserting: vscode.Range, replacing: vscode.Range; } | undefined;\n\t\tif (item.textEdit) {\n\t\t\trange = item.textEdit.range;\n\t\t} else if (item.range) {\n\t\t\trange = item.range;\n\t\t}\n\n\t\tif (Range.isRange(range)) {\n\t\t\t// \"old\" range\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.range] = typeConvert.Range.from(range);\n\n\t\t} else if (range && (!defaultInsertRange?.isEqual(range.inserting) || !defaultReplaceRange?.isEqual(range.replacing))) {\n\t\t\t// ONLY send range when it's different from the default ranges (safe bandwidth)\n\t\t\tresult[extHostProtocol.ISuggestDataDtoField.range] = {\n\t\t\t\tinsert: typeConvert.Range.from(range.inserting),\n\t\t\t\treplace: typeConvert.Range.from(range.replacing)\n\t\t\t};\n\t\t}\n\n\t\treturn result;\n\t}\n}\n\nclass SignatureHelpAdapter {\n\n\tprivate readonly _cache = new Cache<vscode.SignatureHelp>('SignatureHelp');\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.SignatureHelpProvider,\n\t) { }\n\n\tprovideSignatureHelp(resource: URI, position: IPosition, context: extHostProtocol.ISignatureHelpContextDto, token: CancellationToken): Promise<extHostProtocol.ISignatureHelpDto | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\tconst pos = typeConvert.Position.to(position);\n\t\tconst vscodeContext = this.reviveContext(context);\n\n\t\treturn asPromise(() => this._provider.provideSignatureHelp(doc, pos, token, vscodeContext)).then(value => {\n\t\t\tif (value) {\n\t\t\t\tconst id = this._cache.add([value]);\n\t\t\t\treturn { ...typeConvert.SignatureHelp.from(value), id };\n\t\t\t}\n\t\t\treturn undefined;\n\t\t});\n\t}\n\n\tprivate reviveContext(context: extHostProtocol.ISignatureHelpContextDto): vscode.SignatureHelpContext {\n\t\tlet activeSignatureHelp: vscode.SignatureHelp | undefined = undefined;\n\t\tif (context.activeSignatureHelp) {\n\t\t\tconst revivedSignatureHelp = typeConvert.SignatureHelp.to(context.activeSignatureHelp);\n\t\t\tconst saved = this._cache.get(context.activeSignatureHelp.id, 0);\n\t\t\tif (saved) {\n\t\t\t\tactiveSignatureHelp = saved;\n\t\t\t\tactiveSignatureHelp.activeSignature = revivedSignatureHelp.activeSignature;\n\t\t\t\tactiveSignatureHelp.activeParameter = revivedSignatureHelp.activeParameter;\n\t\t\t} else {\n\t\t\t\tactiveSignatureHelp = revivedSignatureHelp;\n\t\t\t}\n\t\t}\n\t\treturn { ...context, activeSignatureHelp };\n\t}\n\n\treleaseSignatureHelp(id: number): any {\n\t\tthis._cache.delete(id);\n\t}\n}\n\nclass InlineHintsAdapter {\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.InlineHintsProvider,\n\t) { }\n\n\tprovideInlineHints(resource: URI, range: IRange, token: CancellationToken): Promise<extHostProtocol.IInlineHintsDto | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\treturn asPromise(() => this._provider.provideInlineHints(doc, typeConvert.Range.to(range), token)).then(value => {\n\t\t\treturn value ? { hints: value.map(typeConvert.InlineHint.from) } : undefined;\n\t\t});\n\t}\n}\n\nclass LinkProviderAdapter {\n\n\tprivate _cache = new Cache<vscode.DocumentLink>('DocumentLink');\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.DocumentLinkProvider\n\t) { }\n\n\tprovideLinks(resource: URI, token: CancellationToken): Promise<extHostProtocol.ILinksListDto | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\n\t\treturn asPromise(() => this._provider.provideDocumentLinks(doc, token)).then(links => {\n\t\t\tif (!Array.isArray(links) || links.length === 0) {\n\t\t\t\t// bad result\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\t// cancelled -> return without further ado, esp no caching\n\t\t\t\t// of results as they will leak\n\t\t\t\treturn undefined;\n\t\t\t}\n\n\t\t\tif (typeof this._provider.resolveDocumentLink !== 'function') {\n\t\t\t\t// no resolve -> no caching\n\t\t\t\treturn { links: links.map(typeConvert.DocumentLink.from) };\n\n\t\t\t} else {\n\t\t\t\t// cache links for future resolving\n\t\t\t\tconst pid = this._cache.add(links);\n\t\t\t\tconst result: extHostProtocol.ILinksListDto = { links: [], id: pid };\n\t\t\t\tfor (let i = 0; i < links.length; i++) {\n\t\t\t\t\tconst dto: extHostProtocol.ILinkDto = typeConvert.DocumentLink.from(links[i]);\n\t\t\t\t\tdto.cacheId = [pid, i];\n\t\t\t\t\tresult.links.push(dto);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t});\n\t}\n\n\tresolveLink(id: extHostProtocol.ChainedCacheId, token: CancellationToken): Promise<extHostProtocol.ILinkDto | undefined> {\n\t\tif (typeof this._provider.resolveDocumentLink !== 'function') {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\t\tconst item = this._cache.get(...id);\n\t\tif (!item) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\t\treturn asPromise(() => this._provider.resolveDocumentLink!(item, token)).then(value => {\n\t\t\treturn value && typeConvert.DocumentLink.from(value) || undefined;\n\t\t});\n\t}\n\n\treleaseLinks(id: number): any {\n\t\tthis._cache.delete(id);\n\t}\n}\n\nclass ColorProviderAdapter {\n\n\tconstructor(\n\t\tprivate _documents: ExtHostDocuments,\n\t\tprivate _provider: vscode.DocumentColorProvider\n\t) { }\n\n\tprovideColors(resource: URI, token: CancellationToken): Promise<extHostProtocol.IRawColorInfo[]> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\treturn asPromise(() => this._provider.provideDocumentColors(doc, token)).then(colors => {\n\t\t\tif (!Array.isArray(colors)) {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst colorInfos: extHostProtocol.IRawColorInfo[] = colors.map(ci => {\n\t\t\t\treturn {\n\t\t\t\t\tcolor: typeConvert.Color.from(ci.color),\n\t\t\t\t\trange: typeConvert.Range.from(ci.range)\n\t\t\t\t};\n\t\t\t});\n\n\t\t\treturn colorInfos;\n\t\t});\n\t}\n\n\tprovideColorPresentations(resource: URI, raw: extHostProtocol.IRawColorInfo, token: CancellationToken): Promise<modes.IColorPresentation[] | undefined> {\n\t\tconst document = this._documents.getDocument(resource);\n\t\tconst range = typeConvert.Range.to(raw.range);\n\t\tconst color = typeConvert.Color.to(raw.color);\n\t\treturn asPromise(() => this._provider.provideColorPresentations(color, { document, range }, token)).then(value => {\n\t\t\tif (!Array.isArray(value)) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn value.map(typeConvert.ColorPresentation.from);\n\t\t});\n\t}\n}\n\nclass FoldingProviderAdapter {\n\n\tconstructor(\n\t\tprivate _documents: ExtHostDocuments,\n\t\tprivate _provider: vscode.FoldingRangeProvider\n\t) { }\n\n\tprovideFoldingRanges(resource: URI, context: modes.FoldingContext, token: CancellationToken): Promise<modes.FoldingRange[] | undefined> {\n\t\tconst doc = this._documents.getDocument(resource);\n\t\treturn asPromise(() => this._provider.provideFoldingRanges(doc, context, token)).then(ranges => {\n\t\t\tif (!Array.isArray(ranges)) {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t\treturn ranges.map(typeConvert.FoldingRange.from);\n\t\t});\n\t}\n}\n\nclass SelectionRangeAdapter {\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.SelectionRangeProvider,\n\t\tprivate readonly _logService: ILogService\n\t) { }\n\n\tprovideSelectionRanges(resource: URI, pos: IPosition[], token: CancellationToken): Promise<modes.SelectionRange[][]> {\n\t\tconst document = this._documents.getDocument(resource);\n\t\tconst positions = pos.map(typeConvert.Position.to);\n\n\t\treturn asPromise(() => this._provider.provideSelectionRanges(document, positions, token)).then(allProviderRanges => {\n\t\t\tif (!isNonEmptyArray(allProviderRanges)) {\n\t\t\t\treturn [];\n\t\t\t}\n\t\t\tif (allProviderRanges.length !== positions.length) {\n\t\t\t\tthis._logService.warn('BAD selection ranges, provider must return ranges for each position');\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\tconst allResults: modes.SelectionRange[][] = [];\n\t\t\tfor (let i = 0; i < positions.length; i++) {\n\t\t\t\tconst oneResult: modes.SelectionRange[] = [];\n\t\t\t\tallResults.push(oneResult);\n\n\t\t\t\tlet last: vscode.Position | vscode.Range = positions[i];\n\t\t\t\tlet selectionRange = allProviderRanges[i];\n\n\t\t\t\twhile (true) {\n\t\t\t\t\tif (!selectionRange.range.contains(last)) {\n\t\t\t\t\t\tthrow new Error('INVALID selection range, must contain the previous range');\n\t\t\t\t\t}\n\t\t\t\t\toneResult.push(typeConvert.SelectionRange.from(selectionRange));\n\t\t\t\t\tif (!selectionRange.parent) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tlast = selectionRange.range;\n\t\t\t\t\tselectionRange = selectionRange.parent;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn allResults;\n\t\t});\n\t}\n}\n\nclass CallHierarchyAdapter {\n\n\tprivate readonly _idPool = new IdGenerator('');\n\tprivate readonly _cache = new Map<string, Map<string, vscode.CallHierarchyItem>>();\n\n\tconstructor(\n\t\tprivate readonly _documents: ExtHostDocuments,\n\t\tprivate readonly _provider: vscode.CallHierarchyProvider\n\t) { }\n\n\tasync prepareSession(uri: URI, position: IPosition, token: CancellationToken): Promise<extHostProtocol.ICallHierarchyItemDto[] | undefined> {\n\t\tconst doc = this._documents.getDocument(uri);\n\t\tconst pos = typeConvert.Position.to(position);\n\n\t\tconst items = await this._provider.prepareCallHierarchy(doc, pos, token);\n\t\tif (!items) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst sessionId = this._idPool.nextId();\n\t\tthis._cache.set(sessionId, new Map());\n\n\t\tif (Array.isArray(items)) {\n\t\t\treturn items.map(item => this._cacheAndConvertItem(sessionId, item));\n\t\t} else {\n\t\t\treturn [this._cacheAndConvertItem(sessionId, items)];\n\t\t}\n\t}\n\n\tasync provideCallsTo(sessionId: string, itemId: string, token: CancellationToken): Promise<extHostProtocol.IIncomingCallDto[] | undefined> {\n\t\tconst item = this._itemFromCache(sessionId, itemId);\n\t\tif (!item) {\n\t\t\tthrow new Error('missing call hierarchy item');\n\t\t}\n\t\tconst calls = await this._provider.provideCallHierarchyIncomingCalls(item, token);\n\t\tif (!calls) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn calls.map(call => {\n\t\t\treturn {\n\t\t\t\tfrom: this._cacheAndConvertItem(sessionId, call.from),\n\t\t\t\tfromRanges: call.fromRanges.map(r => typeConvert.Range.from(r))\n\t\t\t};\n\t\t});\n\t}\n\n\tasync provideCallsFrom(sessionId: string, itemId: string, token: CancellationToken): Promise<extHostProtocol.IOutgoingCallDto[] | undefined> {\n\t\tconst item = this._itemFromCache(sessionId, itemId);\n\t\tif (!item) {\n\t\t\tthrow new Error('missing call hierarchy item');\n\t\t}\n\t\tconst calls = await this._provider.provideCallHierarchyOutgoingCalls(item, token);\n\t\tif (!calls) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn calls.map(call => {\n\t\t\treturn {\n\t\t\t\tto: this._cacheAndConvertItem(sessionId, call.to),\n\t\t\t\tfromRanges: call.fromRanges.map(r => typeConvert.Range.from(r))\n\t\t\t};\n\t\t});\n\t}\n\n\treleaseSession(sessionId: string): void {\n\t\tthis._cache.delete(sessionId);\n\t}\n\n\tprivate _cacheAndConvertItem(sessionId: string, item: vscode.CallHierarchyItem): extHostProtocol.ICallHierarchyItemDto {\n\t\tconst map = this._cache.get(sessionId)!;\n\t\tconst dto: extHostProtocol.ICallHierarchyItemDto = {\n\t\t\t_sessionId: sessionId,\n\t\t\t_itemId: map.size.toString(36),\n\t\t\tname: item.name,\n\t\t\tdetail: item.detail,\n\t\t\tkind: typeConvert.SymbolKind.from(item.kind),\n\t\t\turi: item.uri,\n\t\t\trange: typeConvert.Range.from(item.range),\n\t\t\tselectionRange: typeConvert.Range.from(item.selectionRange),\n\t\t\ttags: item.tags?.map(typeConvert.SymbolTag.from)\n\t\t};\n\t\tmap.set(dto._itemId, item);\n\t\treturn dto;\n\t}\n\n\tprivate _itemFromCache(sessionId: string, itemId: string): vscode.CallHierarchyItem | undefined {\n\t\tconst map = this._cache.get(sessionId);\n\t\treturn map?.get(itemId);\n\t}\n}\n\ntype Adapter = DocumentSymbolAdapter | CodeLensAdapter | DefinitionAdapter | HoverAdapter\n\t| DocumentHighlightAdapter | ReferenceAdapter | CodeActionAdapter | DocumentFormattingAdapter\n\t| RangeFormattingAdapter | OnTypeFormattingAdapter | NavigateTypeAdapter | RenameAdapter\n\t| SuggestAdapter | SignatureHelpAdapter | LinkProviderAdapter | ImplementationAdapter\n\t| TypeDefinitionAdapter | ColorProviderAdapter | FoldingProviderAdapter | DeclarationAdapter\n\t| SelectionRangeAdapter | CallHierarchyAdapter | DocumentSemanticTokensAdapter | DocumentRangeSemanticTokensAdapter\n\t| EvaluatableExpressionAdapter | InlineValuesAdapter\n\t| LinkedEditingRangeAdapter | InlineHintsAdapter;\n\nclass AdapterData {\n\tconstructor(\n\t\treadonly adapter: Adapter,\n\t\treadonly extension: IExtensionDescription | undefined\n\t) { }\n}\n\nexport class ExtHostLanguageFeatures implements extHostProtocol.ExtHostLanguageFeaturesShape {\n\n\tprivate static _handlePool: number = 0;\n\n\tprivate readonly _uriTransformer: IURITransformer | null;\n\tprivate readonly _proxy: extHostProtocol.MainThreadLanguageFeaturesShape;\n\tprivate _documents: ExtHostDocuments;\n\tprivate _commands: ExtHostCommands;\n\tprivate _diagnostics: ExtHostDiagnostics;\n\tprivate _adapter = new Map<number, AdapterData>();\n\tprivate readonly _logService: ILogService;\n\tprivate readonly _apiDeprecation: IExtHostApiDeprecationService;\n\n\tconstructor(\n\t\tmainContext: extHostProtocol.IMainContext,\n\t\turiTransformer: IURITransformer | null,\n\t\tdocuments: ExtHostDocuments,\n\t\tcommands: ExtHostCommands,\n\t\tdiagnostics: ExtHostDiagnostics,\n\t\tlogService: ILogService,\n\t\tapiDeprecationService: IExtHostApiDeprecationService,\n\t) {\n\t\tthis._uriTransformer = uriTransformer;\n\t\tthis._proxy = mainContext.getProxy(extHostProtocol.MainContext.MainThreadLanguageFeatures);\n\t\tthis._documents = documents;\n\t\tthis._commands = commands;\n\t\tthis._diagnostics = diagnostics;\n\t\tthis._logService = logService;\n\t\tthis._apiDeprecation = apiDeprecationService;\n\t}\n\n\tprivate _transformDocumentSelector(selector: vscode.DocumentSelector): Array<extHostProtocol.IDocumentFilterDto> {\n\t\treturn coalesce(asArray(selector).map(sel => this._doTransformDocumentSelector(sel)));\n\t}\n\n\tprivate _doTransformDocumentSelector(selector: string | vscode.DocumentFilter): extHostProtocol.IDocumentFilterDto | undefined {\n\t\tif (typeof selector === 'string') {\n\t\t\treturn {\n\t\t\t\t$serialized: true,\n\t\t\t\tlanguage: selector\n\t\t\t};\n\t\t}\n\n\t\tif (selector) {\n\t\t\treturn {\n\t\t\t\t$serialized: true,\n\t\t\t\tlanguage: selector.language,\n\t\t\t\tscheme: this._transformScheme(selector.scheme),\n\t\t\t\tpattern: typeof selector.pattern === 'undefined' ? undefined : typeConvert.GlobPattern.from(selector.pattern),\n\t\t\t\texclusive: selector.exclusive\n\t\t\t};\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate _transformScheme(scheme: string | undefined): string | undefined {\n\t\tif (this._uriTransformer && typeof scheme === 'string') {\n\t\t\treturn this._uriTransformer.transformOutgoingScheme(scheme);\n\t\t}\n\t\treturn scheme;\n\t}\n\n\tprivate _createDisposable(handle: number): Disposable {\n\t\treturn new Disposable(() => {\n\t\t\tthis._adapter.delete(handle);\n\t\t\tthis._proxy.$unregister(handle);\n\t\t});\n\t}\n\n\tprivate _nextHandle(): number {\n\t\treturn ExtHostLanguageFeatures._handlePool++;\n\t}\n\n\tprivate _withAdapter<A, R>(handle: number, ctor: { new(...args: any[]): A; }, callback: (adapter: A, extension: IExtensionDescription | undefined) => Promise<R>, fallbackValue: R, allowCancellationError: boolean = false): Promise<R> {\n\t\tconst data = this._adapter.get(handle);\n\t\tif (!data) {\n\t\t\treturn Promise.resolve(fallbackValue);\n\t\t}\n\n\t\tif (data.adapter instanceof ctor) {\n\t\t\tlet t1: number;\n\t\t\tif (data.extension) {\n\t\t\t\tt1 = Date.now();\n\t\t\t\tthis._logService.trace(`[${data.extension.identifier.value}] INVOKE provider '${(ctor as any).name}'`);\n\t\t\t}\n\t\t\tconst p = callback(data.adapter, data.extension);\n\t\t\tconst extension = data.extension;\n\t\t\tif (extension) {\n\t\t\t\tPromise.resolve(p).then(\n\t\t\t\t\t() => this._logService.trace(`[${extension.identifier.value}] provider DONE after ${Date.now() - t1}ms`),\n\t\t\t\t\terr => {\n\t\t\t\t\t\tconst isExpectedError = allowCancellationError && (err instanceof CancellationError);\n\t\t\t\t\t\tif (!isExpectedError) {\n\t\t\t\t\t\t\tthis._logService.error(`[${extension.identifier.value}] provider FAILED`);\n\t\t\t\t\t\t\tthis._logService.error(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn p;\n\t\t}\n\t\treturn Promise.reject(new Error('no adapter found'));\n\t}\n\n\tprivate _addNewAdapter(adapter: Adapter, extension: IExtensionDescription | undefined): number {\n\t\tconst handle = this._nextHandle();\n\t\tthis._adapter.set(handle, new AdapterData(adapter, extension));\n\t\treturn handle;\n\t}\n\n\tprivate static _extLabel(ext: IExtensionDescription): string {\n\t\treturn ext.displayName || ext.name;\n\t}\n\n\t// --- outline\n\n\tregisterDocumentSymbolProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentSymbolProvider, metadata?: vscode.DocumentSymbolProviderMetadata): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new DocumentSymbolAdapter(this._documents, provider), extension);\n\t\tconst displayName = (metadata && metadata.label) || ExtHostLanguageFeatures._extLabel(extension);\n\t\tthis._proxy.$registerDocumentSymbolProvider(handle, this._transformDocumentSelector(selector), displayName);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentSymbols(handle: number, resource: UriComponents, token: CancellationToken): Promise<modes.DocumentSymbol[] | undefined> {\n\t\treturn this._withAdapter(handle, DocumentSymbolAdapter, adapter => adapter.provideDocumentSymbols(URI.revive(resource), token), undefined);\n\t}\n\n\t// --- code lens\n\n\tregisterCodeLensProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.CodeLensProvider): vscode.Disposable {\n\t\tconst handle = this._nextHandle();\n\t\tconst eventHandle = typeof provider.onDidChangeCodeLenses === 'function' ? this._nextHandle() : undefined;\n\n\t\tthis._adapter.set(handle, new AdapterData(new CodeLensAdapter(this._documents, this._commands.converter, provider), extension));\n\t\tthis._proxy.$registerCodeLensSupport(handle, this._transformDocumentSelector(selector), eventHandle);\n\t\tlet result = this._createDisposable(handle);\n\n\t\tif (eventHandle !== undefined) {\n\t\t\tconst subscription = provider.onDidChangeCodeLenses!(_ => this._proxy.$emitCodeLensEvent(eventHandle));\n\t\t\tresult = Disposable.from(result, subscription);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t$provideCodeLenses(handle: number, resource: UriComponents, token: CancellationToken): Promise<extHostProtocol.ICodeLensListDto | undefined> {\n\t\treturn this._withAdapter(handle, CodeLensAdapter, adapter => adapter.provideCodeLenses(URI.revive(resource), token), undefined);\n\t}\n\n\t$resolveCodeLens(handle: number, symbol: extHostProtocol.ICodeLensDto, token: CancellationToken): Promise<extHostProtocol.ICodeLensDto | undefined> {\n\t\treturn this._withAdapter(handle, CodeLensAdapter, adapter => adapter.resolveCodeLens(symbol, token), undefined);\n\t}\n\n\t$releaseCodeLenses(handle: number, cacheId: number): void {\n\t\tthis._withAdapter(handle, CodeLensAdapter, adapter => Promise.resolve(adapter.releaseCodeLenses(cacheId)), undefined);\n\t}\n\n\t// --- declaration\n\n\tregisterDefinitionProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DefinitionProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new DefinitionAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerDefinitionSupport(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDefinition(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<modes.LocationLink[]> {\n\t\treturn this._withAdapter(handle, DefinitionAdapter, adapter => adapter.provideDefinition(URI.revive(resource), position, token), []);\n\t}\n\n\tregisterDeclarationProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DeclarationProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new DeclarationAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerDeclarationSupport(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDeclaration(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<modes.LocationLink[]> {\n\t\treturn this._withAdapter(handle, DeclarationAdapter, adapter => adapter.provideDeclaration(URI.revive(resource), position, token), []);\n\t}\n\n\tregisterImplementationProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.ImplementationProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new ImplementationAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerImplementationSupport(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideImplementation(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<modes.LocationLink[]> {\n\t\treturn this._withAdapter(handle, ImplementationAdapter, adapter => adapter.provideImplementation(URI.revive(resource), position, token), []);\n\t}\n\n\tregisterTypeDefinitionProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.TypeDefinitionProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new TypeDefinitionAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerTypeDefinitionSupport(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideTypeDefinition(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<modes.LocationLink[]> {\n\t\treturn this._withAdapter(handle, TypeDefinitionAdapter, adapter => adapter.provideTypeDefinition(URI.revive(resource), position, token), []);\n\t}\n\n\t// --- extra info\n\n\tregisterHoverProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.HoverProvider, extensionId?: ExtensionIdentifier): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new HoverAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerHoverProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideHover(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<modes.Hover | undefined> {\n\t\treturn this._withAdapter(handle, HoverAdapter, adapter => adapter.provideHover(URI.revive(resource), position, token), undefined);\n\t}\n\n\t// --- debug hover\n\n\tregisterEvaluatableExpressionProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.EvaluatableExpressionProvider, extensionId?: ExtensionIdentifier): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new EvaluatableExpressionAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerEvaluatableExpressionProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideEvaluatableExpression(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<modes.EvaluatableExpression | undefined> {\n\t\treturn this._withAdapter(handle, EvaluatableExpressionAdapter, adapter => adapter.provideEvaluatableExpression(URI.revive(resource), position, token), undefined);\n\t}\n\n\t// --- debug inline values\n\n\tregisterInlineValuesProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.InlineValuesProvider, extensionId?: ExtensionIdentifier): vscode.Disposable {\n\n\t\tconst eventHandle = typeof provider.onDidChangeInlineValues === 'function' ? this._nextHandle() : undefined;\n\t\tconst handle = this._addNewAdapter(new InlineValuesAdapter(this._documents, provider), extension);\n\n\t\tthis._proxy.$registerInlineValuesProvider(handle, this._transformDocumentSelector(selector), eventHandle);\n\t\tlet result = this._createDisposable(handle);\n\n\t\tif (eventHandle !== undefined) {\n\t\t\tconst subscription = provider.onDidChangeInlineValues!(_ => this._proxy.$emitInlineValuesEvent(eventHandle));\n\t\t\tresult = Disposable.from(result, subscription);\n\t\t}\n\t\treturn result;\n\t}\n\n\t$provideInlineValues(handle: number, resource: UriComponents, range: IRange, context: extHostProtocol.IInlineValueContextDto, token: CancellationToken): Promise<modes.InlineValue[] | undefined> {\n\t\treturn this._withAdapter(handle, InlineValuesAdapter, adapter => adapter.provideInlineValues(URI.revive(resource), range, context, token), undefined);\n\t}\n\n\t// --- occurrences\n\n\tregisterDocumentHighlightProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentHighlightProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new DocumentHighlightAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerDocumentHighlightProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentHighlights(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<modes.DocumentHighlight[] | undefined> {\n\t\treturn this._withAdapter(handle, DocumentHighlightAdapter, adapter => adapter.provideDocumentHighlights(URI.revive(resource), position, token), undefined);\n\t}\n\n\t// --- linked editing\n\n\tregisterLinkedEditingRangeProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.LinkedEditingRangeProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new LinkedEditingRangeAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerLinkedEditingRangeProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideLinkedEditingRanges(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<extHostProtocol.ILinkedEditingRangesDto | undefined> {\n\t\treturn this._withAdapter(handle, LinkedEditingRangeAdapter, async adapter => {\n\t\t\tconst res = await adapter.provideLinkedEditingRanges(URI.revive(resource), position, token);\n\t\t\tif (res) {\n\t\t\t\treturn {\n\t\t\t\t\tranges: res.ranges,\n\t\t\t\t\twordPattern: res.wordPattern ? ExtHostLanguageFeatures._serializeRegExp(res.wordPattern) : undefined\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn undefined;\n\t\t}, undefined);\n\t}\n\n\t// --- references\n\n\tregisterReferenceProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.ReferenceProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new ReferenceAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerReferenceSupport(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideReferences(handle: number, resource: UriComponents, position: IPosition, context: modes.ReferenceContext, token: CancellationToken): Promise<modes.Location[] | undefined> {\n\t\treturn this._withAdapter(handle, ReferenceAdapter, adapter => adapter.provideReferences(URI.revive(resource), position, context, token), undefined);\n\t}\n\n\t// --- quick fix\n\n\tregisterCodeActionProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.CodeActionProvider, metadata?: vscode.CodeActionProviderMetadata): vscode.Disposable {\n\t\tconst store = new DisposableStore();\n\t\tconst handle = this._addNewAdapter(new CodeActionAdapter(this._documents, this._commands.converter, this._diagnostics, provider, this._logService, extension, this._apiDeprecation), extension);\n\t\tthis._proxy.$registerQuickFixSupport(handle, this._transformDocumentSelector(selector), {\n\t\t\tprovidedKinds: metadata?.providedCodeActionKinds?.map(kind => kind.value),\n\t\t\tdocumentation: metadata?.documentation?.map(x => ({\n\t\t\t\tkind: x.kind.value,\n\t\t\t\tcommand: this._commands.converter.toInternal(x.command, store),\n\t\t\t}))\n\t\t}, ExtHostLanguageFeatures._extLabel(extension), Boolean(provider.resolveCodeAction));\n\t\tstore.add(this._createDisposable(handle));\n\t\treturn store;\n\t}\n\n\n\t$provideCodeActions(handle: number, resource: UriComponents, rangeOrSelection: IRange | ISelection, context: modes.CodeActionContext, token: CancellationToken): Promise<extHostProtocol.ICodeActionListDto | undefined> {\n\t\treturn this._withAdapter(handle, CodeActionAdapter, adapter => adapter.provideCodeActions(URI.revive(resource), rangeOrSelection, context, token), undefined);\n\t}\n\n\t$resolveCodeAction(handle: number, id: extHostProtocol.ChainedCacheId, token: CancellationToken): Promise<extHostProtocol.IWorkspaceEditDto | undefined> {\n\t\treturn this._withAdapter(handle, CodeActionAdapter, adapter => adapter.resolveCodeAction(id, token), undefined);\n\t}\n\n\t$releaseCodeActions(handle: number, cacheId: number): void {\n\t\tthis._withAdapter(handle, CodeActionAdapter, adapter => Promise.resolve(adapter.releaseCodeActions(cacheId)), undefined);\n\t}\n\n\t// --- formatting\n\n\tregisterDocumentFormattingEditProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentFormattingEditProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new DocumentFormattingAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerDocumentFormattingSupport(handle, this._transformDocumentSelector(selector), extension.identifier, extension.displayName || extension.name);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentFormattingEdits(handle: number, resource: UriComponents, options: modes.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined> {\n\t\treturn this._withAdapter(handle, DocumentFormattingAdapter, adapter => adapter.provideDocumentFormattingEdits(URI.revive(resource), options, token), undefined);\n\t}\n\n\tregisterDocumentRangeFormattingEditProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentRangeFormattingEditProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new RangeFormattingAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerRangeFormattingSupport(handle, this._transformDocumentSelector(selector), extension.identifier, extension.displayName || extension.name);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentRangeFormattingEdits(handle: number, resource: UriComponents, range: IRange, options: modes.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined> {\n\t\treturn this._withAdapter(handle, RangeFormattingAdapter, adapter => adapter.provideDocumentRangeFormattingEdits(URI.revive(resource), range, options, token), undefined);\n\t}\n\n\tregisterOnTypeFormattingEditProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.OnTypeFormattingEditProvider, triggerCharacters: string[]): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new OnTypeFormattingAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerOnTypeFormattingSupport(handle, this._transformDocumentSelector(selector), triggerCharacters, extension.identifier);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideOnTypeFormattingEdits(handle: number, resource: UriComponents, position: IPosition, ch: string, options: modes.FormattingOptions, token: CancellationToken): Promise<ISingleEditOperation[] | undefined> {\n\t\treturn this._withAdapter(handle, OnTypeFormattingAdapter, adapter => adapter.provideOnTypeFormattingEdits(URI.revive(resource), position, ch, options, token), undefined);\n\t}\n\n\t// --- navigate types\n\n\tregisterWorkspaceSymbolProvider(extension: IExtensionDescription, provider: vscode.WorkspaceSymbolProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new NavigateTypeAdapter(provider, this._logService), extension);\n\t\tthis._proxy.$registerNavigateTypeSupport(handle);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideWorkspaceSymbols(handle: number, search: string, token: CancellationToken): Promise<extHostProtocol.IWorkspaceSymbolsDto> {\n\t\treturn this._withAdapter(handle, NavigateTypeAdapter, adapter => adapter.provideWorkspaceSymbols(search, token), { symbols: [] });\n\t}\n\n\t$resolveWorkspaceSymbol(handle: number, symbol: extHostProtocol.IWorkspaceSymbolDto, token: CancellationToken): Promise<extHostProtocol.IWorkspaceSymbolDto | undefined> {\n\t\treturn this._withAdapter(handle, NavigateTypeAdapter, adapter => adapter.resolveWorkspaceSymbol(symbol, token), undefined);\n\t}\n\n\t$releaseWorkspaceSymbols(handle: number, id: number): void {\n\t\tthis._withAdapter(handle, NavigateTypeAdapter, adapter => adapter.releaseWorkspaceSymbols(id), undefined);\n\t}\n\n\t// --- rename\n\n\tregisterRenameProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.RenameProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new RenameAdapter(this._documents, provider, this._logService), extension);\n\t\tthis._proxy.$registerRenameSupport(handle, this._transformDocumentSelector(selector), RenameAdapter.supportsResolving(provider));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideRenameEdits(handle: number, resource: UriComponents, position: IPosition, newName: string, token: CancellationToken): Promise<extHostProtocol.IWorkspaceEditDto | undefined> {\n\t\treturn this._withAdapter(handle, RenameAdapter, adapter => adapter.provideRenameEdits(URI.revive(resource), position, newName, token), undefined);\n\t}\n\n\t$resolveRenameLocation(handle: number, resource: URI, position: IPosition, token: CancellationToken): Promise<modes.RenameLocation | undefined> {\n\t\treturn this._withAdapter(handle, RenameAdapter, adapter => adapter.resolveRenameLocation(URI.revive(resource), position, token), undefined);\n\t}\n\n\t//#region semantic coloring\n\n\tregisterDocumentSemanticTokensProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentSemanticTokensProvider, legend: vscode.SemanticTokensLegend): vscode.Disposable {\n\t\tconst handle = this._nextHandle();\n\t\tconst eventHandle = (typeof provider.onDidChangeSemanticTokens === 'function' ? this._nextHandle() : undefined);\n\n\t\tthis._adapter.set(handle, new AdapterData(new DocumentSemanticTokensAdapter(this._documents, provider), extension));\n\t\tthis._proxy.$registerDocumentSemanticTokensProvider(handle, this._transformDocumentSelector(selector), legend, eventHandle);\n\t\tlet result = this._createDisposable(handle);\n\n\t\tif (eventHandle) {\n\t\t\tconst subscription = provider.onDidChangeSemanticTokens!(_ => this._proxy.$emitDocumentSemanticTokensEvent(eventHandle));\n\t\t\tresult = Disposable.from(result, subscription);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t$provideDocumentSemanticTokens(handle: number, resource: UriComponents, previousResultId: number, token: CancellationToken): Promise<VSBuffer | null> {\n\t\treturn this._withAdapter(handle, DocumentSemanticTokensAdapter, adapter => adapter.provideDocumentSemanticTokens(URI.revive(resource), previousResultId, token), null, true);\n\t}\n\n\t$releaseDocumentSemanticTokens(handle: number, semanticColoringResultId: number): void {\n\t\tthis._withAdapter(handle, DocumentSemanticTokensAdapter, adapter => adapter.releaseDocumentSemanticColoring(semanticColoringResultId), undefined);\n\t}\n\n\tregisterDocumentRangeSemanticTokensProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentRangeSemanticTokensProvider, legend: vscode.SemanticTokensLegend): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new DocumentRangeSemanticTokensAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerDocumentRangeSemanticTokensProvider(handle, this._transformDocumentSelector(selector), legend);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentRangeSemanticTokens(handle: number, resource: UriComponents, range: IRange, token: CancellationToken): Promise<VSBuffer | null> {\n\t\treturn this._withAdapter(handle, DocumentRangeSemanticTokensAdapter, adapter => adapter.provideDocumentRangeSemanticTokens(URI.revive(resource), range, token), null, true);\n\t}\n\n\t//#endregion\n\n\t// --- suggestion\n\n\tregisterCompletionItemProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.CompletionItemProvider, triggerCharacters: string[]): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new SuggestAdapter(this._documents, this._commands.converter, provider, this._apiDeprecation, extension), extension);\n\t\tthis._proxy.$registerSuggestSupport(handle, this._transformDocumentSelector(selector), triggerCharacters, SuggestAdapter.supportsResolving(provider), `${extension.identifier.value}(${triggerCharacters.join('')})`);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideCompletionItems(handle: number, resource: UriComponents, position: IPosition, context: modes.CompletionContext, token: CancellationToken): Promise<extHostProtocol.ISuggestResultDto | undefined> {\n\t\treturn this._withAdapter(handle, SuggestAdapter, adapter => adapter.provideCompletionItems(URI.revive(resource), position, context, token), undefined);\n\t}\n\n\t$resolveCompletionItem(handle: number, id: extHostProtocol.ChainedCacheId, token: CancellationToken): Promise<extHostProtocol.ISuggestDataDto | undefined> {\n\t\treturn this._withAdapter(handle, SuggestAdapter, adapter => adapter.resolveCompletionItem(id, token), undefined);\n\t}\n\n\t$releaseCompletionItems(handle: number, id: number): void {\n\t\tthis._withAdapter(handle, SuggestAdapter, adapter => adapter.releaseCompletionItems(id), undefined);\n\t}\n\n\t// --- parameter hints\n\n\tregisterSignatureHelpProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.SignatureHelpProvider, metadataOrTriggerChars: string[] | vscode.SignatureHelpProviderMetadata): vscode.Disposable {\n\t\tconst metadata: extHostProtocol.ISignatureHelpProviderMetadataDto | undefined = Array.isArray(metadataOrTriggerChars)\n\t\t\t? { triggerCharacters: metadataOrTriggerChars, retriggerCharacters: [] }\n\t\t\t: metadataOrTriggerChars;\n\n\t\tconst handle = this._addNewAdapter(new SignatureHelpAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerSignatureHelpProvider(handle, this._transformDocumentSelector(selector), metadata);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideSignatureHelp(handle: number, resource: UriComponents, position: IPosition, context: extHostProtocol.ISignatureHelpContextDto, token: CancellationToken): Promise<extHostProtocol.ISignatureHelpDto | undefined> {\n\t\treturn this._withAdapter(handle, SignatureHelpAdapter, adapter => adapter.provideSignatureHelp(URI.revive(resource), position, context, token), undefined);\n\t}\n\n\t$releaseSignatureHelp(handle: number, id: number): void {\n\t\tthis._withAdapter(handle, SignatureHelpAdapter, adapter => adapter.releaseSignatureHelp(id), undefined);\n\t}\n\n\t// --- inline hints\n\n\tregisterInlineHintsProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.InlineHintsProvider): vscode.Disposable {\n\n\t\tconst eventHandle = typeof provider.onDidChangeInlineHints === 'function' ? this._nextHandle() : undefined;\n\t\tconst handle = this._addNewAdapter(new InlineHintsAdapter(this._documents, provider), extension);\n\n\t\tthis._proxy.$registerInlineHintsProvider(handle, this._transformDocumentSelector(selector), eventHandle);\n\t\tlet result = this._createDisposable(handle);\n\n\t\tif (eventHandle !== undefined) {\n\t\t\tconst subscription = provider.onDidChangeInlineHints!(_ => this._proxy.$emitInlineHintsEvent(eventHandle));\n\t\t\tresult = Disposable.from(result, subscription);\n\t\t}\n\t\treturn result;\n\t}\n\n\t$provideInlineHints(handle: number, resource: UriComponents, range: IRange, token: CancellationToken): Promise<extHostProtocol.IInlineHintsDto | undefined> {\n\t\treturn this._withAdapter(handle, InlineHintsAdapter, adapter => adapter.provideInlineHints(URI.revive(resource), range, token), undefined);\n\t}\n\n\t// --- links\n\n\tregisterDocumentLinkProvider(extension: IExtensionDescription | undefined, selector: vscode.DocumentSelector, provider: vscode.DocumentLinkProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new LinkProviderAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerDocumentLinkProvider(handle, this._transformDocumentSelector(selector), typeof provider.resolveDocumentLink === 'function');\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentLinks(handle: number, resource: UriComponents, token: CancellationToken): Promise<extHostProtocol.ILinksListDto | undefined> {\n\t\treturn this._withAdapter(handle, LinkProviderAdapter, adapter => adapter.provideLinks(URI.revive(resource), token), undefined);\n\t}\n\n\t$resolveDocumentLink(handle: number, id: extHostProtocol.ChainedCacheId, token: CancellationToken): Promise<extHostProtocol.ILinkDto | undefined> {\n\t\treturn this._withAdapter(handle, LinkProviderAdapter, adapter => adapter.resolveLink(id, token), undefined);\n\t}\n\n\t$releaseDocumentLinks(handle: number, id: number): void {\n\t\tthis._withAdapter(handle, LinkProviderAdapter, adapter => adapter.releaseLinks(id), undefined);\n\t}\n\n\tregisterColorProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.DocumentColorProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new ColorProviderAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerDocumentColorProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideDocumentColors(handle: number, resource: UriComponents, token: CancellationToken): Promise<extHostProtocol.IRawColorInfo[]> {\n\t\treturn this._withAdapter(handle, ColorProviderAdapter, adapter => adapter.provideColors(URI.revive(resource), token), []);\n\t}\n\n\t$provideColorPresentations(handle: number, resource: UriComponents, colorInfo: extHostProtocol.IRawColorInfo, token: CancellationToken): Promise<modes.IColorPresentation[] | undefined> {\n\t\treturn this._withAdapter(handle, ColorProviderAdapter, adapter => adapter.provideColorPresentations(URI.revive(resource), colorInfo, token), undefined);\n\t}\n\n\tregisterFoldingRangeProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.FoldingRangeProvider): vscode.Disposable {\n\t\tconst handle = this._nextHandle();\n\t\tconst eventHandle = typeof provider.onDidChangeFoldingRanges === 'function' ? this._nextHandle() : undefined;\n\n\t\tthis._adapter.set(handle, new AdapterData(new FoldingProviderAdapter(this._documents, provider), extension));\n\t\tthis._proxy.$registerFoldingRangeProvider(handle, this._transformDocumentSelector(selector), eventHandle);\n\t\tlet result = this._createDisposable(handle);\n\n\t\tif (eventHandle !== undefined) {\n\t\t\tconst subscription = provider.onDidChangeFoldingRanges!(() => this._proxy.$emitFoldingRangeEvent(eventHandle));\n\t\t\tresult = Disposable.from(result, subscription);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\t$provideFoldingRanges(handle: number, resource: UriComponents, context: vscode.FoldingContext, token: CancellationToken): Promise<modes.FoldingRange[] | undefined> {\n\t\treturn this._withAdapter(handle, FoldingProviderAdapter, adapter => adapter.provideFoldingRanges(URI.revive(resource), context, token), undefined);\n\t}\n\n\t// --- smart select\n\n\tregisterSelectionRangeProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.SelectionRangeProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new SelectionRangeAdapter(this._documents, provider, this._logService), extension);\n\t\tthis._proxy.$registerSelectionRangeProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$provideSelectionRanges(handle: number, resource: UriComponents, positions: IPosition[], token: CancellationToken): Promise<modes.SelectionRange[][]> {\n\t\treturn this._withAdapter(handle, SelectionRangeAdapter, adapter => adapter.provideSelectionRanges(URI.revive(resource), positions, token), []);\n\t}\n\n\t// --- call hierarchy\n\n\tregisterCallHierarchyProvider(extension: IExtensionDescription, selector: vscode.DocumentSelector, provider: vscode.CallHierarchyProvider): vscode.Disposable {\n\t\tconst handle = this._addNewAdapter(new CallHierarchyAdapter(this._documents, provider), extension);\n\t\tthis._proxy.$registerCallHierarchyProvider(handle, this._transformDocumentSelector(selector));\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$prepareCallHierarchy(handle: number, resource: UriComponents, position: IPosition, token: CancellationToken): Promise<extHostProtocol.ICallHierarchyItemDto[] | undefined> {\n\t\treturn this._withAdapter(handle, CallHierarchyAdapter, adapter => Promise.resolve(adapter.prepareSession(URI.revive(resource), position, token)), undefined);\n\t}\n\n\t$provideCallHierarchyIncomingCalls(handle: number, sessionId: string, itemId: string, token: CancellationToken): Promise<extHostProtocol.IIncomingCallDto[] | undefined> {\n\t\treturn this._withAdapter(handle, CallHierarchyAdapter, adapter => adapter.provideCallsTo(sessionId, itemId, token), undefined);\n\t}\n\n\t$provideCallHierarchyOutgoingCalls(handle: number, sessionId: string, itemId: string, token: CancellationToken): Promise<extHostProtocol.IOutgoingCallDto[] | undefined> {\n\t\treturn this._withAdapter(handle, CallHierarchyAdapter, adapter => adapter.provideCallsFrom(sessionId, itemId, token), undefined);\n\t}\n\n\t$releaseCallHierarchy(handle: number, sessionId: string): void {\n\t\tthis._withAdapter(handle, CallHierarchyAdapter, adapter => Promise.resolve(adapter.releaseSession(sessionId)), undefined);\n\t}\n\n\t// --- configuration\n\n\tprivate static _serializeRegExp(regExp: RegExp): extHostProtocol.IRegExpDto {\n\t\treturn {\n\t\t\tpattern: regExp.source,\n\t\t\tflags: regExpFlags(regExp),\n\t\t};\n\t}\n\n\tprivate static _serializeIndentationRule(indentationRule: vscode.IndentationRule): extHostProtocol.IIndentationRuleDto {\n\t\treturn {\n\t\t\tdecreaseIndentPattern: ExtHostLanguageFeatures._serializeRegExp(indentationRule.decreaseIndentPattern),\n\t\t\tincreaseIndentPattern: ExtHostLanguageFeatures._serializeRegExp(indentationRule.increaseIndentPattern),\n\t\t\tindentNextLinePattern: indentationRule.indentNextLinePattern ? ExtHostLanguageFeatures._serializeRegExp(indentationRule.indentNextLinePattern) : undefined,\n\t\t\tunIndentedLinePattern: indentationRule.unIndentedLinePattern ? ExtHostLanguageFeatures._serializeRegExp(indentationRule.unIndentedLinePattern) : undefined,\n\t\t};\n\t}\n\n\tprivate static _serializeOnEnterRule(onEnterRule: vscode.OnEnterRule): extHostProtocol.IOnEnterRuleDto {\n\t\treturn {\n\t\t\tbeforeText: ExtHostLanguageFeatures._serializeRegExp(onEnterRule.beforeText),\n\t\t\tafterText: onEnterRule.afterText ? ExtHostLanguageFeatures._serializeRegExp(onEnterRule.afterText) : undefined,\n\t\t\tpreviousLineText: onEnterRule.previousLineText ? ExtHostLanguageFeatures._serializeRegExp(onEnterRule.previousLineText) : undefined,\n\t\t\taction: onEnterRule.action\n\t\t};\n\t}\n\n\tprivate static _serializeOnEnterRules(onEnterRules: vscode.OnEnterRule[]): extHostProtocol.IOnEnterRuleDto[] {\n\t\treturn onEnterRules.map(ExtHostLanguageFeatures._serializeOnEnterRule);\n\t}\n\n\tsetLanguageConfiguration(extension: IExtensionDescription, languageId: string, configuration: vscode.LanguageConfiguration): vscode.Disposable {\n\t\tlet { wordPattern } = configuration;\n\n\t\t// check for a valid word pattern\n\t\tif (wordPattern && regExpLeadsToEndlessLoop(wordPattern)) {\n\t\t\tthrow new Error(`Invalid language configuration: wordPattern '${wordPattern}' is not allowed to match the empty string.`);\n\t\t}\n\n\t\t// word definition\n\t\tif (wordPattern) {\n\t\t\tthis._documents.setWordDefinitionFor(languageId, wordPattern);\n\t\t} else {\n\t\t\tthis._documents.setWordDefinitionFor(languageId, undefined);\n\t\t}\n\n\t\tif (configuration.__electricCharacterSupport) {\n\t\t\tthis._apiDeprecation.report('LanguageConfiguration.__electricCharacterSupport', extension,\n\t\t\t\t`Do not use.`);\n\t\t}\n\n\t\tif (configuration.__characterPairSupport) {\n\t\t\tthis._apiDeprecation.report('LanguageConfiguration.__characterPairSupport', extension,\n\t\t\t\t`Do not use.`);\n\t\t}\n\n\t\tconst handle = this._nextHandle();\n\t\tconst serializedConfiguration: extHostProtocol.ILanguageConfigurationDto = {\n\t\t\tcomments: configuration.comments,\n\t\t\tbrackets: configuration.brackets,\n\t\t\twordPattern: configuration.wordPattern ? ExtHostLanguageFeatures._serializeRegExp(configuration.wordPattern) : undefined,\n\t\t\tindentationRules: configuration.indentationRules ? ExtHostLanguageFeatures._serializeIndentationRule(configuration.indentationRules) : undefined,\n\t\t\tonEnterRules: configuration.onEnterRules ? ExtHostLanguageFeatures._serializeOnEnterRules(configuration.onEnterRules) : undefined,\n\t\t\t__electricCharacterSupport: configuration.__electricCharacterSupport,\n\t\t\t__characterPairSupport: configuration.__characterPairSupport,\n\t\t};\n\t\tthis._proxy.$setLanguageConfiguration(handle, languageId, serializedConfiguration);\n\t\treturn this._createDisposable(handle);\n\t}\n\n\t$setWordDefinitions(wordDefinitions: extHostProtocol.ILanguageWordDefinitionDto[]): void {\n\t\tfor (const wordDefinition of wordDefinitions) {\n\t\t\tthis._documents.setWordDefinitionFor(wordDefinition.languageId, new RegExp(wordDefinition.regexSource, wordDefinition.regexFlags));\n\t\t}\n\t}\n}\n"]}