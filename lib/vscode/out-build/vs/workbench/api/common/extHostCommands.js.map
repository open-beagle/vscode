{"version":3,"file":"extHostCommands.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/api/common/extHostCommands.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { validateConstraint } from 'vs/base/common/types';\nimport { ICommandHandlerDescription } from 'vs/platform/commands/common/commands';\nimport * as extHostTypes from 'vs/workbench/api/common/extHostTypes';\nimport * as extHostTypeConverter from 'vs/workbench/api/common/extHostTypeConverters';\nimport { cloneAndChange } from 'vs/base/common/objects';\nimport { MainContext, MainThreadCommandsShape, ExtHostCommandsShape, ObjectIdentifier, ICommandDto } from './extHost.protocol';\nimport { isNonEmptyArray } from 'vs/base/common/arrays';\nimport * as modes from 'vs/editor/common/modes';\nimport type * as vscode from 'vscode';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { revive } from 'vs/base/common/marshalling';\nimport { IRange, Range } from 'vs/editor/common/core/range';\nimport { IPosition, Position } from 'vs/editor/common/core/position';\nimport { URI } from 'vs/base/common/uri';\nimport { DisposableStore, toDisposable } from 'vs/base/common/lifecycle';\nimport { createDecorator } from 'vs/platform/instantiation/common/instantiation';\nimport { IExtHostRpcService } from 'vs/workbench/api/common/extHostRpcService';\nimport { ISelection } from 'vs/editor/common/core/selection';\n\ninterface CommandHandler {\n\tcallback: Function;\n\tthisArg: any;\n\tdescription?: ICommandHandlerDescription;\n}\n\nexport interface ArgumentProcessor {\n\tprocessArgument(arg: any): any;\n}\n\nexport class ExtHostCommands implements ExtHostCommandsShape {\n\n\treadonly _serviceBrand: undefined;\n\n\tprivate readonly _commands = new Map<string, CommandHandler>();\n\tprivate readonly _apiCommands = new Map<string, ApiCommand>();\n\n\tprivate readonly _proxy: MainThreadCommandsShape;\n\tprivate readonly _logService: ILogService;\n\tprivate readonly _argumentProcessors: ArgumentProcessor[];\n\n\treadonly converter: CommandsConverter;\n\n\tconstructor(\n\t\t@IExtHostRpcService extHostRpc: IExtHostRpcService,\n\t\t@ILogService logService: ILogService\n\t) {\n\t\tthis._proxy = extHostRpc.getProxy(MainContext.MainThreadCommands);\n\t\tthis._logService = logService;\n\t\tthis.converter = new CommandsConverter(\n\t\t\tthis,\n\t\t\tid => {\n\t\t\t\t// API commands that have no return type (void) can be\n\t\t\t\t// converted to their internal command and don't need\n\t\t\t\t// any indirection commands\n\t\t\t\tconst candidate = this._apiCommands.get(id);\n\t\t\t\treturn candidate?.result === ApiCommandResult.Void\n\t\t\t\t\t? candidate : undefined;\n\t\t\t},\n\t\t\tlogService\n\t\t);\n\t\tthis._argumentProcessors = [\n\t\t\t{\n\t\t\t\tprocessArgument(a) {\n\t\t\t\t\t// URI, Regex\n\t\t\t\t\treturn revive(a);\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tprocessArgument(arg) {\n\t\t\t\t\treturn cloneAndChange(arg, function (obj) {\n\t\t\t\t\t\t// Reverse of https://github.com/microsoft/vscode/blob/1f28c5fc681f4c01226460b6d1c7e91b8acb4a5b/src/vs/workbench/api/node/extHostCommands.ts#L112-L127\n\t\t\t\t\t\tif (Range.isIRange(obj)) {\n\t\t\t\t\t\t\treturn extHostTypeConverter.Range.to(obj);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (Position.isIPosition(obj)) {\n\t\t\t\t\t\t\treturn extHostTypeConverter.Position.to(obj);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (Range.isIRange((obj as modes.Location).range) && URI.isUri((obj as modes.Location).uri)) {\n\t\t\t\t\t\t\treturn extHostTypeConverter.location.to(obj);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!Array.isArray(obj)) {\n\t\t\t\t\t\t\treturn obj;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t}\n\n\tregisterArgumentProcessor(processor: ArgumentProcessor): void {\n\t\tthis._argumentProcessors.push(processor);\n\t}\n\n\tregisterApiCommand(apiCommand: ApiCommand): extHostTypes.Disposable {\n\n\n\t\tconst registration = this.registerCommand(false, apiCommand.id, async (...apiArgs) => {\n\n\t\t\tconst internalArgs = apiCommand.args.map((arg, i) => {\n\t\t\t\tif (!arg.validate(apiArgs[i])) {\n\t\t\t\t\tthrow new Error(`Invalid argument '${arg.name}' when running '${apiCommand.id}', received: ${apiArgs[i]}`);\n\t\t\t\t}\n\t\t\t\treturn arg.convert(apiArgs[i]);\n\t\t\t});\n\n\t\t\tconst internalResult = await this.executeCommand(apiCommand.internalId, ...internalArgs);\n\t\t\treturn apiCommand.result.convert(internalResult, apiArgs, this.converter);\n\t\t}, undefined, {\n\t\t\tdescription: apiCommand.description,\n\t\t\targs: apiCommand.args,\n\t\t\treturns: apiCommand.result.description\n\t\t});\n\n\t\tthis._apiCommands.set(apiCommand.id, apiCommand);\n\n\t\treturn new extHostTypes.Disposable(() => {\n\t\t\tregistration.dispose();\n\t\t\tthis._apiCommands.delete(apiCommand.id);\n\t\t});\n\t}\n\n\tregisterCommand(global: boolean, id: string, callback: <T>(...args: any[]) => T | Thenable<T>, thisArg?: any, description?: ICommandHandlerDescription): extHostTypes.Disposable {\n\t\tthis._logService.trace('ExtHostCommands#registerCommand', id);\n\n\t\tif (!id.trim().length) {\n\t\t\tthrow new Error('invalid id');\n\t\t}\n\n\t\tif (this._commands.has(id)) {\n\t\t\tthrow new Error(`command '${id}' already exists`);\n\t\t}\n\n\t\tthis._commands.set(id, { callback, thisArg, description });\n\t\tif (global) {\n\t\t\tthis._proxy.$registerCommand(id);\n\t\t}\n\n\t\treturn new extHostTypes.Disposable(() => {\n\t\t\tif (this._commands.delete(id)) {\n\t\t\t\tif (global) {\n\t\t\t\t\tthis._proxy.$unregisterCommand(id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\texecuteCommand<T>(id: string, ...args: any[]): Promise<T> {\n\t\tthis._logService.trace('ExtHostCommands#executeCommand', id);\n\t\treturn this._doExecuteCommand(id, args, true);\n\t}\n\n\tprivate async _doExecuteCommand<T>(id: string, args: any[], retry: boolean): Promise<T> {\n\n\t\tif (this._commands.has(id)) {\n\t\t\t// we stay inside the extension host and support\n\t\t\t// to pass any kind of parameters around\n\t\t\treturn this._executeContributedCommand<T>(id, args);\n\n\t\t} else {\n\t\t\t// automagically convert some argument types\n\t\t\tconst toArgs = cloneAndChange(args, function (value) {\n\t\t\t\tif (value instanceof extHostTypes.Position) {\n\t\t\t\t\treturn extHostTypeConverter.Position.from(value);\n\t\t\t\t}\n\t\t\t\tif (value instanceof extHostTypes.Range) {\n\t\t\t\t\treturn extHostTypeConverter.Range.from(value);\n\t\t\t\t}\n\t\t\t\tif (value instanceof extHostTypes.Location) {\n\t\t\t\t\treturn extHostTypeConverter.location.from(value);\n\t\t\t\t}\n\t\t\t\tif (!Array.isArray(value)) {\n\t\t\t\t\treturn value;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\ttry {\n\t\t\t\tconst result = await this._proxy.$executeCommand<T>(id, toArgs, retry);\n\t\t\t\treturn revive<any>(result);\n\t\t\t} catch (e) {\n\t\t\t\t// Rerun the command when it wasn't known, had arguments, and when retry\n\t\t\t\t// is enabled. We do this because the command might be registered inside\n\t\t\t\t// the extension host now and can therfore accept the arguments as-is.\n\t\t\t\tif (e instanceof Error && e.message === '$executeCommand:retry') {\n\t\t\t\t\treturn this._doExecuteCommand(id, args, false);\n\t\t\t\t} else {\n\t\t\t\t\tthrow e;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async _executeContributedCommand<T>(id: string, args: any[]): Promise<T> {\n\t\tconst command = this._commands.get(id);\n\t\tif (!command) {\n\t\t\tthrow new Error('Unknown command');\n\t\t}\n\t\tlet { callback, thisArg, description } = command;\n\t\tif (description) {\n\t\t\tfor (let i = 0; i < description.args.length; i++) {\n\t\t\t\ttry {\n\t\t\t\t\tvalidateConstraint(args[i], description.args[i].constraint);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tthrow new Error(`Running the contributed command: '${id}' failed. Illegal argument '${description.args[i].name}' - ${description.args[i].description}`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\ttry {\n\t\t\treturn await callback.apply(thisArg, args);\n\t\t} catch (err) {\n\t\t\t// The indirection-command from the converter can fail when invoking the actual\n\t\t\t// command and in that case it is better to blame the correct command\n\t\t\tif (id === this.converter.delegatingCommandId) {\n\t\t\t\tconst actual = this.converter.getActualCommand(...args);\n\t\t\t\tif (actual) {\n\t\t\t\t\tid = actual.command;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._logService.error(err, id);\n\t\t\tthrow new Error(`Running the contributed command: '${id}' failed.`);\n\t\t}\n\t}\n\n\t$executeContributedCommand<T>(id: string, ...args: any[]): Promise<T> {\n\t\tthis._logService.trace('ExtHostCommands#$executeContributedCommand', id);\n\n\t\tif (!this._commands.has(id)) {\n\t\t\treturn Promise.reject(new Error(`Contributed command '${id}' does not exist.`));\n\t\t} else {\n\t\t\targs = args.map(arg => this._argumentProcessors.reduce((r, p) => p.processArgument(r), arg));\n\t\t\treturn this._executeContributedCommand(id, args);\n\t\t}\n\t}\n\n\tgetCommands(filterUnderscoreCommands: boolean = false): Promise<string[]> {\n\t\tthis._logService.trace('ExtHostCommands#getCommands', filterUnderscoreCommands);\n\n\t\treturn this._proxy.$getCommands().then(result => {\n\t\t\tif (filterUnderscoreCommands) {\n\t\t\t\tresult = result.filter(command => command[0] !== '_');\n\t\t\t}\n\t\t\treturn result;\n\t\t});\n\t}\n\n\t$getContributedCommandHandlerDescriptions(): Promise<{ [id: string]: string | ICommandHandlerDescription }> {\n\t\tconst result: { [id: string]: string | ICommandHandlerDescription } = Object.create(null);\n\t\tfor (let [id, command] of this._commands) {\n\t\t\tlet { description } = command;\n\t\t\tif (description) {\n\t\t\t\tresult[id] = description;\n\t\t\t}\n\t\t}\n\t\treturn Promise.resolve(result);\n\t}\n}\n\nexport interface IExtHostCommands extends ExtHostCommands { }\nexport const IExtHostCommands = createDecorator<IExtHostCommands>('IExtHostCommands');\n\nexport class CommandsConverter {\n\n\treadonly delegatingCommandId: string = `_vscode_delegate_cmd_${Date.now().toString(36)}`;\n\tprivate readonly _cache = new Map<number, vscode.Command>();\n\tprivate _cachIdPool = 0;\n\n\t// --- conversion between internal and api commands\n\tconstructor(\n\t\tprivate readonly _commands: ExtHostCommands,\n\t\tprivate readonly _lookupApiCommand: (id: string) => ApiCommand | undefined,\n\t\tprivate readonly _logService: ILogService\n\t) {\n\t\tthis._commands.registerCommand(true, this.delegatingCommandId, this._executeConvertedCommand, this);\n\t}\n\n\ttoInternal(command: vscode.Command, disposables: DisposableStore): ICommandDto;\n\ttoInternal(command: vscode.Command | undefined, disposables: DisposableStore): ICommandDto | undefined;\n\ttoInternal(command: vscode.Command | undefined, disposables: DisposableStore): ICommandDto | undefined {\n\n\t\tif (!command) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst result: ICommandDto = {\n\t\t\t$ident: undefined,\n\t\t\tid: command.command,\n\t\t\ttitle: command.title,\n\t\t\ttooltip: command.tooltip\n\t\t};\n\n\t\tif (!command.command) {\n\t\t\t// falsy command id -> return converted command but don't attempt any\n\t\t\t// argument or API-command dance since this command won't run anyways\n\t\t\treturn result;\n\t\t}\n\n\t\tconst apiCommand = this._lookupApiCommand(command.command);\n\t\tif (apiCommand) {\n\t\t\t// API command with return-value can be converted inplace\n\t\t\tresult.id = apiCommand.internalId;\n\t\t\tresult.arguments = apiCommand.args.map((arg, i) => arg.convert(command.arguments && command.arguments[i]));\n\n\n\t\t} else if (isNonEmptyArray(command.arguments)) {\n\t\t\t// we have a contributed command with arguments. that\n\t\t\t// means we don't want to send the arguments around\n\n\t\t\tconst id = ++this._cachIdPool;\n\t\t\tthis._cache.set(id, command);\n\t\t\tdisposables.add(toDisposable(() => {\n\t\t\t\tthis._cache.delete(id);\n\t\t\t\tthis._logService.trace('CommandsConverter#DISPOSE', id);\n\t\t\t}));\n\t\t\tresult.$ident = id;\n\n\t\t\tresult.id = this.delegatingCommandId;\n\t\t\tresult.arguments = [id];\n\n\t\t\tthis._logService.trace('CommandsConverter#CREATE', command.command, id);\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tfromInternal(command: modes.Command): vscode.Command | undefined {\n\n\t\tconst id = ObjectIdentifier.of(command);\n\t\tif (typeof id === 'number') {\n\t\t\treturn this._cache.get(id);\n\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tcommand: command.id,\n\t\t\t\ttitle: command.title,\n\t\t\t\targuments: command.arguments\n\t\t\t};\n\t\t}\n\t}\n\n\n\tgetActualCommand(...args: any[]): vscode.Command | undefined {\n\t\treturn this._cache.get(args[0]);\n\t}\n\n\tprivate _executeConvertedCommand<R>(...args: any[]): Promise<R> {\n\t\tconst actualCmd = this.getActualCommand(...args);\n\t\tthis._logService.trace('CommandsConverter#EXECUTE', args[0], actualCmd ? actualCmd.command : 'MISSING');\n\n\t\tif (!actualCmd) {\n\t\t\treturn Promise.reject('actual command NOT FOUND');\n\t\t}\n\t\treturn this._commands.executeCommand(actualCmd.command, ...(actualCmd.arguments || []));\n\t}\n\n}\n\n\nexport class ApiCommandArgument<V, O = V> {\n\n\tstatic readonly Uri = new ApiCommandArgument<URI>('uri', 'Uri of a text document', v => URI.isUri(v), v => v);\n\tstatic readonly Position = new ApiCommandArgument<extHostTypes.Position, IPosition>('position', 'A position in a text document', v => extHostTypes.Position.isPosition(v), extHostTypeConverter.Position.from);\n\tstatic readonly Range = new ApiCommandArgument<extHostTypes.Range, IRange>('range', 'A range in a text document', v => extHostTypes.Range.isRange(v), extHostTypeConverter.Range.from);\n\tstatic readonly Selection = new ApiCommandArgument<extHostTypes.Selection, ISelection>('selection', 'A selection in a text document', v => extHostTypes.Selection.isSelection(v), extHostTypeConverter.Selection.from);\n\tstatic readonly Number = new ApiCommandArgument<number>('number', '', v => typeof v === 'number', v => v);\n\tstatic readonly String = new ApiCommandArgument<string>('string', '', v => typeof v === 'string', v => v);\n\n\tstatic readonly CallHierarchyItem = new ApiCommandArgument('item', 'A call hierarchy item', v => v instanceof extHostTypes.CallHierarchyItem, extHostTypeConverter.CallHierarchyItem.to);\n\n\tconstructor(\n\t\treadonly name: string,\n\t\treadonly description: string,\n\t\treadonly validate: (v: V) => boolean,\n\t\treadonly convert: (v: V) => O\n\t) { }\n\n\toptional(): ApiCommandArgument<V | undefined | null, O | undefined | null> {\n\t\treturn new ApiCommandArgument(\n\t\t\tthis.name, `(optional) ${this.description}`,\n\t\t\tvalue => value === undefined || value === null || this.validate(value),\n\t\t\tvalue => value === undefined ? undefined : value === null ? null : this.convert(value)\n\t\t);\n\t}\n\n\twith(name: string | undefined, description: string | undefined): ApiCommandArgument<V, O> {\n\t\treturn new ApiCommandArgument(name ?? this.name, description ?? this.description, this.validate, this.convert);\n\t}\n}\n\nexport class ApiCommandResult<V, O = V> {\n\n\tstatic readonly Void = new ApiCommandResult<void, void>('no result', v => v);\n\n\tconstructor(\n\t\treadonly description: string,\n\t\treadonly convert: (v: V, apiArgs: any[], cmdConverter: CommandsConverter) => O\n\t) { }\n}\n\nexport class ApiCommand {\n\n\tconstructor(\n\t\treadonly id: string,\n\t\treadonly internalId: string,\n\t\treadonly description: string,\n\t\treadonly args: ApiCommandArgument<any, any>[],\n\t\treadonly result: ApiCommandResult<any, any>\n\t) { }\n}\n"]}