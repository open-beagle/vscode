{"version":3,"file":"terminalProtocolLinkProvider.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/contrib/terminal/browser/links/terminalProtocolLinkProvider.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport type { Terminal, IViewportRange, IBufferLine } from 'xterm';\nimport { ILinkComputerTarget, LinkComputer } from 'vs/editor/common/modes/linkComputer';\nimport { getXtermLineContent, convertLinkRangeToBuffer } from 'vs/workbench/contrib/terminal/browser/links/terminalLinkHelpers';\nimport { TerminalLink, OPEN_FILE_LABEL } from 'vs/workbench/contrib/terminal/browser/links/terminalLink';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { URI } from 'vs/base/common/uri';\nimport { TerminalBaseLinkProvider } from 'vs/workbench/contrib/terminal/browser/links/terminalBaseLinkProvider';\nimport { Schemas } from 'vs/base/common/network';\n\nexport class TerminalProtocolLinkProvider extends TerminalBaseLinkProvider {\n\tprivate _linkComputerTarget: ILinkComputerTarget | undefined;\n\n\tconstructor(\n\t\tprivate readonly _xterm: Terminal,\n\t\tprivate readonly _activateCallback: (event: MouseEvent | undefined, uri: string) => void,\n\t\tprivate readonly _tooltipCallback: (link: TerminalLink, viewportRange: IViewportRange, modifierDownCallback?: () => void, modifierUpCallback?: () => void) => void,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService\n\t) {\n\t\tsuper();\n\t}\n\n\tprotected _provideLinks(y: number): TerminalLink[] {\n\t\tlet startLine = y - 1;\n\t\tlet endLine = startLine;\n\n\t\tconst lines: IBufferLine[] = [\n\t\t\tthis._xterm.buffer.active.getLine(startLine)!\n\t\t];\n\n\t\twhile (startLine >= 0 && this._xterm.buffer.active.getLine(startLine)?.isWrapped) {\n\t\t\tlines.unshift(this._xterm.buffer.active.getLine(startLine - 1)!);\n\t\t\tstartLine--;\n\t\t}\n\n\t\twhile (endLine < this._xterm.buffer.active.length && this._xterm.buffer.active.getLine(endLine + 1)?.isWrapped) {\n\t\t\tlines.push(this._xterm.buffer.active.getLine(endLine + 1)!);\n\t\t\tendLine++;\n\t\t}\n\n\t\tthis._linkComputerTarget = new TerminalLinkAdapter(this._xterm, startLine, endLine);\n\t\tconst links = LinkComputer.computeLinks(this._linkComputerTarget);\n\n\t\treturn links.map(link => {\n\t\t\tconst range = convertLinkRangeToBuffer(lines, this._xterm.cols, link.range, startLine);\n\n\t\t\t// Check if the link if within the mouse position\n\t\t\tconst uri = link.url\n\t\t\t\t? (typeof link.url === 'string' ? URI.parse(link.url) : link.url)\n\t\t\t\t: undefined;\n\t\t\tconst label = (uri?.scheme === Schemas.file) ? OPEN_FILE_LABEL : undefined;\n\t\t\treturn this._instantiationService.createInstance(TerminalLink, this._xterm, range, link.url?.toString() || '', this._xterm.buffer.active.viewportY, this._activateCallback, this._tooltipCallback, true, label);\n\t\t});\n\t}\n}\n\nclass TerminalLinkAdapter implements ILinkComputerTarget {\n\tconstructor(\n\t\tprivate _xterm: Terminal,\n\t\tprivate _lineStart: number,\n\t\tprivate _lineEnd: number\n\t) { }\n\n\tgetLineCount(): number {\n\t\treturn 1;\n\t}\n\n\tgetLineContent(): string {\n\t\treturn getXtermLineContent(this._xterm.buffer.active, this._lineStart, this._lineEnd, this._xterm.cols);\n\t}\n}\n"]}