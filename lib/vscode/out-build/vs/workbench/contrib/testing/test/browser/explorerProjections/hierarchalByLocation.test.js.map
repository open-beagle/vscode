{"version":3,"file":"hierarchalByLocation.test.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/contrib/testing/test/browser/explorerProjections/hierarchalByLocation.test.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { HierarchicalByLocationProjection } from 'vs/workbench/contrib/testing/browser/explorerProjections/hierarchalByLocation';\nimport { testStubs } from 'vs/workbench/contrib/testing/common/testStubs';\nimport { makeTestWorkspaceFolder, TestTreeTestHarness } from 'vs/workbench/contrib/testing/test/browser/testObjectTree';\n\nclass TestHierarchicalByLocationProjection extends HierarchicalByLocationProjection {\n\tpublic get folderNodes() {\n\t\treturn [...this.folders.values()];\n\t}\n}\n\nsuite('Workbench - Testing Explorer Hierarchal by Location Projection', () => {\n\tlet harness: TestTreeTestHarness<TestHierarchicalByLocationProjection>;\n\tconst folder1 = makeTestWorkspaceFolder('f1');\n\tconst folder2 = makeTestWorkspaceFolder('f2');\n\tsetup(() => {\n\t\tharness = new TestTreeTestHarness([folder1, folder2], l => new TestHierarchicalByLocationProjection(l, {\n\t\t\tonResultsChanged: () => undefined,\n\t\t\tonTestChanged: () => undefined,\n\t\t\tgetStateById: () => ({ state: { state: 0 }, computedState: 0 }),\n\t\t} as any));\n\t});\n\n\tteardown(() => {\n\t\tharness.dispose();\n\t});\n\n\ttest('renders initial tree', async () => {\n\t\tharness.c.addRoot(testStubs.nested(), 'a');\n\t\tharness.flush(folder1);\n\t\tassert.deepStrictEqual(harness.tree.getRendered(), [\n\t\t\t{ e: 'a' }, { e: 'b' }\n\t\t]);\n\t});\n\n\ttest('expands children', async () => {\n\t\tharness.c.addRoot(testStubs.nested(), 'a');\n\t\tharness.flush(folder1);\n\t\tharness.tree.expand(harness.projection.getElementByTestId('id-a')!);\n\t\tassert.deepStrictEqual(harness.flush(folder1), [\n\t\t\t{ e: 'a', children: [{ e: 'aa' }, { e: 'ab' }] }, { e: 'b' }\n\t\t]);\n\t});\n\n\ttest('updates render if a second folder is added', async () => {\n\t\tharness.c.addRoot(testStubs.nested('id1-'), 'a');\n\t\tharness.flush(folder1);\n\t\tharness.c.addRoot(testStubs.nested('id2-'), 'a');\n\t\tharness.flush(folder2);\n\t\tassert.deepStrictEqual(harness.tree.getRendered(), [\n\t\t\t{ e: 'f1', children: [{ e: 'a' }, { e: 'b' }] },\n\t\t\t{ e: 'f2', children: [{ e: 'a' }, { e: 'b' }] },\n\t\t]);\n\n\t\tharness.tree.expand(harness.projection.getElementByTestId('id1-a')!);\n\t\tassert.deepStrictEqual(harness.flush(folder1), [\n\t\t\t{ e: 'f1', children: [{ e: 'a', children: [{ e: 'aa' }, { e: 'ab' }] }, { e: 'b' }] },\n\t\t\t{ e: 'f2', children: [{ e: 'a' }, { e: 'b' }] },\n\t\t]);\n\t});\n\n\ttest('updates render if second folder is removed', async () => {\n\t\tharness.c.addRoot(testStubs.nested('id1-'), 'a');\n\t\tharness.flush(folder1);\n\t\tharness.c.addRoot(testStubs.nested('id2-'), 'a');\n\t\tharness.flush(folder2);\n\t\tharness.onFolderChange.fire({ added: [], changed: [], removed: [folder1] });\n\t\tassert.deepStrictEqual(harness.flush(folder1), [\n\t\t\t{ e: 'a' }, { e: 'b' },\n\t\t]);\n\t});\n\n\ttest('updates render if second test provider appears', async () => {\n\t\tharness.c.addRoot(testStubs.nested(), 'a');\n\t\tharness.flush(folder1);\n\t\tharness.c.addRoot(testStubs.test('root2', undefined, [testStubs.test('c')]), 'b');\n\t\tassert.deepStrictEqual(harness.flush(folder1), [\n\t\t\t{ e: 'root', children: [{ e: 'a' }, { e: 'b' }] },\n\t\t\t{ e: 'root2', children: [{ e: 'c' }] },\n\t\t]);\n\t});\n\n\ttest('updates nodes if they add children', async () => {\n\t\tconst tests = testStubs.nested();\n\t\tharness.c.addRoot(tests, 'a');\n\t\tharness.flush(folder1);\n\t\tharness.tree.expand(harness.projection.getElementByTestId('id-a')!);\n\n\t\tassert.deepStrictEqual(harness.flush(folder1), [\n\t\t\t{ e: 'a', children: [{ e: 'aa' }, { e: 'ab' }] },\n\t\t\t{ e: 'b' }\n\t\t]);\n\n\t\ttests.children.get('id-a')!.addChild(testStubs.test('ac'));\n\n\t\tassert.deepStrictEqual(harness.flush(folder1), [\n\t\t\t{ e: 'a', children: [{ e: 'aa' }, { e: 'ab' }, { e: 'ac' }] },\n\t\t\t{ e: 'b' }\n\t\t]);\n\t});\n\n\ttest('updates nodes if they remove children', async () => {\n\t\tconst tests = testStubs.nested();\n\t\tharness.c.addRoot(tests, 'a');\n\t\tharness.flush(folder1);\n\t\tharness.tree.expand(harness.projection.getElementByTestId('id-a')!);\n\n\t\ttests.children.get('id-a')!.children.get('id-ab')!.dispose();\n\n\t\tassert.deepStrictEqual(harness.flush(folder1), [\n\t\t\t{ e: 'a', children: [{ e: 'aa' }] },\n\t\t\t{ e: 'b' }\n\t\t]);\n\t});\n});\n\n"]}