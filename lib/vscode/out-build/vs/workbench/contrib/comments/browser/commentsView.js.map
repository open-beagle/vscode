{"version":3,"sources":["vs/workbench/contrib/comments/browser/commentsView.ts"],"names":[],"mappings":"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","file":"commentsView.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./media/panel';\nimport * as nls from 'vs/nls';\nimport * as dom from 'vs/base/browser/dom';\nimport { basename } from 'vs/base/common/resources';\nimport { isCodeEditor } from 'vs/editor/browser/editorBrowser';\nimport { IInstantiationService, ServicesAccessor } from 'vs/platform/instantiation/common/instantiation';\nimport { IThemeService } from 'vs/platform/theme/common/themeService';\nimport { CommentNode, CommentsModel, ResourceWithCommentThreads, ICommentThreadChangedEvent } from 'vs/workbench/contrib/comments/common/commentModel';\nimport { CommentController } from 'vs/workbench/contrib/comments/browser/commentsEditorContribution';\nimport { IWorkspaceCommentThreadsEvent, ICommentService } from 'vs/workbench/contrib/comments/browser/commentService';\nimport { IEditorService, ACTIVE_GROUP, SIDE_GROUP } from 'vs/workbench/services/editor/common/editorService';\nimport { CommandsRegistry } from 'vs/platform/commands/common/commands';\nimport { textLinkForeground, textLinkActiveForeground, focusBorder, textPreformatForeground } from 'vs/platform/theme/common/colorRegistry';\nimport { ResourceLabels } from 'vs/workbench/browser/labels';\nimport { CommentsList, COMMENTS_VIEW_ID, COMMENTS_VIEW_TITLE } from 'vs/workbench/contrib/comments/browser/commentsTreeViewer';\nimport { ViewPane, IViewPaneOptions, ViewAction } from 'vs/workbench/browser/parts/views/viewPane';\nimport { IViewDescriptorService, IViewsService } from 'vs/workbench/common/views';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { ContextKeyAndExpr, ContextKeyEqualsExpr, IContextKey, IContextKeyService, RawContextKey } from 'vs/platform/contextkey/common/contextkey';\nimport { IContextMenuService } from 'vs/platform/contextview/browser/contextView';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { IOpenerService } from 'vs/platform/opener/common/opener';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { IUriIdentityService } from 'vs/workbench/services/uriIdentity/common/uriIdentity';\nimport { MenuId, registerAction2 } from 'vs/platform/actions/common/actions';\nimport { Codicon } from 'vs/base/common/codicons';\n\nconst CONTEXT_KEY_HAS_COMMENTS = new RawContextKey<boolean>('commentsView.hasComments', false);\n\nexport class CommentsPanel extends ViewPane {\n\tprivate treeLabels!: ResourceLabels;\n\tprivate tree!: CommentsList;\n\tprivate treeContainer!: HTMLElement;\n\tprivate messageBoxContainer!: HTMLElement;\n\tprivate commentsModel!: CommentsModel;\n\tprivate readonly hasCommentsContextKey: IContextKey<boolean>;\n\n\treadonly onDidChangeVisibility = this.onDidChangeBodyVisibility;\n\n\tconstructor(\n\t\toptions: IViewPaneOptions,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IViewDescriptorService viewDescriptorService: IViewDescriptorService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IContextMenuService contextMenuService: IContextMenuService,\n\t\t@IKeybindingService keybindingService: IKeybindingService,\n\t\t@IOpenerService openerService: IOpenerService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@ICommentService private readonly commentService: ICommentService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IUriIdentityService private readonly uriIdentityService: IUriIdentityService\n\t) {\n\t\tsuper(options, keybindingService, contextMenuService, configurationService, contextKeyService, viewDescriptorService, instantiationService, openerService, themeService, telemetryService);\n\t\tthis.hasCommentsContextKey = CONTEXT_KEY_HAS_COMMENTS.bindTo(contextKeyService);\n\t}\n\n\tpublic override renderBody(container: HTMLElement): void {\n\t\tsuper.renderBody(container);\n\n\t\tcontainer.classList.add('comments-panel');\n\n\t\tlet domContainer = dom.append(container, dom.$('.comments-panel-container'));\n\t\tthis.treeContainer = dom.append(domContainer, dom.$('.tree-container'));\n\t\tthis.commentsModel = new CommentsModel();\n\n\t\tthis.createTree();\n\t\tthis.createMessageBox(domContainer);\n\n\t\tthis._register(this.commentService.onDidSetAllCommentThreads(this.onAllCommentsChanged, this));\n\t\tthis._register(this.commentService.onDidUpdateCommentThreads(this.onCommentsUpdated, this));\n\n\t\tconst styleElement = dom.createStyleSheet(container);\n\t\tthis.applyStyles(styleElement);\n\t\tthis._register(this.themeService.onDidColorThemeChange(_ => this.applyStyles(styleElement)));\n\n\t\tthis._register(this.onDidChangeBodyVisibility(visible => {\n\t\t\tif (visible) {\n\t\t\t\tthis.refresh();\n\t\t\t}\n\t\t}));\n\n\t\tthis.renderComments();\n\t}\n\n\tpublic override focus(): void {\n\t\tif (this.tree && this.tree.getHTMLElement() === document.activeElement) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.commentsModel.hasCommentThreads() && this.messageBoxContainer) {\n\t\t\tthis.messageBoxContainer.focus();\n\t\t} else if (this.tree) {\n\t\t\tthis.tree.domFocus();\n\t\t}\n\t}\n\n\tprivate applyStyles(styleElement: HTMLStyleElement) {\n\t\tconst content: string[] = [];\n\n\t\tconst theme = this.themeService.getColorTheme();\n\t\tconst linkColor = theme.getColor(textLinkForeground);\n\t\tif (linkColor) {\n\t\t\tcontent.push(`.comments-panel .comments-panel-container a { color: ${linkColor}; }`);\n\t\t}\n\n\t\tconst linkActiveColor = theme.getColor(textLinkActiveForeground);\n\t\tif (linkActiveColor) {\n\t\t\tcontent.push(`.comments-panel .comments-panel-container a:hover, a:active { color: ${linkActiveColor}; }`);\n\t\t}\n\n\t\tconst focusColor = theme.getColor(focusBorder);\n\t\tif (focusColor) {\n\t\t\tcontent.push(`.comments-panel .commenst-panel-container a:focus { outline-color: ${focusColor}; }`);\n\t\t}\n\n\t\tconst codeTextForegroundColor = theme.getColor(textPreformatForeground);\n\t\tif (codeTextForegroundColor) {\n\t\t\tcontent.push(`.comments-panel .comments-panel-container .text code { color: ${codeTextForegroundColor}; }`);\n\t\t}\n\n\t\tstyleElement.textContent = content.join('\\n');\n\t}\n\n\tprivate async renderComments(): Promise<void> {\n\t\tthis.treeContainer.classList.toggle('hidden', !this.commentsModel.hasCommentThreads());\n\t\tthis.renderMessage();\n\t\tawait this.tree.setInput(this.commentsModel);\n\t}\n\n\tpublic collapseAll() {\n\t\tif (this.tree) {\n\t\t\tthis.tree.collapseAll();\n\t\t\tthis.tree.setSelection([]);\n\t\t\tthis.tree.setFocus([]);\n\t\t\tthis.tree.domFocus();\n\t\t\tthis.tree.focusFirst();\n\t\t}\n\t}\n\n\tpublic override layoutBody(height: number, width: number): void {\n\t\tsuper.layoutBody(height, width);\n\t\tthis.tree.layout(height, width);\n\t}\n\n\tpublic getTitle(): string {\n\t\treturn COMMENTS_VIEW_TITLE;\n\t}\n\n\tprivate createMessageBox(parent: HTMLElement): void {\n\t\tthis.messageBoxContainer = dom.append(parent, dom.$('.message-box-container'));\n\t\tthis.messageBoxContainer.setAttribute('tabIndex', '0');\n\t}\n\n\tprivate renderMessage(): void {\n\t\tthis.messageBoxContainer.textContent = this.commentsModel.getMessage();\n\t\tthis.messageBoxContainer.classList.toggle('hidden', this.commentsModel.hasCommentThreads());\n\t}\n\n\tprivate createTree(): void {\n\t\tthis.treeLabels = this._register(this.instantiationService.createInstance(ResourceLabels, this));\n\t\tthis.tree = this._register(this.instantiationService.createInstance(CommentsList, this.treeLabels, this.treeContainer, {\n\t\t\toverrideStyles: { listBackground: this.getBackgroundColor() },\n\t\t\tselectionNavigation: true,\n\t\t\taccessibilityProvider: {\n\t\t\t\tgetAriaLabel(element: any): string {\n\t\t\t\t\tif (element instanceof CommentsModel) {\n\t\t\t\t\t\treturn nls.localize('rootCommentsLabel', \"Comments for current workspace\");\n\t\t\t\t\t}\n\t\t\t\t\tif (element instanceof ResourceWithCommentThreads) {\n\t\t\t\t\t\treturn nls.localize('resourceWithCommentThreadsLabel', \"Comments in {0}, full path {1}\", basename(element.resource), element.resource.fsPath);\n\t\t\t\t\t}\n\t\t\t\t\tif (element instanceof CommentNode) {\n\t\t\t\t\t\treturn nls.localize('resourceWithCommentLabel',\n\t\t\t\t\t\t\t\"Comment from ${0} at line {1} column {2} in {3}, source: {4}\",\n\t\t\t\t\t\t\telement.comment.userName,\n\t\t\t\t\t\t\telement.range.startLineNumber,\n\t\t\t\t\t\t\telement.range.startColumn,\n\t\t\t\t\t\t\tbasename(element.resource),\n\t\t\t\t\t\t\telement.comment.body.value\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\treturn '';\n\t\t\t\t},\n\t\t\t\tgetWidgetAriaLabel(): string {\n\t\t\t\t\treturn COMMENTS_VIEW_TITLE;\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this.tree.onDidOpen(e => {\n\t\t\tthis.openFile(e.element, e.editorOptions.pinned, e.editorOptions.preserveFocus, e.sideBySide);\n\t\t}));\n\t}\n\n\tprivate openFile(element: any, pinned?: boolean, preserveFocus?: boolean, sideBySide?: boolean): boolean {\n\t\tif (!element) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!(element instanceof ResourceWithCommentThreads || element instanceof CommentNode)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst range = element instanceof ResourceWithCommentThreads ? element.commentThreads[0].range : element.range;\n\n\t\tconst activeEditor = this.editorService.activeEditor;\n\t\tlet currentActiveResource = activeEditor ? activeEditor.resource : undefined;\n\t\tif (this.uriIdentityService.extUri.isEqual(element.resource, currentActiveResource)) {\n\t\t\tconst threadToReveal = element instanceof ResourceWithCommentThreads ? element.commentThreads[0].threadId : element.threadId;\n\t\t\tconst commentToReveal = element instanceof ResourceWithCommentThreads ? element.commentThreads[0].comment.uniqueIdInThread : element.comment.uniqueIdInThread;\n\t\t\tconst control = this.editorService.activeTextEditorControl;\n\t\t\tif (threadToReveal && isCodeEditor(control)) {\n\t\t\t\tconst controller = CommentController.get(control);\n\t\t\t\tcontroller.revealCommentThread(threadToReveal, commentToReveal, false);\n\t\t\t}\n\n\t\t\treturn true;\n\t\t}\n\n\t\tconst threadToReveal = element instanceof ResourceWithCommentThreads ? element.commentThreads[0].threadId : element.threadId;\n\t\tconst commentToReveal = element instanceof ResourceWithCommentThreads ? element.commentThreads[0].comment : element.comment;\n\n\t\tthis.editorService.openEditor({\n\t\t\tresource: element.resource,\n\t\t\toptions: {\n\t\t\t\tpinned: pinned,\n\t\t\t\tpreserveFocus: preserveFocus,\n\t\t\t\tselection: range\n\t\t\t}\n\t\t}, sideBySide ? SIDE_GROUP : ACTIVE_GROUP).then(editor => {\n\t\t\tif (editor) {\n\t\t\t\tconst control = editor.getControl();\n\t\t\t\tif (threadToReveal && isCodeEditor(control)) {\n\t\t\t\t\tconst controller = CommentController.get(control);\n\t\t\t\t\tcontroller.revealCommentThread(threadToReveal, commentToReveal.uniqueIdInThread, true);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\treturn true;\n\t}\n\n\tprivate async refresh(): Promise<void> {\n\t\tif (this.isVisible()) {\n\t\t\tthis.hasCommentsContextKey.set(this.commentsModel.hasCommentThreads());\n\n\t\t\tthis.treeContainer.classList.toggle('hidden', !this.commentsModel.hasCommentThreads());\n\t\t\tthis.renderMessage();\n\t\t\tawait this.tree.updateChildren();\n\n\t\t\tif (this.tree.getSelection().length === 0 && this.commentsModel.hasCommentThreads()) {\n\t\t\t\tconst firstComment = this.commentsModel.resourceCommentThreads[0].commentThreads[0];\n\t\t\t\tif (firstComment) {\n\t\t\t\t\tthis.tree.setFocus([firstComment]);\n\t\t\t\t\tthis.tree.setSelection([firstComment]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate onAllCommentsChanged(e: IWorkspaceCommentThreadsEvent): void {\n\t\tthis.commentsModel.setCommentThreads(e.ownerId, e.commentThreads);\n\t\tthis.refresh();\n\t}\n\n\tprivate onCommentsUpdated(e: ICommentThreadChangedEvent): void {\n\t\tconst didUpdate = this.commentsModel.updateCommentThreads(e);\n\t\tif (didUpdate) {\n\t\t\tthis.refresh();\n\t\t}\n\t}\n}\n\nCommandsRegistry.registerCommand({\n\tid: 'workbench.action.focusCommentsPanel',\n\thandler: async (accessor) => {\n\t\tconst viewsService = accessor.get(IViewsService);\n\t\tviewsService.openView(COMMENTS_VIEW_ID, true);\n\t}\n});\n\nregisterAction2(class Collapse extends ViewAction<CommentsPanel> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tviewId: COMMENTS_VIEW_ID,\n\t\t\tid: 'comments.collapse',\n\t\t\ttitle: nls.localize('collapseAll', \"Collapse All\"),\n\t\t\tf1: false,\n\t\t\ticon: Codicon.collapseAll,\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.ViewTitle,\n\t\t\t\tgroup: 'navigation',\n\t\t\t\twhen: ContextKeyAndExpr.create([ContextKeyEqualsExpr.create('view', COMMENTS_VIEW_ID), CONTEXT_KEY_HAS_COMMENTS])\n\t\t\t}\n\t\t});\n\t}\n\trunInView(_accessor: ServicesAccessor, view: CommentsPanel) {\n\t\tview.collapseAll();\n\t}\n});\n"]}