{"version":3,"sources":["vs/workbench/contrib/comments/browser/commentNode.ts"],"names":[],"mappings":"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","file":"commentNode.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport * as dom from 'vs/base/browser/dom';\nimport * as modes from 'vs/editor/common/modes';\nimport { ActionsOrientation, ActionBar } from 'vs/base/browser/ui/actionbar/actionbar';\nimport { Action, IActionRunner, IAction, Separator } from 'vs/base/common/actions';\nimport { Disposable, IDisposable } from 'vs/base/common/lifecycle';\nimport { URI } from 'vs/base/common/uri';\nimport { ITextModel } from 'vs/editor/common/model';\nimport { IModelService } from 'vs/editor/common/services/modelService';\nimport { IModeService } from 'vs/editor/common/services/modeService';\nimport { MarkdownRenderer } from 'vs/editor/browser/core/markdownRenderer';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IThemeService } from 'vs/platform/theme/common/themeService';\nimport { ICommentService } from 'vs/workbench/contrib/comments/browser/commentService';\nimport { SimpleCommentEditor } from 'vs/workbench/contrib/comments/browser/simpleCommentEditor';\nimport { Selection } from 'vs/editor/common/core/selection';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { INotificationService } from 'vs/platform/notification/common/notification';\nimport { ToolBar } from 'vs/base/browser/ui/toolbar/toolbar';\nimport { IContextMenuService } from 'vs/platform/contextview/browser/contextView';\nimport { AnchorAlignment } from 'vs/base/browser/ui/contextview/contextview';\nimport { ToggleReactionsAction, ReactionAction, ReactionActionViewItem } from './reactionsAction';\nimport { ICodeEditor } from 'vs/editor/browser/editorBrowser';\nimport { ICommentThreadWidget } from 'vs/workbench/contrib/comments/common/commentThreadWidget';\nimport { MenuItemAction, SubmenuItemAction, IMenu } from 'vs/platform/actions/common/actions';\nimport { MenuEntryActionViewItem, SubmenuEntryActionViewItem } from 'vs/platform/actions/browser/menuEntryActionViewItem';\nimport { IContextKeyService, IContextKey } from 'vs/platform/contextkey/common/contextkey';\nimport { CommentFormActions } from 'vs/workbench/contrib/comments/browser/commentFormActions';\nimport { MOUSE_CURSOR_TEXT_CSS_CLASS_NAME } from 'vs/base/browser/ui/mouseCursor/mouseCursor';\nimport { ActionViewItem } from 'vs/base/browser/ui/actionbar/actionViewItems';\nimport { DropdownMenuActionViewItem } from 'vs/base/browser/ui/dropdown/dropdownActionViewItem';\nimport { Codicon } from 'vs/base/common/codicons';\n\nexport class CommentNode extends Disposable {\n\tprivate _domNode: HTMLElement;\n\tprivate _body: HTMLElement;\n\tprivate _md: HTMLElement;\n\tprivate _clearTimeout: any;\n\n\tprivate _editAction: Action | null = null;\n\tprivate _commentEditContainer: HTMLElement | null = null;\n\tprivate _commentDetailsContainer: HTMLElement;\n\tprivate _actionsToolbarContainer!: HTMLElement;\n\tprivate _reactionsActionBar?: ActionBar;\n\tprivate _reactionActionsContainer?: HTMLElement;\n\tprivate _commentEditor: SimpleCommentEditor | null = null;\n\tprivate _commentEditorDisposables: IDisposable[] = [];\n\tprivate _commentEditorModel: ITextModel | null = null;\n\tprivate _isPendingLabel!: HTMLElement;\n\tprivate _contextKeyService: IContextKeyService;\n\tprivate _commentContextValue: IContextKey<string>;\n\n\tprotected actionRunner?: IActionRunner;\n\tprotected toolbar: ToolBar | undefined;\n\tprivate _commentFormActions: CommentFormActions | null = null;\n\n\tprivate readonly _onDidClick = new Emitter<CommentNode>();\n\n\tpublic get domNode(): HTMLElement {\n\t\treturn this._domNode;\n\t}\n\n\tpublic isEditing: boolean = false;\n\n\tconstructor(\n\t\tprivate commentThread: modes.CommentThread,\n\t\tpublic comment: modes.Comment,\n\t\tprivate owner: string,\n\t\tprivate resource: URI,\n\t\tprivate parentEditor: ICodeEditor,\n\t\tprivate parentThread: ICommentThreadWidget,\n\t\tprivate markdownRenderer: MarkdownRenderer,\n\t\t@IThemeService private themeService: IThemeService,\n\t\t@IInstantiationService private instantiationService: IInstantiationService,\n\t\t@ICommentService private commentService: ICommentService,\n\t\t@IModelService private modelService: IModelService,\n\t\t@IModeService private modeService: IModeService,\n\t\t@INotificationService private notificationService: INotificationService,\n\t\t@IContextMenuService private contextMenuService: IContextMenuService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService\n\t) {\n\t\tsuper();\n\n\t\tthis._domNode = dom.$('div.review-comment');\n\t\tthis._contextKeyService = contextKeyService.createScoped(this._domNode);\n\t\tthis._commentContextValue = this._contextKeyService.createKey('comment', comment.contextValue);\n\n\t\tthis._domNode.tabIndex = -1;\n\t\tconst avatar = dom.append(this._domNode, dom.$('div.avatar-container'));\n\t\tif (comment.userIconPath) {\n\t\t\tconst img = <HTMLImageElement>dom.append(avatar, dom.$('img.avatar'));\n\t\t\timg.src = comment.userIconPath.toString();\n\t\t\timg.onerror = _ => img.remove();\n\t\t}\n\t\tthis._commentDetailsContainer = dom.append(this._domNode, dom.$('.review-comment-contents'));\n\n\t\tthis.createHeader(this._commentDetailsContainer);\n\n\t\tthis._body = dom.append(this._commentDetailsContainer, dom.$(`div.comment-body.${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`));\n\t\tthis._md = this.markdownRenderer.render(comment.body).element;\n\t\tthis._body.appendChild(this._md);\n\n\t\tif (this.comment.commentReactions && this.comment.commentReactions.length && this.comment.commentReactions.filter(reaction => !!reaction.count).length) {\n\t\t\tthis.createReactionsContainer(this._commentDetailsContainer);\n\t\t}\n\n\t\tthis._domNode.setAttribute('aria-label', `${comment.userName}, ${comment.body.value}`);\n\t\tthis._domNode.setAttribute('role', 'treeitem');\n\t\tthis._clearTimeout = null;\n\n\t\tthis._register(dom.addDisposableListener(this._domNode, dom.EventType.CLICK, () => this.isEditing || this._onDidClick.fire(this)));\n\t}\n\n\tpublic get onDidClick(): Event<CommentNode> {\n\t\treturn this._onDidClick.event;\n\t}\n\n\tprivate createHeader(commentDetailsContainer: HTMLElement): void {\n\t\tconst header = dom.append(commentDetailsContainer, dom.$(`div.comment-title.${MOUSE_CURSOR_TEXT_CSS_CLASS_NAME}`));\n\t\tconst author = dom.append(header, dom.$('strong.author'));\n\t\tauthor.innerText = this.comment.userName;\n\n\t\tthis._isPendingLabel = dom.append(header, dom.$('span.isPending'));\n\n\t\tif (this.comment.label) {\n\t\t\tthis._isPendingLabel.innerText = this.comment.label;\n\t\t} else {\n\t\t\tthis._isPendingLabel.innerText = '';\n\t\t}\n\n\t\tthis._actionsToolbarContainer = dom.append(header, dom.$('.comment-actions.hidden'));\n\t\tthis.createActionsToolbar();\n\t}\n\n\tprivate getToolbarActions(menu: IMenu): { primary: IAction[], secondary: IAction[] } {\n\t\tconst contributedActions = menu.getActions({ shouldForwardArgs: true });\n\t\tconst primary: IAction[] = [];\n\t\tconst secondary: IAction[] = [];\n\t\tconst result = { primary, secondary };\n\t\tfillInActions(contributedActions, result, false, g => /^inline/.test(g));\n\t\treturn result;\n\t}\n\n\tprivate createToolbar() {\n\t\tthis.toolbar = new ToolBar(this._actionsToolbarContainer, this.contextMenuService, {\n\t\t\tactionViewItemProvider: action => {\n\t\t\t\tif (action.id === ToggleReactionsAction.ID) {\n\t\t\t\t\treturn new DropdownMenuActionViewItem(\n\t\t\t\t\t\taction,\n\t\t\t\t\t\t(<ToggleReactionsAction>action).menuActions,\n\t\t\t\t\t\tthis.contextMenuService,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tactionViewItemProvider: action => this.actionViewItemProvider(action as Action),\n\t\t\t\t\t\t\tactionRunner: this.actionRunner,\n\t\t\t\t\t\t\tclassNames: ['toolbar-toggle-pickReactions', ...Codicon.reactions.classNamesArray],\n\t\t\t\t\t\t\tanchorAlignmentProvider: () => AnchorAlignment.RIGHT\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\treturn this.actionViewItemProvider(action as Action);\n\t\t\t},\n\t\t\torientation: ActionsOrientation.HORIZONTAL\n\t\t});\n\n\t\tthis.toolbar.context = {\n\t\t\tthread: this.commentThread,\n\t\t\tcommentUniqueId: this.comment.uniqueIdInThread,\n\t\t\t$mid: 9\n\t\t};\n\n\t\tthis.registerActionBarListeners(this._actionsToolbarContainer);\n\t\tthis._register(this.toolbar);\n\t}\n\n\tprivate createActionsToolbar() {\n\t\tconst actions: IAction[] = [];\n\n\t\tlet hasReactionHandler = this.commentService.hasReactionHandler(this.owner);\n\n\t\tif (hasReactionHandler) {\n\t\t\tlet toggleReactionAction = this.createReactionPicker(this.comment.commentReactions || []);\n\t\t\tactions.push(toggleReactionAction);\n\t\t}\n\n\t\tlet commentMenus = this.commentService.getCommentMenus(this.owner);\n\t\tconst menu = commentMenus.getCommentTitleActions(this.comment, this._contextKeyService);\n\t\tthis._register(menu);\n\t\tthis._register(menu.onDidChange(e => {\n\t\t\tconst { primary, secondary } = this.getToolbarActions(menu);\n\t\t\tif (!this.toolbar && (primary.length || secondary.length)) {\n\t\t\t\tthis.createToolbar();\n\t\t\t}\n\n\t\t\tthis.toolbar!.setActions(primary, secondary);\n\t\t}));\n\n\t\tconst { primary, secondary } = this.getToolbarActions(menu);\n\t\tactions.push(...primary);\n\n\t\tif (actions.length || secondary.length) {\n\t\t\tthis.createToolbar();\n\t\t\tthis.toolbar!.setActions(actions, secondary);\n\t\t}\n\t}\n\n\tactionViewItemProvider(action: Action) {\n\t\tlet options = {};\n\t\tif (action.id === ToggleReactionsAction.ID) {\n\t\t\toptions = { label: false, icon: true };\n\t\t} else {\n\t\t\toptions = { label: false, icon: true };\n\t\t}\n\n\t\tif (action.id === ReactionAction.ID) {\n\t\t\tlet item = new ReactionActionViewItem(action);\n\t\t\treturn item;\n\t\t} else if (action instanceof MenuItemAction) {\n\t\t\treturn this.instantiationService.createInstance(MenuEntryActionViewItem, action);\n\t\t} else if (action instanceof SubmenuItemAction) {\n\t\t\treturn this.instantiationService.createInstance(SubmenuEntryActionViewItem, action);\n\t\t} else {\n\t\t\tlet item = new ActionViewItem({}, action, options);\n\t\t\treturn item;\n\t\t}\n\t}\n\n\tprivate createReactionPicker(reactionGroup: modes.CommentReaction[]): ToggleReactionsAction {\n\t\tlet toggleReactionActionViewItem: DropdownMenuActionViewItem;\n\t\tlet toggleReactionAction = this._register(new ToggleReactionsAction(() => {\n\t\t\tif (toggleReactionActionViewItem) {\n\t\t\t\ttoggleReactionActionViewItem.show();\n\t\t\t}\n\t\t}, nls.localize('commentToggleReaction', \"Toggle Reaction\")));\n\n\t\tlet reactionMenuActions: Action[] = [];\n\t\tif (reactionGroup && reactionGroup.length) {\n\t\t\treactionMenuActions = reactionGroup.map((reaction) => {\n\t\t\t\treturn new Action(`reaction.command.${reaction.label}`, `${reaction.label}`, '', true, async () => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait this.commentService.toggleReaction(this.owner, this.resource, this.commentThread, this.comment, reaction);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tconst error = e.message\n\t\t\t\t\t\t\t? nls.localize('commentToggleReactionError', \"Toggling the comment reaction failed: {0}.\", e.message)\n\t\t\t\t\t\t\t: nls.localize('commentToggleReactionDefaultError', \"Toggling the comment reaction failed\");\n\t\t\t\t\t\tthis.notificationService.error(error);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\n\t\ttoggleReactionAction.menuActions = reactionMenuActions;\n\n\t\ttoggleReactionActionViewItem = new DropdownMenuActionViewItem(\n\t\t\ttoggleReactionAction,\n\t\t\t(<ToggleReactionsAction>toggleReactionAction).menuActions,\n\t\t\tthis.contextMenuService,\n\t\t\t{\n\t\t\t\tactionViewItemProvider: action => {\n\t\t\t\t\tif (action.id === ToggleReactionsAction.ID) {\n\t\t\t\t\t\treturn toggleReactionActionViewItem;\n\t\t\t\t\t}\n\t\t\t\t\treturn this.actionViewItemProvider(action as Action);\n\t\t\t\t},\n\t\t\t\tactionRunner: this.actionRunner,\n\t\t\t\tclassNames: 'toolbar-toggle-pickReactions',\n\t\t\t\tanchorAlignmentProvider: () => AnchorAlignment.RIGHT\n\t\t\t}\n\t\t);\n\n\t\treturn toggleReactionAction;\n\t}\n\n\tprivate createReactionsContainer(commentDetailsContainer: HTMLElement): void {\n\t\tthis._reactionActionsContainer = dom.append(commentDetailsContainer, dom.$('div.comment-reactions'));\n\t\tthis._reactionsActionBar = new ActionBar(this._reactionActionsContainer, {\n\t\t\tactionViewItemProvider: action => {\n\t\t\t\tif (action.id === ToggleReactionsAction.ID) {\n\t\t\t\t\treturn new DropdownMenuActionViewItem(\n\t\t\t\t\t\taction,\n\t\t\t\t\t\t(<ToggleReactionsAction>action).menuActions,\n\t\t\t\t\t\tthis.contextMenuService,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tactionViewItemProvider: action => this.actionViewItemProvider(action as Action),\n\t\t\t\t\t\t\tactionRunner: this.actionRunner,\n\t\t\t\t\t\t\tclassNames: 'toolbar-toggle-pickReactions',\n\t\t\t\t\t\t\tanchorAlignmentProvider: () => AnchorAlignment.RIGHT\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\treturn this.actionViewItemProvider(action as Action);\n\t\t\t}\n\t\t});\n\t\tthis._register(this._reactionsActionBar);\n\n\t\tlet hasReactionHandler = this.commentService.hasReactionHandler(this.owner);\n\t\tthis.comment.commentReactions!.filter(reaction => !!reaction.count).map(reaction => {\n\t\t\tlet action = new ReactionAction(`reaction.${reaction.label}`, `${reaction.label}`, reaction.hasReacted && (reaction.canEdit || hasReactionHandler) ? 'active' : '', (reaction.canEdit || hasReactionHandler), async () => {\n\t\t\t\ttry {\n\t\t\t\t\tawait this.commentService.toggleReaction(this.owner, this.resource, this.commentThread, this.comment, reaction);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tlet error: string;\n\n\t\t\t\t\tif (reaction.hasReacted) {\n\t\t\t\t\t\terror = e.message\n\t\t\t\t\t\t\t? nls.localize('commentDeleteReactionError', \"Deleting the comment reaction failed: {0}.\", e.message)\n\t\t\t\t\t\t\t: nls.localize('commentDeleteReactionDefaultError', \"Deleting the comment reaction failed\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\terror = e.message\n\t\t\t\t\t\t\t? nls.localize('commentAddReactionError', \"Deleting the comment reaction failed: {0}.\", e.message)\n\t\t\t\t\t\t\t: nls.localize('commentAddReactionDefaultError', \"Deleting the comment reaction failed\");\n\t\t\t\t\t}\n\t\t\t\t\tthis.notificationService.error(error);\n\t\t\t\t}\n\t\t\t}, reaction.iconPath, reaction.count);\n\n\t\t\tif (this._reactionsActionBar) {\n\t\t\t\tthis._reactionsActionBar.push(action, { label: true, icon: true });\n\t\t\t}\n\t\t});\n\n\t\tif (hasReactionHandler) {\n\t\t\tlet toggleReactionAction = this.createReactionPicker(this.comment.commentReactions || []);\n\t\t\tthis._reactionsActionBar.push(toggleReactionAction, { label: false, icon: true });\n\t\t}\n\t}\n\n\tprivate createCommentEditor(editContainer: HTMLElement): void {\n\t\tconst container = dom.append(editContainer, dom.$('.edit-textarea'));\n\t\tthis._commentEditor = this.instantiationService.createInstance(SimpleCommentEditor, container, SimpleCommentEditor.getEditorOptions(), this.parentEditor, this.parentThread);\n\t\tconst resource = URI.parse(`comment:commentinput-${this.comment.uniqueIdInThread}-${Date.now()}.md`);\n\t\tthis._commentEditorModel = this.modelService.createModel('', this.modeService.createByFilepathOrFirstLine(resource), resource, false);\n\n\t\tthis._commentEditor.setModel(this._commentEditorModel);\n\t\tthis._commentEditor.setValue(this.comment.body.value);\n\t\tthis._commentEditor.layout({ width: container.clientWidth - 14, height: 90 });\n\t\tthis._commentEditor.focus();\n\n\t\tdom.scheduleAtNextAnimationFrame(() => {\n\t\t\tthis._commentEditor!.layout({ width: container.clientWidth - 14, height: 90 });\n\t\t\tthis._commentEditor!.focus();\n\t\t});\n\n\t\tconst lastLine = this._commentEditorModel.getLineCount();\n\t\tconst lastColumn = this._commentEditorModel.getLineContent(lastLine).length + 1;\n\t\tthis._commentEditor.setSelection(new Selection(lastLine, lastColumn, lastLine, lastColumn));\n\n\t\tlet commentThread = this.commentThread;\n\t\tcommentThread.input = {\n\t\t\turi: this._commentEditor.getModel()!.uri,\n\t\t\tvalue: this.comment.body.value\n\t\t};\n\t\tthis.commentService.setActiveCommentThread(commentThread);\n\n\t\tthis._commentEditorDisposables.push(this._commentEditor.onDidFocusEditorWidget(() => {\n\t\t\tcommentThread.input = {\n\t\t\t\turi: this._commentEditor!.getModel()!.uri,\n\t\t\t\tvalue: this.comment.body.value\n\t\t\t};\n\t\t\tthis.commentService.setActiveCommentThread(commentThread);\n\t\t}));\n\n\t\tthis._commentEditorDisposables.push(this._commentEditor.onDidChangeModelContent(e => {\n\t\t\tif (commentThread.input && this._commentEditor && this._commentEditor.getModel()!.uri === commentThread.input.uri) {\n\t\t\t\tlet newVal = this._commentEditor.getValue();\n\t\t\t\tif (newVal !== commentThread.input.value) {\n\t\t\t\t\tlet input = commentThread.input;\n\t\t\t\t\tinput.value = newVal;\n\t\t\t\t\tcommentThread.input = input;\n\t\t\t\t\tthis.commentService.setActiveCommentThread(commentThread);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._commentEditor);\n\t\tthis._register(this._commentEditorModel);\n\t}\n\n\tprivate removeCommentEditor() {\n\t\tthis.isEditing = false;\n\t\tif (this._editAction) {\n\t\t\tthis._editAction.enabled = true;\n\t\t}\n\t\tthis._body.classList.remove('hidden');\n\n\t\tif (this._commentEditorModel) {\n\t\t\tthis._commentEditorModel.dispose();\n\t\t}\n\n\t\tthis._commentEditorDisposables.forEach(dispose => dispose.dispose());\n\t\tthis._commentEditorDisposables = [];\n\t\tif (this._commentEditor) {\n\t\t\tthis._commentEditor.dispose();\n\t\t\tthis._commentEditor = null;\n\t\t}\n\n\t\tthis._commentEditContainer!.remove();\n\t}\n\n\tlayout() {\n\t\tthis._commentEditor?.layout();\n\t}\n\n\tpublic switchToEditMode() {\n\t\tif (this.isEditing) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.isEditing = true;\n\t\tthis._body.classList.add('hidden');\n\t\tthis._commentEditContainer = dom.append(this._commentDetailsContainer, dom.$('.edit-container'));\n\t\tthis.createCommentEditor(this._commentEditContainer);\n\t\tconst formActions = dom.append(this._commentEditContainer, dom.$('.form-actions'));\n\n\t\tconst menus = this.commentService.getCommentMenus(this.owner);\n\t\tconst menu = menus.getCommentActions(this.comment, this._contextKeyService);\n\n\t\tthis._register(menu);\n\t\tthis._register(menu.onDidChange(() => {\n\t\t\tif (this._commentFormActions) {\n\t\t\t\tthis._commentFormActions.setActions(menu);\n\t\t\t}\n\t\t}));\n\n\t\tthis._commentFormActions = new CommentFormActions(formActions, (action: IAction): void => {\n\t\t\tlet text = this._commentEditor!.getValue();\n\n\t\t\taction.run({\n\t\t\t\tthread: this.commentThread,\n\t\t\t\tcommentUniqueId: this.comment.uniqueIdInThread,\n\t\t\t\ttext: text,\n\t\t\t\t$mid: 10\n\t\t\t});\n\n\t\t\tthis.removeCommentEditor();\n\t\t}, this.themeService);\n\n\t\tthis._commentFormActions.setActions(menu);\n\t}\n\n\tsetFocus(focused: boolean, visible: boolean = false) {\n\t\tif (focused) {\n\t\t\tthis._domNode.focus();\n\t\t\tthis._actionsToolbarContainer.classList.remove('hidden');\n\t\t\tthis._actionsToolbarContainer.classList.add('tabfocused');\n\t\t\tthis._domNode.tabIndex = 0;\n\t\t\tif (this.comment.mode === modes.CommentMode.Editing) {\n\t\t\t\tthis._commentEditor?.focus();\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._actionsToolbarContainer.classList.contains('tabfocused') && !this._actionsToolbarContainer.classList.contains('mouseover')) {\n\t\t\t\tthis._actionsToolbarContainer.classList.add('hidden');\n\t\t\t\tthis._domNode.tabIndex = -1;\n\t\t\t}\n\t\t\tthis._actionsToolbarContainer.classList.remove('tabfocused');\n\t\t}\n\t}\n\n\tprivate registerActionBarListeners(actionsContainer: HTMLElement): void {\n\t\tthis._register(dom.addDisposableListener(this._domNode, 'mouseenter', () => {\n\t\t\tactionsContainer.classList.remove('hidden');\n\t\t\tactionsContainer.classList.add('mouseover');\n\t\t}));\n\t\tthis._register(dom.addDisposableListener(this._domNode, 'mouseleave', () => {\n\t\t\tif (actionsContainer.classList.contains('mouseover') && !actionsContainer.classList.contains('tabfocused')) {\n\t\t\t\tactionsContainer.classList.add('hidden');\n\t\t\t}\n\t\t\tactionsContainer.classList.remove('mouseover');\n\t\t}));\n\t}\n\n\tupdate(newComment: modes.Comment) {\n\n\t\tif (newComment.body !== this.comment.body) {\n\t\t\tthis._body.removeChild(this._md);\n\t\t\tthis._md = this.markdownRenderer.render(newComment.body).element;\n\t\t\tthis._body.appendChild(this._md);\n\t\t}\n\n\t\tif (newComment.mode !== undefined && newComment.mode !== this.comment.mode) {\n\t\t\tif (newComment.mode === modes.CommentMode.Editing) {\n\t\t\t\tthis.switchToEditMode();\n\t\t\t} else {\n\t\t\t\tthis.removeCommentEditor();\n\t\t\t}\n\t\t}\n\n\t\tthis.comment = newComment;\n\n\t\tif (newComment.label) {\n\t\t\tthis._isPendingLabel.innerText = newComment.label;\n\t\t} else {\n\t\t\tthis._isPendingLabel.innerText = '';\n\t\t}\n\n\t\t// update comment reactions\n\t\tif (this._reactionActionsContainer) {\n\t\t\tthis._reactionActionsContainer.remove();\n\t\t}\n\n\t\tif (this._reactionsActionBar) {\n\t\t\tthis._reactionsActionBar.clear();\n\t\t}\n\n\t\tif (this.comment.commentReactions && this.comment.commentReactions.some(reaction => !!reaction.count)) {\n\t\t\tthis.createReactionsContainer(this._commentDetailsContainer);\n\t\t}\n\n\t\tif (this.comment.contextValue) {\n\t\t\tthis._commentContextValue.set(this.comment.contextValue);\n\t\t} else {\n\t\t\tthis._commentContextValue.reset();\n\t\t}\n\t}\n\n\tfocus() {\n\t\tthis.domNode.focus();\n\t\tif (!this._clearTimeout) {\n\t\t\tthis.domNode.classList.add('focus');\n\t\t\tthis._clearTimeout = setTimeout(() => {\n\t\t\t\tthis.domNode.classList.remove('focus');\n\t\t\t}, 3000);\n\t\t}\n\t}\n}\n\nfunction fillInActions(groups: [string, Array<MenuItemAction | SubmenuItemAction>][], target: IAction[] | { primary: IAction[]; secondary: IAction[]; }, useAlternativeActions: boolean, isPrimaryGroup: (group: string) => boolean = group => group === 'navigation'): void {\n\tfor (let tuple of groups) {\n\t\tlet [group, actions] = tuple;\n\t\tif (useAlternativeActions) {\n\t\t\tactions = actions.map(a => (a instanceof MenuItemAction) && !!a.alt ? a.alt : a);\n\t\t}\n\n\t\tif (isPrimaryGroup(group)) {\n\t\t\tconst to = Array.isArray(target) ? target : target.primary;\n\n\t\t\tto.unshift(...actions);\n\t\t} else {\n\t\t\tconst to = Array.isArray(target) ? target : target.secondary;\n\n\t\t\tif (to.length > 0) {\n\t\t\t\tto.push(new Separator());\n\t\t\t}\n\n\t\t\tto.push(...actions);\n\t\t}\n\t}\n}\n"]}