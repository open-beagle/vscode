{"version":3,"sources":["vs/workbench/contrib/debug/browser/debugService.ts"],"names":[],"mappings":"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","file":"debugService.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { URI, URI as uri } from 'vs/base/common/uri';\nimport { distinct } from 'vs/base/common/arrays';\nimport * as errors from 'vs/base/common/errors';\nimport severity from 'vs/base/common/severity';\nimport * as aria from 'vs/base/browser/ui/aria/aria';\nimport { IContextKeyService, IContextKey } from 'vs/platform/contextkey/common/contextkey';\nimport { ILifecycleService } from 'vs/workbench/services/lifecycle/common/lifecycle';\nimport { IExtensionService } from 'vs/workbench/services/extensions/common/extensions';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { FileChangesEvent, FileChangeType, IFileService } from 'vs/platform/files/common/files';\nimport { DebugModel, FunctionBreakpoint, Breakpoint, DataBreakpoint } from 'vs/workbench/contrib/debug/common/debugModel';\nimport { ViewModel } from 'vs/workbench/contrib/debug/common/debugViewModel';\nimport { ConfigurationManager } from 'vs/workbench/contrib/debug/browser/debugConfigurationManager';\nimport { VIEWLET_ID as EXPLORER_VIEWLET_ID } from 'vs/workbench/contrib/files/common/files';\nimport { IViewletService } from 'vs/workbench/services/viewlet/browser/viewlet';\nimport { IWorkbenchLayoutService, Parts } from 'vs/workbench/services/layout/browser/layoutService';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IWorkspaceContextService, WorkbenchState, IWorkspaceFolder } from 'vs/platform/workspace/common/workspace';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\nimport { IDialogService } from 'vs/platform/dialogs/common/dialogs';\nimport { INotificationService } from 'vs/platform/notification/common/notification';\nimport { IAction, Action } from 'vs/base/common/actions';\nimport { deepClone, equals } from 'vs/base/common/objects';\nimport { DebugSession } from 'vs/workbench/contrib/debug/browser/debugSession';\nimport { dispose, IDisposable } from 'vs/base/common/lifecycle';\nimport { IDebugService, State, IDebugSession, CONTEXT_DEBUG_TYPE, CONTEXT_DEBUG_STATE, CONTEXT_IN_DEBUG_MODE, IThread, IDebugConfiguration, VIEWLET_ID, IConfig, ILaunch, IViewModel, IConfigurationManager, IDebugModel, IEnablement, IBreakpoint, IBreakpointData, ICompound, IStackFrame, getStateLabel, IDebugSessionOptions, CONTEXT_DEBUG_UX, REPL_VIEW_ID, CONTEXT_BREAKPOINTS_EXIST, IGlobalConfig, CALLSTACK_VIEW_ID, IAdapterManager, IExceptionBreakpoint } from 'vs/workbench/contrib/debug/common/debug';\nimport { getExtensionHostDebugSession } from 'vs/workbench/contrib/debug/common/debugUtils';\nimport { RunOnceScheduler } from 'vs/base/common/async';\nimport { IExtensionHostDebugService } from 'vs/platform/debug/common/extensionHostDebug';\nimport { isCodeEditor } from 'vs/editor/browser/editorBrowser';\nimport { CancellationTokenSource } from 'vs/base/common/cancellation';\nimport { TaskRunResult, DebugTaskRunner } from 'vs/workbench/contrib/debug/browser/debugTaskRunner';\nimport { IActivityService, NumberBadge } from 'vs/workbench/services/activity/common/activity';\nimport { IViewsService, IViewDescriptorService } from 'vs/workbench/common/views';\nimport { generateUuid } from 'vs/base/common/uuid';\nimport { DebugStorage } from 'vs/workbench/contrib/debug/common/debugStorage';\nimport { DebugTelemetry } from 'vs/workbench/contrib/debug/common/debugTelemetry';\nimport { DebugCompoundRoot } from 'vs/workbench/contrib/debug/common/debugCompoundRoot';\nimport { ICommandService } from 'vs/platform/commands/common/commands';\nimport { IQuickInputService } from 'vs/platform/quickinput/common/quickInput';\nimport { AdapterManager } from 'vs/workbench/contrib/debug/browser/debugAdapterManager';\nimport { ITextModel } from 'vs/editor/common/model';\nimport { DEBUG_CONFIGURE_COMMAND_ID, DEBUG_CONFIGURE_LABEL } from 'vs/workbench/contrib/debug/browser/debugCommands';\nimport { IWorkspaceTrustRequestService } from 'vs/platform/workspace/common/workspaceTrust';\n\nexport class DebugService implements IDebugService {\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _onDidChangeState: Emitter<State>;\n\tprivate readonly _onDidNewSession: Emitter<IDebugSession>;\n\tprivate readonly _onWillNewSession: Emitter<IDebugSession>;\n\tprivate readonly _onDidEndSession: Emitter<IDebugSession>;\n\tprivate debugStorage: DebugStorage;\n\tprivate model: DebugModel;\n\tprivate viewModel: ViewModel;\n\tprivate telemetry: DebugTelemetry;\n\tprivate taskRunner: DebugTaskRunner;\n\tprivate configurationManager: ConfigurationManager;\n\tprivate adapterManager: AdapterManager;\n\tprivate toDispose: IDisposable[];\n\tprivate debugType!: IContextKey<string>;\n\tprivate debugState!: IContextKey<string>;\n\tprivate inDebugMode!: IContextKey<boolean>;\n\tprivate debugUx!: IContextKey<string>;\n\tprivate breakpointsExist!: IContextKey<boolean>;\n\tprivate breakpointsToSendOnResourceSaved: Set<URI>;\n\tprivate initializing = false;\n\tprivate previousState: State | undefined;\n\tprivate sessionCancellationTokens = new Map<string, CancellationTokenSource>();\n\tprivate activity: IDisposable | undefined;\n\n\tconstructor(\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IViewletService private readonly viewletService: IViewletService,\n\t\t@IViewsService private readonly viewsService: IViewsService,\n\t\t@IViewDescriptorService private readonly viewDescriptorService: IViewDescriptorService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@IDialogService private readonly dialogService: IDialogService,\n\t\t@IWorkbenchLayoutService private readonly layoutService: IWorkbenchLayoutService,\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService,\n\t\t@IContextKeyService private readonly contextKeyService: IContextKeyService,\n\t\t@ILifecycleService private readonly lifecycleService: ILifecycleService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IExtensionService private readonly extensionService: IExtensionService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IExtensionHostDebugService private readonly extensionHostDebugService: IExtensionHostDebugService,\n\t\t@IActivityService private readonly activityService: IActivityService,\n\t\t@ICommandService private readonly commandService: ICommandService,\n\t\t@IQuickInputService private readonly quickInputService: IQuickInputService,\n\t\t@IWorkspaceTrustRequestService private readonly workspaceTrustRequestService: IWorkspaceTrustRequestService\n\t) {\n\t\tthis.toDispose = [];\n\n\t\tthis.breakpointsToSendOnResourceSaved = new Set<URI>();\n\n\t\tthis._onDidChangeState = new Emitter<State>();\n\t\tthis._onDidNewSession = new Emitter<IDebugSession>();\n\t\tthis._onWillNewSession = new Emitter<IDebugSession>();\n\t\tthis._onDidEndSession = new Emitter<IDebugSession>();\n\n\t\tthis.adapterManager = this.instantiationService.createInstance(AdapterManager);\n\t\tthis.configurationManager = this.instantiationService.createInstance(ConfigurationManager, this.adapterManager);\n\t\tthis.toDispose.push(this.configurationManager);\n\t\tthis.debugStorage = this.instantiationService.createInstance(DebugStorage);\n\n\t\tcontextKeyService.bufferChangeEvents(() => {\n\t\t\tthis.debugType = CONTEXT_DEBUG_TYPE.bindTo(contextKeyService);\n\t\t\tthis.debugState = CONTEXT_DEBUG_STATE.bindTo(contextKeyService);\n\t\t\tthis.inDebugMode = CONTEXT_IN_DEBUG_MODE.bindTo(contextKeyService);\n\t\t\tthis.debugUx = CONTEXT_DEBUG_UX.bindTo(contextKeyService);\n\t\t\tthis.debugUx.set(this.debugStorage.loadDebugUxState());\n\t\t\tthis.breakpointsExist = CONTEXT_BREAKPOINTS_EXIST.bindTo(contextKeyService);\n\t\t});\n\n\t\tthis.model = this.instantiationService.createInstance(DebugModel, this.debugStorage);\n\t\tthis.telemetry = this.instantiationService.createInstance(DebugTelemetry, this.model);\n\t\tconst setBreakpointsExistContext = () => this.breakpointsExist.set(!!(this.model.getBreakpoints().length || this.model.getDataBreakpoints().length || this.model.getFunctionBreakpoints().length));\n\t\tsetBreakpointsExistContext();\n\n\t\tthis.viewModel = new ViewModel(contextKeyService);\n\t\tthis.taskRunner = this.instantiationService.createInstance(DebugTaskRunner);\n\n\t\tthis.toDispose.push(this.fileService.onDidFilesChange(e => this.onFileChanges(e)));\n\t\tthis.toDispose.push(this.lifecycleService.onDidShutdown(this.dispose, this));\n\n\t\tthis.toDispose.push(this.extensionHostDebugService.onAttachSession(event => {\n\t\t\tconst session = this.model.getSession(event.sessionId, true);\n\t\t\tif (session) {\n\t\t\t\t// EH was started in debug mode -> attach to it\n\t\t\t\tsession.configuration.request = 'attach';\n\t\t\t\tsession.configuration.port = event.port;\n\t\t\t\tsession.setSubId(event.subId);\n\t\t\t\tthis.launchOrAttachToSession(session);\n\t\t\t}\n\t\t}));\n\t\tthis.toDispose.push(this.extensionHostDebugService.onTerminateSession(event => {\n\t\t\tconst session = this.model.getSession(event.sessionId);\n\t\t\tif (session && session.subId === event.subId) {\n\t\t\t\tsession.disconnect();\n\t\t\t}\n\t\t}));\n\n\t\tthis.toDispose.push(this.viewModel.onDidFocusStackFrame(() => {\n\t\t\tthis.onStateChange();\n\t\t}));\n\t\tthis.toDispose.push(this.viewModel.onDidFocusSession(() => {\n\t\t\tthis.onStateChange();\n\t\t}));\n\t\tthis.toDispose.push(Event.any(this.adapterManager.onDidRegisterDebugger, this.configurationManager.onDidSelectConfiguration)(() => {\n\t\t\tconst debugUxValue = (this.state !== State.Inactive || (this.configurationManager.getAllConfigurations().length > 0 && this.adapterManager.hasDebuggers())) ? 'default' : 'simple';\n\t\t\tthis.debugUx.set(debugUxValue);\n\t\t\tthis.debugStorage.storeDebugUxState(debugUxValue);\n\t\t}));\n\t\tthis.toDispose.push(this.model.onDidChangeCallStack(() => {\n\t\t\tconst numberOfSessions = this.model.getSessions().filter(s => !s.parentSession).length;\n\t\t\tif (this.activity) {\n\t\t\t\tthis.activity.dispose();\n\t\t\t}\n\t\t\tif (numberOfSessions > 0) {\n\t\t\t\tconst viewContainer = this.viewDescriptorService.getViewContainerByViewId(CALLSTACK_VIEW_ID);\n\t\t\t\tif (viewContainer) {\n\t\t\t\t\tthis.activity = this.activityService.showViewContainerActivity(viewContainer.id, { badge: new NumberBadge(numberOfSessions, n => n === 1 ? nls.localize('1activeSession', \"1 active session\") : nls.localize('nActiveSessions', \"{0} active sessions\", n)) });\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tthis.toDispose.push(this.model.onDidChangeBreakpoints(() => setBreakpointsExistContext()));\n\t}\n\n\tgetModel(): IDebugModel {\n\t\treturn this.model;\n\t}\n\n\tgetViewModel(): IViewModel {\n\t\treturn this.viewModel;\n\t}\n\n\tgetConfigurationManager(): IConfigurationManager {\n\t\treturn this.configurationManager;\n\t}\n\n\tgetAdapterManager(): IAdapterManager {\n\t\treturn this.adapterManager;\n\t}\n\n\tsourceIsNotAvailable(uri: uri): void {\n\t\tthis.model.sourceIsNotAvailable(uri);\n\t}\n\n\tdispose(): void {\n\t\tthis.toDispose = dispose(this.toDispose);\n\t}\n\n\t//---- state management\n\n\tget state(): State {\n\t\tconst focusedSession = this.viewModel.focusedSession;\n\t\tif (focusedSession) {\n\t\t\treturn focusedSession.state;\n\t\t}\n\n\t\treturn this.initializing ? State.Initializing : State.Inactive;\n\t}\n\n\tprivate startInitializingState(): void {\n\t\tif (!this.initializing) {\n\t\t\tthis.initializing = true;\n\t\t\tthis.onStateChange();\n\t\t}\n\t}\n\n\tprivate endInitializingState(): void {\n\t\tif (this.initializing) {\n\t\t\tthis.initializing = false;\n\t\t\tthis.onStateChange();\n\t\t}\n\t}\n\n\tprivate cancelTokens(id: string | undefined): void {\n\t\tif (id) {\n\t\t\tconst token = this.sessionCancellationTokens.get(id);\n\t\t\tif (token) {\n\t\t\t\ttoken.cancel();\n\t\t\t\tthis.sessionCancellationTokens.delete(id);\n\t\t\t}\n\t\t} else {\n\t\t\tthis.sessionCancellationTokens.forEach(t => t.cancel());\n\t\t\tthis.sessionCancellationTokens.clear();\n\t\t}\n\t}\n\n\tprivate onStateChange(): void {\n\t\tconst state = this.state;\n\t\tif (this.previousState !== state) {\n\t\t\tthis.contextKeyService.bufferChangeEvents(() => {\n\t\t\t\tthis.debugState.set(getStateLabel(state));\n\t\t\t\tthis.inDebugMode.set(state !== State.Inactive);\n\t\t\t\t// Only show the simple ux if debug is not yet started and if no launch.json exists\n\t\t\t\tconst debugUxValue = ((state !== State.Inactive && state !== State.Initializing) || (this.adapterManager.hasDebuggers() && this.configurationManager.selectedConfiguration.name)) ? 'default' : 'simple';\n\t\t\t\tthis.debugUx.set(debugUxValue);\n\t\t\t\tthis.debugStorage.storeDebugUxState(debugUxValue);\n\t\t\t});\n\t\t\tthis.previousState = state;\n\t\t\tthis._onDidChangeState.fire(state);\n\t\t}\n\t}\n\n\tget onDidChangeState(): Event<State> {\n\t\treturn this._onDidChangeState.event;\n\t}\n\n\tget onDidNewSession(): Event<IDebugSession> {\n\t\treturn this._onDidNewSession.event;\n\t}\n\n\tget onWillNewSession(): Event<IDebugSession> {\n\t\treturn this._onWillNewSession.event;\n\t}\n\n\tget onDidEndSession(): Event<IDebugSession> {\n\t\treturn this._onDidEndSession.event;\n\t}\n\n\t//---- life cycle management\n\n\t/**\n\t * main entry point\n\t * properly manages compounds, checks for errors and handles the initializing state.\n\t */\n\tasync startDebugging(launch: ILaunch | undefined, configOrName?: IConfig | string, options?: IDebugSessionOptions): Promise<boolean> {\n\t\tconst message = options && options.noDebug ? nls.localize('runTrust', \"Running executes build tasks and program code from your workspace.\") : nls.localize('debugTrust', \"Debugging executes build tasks and program code from your workspace.\");\n\t\tconst trust = await this.workspaceTrustRequestService.requestWorkspaceTrust({\n\t\t\tmodal: true,\n\t\t\tmessage,\n\n\t\t});\n\t\tif (!trust) {\n\t\t\treturn false;\n\t\t}\n\t\tthis.startInitializingState();\n\t\ttry {\n\t\t\t// make sure to save all files and that the configuration is up to date\n\t\t\tawait this.extensionService.activateByEvent('onDebug');\n\t\t\tif (!options?.parentSession) {\n\t\t\t\tconst saveBeforeStartConfig: string = this.configurationService.getValue('debug.saveBeforeStart');\n\n\t\t\t\tif (saveBeforeStartConfig !== 'none') {\n\t\t\t\t\tawait this.editorService.saveAll();\n\t\t\t\t\tif (saveBeforeStartConfig === 'allEditorsInActiveGroup') {\n\t\t\t\t\t\tconst activeEditor = this.editorService.activeEditorPane;\n\t\t\t\t\t\tif (activeEditor) {\n\t\t\t\t\t\t\t// Make sure to save the active editor in case it is in untitled file it wont be saved as part of saveAll #111850\n\t\t\t\t\t\t\tawait this.editorService.save({ editor: activeEditor.input, groupId: activeEditor.group.id });\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tawait this.configurationService.reloadConfiguration(launch ? launch.workspace : undefined);\n\t\t\tawait this.extensionService.whenInstalledExtensionsRegistered();\n\n\t\t\tlet config: IConfig | undefined;\n\t\t\tlet compound: ICompound | undefined;\n\t\t\tif (!configOrName) {\n\t\t\t\tconfigOrName = this.configurationManager.selectedConfiguration.name;\n\t\t\t}\n\t\t\tif (typeof configOrName === 'string' && launch) {\n\t\t\t\tconfig = launch.getConfiguration(configOrName);\n\t\t\t\tcompound = launch.getCompound(configOrName);\n\t\t\t} else if (typeof configOrName !== 'string') {\n\t\t\t\tconfig = configOrName;\n\t\t\t}\n\n\t\t\tif (compound) {\n\t\t\t\t// we are starting a compound debug, first do some error checking and than start each configuration in the compound\n\t\t\t\tif (!compound.configurations) {\n\t\t\t\t\tthrow new Error(nls.localize({ key: 'compoundMustHaveConfigurations', comment: ['compound indicates a \"compounds\" configuration item', '\"configurations\" is an attribute and should not be localized'] },\n\t\t\t\t\t\t\"Compound must have \\\"configurations\\\" attribute set in order to start multiple configurations.\"));\n\t\t\t\t}\n\t\t\t\tif (compound.preLaunchTask) {\n\t\t\t\t\tconst taskResult = await this.taskRunner.runTaskAndCheckErrors(launch?.workspace || this.contextService.getWorkspace(), compound.preLaunchTask);\n\t\t\t\t\tif (taskResult === TaskRunResult.Failure) {\n\t\t\t\t\t\tthis.endInitializingState();\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (compound.stopAll) {\n\t\t\t\t\toptions = { ...options, compoundRoot: new DebugCompoundRoot() };\n\t\t\t\t}\n\n\t\t\t\tconst values = await Promise.all(compound.configurations.map(configData => {\n\t\t\t\t\tconst name = typeof configData === 'string' ? configData : configData.name;\n\t\t\t\t\tif (name === compound!.name) {\n\t\t\t\t\t\treturn Promise.resolve(false);\n\t\t\t\t\t}\n\n\t\t\t\t\tlet launchForName: ILaunch | undefined;\n\t\t\t\t\tif (typeof configData === 'string') {\n\t\t\t\t\t\tconst launchesContainingName = this.configurationManager.getLaunches().filter(l => !!l.getConfiguration(name));\n\t\t\t\t\t\tif (launchesContainingName.length === 1) {\n\t\t\t\t\t\t\tlaunchForName = launchesContainingName[0];\n\t\t\t\t\t\t} else if (launch && launchesContainingName.length > 1 && launchesContainingName.indexOf(launch) >= 0) {\n\t\t\t\t\t\t\t// If there are multiple launches containing the configuration give priority to the configuration in the current launch\n\t\t\t\t\t\t\tlaunchForName = launch;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow new Error(launchesContainingName.length === 0 ? nls.localize('noConfigurationNameInWorkspace', \"Could not find launch configuration '{0}' in the workspace.\", name)\n\t\t\t\t\t\t\t\t: nls.localize('multipleConfigurationNamesInWorkspace', \"There are multiple launch configurations '{0}' in the workspace. Use folder name to qualify the configuration.\", name));\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (configData.folder) {\n\t\t\t\t\t\tconst launchesMatchingConfigData = this.configurationManager.getLaunches().filter(l => l.workspace && l.workspace.name === configData.folder && !!l.getConfiguration(configData.name));\n\t\t\t\t\t\tif (launchesMatchingConfigData.length === 1) {\n\t\t\t\t\t\t\tlaunchForName = launchesMatchingConfigData[0];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthrow new Error(nls.localize('noFolderWithName', \"Can not find folder with name '{0}' for configuration '{1}' in compound '{2}'.\", configData.folder, configData.name, compound!.name));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\treturn this.createSession(launchForName, launchForName!.getConfiguration(name), options);\n\t\t\t\t}));\n\n\t\t\t\tconst result = values.every(success => !!success); // Compound launch is a success only if each configuration launched successfully\n\t\t\t\tthis.endInitializingState();\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tif (configOrName && !config) {\n\t\t\t\tconst message = !!launch ? nls.localize('configMissing', \"Configuration '{0}' is missing in 'launch.json'.\", typeof configOrName === 'string' ? configOrName : configOrName.name) :\n\t\t\t\t\tnls.localize('launchJsonDoesNotExist', \"'launch.json' does not exist for passed workspace folder.\");\n\t\t\t\tthrow new Error(message);\n\t\t\t}\n\n\t\t\tconst result = await this.createSession(launch, config, options);\n\t\t\tthis.endInitializingState();\n\t\t\treturn result;\n\t\t} catch (err) {\n\t\t\t// make sure to get out of initializing state, and propagate the result\n\t\t\tthis.notificationService.error(err);\n\t\t\tthis.endInitializingState();\n\t\t\treturn Promise.reject(err);\n\t\t}\n\t}\n\n\t/**\n\t * gets the debugger for the type, resolves configurations by providers, substitutes variables and runs prelaunch tasks\n\t */\n\tprivate async createSession(launch: ILaunch | undefined, config: IConfig | undefined, options?: IDebugSessionOptions): Promise<boolean> {\n\t\t// We keep the debug type in a separate variable 'type' so that a no-folder config has no attributes.\n\t\t// Storing the type in the config would break extensions that assume that the no-folder case is indicated by an empty config.\n\t\tlet type: string | undefined;\n\t\tif (config) {\n\t\t\ttype = config.type;\n\t\t} else {\n\t\t\t// a no-folder workspace has no launch.config\n\t\t\tconfig = Object.create(null);\n\t\t}\n\t\tif (options && options.noDebug) {\n\t\t\tconfig!.noDebug = true;\n\t\t} else if (options && typeof options.noDebug === 'undefined' && options.parentSession && options.parentSession.configuration.noDebug) {\n\t\t\tconfig!.noDebug = true;\n\t\t}\n\t\tconst unresolvedConfig = deepClone(config);\n\n\t\tif (!type) {\n\t\t\tconst guess = await this.adapterManager.guessDebugger(false);\n\t\t\tif (guess) {\n\t\t\t\ttype = guess.type;\n\t\t\t}\n\t\t}\n\n\t\tconst initCancellationToken = new CancellationTokenSource();\n\t\tconst sessionId = generateUuid();\n\t\tthis.sessionCancellationTokens.set(sessionId, initCancellationToken);\n\n\t\tconst configByProviders = await this.configurationManager.resolveConfigurationByProviders(launch && launch.workspace ? launch.workspace.uri : undefined, type, config!, initCancellationToken.token);\n\t\t// a falsy config indicates an aborted launch\n\t\tif (configByProviders && configByProviders.type) {\n\t\t\ttry {\n\t\t\t\tlet resolvedConfig = await this.substituteVariables(launch, configByProviders);\n\t\t\t\tif (!resolvedConfig) {\n\t\t\t\t\t// User cancelled resolving of interactive variables, silently return\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (initCancellationToken.token.isCancellationRequested) {\n\t\t\t\t\t// User cancelled, silently return\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst workspace = launch?.workspace || this.contextService.getWorkspace();\n\t\t\t\tconst taskResult = await this.taskRunner.runTaskAndCheckErrors(workspace, resolvedConfig.preLaunchTask);\n\t\t\t\tif (taskResult === TaskRunResult.Failure) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tconst cfg = await this.configurationManager.resolveDebugConfigurationWithSubstitutedVariables(launch && launch.workspace ? launch.workspace.uri : undefined, type, resolvedConfig, initCancellationToken.token);\n\t\t\t\tif (!cfg) {\n\t\t\t\t\tif (launch && type && cfg === null && !initCancellationToken.token.isCancellationRequested) {\t// show launch.json only for \"config\" being \"null\".\n\t\t\t\t\t\tawait launch.openConfigFile(true, type, initCancellationToken.token);\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tresolvedConfig = cfg;\n\n\t\t\t\tif (!this.adapterManager.getDebugger(resolvedConfig.type) || (configByProviders.request !== 'attach' && configByProviders.request !== 'launch')) {\n\t\t\t\t\tlet message: string;\n\t\t\t\t\tif (configByProviders.request !== 'attach' && configByProviders.request !== 'launch') {\n\t\t\t\t\t\tmessage = configByProviders.request ? nls.localize('debugRequestNotSupported', \"Attribute '{0}' has an unsupported value '{1}' in the chosen debug configuration.\", 'request', configByProviders.request)\n\t\t\t\t\t\t\t: nls.localize('debugRequesMissing', \"Attribute '{0}' is missing from the chosen debug configuration.\", 'request');\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmessage = resolvedConfig.type ? nls.localize('debugTypeNotSupported', \"Configured debug type '{0}' is not supported.\", resolvedConfig.type) :\n\t\t\t\t\t\t\tnls.localize('debugTypeMissing', \"Missing property 'type' for the chosen launch configuration.\");\n\t\t\t\t\t}\n\n\t\t\t\t\tconst actionList: IAction[] = [];\n\n\t\t\t\t\tactionList.push(new Action(\n\t\t\t\t\t\t'installAdditionalDebuggers',\n\t\t\t\t\t\tnls.localize({ key: 'installAdditionalDebuggers', comment: ['Placeholder is the debug type, so for example \"node\", \"python\"'] }, \"Install {0} Extension\", resolvedConfig.type),\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t\tasync () => this.commandService.executeCommand('debug.installAdditionalDebuggers', resolvedConfig?.type)\n\t\t\t\t\t));\n\n\t\t\t\t\tawait this.showError(message, actionList);\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\treturn this.doCreateSession(sessionId, launch?.workspace, { resolved: resolvedConfig, unresolved: unresolvedConfig }, options);\n\t\t\t} catch (err) {\n\t\t\t\tif (err && err.message) {\n\t\t\t\t\tawait this.showError(err.message);\n\t\t\t\t} else if (this.contextService.getWorkbenchState() === WorkbenchState.EMPTY) {\n\t\t\t\t\tawait this.showError(nls.localize('noFolderWorkspaceDebugError', \"The active file can not be debugged. Make sure it is saved and that you have a debug extension installed for that file type.\"));\n\t\t\t\t}\n\t\t\t\tif (launch && !initCancellationToken.token.isCancellationRequested) {\n\t\t\t\t\tawait launch.openConfigFile(true, undefined, initCancellationToken.token);\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tif (launch && type && configByProviders === null && !initCancellationToken.token.isCancellationRequested) {\t// show launch.json only for \"config\" being \"null\".\n\t\t\tawait launch.openConfigFile(true, type, initCancellationToken.token);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t * instantiates the new session, initializes the session, registers session listeners and reports telemetry\n\t */\n\tprivate async doCreateSession(sessionId: string, root: IWorkspaceFolder | undefined, configuration: { resolved: IConfig, unresolved: IConfig | undefined }, options?: IDebugSessionOptions): Promise<boolean> {\n\n\t\tconst session = this.instantiationService.createInstance(DebugSession, sessionId, configuration, root, this.model, options);\n\t\tthis.model.addSession(session);\n\t\t// register listeners as the very first thing!\n\t\tthis.registerSessionListeners(session);\n\n\t\t// since the Session is now properly registered under its ID and hooked, we can announce it\n\t\t// this event doesn't go to extensions\n\t\tthis._onWillNewSession.fire(session);\n\n\t\tconst openDebug = this.configurationService.getValue<IDebugConfiguration>('debug').openDebug;\n\t\t// Open debug viewlet based on the visibility of the side bar and openDebug setting. Do not open for 'run without debug'\n\t\tif (!configuration.resolved.noDebug && (openDebug === 'openOnSessionStart' || (openDebug !== 'neverOpen' && this.viewModel.firstSessionStart))) {\n\t\t\tawait this.viewletService.openViewlet(VIEWLET_ID);\n\t\t}\n\n\t\ttry {\n\t\t\tawait this.launchOrAttachToSession(session);\n\n\t\t\tconst internalConsoleOptions = session.configuration.internalConsoleOptions || this.configurationService.getValue<IDebugConfiguration>('debug').internalConsoleOptions;\n\t\t\tif (internalConsoleOptions === 'openOnSessionStart' || (this.viewModel.firstSessionStart && internalConsoleOptions === 'openOnFirstSessionStart')) {\n\t\t\t\tthis.viewsService.openView(REPL_VIEW_ID, false);\n\t\t\t}\n\n\t\t\tthis.viewModel.firstSessionStart = false;\n\t\t\tconst showSubSessions = this.configurationService.getValue<IDebugConfiguration>('debug').showSubSessionsInToolBar;\n\t\t\tconst sessions = this.model.getSessions();\n\t\t\tconst shownSessions = showSubSessions ? sessions : sessions.filter(s => !s.parentSession);\n\t\t\tif (shownSessions.length > 1) {\n\t\t\t\tthis.viewModel.setMultiSessionView(true);\n\t\t\t}\n\n\t\t\t// since the initialized response has arrived announce the new Session (including extensions)\n\t\t\tthis._onDidNewSession.fire(session);\n\n\t\t\treturn true;\n\t\t} catch (error) {\n\n\t\t\tif (errors.isPromiseCanceledError(error)) {\n\t\t\t\t// don't show 'canceled' error messages to the user #7906\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Show the repl if some error got logged there #5870\n\t\t\tif (session && session.getReplElements().length > 0) {\n\t\t\t\tthis.viewsService.openView(REPL_VIEW_ID, false);\n\t\t\t}\n\n\t\t\tif (session.configuration && session.configuration.request === 'attach' && session.configuration.__autoAttach) {\n\t\t\t\t// ignore attach timeouts in auto attach mode\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst errorMessage = error instanceof Error ? error.message : error;\n\t\t\tawait this.showError(errorMessage, errors.isErrorWithActions(error) ? error.actions : []);\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tprivate async launchOrAttachToSession(session: IDebugSession, forceFocus = false): Promise<void> {\n\t\tconst dbgr = this.adapterManager.getDebugger(session.configuration.type);\n\t\ttry {\n\t\t\tawait session.initialize(dbgr!);\n\t\t\tawait session.launchOrAttach(session.configuration);\n\t\t\tconst launchJsonExists = !!session.root && !!this.configurationService.getValue<IGlobalConfig>('launch', { resource: session.root.uri });\n\t\t\tawait this.telemetry.logDebugSessionStart(dbgr!, launchJsonExists);\n\n\t\t\tif (forceFocus || !this.viewModel.focusedSession || session.parentSession === this.viewModel.focusedSession) {\n\t\t\t\tawait this.focusStackFrame(undefined, undefined, session);\n\t\t\t}\n\t\t} catch (err) {\n\t\t\tif (this.viewModel.focusedSession === session) {\n\t\t\t\tawait this.focusStackFrame(undefined);\n\t\t\t}\n\t\t\treturn Promise.reject(err);\n\t\t}\n\t}\n\n\tprivate registerSessionListeners(session: IDebugSession): void {\n\t\tconst sessionRunningScheduler = new RunOnceScheduler(() => {\n\t\t\t// Do not immediatly defocus the stack frame if the session is running\n\t\t\tif (session.state === State.Running && this.viewModel.focusedSession === session) {\n\t\t\t\tthis.viewModel.setFocus(undefined, this.viewModel.focusedThread, session, false);\n\t\t\t}\n\t\t}, 200);\n\t\tthis.toDispose.push(session.onDidChangeState(() => {\n\t\t\tif (session.state === State.Running && this.viewModel.focusedSession === session) {\n\t\t\t\tsessionRunningScheduler.schedule();\n\t\t\t}\n\t\t\tif (session === this.viewModel.focusedSession) {\n\t\t\t\tthis.onStateChange();\n\t\t\t}\n\t\t}));\n\n\t\tthis.toDispose.push(session.onDidEndAdapter(async adapterExitEvent => {\n\n\t\t\tif (adapterExitEvent) {\n\t\t\t\tif (adapterExitEvent.error) {\n\t\t\t\t\tthis.notificationService.error(nls.localize('debugAdapterCrash', \"Debug adapter process has terminated unexpectedly ({0})\", adapterExitEvent.error.message || adapterExitEvent.error.toString()));\n\t\t\t\t}\n\t\t\t\tthis.telemetry.logDebugSessionStop(session, adapterExitEvent);\n\t\t\t}\n\n\t\t\t// 'Run without debugging' mode VSCode must terminate the extension host. More details: #3905\n\t\t\tconst extensionDebugSession = getExtensionHostDebugSession(session);\n\t\t\tif (extensionDebugSession && extensionDebugSession.state === State.Running && extensionDebugSession.configuration.noDebug) {\n\t\t\t\tthis.extensionHostDebugService.close(extensionDebugSession.getId());\n\t\t\t}\n\n\t\t\tif (session.configuration.postDebugTask) {\n\t\t\t\ttry {\n\t\t\t\t\tawait this.taskRunner.runTask(session.root, session.configuration.postDebugTask);\n\t\t\t\t} catch (err) {\n\t\t\t\t\tthis.notificationService.error(err);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.endInitializingState();\n\t\t\tthis.cancelTokens(session.getId());\n\t\t\tthis._onDidEndSession.fire(session);\n\n\t\t\tconst focusedSession = this.viewModel.focusedSession;\n\t\t\tif (focusedSession && focusedSession.getId() === session.getId()) {\n\t\t\t\tconst { session } = getStackFrameThreadAndSessionToFocus(this.model, undefined);\n\t\t\t\tthis.viewModel.setFocus(undefined, undefined, session, false);\n\t\t\t}\n\n\t\t\tif (this.model.getSessions().length === 0) {\n\t\t\t\tthis.viewModel.setMultiSessionView(false);\n\n\t\t\t\tif (this.layoutService.isVisible(Parts.SIDEBAR_PART) && this.configurationService.getValue<IDebugConfiguration>('debug').openExplorerOnEnd) {\n\t\t\t\t\tthis.viewletService.openViewlet(EXPLORER_VIEWLET_ID);\n\t\t\t\t}\n\n\t\t\t\t// Data breakpoints that can not be persisted should be cleared when a session ends\n\t\t\t\tconst dataBreakpoints = this.model.getDataBreakpoints().filter(dbp => !dbp.canPersist);\n\t\t\t\tdataBreakpoints.forEach(dbp => this.model.removeDataBreakpoints(dbp.getId()));\n\n\t\t\t\tif (this.viewsService.isViewVisible(REPL_VIEW_ID) && this.configurationService.getValue<IDebugConfiguration>('debug').console.closeOnEnd) {\n\t\t\t\t\tthis.viewsService.closeView(REPL_VIEW_ID);\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t}\n\n\tasync restartSession(session: IDebugSession, restartData?: any): Promise<any> {\n\t\tawait this.editorService.saveAll();\n\t\tconst isAutoRestart = !!restartData;\n\n\t\tconst runTasks: () => Promise<TaskRunResult> = async () => {\n\t\t\tif (isAutoRestart) {\n\t\t\t\t// Do not run preLaunch and postDebug tasks for automatic restarts\n\t\t\t\treturn Promise.resolve(TaskRunResult.Success);\n\t\t\t}\n\n\t\t\tconst root = session.root || this.contextService.getWorkspace();\n\t\t\tawait this.taskRunner.runTask(root, session.configuration.preRestartTask);\n\t\t\tawait this.taskRunner.runTask(root, session.configuration.postDebugTask);\n\n\t\t\tconst taskResult1 = await this.taskRunner.runTaskAndCheckErrors(root, session.configuration.preLaunchTask);\n\t\t\tif (taskResult1 !== TaskRunResult.Success) {\n\t\t\t\treturn taskResult1;\n\t\t\t}\n\n\t\t\treturn this.taskRunner.runTaskAndCheckErrors(root, session.configuration.postRestartTask);\n\t\t};\n\n\t\tconst extensionDebugSession = getExtensionHostDebugSession(session);\n\t\tif (extensionDebugSession) {\n\t\t\tconst taskResult = await runTasks();\n\t\t\tif (taskResult === TaskRunResult.Success) {\n\t\t\t\tthis.extensionHostDebugService.reload(extensionDebugSession.getId());\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\t// Read the configuration again if a launch.json has been changed, if not just use the inmemory configuration\n\t\tlet needsToSubstitute = false;\n\t\tlet unresolved: IConfig | undefined;\n\t\tconst launch = session.root ? this.configurationManager.getLaunch(session.root.uri) : undefined;\n\t\tif (launch) {\n\t\t\tunresolved = launch.getConfiguration(session.configuration.name);\n\t\t\tif (unresolved && !equals(unresolved, session.unresolvedConfiguration)) {\n\t\t\t\t// Take the type from the session since the debug extension might overwrite it #21316\n\t\t\t\tunresolved.type = session.configuration.type;\n\t\t\t\tunresolved.noDebug = session.configuration.noDebug;\n\t\t\t\tneedsToSubstitute = true;\n\t\t\t}\n\t\t}\n\n\t\tlet resolved: IConfig | undefined | null = session.configuration;\n\t\tif (launch && needsToSubstitute && unresolved) {\n\t\t\tconst initCancellationToken = new CancellationTokenSource();\n\t\t\tthis.sessionCancellationTokens.set(session.getId(), initCancellationToken);\n\t\t\tconst resolvedByProviders = await this.configurationManager.resolveConfigurationByProviders(launch.workspace ? launch.workspace.uri : undefined, unresolved.type, unresolved, initCancellationToken.token);\n\t\t\tif (resolvedByProviders) {\n\t\t\t\tresolved = await this.substituteVariables(launch, resolvedByProviders);\n\t\t\t\tif (resolved && !initCancellationToken.token.isCancellationRequested) {\n\t\t\t\t\tresolved = await this.configurationManager.resolveDebugConfigurationWithSubstitutedVariables(launch && launch.workspace ? launch.workspace.uri : undefined, unresolved.type, resolved, initCancellationToken.token);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tresolved = resolvedByProviders;\n\t\t\t}\n\t\t}\n\t\tif (resolved) {\n\t\t\tsession.setConfiguration({ resolved, unresolved });\n\t\t}\n\t\tsession.configuration.__restart = restartData;\n\n\t\tif (session.capabilities.supportsRestartRequest) {\n\t\t\tconst taskResult = await runTasks();\n\t\t\tif (taskResult === TaskRunResult.Success) {\n\t\t\t\tawait session.restart();\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst shouldFocus = !!this.viewModel.focusedSession && session.getId() === this.viewModel.focusedSession.getId();\n\t\t// If the restart is automatic  -> disconnect, otherwise -> terminate #55064\n\t\tif (isAutoRestart) {\n\t\t\tawait session.disconnect(true);\n\t\t} else {\n\t\t\tawait session.terminate(true);\n\t\t}\n\n\t\treturn new Promise<void>((c, e) => {\n\t\t\tsetTimeout(async () => {\n\t\t\t\tconst taskResult = await runTasks();\n\t\t\t\tif (taskResult !== TaskRunResult.Success) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!resolved) {\n\t\t\t\t\treturn c(undefined);\n\t\t\t\t}\n\n\t\t\t\ttry {\n\t\t\t\t\tawait this.launchOrAttachToSession(session, shouldFocus);\n\t\t\t\t\tthis._onDidNewSession.fire(session);\n\t\t\t\t\tc(undefined);\n\t\t\t\t} catch (error) {\n\t\t\t\t\te(error);\n\t\t\t\t}\n\t\t\t}, 300);\n\t\t});\n\t}\n\n\tasync stopSession(session: IDebugSession | undefined, disconnect = false): Promise<any> {\n\t\tif (session) {\n\t\t\treturn disconnect ? session.disconnect() : session.terminate();\n\t\t}\n\n\t\tconst sessions = this.model.getSessions();\n\t\tif (sessions.length === 0) {\n\t\t\tthis.taskRunner.cancel();\n\t\t\t// User might have cancelled starting of a debug session, and in some cases the quick pick is left open\n\t\t\tawait this.quickInputService.cancel();\n\t\t\tthis.endInitializingState();\n\t\t\tthis.cancelTokens(undefined);\n\t\t}\n\n\t\treturn Promise.all(sessions.map(s => disconnect ? s.disconnect() : s.terminate()));\n\t}\n\n\tprivate async substituteVariables(launch: ILaunch | undefined, config: IConfig): Promise<IConfig | undefined> {\n\t\tconst dbg = this.adapterManager.getDebugger(config.type);\n\t\tif (dbg) {\n\t\t\tlet folder: IWorkspaceFolder | undefined = undefined;\n\t\t\tif (launch && launch.workspace) {\n\t\t\t\tfolder = launch.workspace;\n\t\t\t} else {\n\t\t\t\tconst folders = this.contextService.getWorkspace().folders;\n\t\t\t\tif (folders.length === 1) {\n\t\t\t\t\tfolder = folders[0];\n\t\t\t\t}\n\t\t\t}\n\t\t\ttry {\n\t\t\t\treturn await dbg.substituteVariables(folder, config);\n\t\t\t} catch (err) {\n\t\t\t\tthis.showError(err.message);\n\t\t\t\treturn undefined;\t// bail out\n\t\t\t}\n\t\t}\n\t\treturn Promise.resolve(config);\n\t}\n\n\tprivate async showError(message: string, errorActions: ReadonlyArray<IAction> = []): Promise<void> {\n\t\tconst configureAction = new Action(DEBUG_CONFIGURE_COMMAND_ID, DEBUG_CONFIGURE_LABEL, undefined, true, () => this.commandService.executeCommand(DEBUG_CONFIGURE_COMMAND_ID));\n\t\tconst actions = [...errorActions, configureAction];\n\t\tconst { choice } = await this.dialogService.show(severity.Error, message, actions.map(a => a.label).concat(nls.localize('cancel', \"Cancel\")), { cancelId: actions.length });\n\t\tif (choice < actions.length) {\n\t\t\tawait actions[choice].run();\n\t\t}\n\t}\n\n\t//---- focus management\n\n\tasync focusStackFrame(_stackFrame: IStackFrame | undefined, _thread?: IThread, _session?: IDebugSession, explicit?: boolean): Promise<void> {\n\t\tconst { stackFrame, thread, session } = getStackFrameThreadAndSessionToFocus(this.model, _stackFrame, _thread, _session);\n\n\t\tif (stackFrame) {\n\t\t\tconst editor = await stackFrame.openInEditor(this.editorService, true);\n\t\t\tif (editor) {\n\t\t\t\tconst control = editor.getControl();\n\t\t\t\tif (stackFrame && isCodeEditor(control) && control.hasModel()) {\n\t\t\t\t\tconst model = control.getModel();\n\t\t\t\t\tconst lineNumber = stackFrame.range.startLineNumber;\n\t\t\t\t\tif (lineNumber >= 1 && lineNumber <= model.getLineCount()) {\n\t\t\t\t\t\tconst lineContent = control.getModel().getLineContent(lineNumber);\n\t\t\t\t\t\taria.alert(nls.localize({ key: 'debuggingPaused', comment: ['First placeholder is the stack frame name, second is the line number, third placeholder is the reason why debugging is stopped, for example \"breakpoint\" and the last one is the file line content.'] },\n\t\t\t\t\t\t\t\"{0}:{1}, debugging paused {2}, {3}\", stackFrame.source ? stackFrame.source.name : '', stackFrame.range.startLineNumber, thread && thread.stoppedDetails ? `, reason ${thread.stoppedDetails.reason}` : '', lineContent));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (session) {\n\t\t\tthis.debugType.set(session.configuration.type);\n\t\t} else {\n\t\t\tthis.debugType.reset();\n\t\t}\n\n\t\tthis.viewModel.setFocus(stackFrame, thread, session, !!explicit);\n\t}\n\n\t//---- watches\n\n\taddWatchExpression(name?: string): void {\n\t\tconst we = this.model.addWatchExpression(name);\n\t\tif (!name) {\n\t\t\tthis.viewModel.setSelectedExpression(we);\n\t\t}\n\t\tthis.debugStorage.storeWatchExpressions(this.model.getWatchExpressions());\n\t}\n\n\trenameWatchExpression(id: string, newName: string): void {\n\t\tthis.model.renameWatchExpression(id, newName);\n\t\tthis.debugStorage.storeWatchExpressions(this.model.getWatchExpressions());\n\t}\n\n\tmoveWatchExpression(id: string, position: number): void {\n\t\tthis.model.moveWatchExpression(id, position);\n\t\tthis.debugStorage.storeWatchExpressions(this.model.getWatchExpressions());\n\t}\n\n\tremoveWatchExpressions(id?: string): void {\n\t\tthis.model.removeWatchExpressions(id);\n\t\tthis.debugStorage.storeWatchExpressions(this.model.getWatchExpressions());\n\t}\n\n\t//---- breakpoints\n\n\tcanSetBreakpointsIn(model: ITextModel): boolean {\n\t\treturn this.adapterManager.canSetBreakpointsIn(model);\n\t}\n\n\tasync enableOrDisableBreakpoints(enable: boolean, breakpoint?: IEnablement): Promise<void> {\n\t\tif (breakpoint) {\n\t\t\tthis.model.setEnablement(breakpoint, enable);\n\t\t\tthis.debugStorage.storeBreakpoints(this.model);\n\t\t\tif (breakpoint instanceof Breakpoint) {\n\t\t\t\tawait this.sendBreakpoints(breakpoint.uri);\n\t\t\t} else if (breakpoint instanceof FunctionBreakpoint) {\n\t\t\t\tawait this.sendFunctionBreakpoints();\n\t\t\t} else if (breakpoint instanceof DataBreakpoint) {\n\t\t\t\tawait this.sendDataBreakpoints();\n\t\t\t} else {\n\t\t\t\tawait this.sendExceptionBreakpoints();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.model.enableOrDisableAllBreakpoints(enable);\n\t\t\tthis.debugStorage.storeBreakpoints(this.model);\n\t\t\tawait this.sendAllBreakpoints();\n\t\t}\n\t\tthis.debugStorage.storeBreakpoints(this.model);\n\t}\n\n\tasync addBreakpoints(uri: uri, rawBreakpoints: IBreakpointData[], ariaAnnounce = true): Promise<IBreakpoint[]> {\n\t\tconst breakpoints = this.model.addBreakpoints(uri, rawBreakpoints);\n\t\tif (ariaAnnounce) {\n\t\t\tbreakpoints.forEach(bp => aria.status(nls.localize('breakpointAdded', \"Added breakpoint, line {0}, file {1}\", bp.lineNumber, uri.fsPath)));\n\t\t}\n\n\t\t// In some cases we need to store breakpoints before we send them because sending them can take a long time\n\t\t// And after sending them because the debug adapter can attach adapter data to a breakpoint\n\t\tthis.debugStorage.storeBreakpoints(this.model);\n\t\tawait this.sendBreakpoints(uri);\n\t\tthis.debugStorage.storeBreakpoints(this.model);\n\t\treturn breakpoints;\n\t}\n\n\tasync updateBreakpoints(uri: uri, data: Map<string, DebugProtocol.Breakpoint>, sendOnResourceSaved: boolean): Promise<void> {\n\t\tthis.model.updateBreakpoints(data);\n\t\tthis.debugStorage.storeBreakpoints(this.model);\n\t\tif (sendOnResourceSaved) {\n\t\t\tthis.breakpointsToSendOnResourceSaved.add(uri);\n\t\t} else {\n\t\t\tawait this.sendBreakpoints(uri);\n\t\t\tthis.debugStorage.storeBreakpoints(this.model);\n\t\t}\n\t}\n\n\tasync removeBreakpoints(id?: string): Promise<void> {\n\t\tconst toRemove = this.model.getBreakpoints().filter(bp => !id || bp.getId() === id);\n\t\ttoRemove.forEach(bp => aria.status(nls.localize('breakpointRemoved', \"Removed breakpoint, line {0}, file {1}\", bp.lineNumber, bp.uri.fsPath)));\n\t\tconst urisToClear = distinct(toRemove, bp => bp.uri.toString()).map(bp => bp.uri);\n\n\t\tthis.model.removeBreakpoints(toRemove);\n\n\t\tthis.debugStorage.storeBreakpoints(this.model);\n\t\tawait Promise.all(urisToClear.map(uri => this.sendBreakpoints(uri)));\n\t}\n\n\tsetBreakpointsActivated(activated: boolean): Promise<void> {\n\t\tthis.model.setBreakpointsActivated(activated);\n\t\treturn this.sendAllBreakpoints();\n\t}\n\n\taddFunctionBreakpoint(name?: string, id?: string): void {\n\t\tthis.model.addFunctionBreakpoint(name || '', id);\n\t}\n\n\tasync updateFunctionBreakpoint(id: string, update: { name?: string, hitCondition?: string, condition?: string }): Promise<void> {\n\t\tthis.model.updateFunctionBreakpoint(id, update);\n\t\tthis.debugStorage.storeBreakpoints(this.model);\n\t\tawait this.sendFunctionBreakpoints();\n\t}\n\n\tasync removeFunctionBreakpoints(id?: string): Promise<void> {\n\t\tthis.model.removeFunctionBreakpoints(id);\n\t\tthis.debugStorage.storeBreakpoints(this.model);\n\t\tawait this.sendFunctionBreakpoints();\n\t}\n\n\tasync addDataBreakpoint(label: string, dataId: string, canPersist: boolean, accessTypes: DebugProtocol.DataBreakpointAccessType[] | undefined, accessType: DebugProtocol.DataBreakpointAccessType): Promise<void> {\n\t\tthis.model.addDataBreakpoint(label, dataId, canPersist, accessTypes, accessType);\n\t\tthis.debugStorage.storeBreakpoints(this.model);\n\t\tawait this.sendDataBreakpoints();\n\t\tthis.debugStorage.storeBreakpoints(this.model);\n\t}\n\n\tasync removeDataBreakpoints(id?: string): Promise<void> {\n\t\tthis.model.removeDataBreakpoints(id);\n\t\tthis.debugStorage.storeBreakpoints(this.model);\n\t\tawait this.sendDataBreakpoints();\n\t}\n\n\tsetExceptionBreakpoints(data: DebugProtocol.ExceptionBreakpointsFilter[]): void {\n\t\tthis.model.setExceptionBreakpoints(data);\n\t\tthis.debugStorage.storeBreakpoints(this.model);\n\t}\n\n\tasync setExceptionBreakpointCondition(exceptionBreakpoint: IExceptionBreakpoint, condition: string | undefined): Promise<void> {\n\t\tthis.model.setExceptionBreakpointCondition(exceptionBreakpoint, condition);\n\t\tthis.debugStorage.storeBreakpoints(this.model);\n\t\tawait this.sendExceptionBreakpoints();\n\t}\n\n\tasync sendAllBreakpoints(session?: IDebugSession): Promise<any> {\n\t\tawait Promise.all(distinct(this.model.getBreakpoints(), bp => bp.uri.toString()).map(bp => this.sendBreakpoints(bp.uri, false, session)));\n\t\tawait this.sendFunctionBreakpoints(session);\n\t\tawait this.sendDataBreakpoints(session);\n\t\t// send exception breakpoints at the end since some debug adapters rely on the order\n\t\tawait this.sendExceptionBreakpoints(session);\n\t}\n\n\tprivate async sendBreakpoints(modelUri: uri, sourceModified = false, session?: IDebugSession): Promise<void> {\n\t\tconst breakpointsToSend = this.model.getBreakpoints({ uri: modelUri, enabledOnly: true });\n\t\tawait sendToOneOrAllSessions(this.model, session, s => s.sendBreakpoints(modelUri, breakpointsToSend, sourceModified));\n\t}\n\n\tprivate async sendFunctionBreakpoints(session?: IDebugSession): Promise<void> {\n\t\tconst breakpointsToSend = this.model.getFunctionBreakpoints().filter(fbp => fbp.enabled && this.model.areBreakpointsActivated());\n\n\t\tawait sendToOneOrAllSessions(this.model, session, async s => {\n\t\t\tif (s.capabilities.supportsFunctionBreakpoints) {\n\t\t\t\tawait s.sendFunctionBreakpoints(breakpointsToSend);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate async sendDataBreakpoints(session?: IDebugSession): Promise<void> {\n\t\tconst breakpointsToSend = this.model.getDataBreakpoints().filter(fbp => fbp.enabled && this.model.areBreakpointsActivated());\n\n\t\tawait sendToOneOrAllSessions(this.model, session, async s => {\n\t\t\tif (s.capabilities.supportsDataBreakpoints) {\n\t\t\t\tawait s.sendDataBreakpoints(breakpointsToSend);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate sendExceptionBreakpoints(session?: IDebugSession): Promise<void> {\n\t\tconst enabledExceptionBps = this.model.getExceptionBreakpoints().filter(exb => exb.enabled);\n\n\t\treturn sendToOneOrAllSessions(this.model, session, async s => {\n\t\t\tif (s.capabilities.supportsConfigurationDoneRequest && (!s.capabilities.exceptionBreakpointFilters || s.capabilities.exceptionBreakpointFilters.length === 0)) {\n\t\t\t\t// Only call `setExceptionBreakpoints` as specified in dap protocol #90001\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tawait s.sendExceptionBreakpoints(enabledExceptionBps);\n\t\t});\n\t}\n\n\tprivate onFileChanges(fileChangesEvent: FileChangesEvent): void {\n\t\tconst toRemove = this.model.getBreakpoints().filter(bp =>\n\t\t\tfileChangesEvent.contains(bp.uri, FileChangeType.DELETED));\n\t\tif (toRemove.length) {\n\t\t\tthis.model.removeBreakpoints(toRemove);\n\t\t}\n\n\t\tconst toSend: URI[] = [];\n\t\tfor (const uri of this.breakpointsToSendOnResourceSaved) {\n\t\t\tif (fileChangesEvent.contains(uri, FileChangeType.UPDATED)) {\n\t\t\t\ttoSend.push(uri);\n\t\t\t}\n\t\t}\n\n\t\tfor (const uri of toSend) {\n\t\t\tthis.breakpointsToSendOnResourceSaved.delete(uri);\n\t\t\tthis.sendBreakpoints(uri, true);\n\t\t}\n\t}\n}\n\nexport function getStackFrameThreadAndSessionToFocus(model: IDebugModel, stackFrame: IStackFrame | undefined, thread?: IThread, session?: IDebugSession): { stackFrame: IStackFrame | undefined, thread: IThread | undefined, session: IDebugSession | undefined } {\n\tif (!session) {\n\t\tif (stackFrame || thread) {\n\t\t\tsession = stackFrame ? stackFrame.thread.session : thread!.session;\n\t\t} else {\n\t\t\tconst sessions = model.getSessions();\n\t\t\tconst stoppedSession = sessions.find(s => s.state === State.Stopped);\n\t\t\tsession = stoppedSession || (sessions.length ? sessions[0] : undefined);\n\t\t}\n\t}\n\n\tif (!thread) {\n\t\tif (stackFrame) {\n\t\t\tthread = stackFrame.thread;\n\t\t} else {\n\t\t\tconst threads = session ? session.getAllThreads() : undefined;\n\t\t\tconst stoppedThread = threads && threads.find(t => t.stopped);\n\t\t\tthread = stoppedThread || (threads && threads.length ? threads[0] : undefined);\n\t\t}\n\t}\n\n\tif (!stackFrame && thread) {\n\t\tstackFrame = thread.getTopStackFrame();\n\t}\n\n\treturn { session, thread, stackFrame };\n}\n\nasync function sendToOneOrAllSessions(model: DebugModel, session: IDebugSession | undefined, send: (session: IDebugSession) => Promise<void>): Promise<void> {\n\tif (session) {\n\t\tawait send(session);\n\t} else {\n\t\tawait Promise.all(model.getSessions().map(s => send(s)));\n\t}\n}\n"]}