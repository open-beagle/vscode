{"version":3,"sources":["vs/workbench/contrib/debug/common/debugSource.ts"],"names":[],"mappings":"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","file":"debugSource.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport { URI } from 'vs/base/common/uri';\nimport { normalize, isAbsolute } from 'vs/base/common/path';\nimport * as resources from 'vs/base/common/resources';\nimport { DEBUG_SCHEME } from 'vs/workbench/contrib/debug/common/debug';\nimport { IRange } from 'vs/editor/common/core/range';\nimport { IEditorService, SIDE_GROUP, ACTIVE_GROUP } from 'vs/workbench/services/editor/common/editorService';\nimport { Schemas } from 'vs/base/common/network';\nimport { isUri } from 'vs/workbench/contrib/debug/common/debugUtils';\nimport { ITextEditorPane } from 'vs/workbench/common/editor';\nimport { TextEditorSelectionRevealType } from 'vs/platform/editor/common/editor';\nimport { IUriIdentityService } from 'vs/workbench/services/uriIdentity/common/uriIdentity';\n\nexport const UNKNOWN_SOURCE_LABEL = nls.localize('unknownSource', \"Unknown Source\");\n\n/**\n * Debug URI format\n *\n * a debug URI represents a Source object and the debug session where the Source comes from.\n *\n *       debug:arbitrary_path?session=123e4567-e89b-12d3-a456-426655440000&ref=1016\n *       \\___/ \\____________/ \\__________________________________________/ \\______/\n *         |          |                             |                          |\n *      scheme   source.path                    session id            source.reference\n *\n *\n */\n\nexport class Source {\n\n\treadonly uri: URI;\n\tavailable: boolean;\n\traw: DebugProtocol.Source;\n\n\tconstructor(raw_: DebugProtocol.Source | undefined, sessionId: string, uriIdentityService: IUriIdentityService) {\n\t\tlet path: string;\n\t\tif (raw_) {\n\t\t\tthis.raw = raw_;\n\t\t\tpath = this.raw.path || this.raw.name || '';\n\t\t\tthis.available = true;\n\t\t} else {\n\t\t\tthis.raw = { name: UNKNOWN_SOURCE_LABEL };\n\t\t\tthis.available = false;\n\t\t\tpath = `${DEBUG_SCHEME}:${UNKNOWN_SOURCE_LABEL}`;\n\t\t}\n\n\t\tthis.uri = getUriFromSource(this.raw, path, sessionId, uriIdentityService);\n\t}\n\n\tget name() {\n\t\treturn this.raw.name || resources.basenameOrAuthority(this.uri);\n\t}\n\n\tget origin() {\n\t\treturn this.raw.origin;\n\t}\n\n\tget presentationHint() {\n\t\treturn this.raw.presentationHint;\n\t}\n\n\tget reference() {\n\t\treturn this.raw.sourceReference;\n\t}\n\n\tget inMemory() {\n\t\treturn this.uri.scheme === DEBUG_SCHEME;\n\t}\n\n\topenInEditor(editorService: IEditorService, selection: IRange, preserveFocus?: boolean, sideBySide?: boolean, pinned?: boolean): Promise<ITextEditorPane | undefined> {\n\t\treturn !this.available ? Promise.resolve(undefined) : editorService.openEditor({\n\t\t\tresource: this.uri,\n\t\t\tdescription: this.origin,\n\t\t\toptions: {\n\t\t\t\tpreserveFocus,\n\t\t\t\tselection,\n\t\t\t\trevealIfOpened: true,\n\t\t\t\tselectionRevealType: TextEditorSelectionRevealType.CenterIfOutsideViewport,\n\t\t\t\tpinned: pinned || (!preserveFocus && !this.inMemory)\n\t\t\t}\n\t\t}, sideBySide ? SIDE_GROUP : ACTIVE_GROUP);\n\t}\n\n\tstatic getEncodedDebugData(modelUri: URI): { name: string, path: string, sessionId?: string, sourceReference?: number } {\n\t\tlet path: string;\n\t\tlet sourceReference: number | undefined;\n\t\tlet sessionId: string | undefined;\n\n\t\tswitch (modelUri.scheme) {\n\t\t\tcase Schemas.file:\n\t\t\t\tpath = normalize(modelUri.fsPath);\n\t\t\t\tbreak;\n\t\t\tcase DEBUG_SCHEME:\n\t\t\t\tpath = modelUri.path;\n\t\t\t\tif (modelUri.query) {\n\t\t\t\t\tconst keyvalues = modelUri.query.split('&');\n\t\t\t\t\tfor (let keyvalue of keyvalues) {\n\t\t\t\t\t\tconst pair = keyvalue.split('=');\n\t\t\t\t\t\tif (pair.length === 2) {\n\t\t\t\t\t\t\tswitch (pair[0]) {\n\t\t\t\t\t\t\t\tcase 'session':\n\t\t\t\t\t\t\t\t\tsessionId = pair[1];\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\tcase 'ref':\n\t\t\t\t\t\t\t\t\tsourceReference = parseInt(pair[1]);\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tpath = modelUri.toString();\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn {\n\t\t\tname: resources.basenameOrAuthority(modelUri),\n\t\t\tpath,\n\t\t\tsourceReference,\n\t\t\tsessionId\n\t\t};\n\t}\n}\n\nexport function getUriFromSource(raw: DebugProtocol.Source, path: string | undefined, sessionId: string, uriIdentityService: IUriIdentityService): URI {\n\tif (typeof raw.sourceReference === 'number' && raw.sourceReference > 0) {\n\t\treturn URI.from({\n\t\t\tscheme: DEBUG_SCHEME,\n\t\t\tpath,\n\t\t\tquery: `session=${sessionId}&ref=${raw.sourceReference}`\n\t\t});\n\t}\n\n\tif (path && isUri(path)) {\t// path looks like a uri\n\t\treturn uriIdentityService.asCanonicalUri(URI.parse(path));\n\t}\n\t// assume a filesystem path\n\tif (path && isAbsolute(path)) {\n\t\treturn uriIdentityService.asCanonicalUri(URI.file(path));\n\t}\n\t// path is relative: since VS Code cannot deal with this by itself\n\t// create a debug url that will result in a DAP 'source' request when the url is resolved.\n\treturn uriIdentityService.asCanonicalUri(URI.from({\n\t\tscheme: DEBUG_SCHEME,\n\t\tpath,\n\t\tquery: `session=${sessionId}`\n\t}));\n}\n"]}