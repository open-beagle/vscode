{"version":3,"file":"notebookViewModel.test.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/contrib/notebook/test/notebookViewModel.test.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { URI } from 'vs/base/common/uri';\nimport { IBulkEditService } from 'vs/editor/browser/services/bulkEditService';\nimport { TrackedRangeStickiness } from 'vs/editor/common/model';\nimport { IModelService } from 'vs/editor/common/services/modelService';\nimport { IModeService } from 'vs/editor/common/services/modeService';\nimport { ITextModelService } from 'vs/editor/common/services/resolverService';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { TestConfigurationService } from 'vs/platform/configuration/test/common/testConfigurationService';\nimport { IThemeService } from 'vs/platform/theme/common/themeService';\nimport { TestThemeService } from 'vs/platform/theme/test/common/testThemeService';\nimport { IUndoRedoService } from 'vs/platform/undoRedo/common/undoRedo';\nimport { reduceCellRanges } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { NotebookEventDispatcher } from 'vs/workbench/contrib/notebook/browser/viewModel/eventDispatcher';\nimport { NotebookViewModel } from 'vs/workbench/contrib/notebook/browser/viewModel/notebookViewModel';\nimport { NotebookTextModel } from 'vs/workbench/contrib/notebook/common/model/notebookTextModel';\nimport { CellKind, diff, notebookDocumentMetadataDefaults } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { ICellRange } from 'vs/workbench/contrib/notebook/common/notebookRange';\nimport { NotebookEditorTestModel, setupInstantiationService, withTestNotebook } from 'vs/workbench/contrib/notebook/test/testNotebookEditor';\n\nsuite('NotebookViewModel', () => {\n\tconst instantiationService = setupInstantiationService();\n\tconst textModelService = instantiationService.get(ITextModelService);\n\tconst bulkEditService = instantiationService.get(IBulkEditService);\n\tconst undoRedoService = instantiationService.get(IUndoRedoService);\n\tconst modelService = instantiationService.get(IModelService);\n\tconst modeService = instantiationService.get(IModeService);\n\n\tinstantiationService.stub(IConfigurationService, new TestConfigurationService());\n\tinstantiationService.stub(IThemeService, new TestThemeService());\n\n\ttest('ctor', function () {\n\t\tconst notebook = new NotebookTextModel('notebook', URI.parse('test'), [], notebookDocumentMetadataDefaults, { transientCellMetadata: {}, transientDocumentMetadata: {}, transientOutputs: false }, undoRedoService, modelService, modeService);\n\t\tconst model = new NotebookEditorTestModel(notebook);\n\t\tconst eventDispatcher = new NotebookEventDispatcher();\n\t\tconst viewModel = new NotebookViewModel('notebook', model.notebook, eventDispatcher, null, instantiationService, bulkEditService, undoRedoService, textModelService);\n\t\tassert.strictEqual(viewModel.viewType, 'notebook');\n\t});\n\n\ttest('insert/delete', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst viewModel = editor.viewModel;\n\n\t\t\t\tconst cell = viewModel.createCell(1, 'var c = 3', 'javascript', CellKind.Code, {}, [], true, true, null, []);\n\t\t\t\tassert.strictEqual(viewModel.length, 3);\n\t\t\t\tassert.strictEqual(viewModel.notebookDocument.cells.length, 3);\n\t\t\t\tassert.strictEqual(viewModel.getCellIndex(cell), 1);\n\n\t\t\t\tviewModel.deleteCell(1, true);\n\t\t\t\tassert.strictEqual(viewModel.length, 2);\n\t\t\t\tassert.strictEqual(viewModel.notebookDocument.cells.length, 2);\n\t\t\t\tassert.strictEqual(viewModel.getCellIndex(cell), -1);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('move cells down', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['//a', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['//b', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['//c', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst viewModel = editor.viewModel;\n\t\t\t\tviewModel.moveCellToIdx(0, 1, 0, true);\n\t\t\t\t// no-op\n\t\t\t\tassert.strictEqual(viewModel.cellAt(0)?.getText(), '//a');\n\t\t\t\tassert.strictEqual(viewModel.cellAt(1)?.getText(), '//b');\n\n\t\t\t\tviewModel.moveCellToIdx(0, 1, 1, true);\n\t\t\t\t// b, a, c\n\t\t\t\tassert.strictEqual(viewModel.cellAt(0)?.getText(), '//b');\n\t\t\t\tassert.strictEqual(viewModel.cellAt(1)?.getText(), '//a');\n\t\t\t\tassert.strictEqual(viewModel.cellAt(2)?.getText(), '//c');\n\n\t\t\t\tviewModel.moveCellToIdx(0, 1, 2, true);\n\t\t\t\t// a, c, b\n\t\t\t\tassert.strictEqual(viewModel.cellAt(0)?.getText(), '//a');\n\t\t\t\tassert.strictEqual(viewModel.cellAt(1)?.getText(), '//c');\n\t\t\t\tassert.strictEqual(viewModel.cellAt(2)?.getText(), '//b');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('move cells up', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['//a', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['//b', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['//c', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst viewModel = editor.viewModel;\n\t\t\t\tviewModel.moveCellToIdx(1, 1, 0, true);\n\t\t\t\t// b, a, c\n\t\t\t\tassert.strictEqual(viewModel.cellAt(0)?.getText(), '//b');\n\t\t\t\tassert.strictEqual(viewModel.cellAt(1)?.getText(), '//a');\n\n\t\t\t\tviewModel.moveCellToIdx(2, 1, 0, true);\n\t\t\t\t// c, b, a\n\t\t\t\tassert.strictEqual(viewModel.cellAt(0)?.getText(), '//c');\n\t\t\t\tassert.strictEqual(viewModel.cellAt(1)?.getText(), '//b');\n\t\t\t\tassert.strictEqual(viewModel.cellAt(2)?.getText(), '//a');\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('index', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst viewModel = editor.viewModel;\n\t\t\t\tconst firstViewCell = viewModel.cellAt(0)!;\n\t\t\t\tconst lastViewCell = viewModel.cellAt(viewModel.length - 1)!;\n\n\t\t\t\tconst insertIndex = viewModel.getCellIndex(firstViewCell) + 1;\n\t\t\t\tconst cell = viewModel.createCell(insertIndex, 'var c = 3;', 'javascript', CellKind.Code, {}, [], true);\n\n\t\t\t\tconst addedCellIndex = viewModel.getCellIndex(cell);\n\t\t\t\tviewModel.deleteCell(addedCellIndex, true);\n\n\t\t\t\tconst secondInsertIndex = viewModel.getCellIndex(lastViewCell) + 1;\n\t\t\t\tconst cell2 = viewModel.createCell(secondInsertIndex, 'var d = 4;', 'javascript', CellKind.Code, {}, [], true);\n\n\t\t\t\tassert.strictEqual(viewModel.length, 3);\n\t\t\t\tassert.strictEqual(viewModel.notebookDocument.cells.length, 3);\n\t\t\t\tassert.strictEqual(viewModel.getCellIndex(cell2), 2);\n\t\t\t}\n\t\t);\n\t});\n});\n\nfunction getVisibleCells<T>(cells: T[], hiddenRanges: ICellRange[]) {\n\tif (!hiddenRanges.length) {\n\t\treturn cells;\n\t}\n\n\tlet start = 0;\n\tlet hiddenRangeIndex = 0;\n\tconst result: T[] = [];\n\n\twhile (start < cells.length && hiddenRangeIndex < hiddenRanges.length) {\n\t\tif (start < hiddenRanges[hiddenRangeIndex].start) {\n\t\t\tresult.push(...cells.slice(start, hiddenRanges[hiddenRangeIndex].start));\n\t\t}\n\n\t\tstart = hiddenRanges[hiddenRangeIndex].end + 1;\n\t\thiddenRangeIndex++;\n\t}\n\n\tif (start < cells.length) {\n\t\tresult.push(...cells.slice(start));\n\t}\n\n\treturn result;\n}\n\nsuite('NotebookViewModel Decorations', () => {\n\ttest('tracking range', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var e = 5;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst viewModel = editor.viewModel;\n\t\t\t\tconst trackedId = viewModel.setTrackedRange('test', { start: 1, end: 2 }, TrackedRangeStickiness.GrowsOnlyWhenTypingAfter);\n\t\t\t\tassert.deepStrictEqual(viewModel.getTrackedRange(trackedId!), {\n\t\t\t\t\tstart: 1,\n\n\t\t\t\t\tend: 2,\n\t\t\t\t});\n\n\t\t\t\tviewModel.createCell(0, 'var d = 6;', 'javascript', CellKind.Code, {}, [], true);\n\t\t\t\tassert.deepStrictEqual(viewModel.getTrackedRange(trackedId!), {\n\t\t\t\t\tstart: 2,\n\n\t\t\t\t\tend: 3\n\t\t\t\t});\n\n\t\t\t\tviewModel.deleteCell(0, true);\n\t\t\t\tassert.deepStrictEqual(viewModel.getTrackedRange(trackedId!), {\n\t\t\t\t\tstart: 1,\n\n\t\t\t\t\tend: 2\n\t\t\t\t});\n\n\t\t\t\tviewModel.createCell(3, 'var d = 7;', 'javascript', CellKind.Code, {}, [], true);\n\t\t\t\tassert.deepStrictEqual(viewModel.getTrackedRange(trackedId!), {\n\t\t\t\t\tstart: 1,\n\n\t\t\t\t\tend: 3\n\t\t\t\t});\n\n\t\t\t\tviewModel.deleteCell(3, true);\n\t\t\t\tassert.deepStrictEqual(viewModel.getTrackedRange(trackedId!), {\n\t\t\t\t\tstart: 1,\n\n\t\t\t\t\tend: 2\n\t\t\t\t});\n\n\t\t\t\tviewModel.deleteCell(1, true);\n\t\t\t\tassert.deepStrictEqual(viewModel.getTrackedRange(trackedId!), {\n\t\t\t\t\tstart: 0,\n\n\t\t\t\t\tend: 1\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('tracking range 2', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var a = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var b = 2;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var d = 4;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var e = 5;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var e = 6;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['var e = 7;', 'javascript', CellKind.Code, [], {}],\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst viewModel = editor.viewModel;\n\t\t\t\tconst trackedId = viewModel.setTrackedRange('test', { start: 1, end: 3 }, TrackedRangeStickiness.GrowsOnlyWhenTypingAfter);\n\t\t\t\tassert.deepStrictEqual(viewModel.getTrackedRange(trackedId!), {\n\t\t\t\t\tstart: 1,\n\n\t\t\t\t\tend: 3\n\t\t\t\t});\n\n\t\t\t\tviewModel.createCell(5, 'var d = 9;', 'javascript', CellKind.Code, {}, [], true);\n\t\t\t\tassert.deepStrictEqual(viewModel.getTrackedRange(trackedId!), {\n\t\t\t\t\tstart: 1,\n\n\t\t\t\t\tend: 3\n\t\t\t\t});\n\n\t\t\t\tviewModel.createCell(4, 'var d = 10;', 'javascript', CellKind.Code, {}, [], true);\n\t\t\t\tassert.deepStrictEqual(viewModel.getTrackedRange(trackedId!), {\n\t\t\t\t\tstart: 1,\n\n\t\t\t\t\tend: 4\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('reduce range', async function () {\n\t\tassert.deepStrictEqual(reduceCellRanges([\n\t\t\t{ start: 0, end: 1 },\n\t\t\t{ start: 1, end: 2 },\n\t\t\t{ start: 4, end: 6 }\n\t\t]), [\n\t\t\t{ start: 0, end: 2 },\n\t\t\t{ start: 4, end: 6 }\n\t\t]);\n\n\t\tassert.deepStrictEqual(reduceCellRanges([\n\t\t\t{ start: 0, end: 1 },\n\t\t\t{ start: 1, end: 2 },\n\t\t\t{ start: 3, end: 4 }\n\t\t]), [\n\t\t\t{ start: 0, end: 4 }\n\t\t]);\n\t});\n\n\ttest('diff hidden ranges', async function () {\n\t\tassert.deepStrictEqual(getVisibleCells<number>([1, 2, 3, 4, 5], []), [1, 2, 3, 4, 5]);\n\n\t\tassert.deepStrictEqual(\n\t\t\tgetVisibleCells<number>(\n\t\t\t\t[1, 2, 3, 4, 5],\n\t\t\t\t[{ start: 1, end: 2 }]\n\t\t\t),\n\t\t\t[1, 4, 5]\n\t\t);\n\n\t\tassert.deepStrictEqual(\n\t\t\tgetVisibleCells<number>(\n\t\t\t\t[1, 2, 3, 4, 5, 6, 7, 8, 9],\n\t\t\t\t[\n\t\t\t\t\t{ start: 1, end: 2 },\n\t\t\t\t\t{ start: 4, end: 5 }\n\t\t\t\t]\n\t\t\t),\n\t\t\t[1, 4, 7, 8, 9]\n\t\t);\n\n\t\tconst original = getVisibleCells<number>(\n\t\t\t[1, 2, 3, 4, 5, 6, 7, 8, 9],\n\t\t\t[\n\t\t\t\t{ start: 1, end: 2 },\n\t\t\t\t{ start: 4, end: 5 }\n\t\t\t]\n\t\t);\n\n\t\tconst modified = getVisibleCells<number>(\n\t\t\t[1, 2, 3, 4, 5, 6, 7, 8, 9],\n\t\t\t[\n\t\t\t\t{ start: 2, end: 4 }\n\t\t\t]\n\t\t);\n\n\t\tassert.deepStrictEqual(diff<number>(original, modified, (a) => {\n\t\t\treturn original.indexOf(a) >= 0;\n\t\t}), [{ start: 1, deleteCount: 1, toInsert: [2, 6] }]);\n\t});\n\n\ttest('hidden ranges', async function () {\n\n\t});\n});\n\nsuite('NotebookViewModel API', () => {\n\ttest('#115432, get nearest code cell', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markdown, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header b', 'markdown', CellKind.Markdown, [], {}],\n\t\t\t\t['b = 2;', 'python', CellKind.Code, [], {}],\n\t\t\t\t['var c = 3', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header d', 'markdown', CellKind.Markdown, [], {}],\n\t\t\t\t['var e = 4;', 'TypeScript', CellKind.Code, [], {}],\n\t\t\t\t['# header f', 'markdown', CellKind.Markdown, [], {}]\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst viewModel = editor.viewModel;\n\t\t\t\tassert.strictEqual(viewModel.nearestCodeCellIndex(0), 1);\n\t\t\t\t// find the nearest code cell from above\n\t\t\t\tassert.strictEqual(viewModel.nearestCodeCellIndex(2), 1);\n\t\t\t\tassert.strictEqual(viewModel.nearestCodeCellIndex(4), 3);\n\t\t\t\tassert.strictEqual(viewModel.nearestCodeCellIndex(5), 4);\n\t\t\t\tassert.strictEqual(viewModel.nearestCodeCellIndex(6), 4);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('#108464, get nearest code cell', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markdown, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header b', 'markdown', CellKind.Markdown, [], {}]\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst viewModel = editor.viewModel;\n\t\t\t\tassert.strictEqual(viewModel.nearestCodeCellIndex(2), 1);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('getCells', async () => {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['# header a', 'markdown', CellKind.Markdown, [], {}],\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}],\n\t\t\t\t['# header b', 'markdown', CellKind.Markdown, [], {}]\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst viewModel = editor.viewModel;\n\t\t\t\tassert.strictEqual(viewModel.getCells().length, 3);\n\t\t\t\tassert.deepStrictEqual(viewModel.getCells({ start: 0, end: 1 }).map(cell => cell.getText()), ['# header a']);\n\t\t\t\tassert.deepStrictEqual(viewModel.getCells({ start: 0, end: 2 }).map(cell => cell.getText()), ['# header a', 'var b = 1;']);\n\t\t\t\tassert.deepStrictEqual(viewModel.getCells({ start: 0, end: 3 }).map(cell => cell.getText()), ['# header a', 'var b = 1;', '# header b']);\n\t\t\t\tassert.deepStrictEqual(viewModel.getCells({ start: 0, end: 4 }).map(cell => cell.getText()), ['# header a', 'var b = 1;', '# header b']);\n\t\t\t\tassert.deepStrictEqual(viewModel.getCells({ start: 1, end: 4 }).map(cell => cell.getText()), ['var b = 1;', '# header b']);\n\t\t\t\tassert.deepStrictEqual(viewModel.getCells({ start: 2, end: 4 }).map(cell => cell.getText()), ['# header b']);\n\t\t\t\tassert.deepStrictEqual(viewModel.getCells({ start: 3, end: 4 }).map(cell => cell.getText()), []);\n\n\t\t\t\t// no one should use an invalid range but `getCells` should be able to handle that.\n\t\t\t\tassert.deepStrictEqual(viewModel.getCells({ start: -1, end: 1 }).map(cell => cell.getText()), ['# header a']);\n\t\t\t\tassert.deepStrictEqual(viewModel.getCells({ start: 3, end: 0 }).map(cell => cell.getText()), ['# header a', 'var b = 1;', '# header b']);\n\t\t\t}\n\t\t);\n\t});\n\n\ttest('split cell', async function () {\n\t\tawait withTestNotebook(\n\t\t\t[\n\t\t\t\t['var b = 1;', 'javascript', CellKind.Code, [], {}]\n\t\t\t],\n\t\t\t(editor) => {\n\t\t\t\tconst viewModel = editor.viewModel;\n\t\t\t\tassert.deepStrictEqual(viewModel.computeCellLinesContents(viewModel.cellAt(0)!, [{ lineNumber: 1, column: 4 }]), [\n\t\t\t\t\t'var',\n\t\t\t\t\t' b = 1;'\n\t\t\t\t]);\n\n\t\t\t\tassert.deepStrictEqual(viewModel.computeCellLinesContents(viewModel.cellAt(0)!, [{ lineNumber: 1, column: 4 }, { lineNumber: 1, column: 6 }]), [\n\t\t\t\t\t'var',\n\t\t\t\t\t' b',\n\t\t\t\t\t' = 1;'\n\t\t\t\t]);\n\n\t\t\t\tassert.deepStrictEqual(viewModel.computeCellLinesContents(viewModel.cellAt(0)!, [{ lineNumber: 1, column: 1 }]), [\n\t\t\t\t\t'',\n\t\t\t\t\t'var b = 1;'\n\t\t\t\t]);\n\n\t\t\t\tassert.deepStrictEqual(viewModel.computeCellLinesContents(viewModel.cellAt(0)!, [{ lineNumber: 1, column: 11 }]), [\n\t\t\t\t\t'var b = 1;',\n\t\t\t\t\t'',\n\t\t\t\t]);\n\t\t\t}\n\t\t);\n\t});\n});\n"]}