{"version":3,"file":"notebookCellList.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/contrib/notebook/browser/view/notebookCellList.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from 'vs/base/browser/dom';\nimport { IMouseWheelEvent } from 'vs/base/browser/mouseEvent';\nimport { IListRenderer, IListVirtualDelegate, ListError } from 'vs/base/browser/ui/list/list';\nimport { IListStyles, IStyleController } from 'vs/base/browser/ui/list/listWidget';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { DisposableStore, IDisposable } from 'vs/base/common/lifecycle';\nimport { isMacintosh } from 'vs/base/common/platform';\nimport { ScrollEvent } from 'vs/base/common/scrollable';\nimport { Range } from 'vs/editor/common/core/range';\nimport { TrackedRangeStickiness } from 'vs/editor/common/model';\nimport { PrefixSumComputer } from 'vs/editor/common/viewModel/prefixSumComputer';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { IListService, IWorkbenchListOptions, WorkbenchList } from 'vs/platform/list/browser/listService';\nimport { IThemeService } from 'vs/platform/theme/common/themeService';\nimport { CellRevealPosition, CellRevealType, CursorAtBoundary, getVisibleCells, ICellViewModel, INotebookCellList, reduceCellRanges, CellEditState, CellFocusMode, BaseCellRenderTemplate, NOTEBOOK_CELL_LIST_FOCUSED, cellRangesEqual, ICellOutputViewModel } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { CellViewModel, NotebookViewModel } from 'vs/workbench/contrib/notebook/browser/viewModel/notebookViewModel';\nimport { diff, NOTEBOOK_EDITOR_CURSOR_BOUNDARY, CellKind, SelectionStateType } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { ICellRange, cellRangesToIndexes } from 'vs/workbench/contrib/notebook/common/notebookRange';\nimport { clamp } from 'vs/base/common/numbers';\nimport { SCROLLABLE_ELEMENT_PADDING_TOP } from 'vs/workbench/contrib/notebook/browser/constants';\nimport { ISplice } from 'vs/base/common/sequence';\n\nexport interface IFocusNextPreviousDelegate {\n\tonFocusNext(applyFocusNext: () => void): void;\n\tonFocusPrevious(applyFocusPrevious: () => void): void;\n}\n\nexport interface INotebookCellListOptions extends IWorkbenchListOptions<CellViewModel> {\n\tfocusNextPreviousDelegate: IFocusNextPreviousDelegate;\n}\n\nexport class NotebookCellList extends WorkbenchList<CellViewModel> implements IDisposable, IStyleController, INotebookCellList {\n\tget onWillScroll(): Event<ScrollEvent> { return this.view.onWillScroll; }\n\n\tget rowsContainer(): HTMLElement {\n\t\treturn this.view.containerDomNode;\n\t}\n\tprivate _previousFocusedElements: CellViewModel[] = [];\n\tprivate _localDisposableStore = new DisposableStore();\n\tprivate _viewModelStore = new DisposableStore();\n\tprivate styleElement?: HTMLStyleElement;\n\n\tprivate readonly _onDidRemoveOutputs = new Emitter<readonly ICellOutputViewModel[]>();\n\treadonly onDidRemoveOutputs = this._onDidRemoveOutputs.event;\n\n\tprivate readonly _onDidHideOutputs = new Emitter<readonly ICellOutputViewModel[]>();\n\treadonly onDidHideOutputs = this._onDidHideOutputs.event;\n\n\tprivate readonly _onDidRemoveCellsFromView = new Emitter<readonly ICellViewModel[]>();\n\treadonly onDidRemoveCellsFromView = this._onDidRemoveCellsFromView.event;\n\n\tprivate _viewModel: NotebookViewModel | null = null;\n\tget viewModel(): NotebookViewModel | null {\n\t\treturn this._viewModel;\n\t}\n\tprivate _hiddenRangeIds: string[] = [];\n\tprivate hiddenRangesPrefixSum: PrefixSumComputer | null = null;\n\n\tprivate readonly _onDidChangeVisibleRanges = new Emitter<void>();\n\n\tonDidChangeVisibleRanges: Event<void> = this._onDidChangeVisibleRanges.event;\n\tprivate _visibleRanges: ICellRange[] = [];\n\n\tget visibleRanges() {\n\t\treturn this._visibleRanges;\n\t}\n\n\tset visibleRanges(ranges: ICellRange[]) {\n\t\tif (cellRangesEqual(this._visibleRanges, ranges)) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._visibleRanges = ranges;\n\t\tthis._onDidChangeVisibleRanges.fire();\n\t}\n\n\tprivate _isDisposed = false;\n\n\tget isDisposed() {\n\t\treturn this._isDisposed;\n\t}\n\n\tprivate _isInLayout: boolean = false;\n\n\tprivate readonly _focusNextPreviousDelegate: IFocusNextPreviousDelegate;\n\n\tconstructor(\n\t\tprivate listUser: string,\n\t\tparentContainer: HTMLElement,\n\t\tcontainer: HTMLElement,\n\t\tdelegate: IListVirtualDelegate<CellViewModel>,\n\t\trenderers: IListRenderer<CellViewModel, BaseCellRenderTemplate>[],\n\t\tcontextKeyService: IContextKeyService,\n\t\toptions: INotebookCellListOptions,\n\t\t@IListService listService: IListService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IKeybindingService keybindingService: IKeybindingService\n\t) {\n\t\tsuper(listUser, container, delegate, renderers, options, contextKeyService, listService, themeService, configurationService, keybindingService);\n\t\tNOTEBOOK_CELL_LIST_FOCUSED.bindTo(this.contextKeyService).set(true);\n\t\tthis._focusNextPreviousDelegate = options.focusNextPreviousDelegate;\n\t\tthis._previousFocusedElements = this.getFocusedElements();\n\t\tthis._localDisposableStore.add(this.onDidChangeFocus((e) => {\n\t\t\tthis._previousFocusedElements.forEach(element => {\n\t\t\t\tif (e.elements.indexOf(element) < 0) {\n\t\t\t\t\telement.onDeselect();\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis._previousFocusedElements = e.elements;\n\n\t\t\tif (document.activeElement && document.activeElement.classList.contains('webview')) {\n\t\t\t\tsuper.domFocus();\n\t\t\t}\n\t\t}));\n\n\t\tconst notebookEditorCursorAtBoundaryContext = NOTEBOOK_EDITOR_CURSOR_BOUNDARY.bindTo(contextKeyService);\n\t\tnotebookEditorCursorAtBoundaryContext.set('none');\n\n\t\tlet cursorSelectionListener: IDisposable | null = null;\n\t\tlet textEditorAttachListener: IDisposable | null = null;\n\n\t\tconst recomputeContext = (element: CellViewModel) => {\n\t\t\tswitch (element.cursorAtBoundary()) {\n\t\t\t\tcase CursorAtBoundary.Both:\n\t\t\t\t\tnotebookEditorCursorAtBoundaryContext.set('both');\n\t\t\t\t\tbreak;\n\t\t\t\tcase CursorAtBoundary.Top:\n\t\t\t\t\tnotebookEditorCursorAtBoundaryContext.set('top');\n\t\t\t\t\tbreak;\n\t\t\t\tcase CursorAtBoundary.Bottom:\n\t\t\t\t\tnotebookEditorCursorAtBoundaryContext.set('bottom');\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tnotebookEditorCursorAtBoundaryContext.set('none');\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\treturn;\n\t\t};\n\n\t\t// Cursor Boundary context\n\t\tthis._localDisposableStore.add(this.onDidChangeFocus((e) => {\n\t\t\tif (e.elements.length) {\n\t\t\t\tcursorSelectionListener?.dispose();\n\t\t\t\ttextEditorAttachListener?.dispose();\n\t\t\t\t// we only validate the first focused element\n\t\t\t\tconst focusedElement = e.elements[0];\n\n\t\t\t\tcursorSelectionListener = focusedElement.onDidChangeState((e) => {\n\t\t\t\t\tif (e.selectionChanged) {\n\t\t\t\t\t\trecomputeContext(focusedElement);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\ttextEditorAttachListener = focusedElement.onDidChangeEditorAttachState(() => {\n\t\t\t\t\tif (focusedElement.editorAttached) {\n\t\t\t\t\t\trecomputeContext(focusedElement);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\trecomputeContext(focusedElement);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// reset context\n\t\t\tnotebookEditorCursorAtBoundaryContext.set('none');\n\t\t}));\n\n\t\tthis._localDisposableStore.add(this.view.onMouseDblClick(() => {\n\t\t\tconst focus = this.getFocusedElements()[0];\n\n\t\t\tif (focus && focus.cellKind === CellKind.Markdown && !focus.metadata?.inputCollapsed) {\n\t\t\t\tfocus.updateEditState(CellEditState.Editing, 'dbclick');\n\t\t\t\tfocus.focusMode = CellFocusMode.Editor;\n\t\t\t}\n\t\t}));\n\n\t\t// update visibleRanges\n\t\tconst updateVisibleRanges = () => {\n\t\t\tif (!this.view.length) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst top = this.getViewScrollTop();\n\t\t\tconst bottom = this.getViewScrollBottom();\n\t\t\tif (top >= bottom) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst topViewIndex = clamp(this.view.indexAt(top), 0, this.view.length - 1);\n\t\t\tconst topElement = this.view.element(topViewIndex);\n\t\t\tconst topModelIndex = this._viewModel!.getCellIndex(topElement);\n\t\t\tconst bottomViewIndex = clamp(this.view.indexAt(bottom), 0, this.view.length - 1);\n\t\t\tconst bottomElement = this.view.element(bottomViewIndex);\n\t\t\tconst bottomModelIndex = this._viewModel!.getCellIndex(bottomElement);\n\n\t\t\tif (bottomModelIndex - topModelIndex === bottomViewIndex - topViewIndex) {\n\t\t\t\tthis.visibleRanges = [{ start: topModelIndex, end: bottomModelIndex }];\n\t\t\t} else {\n\t\t\t\tthis.visibleRanges = this._getVisibleRangesFromIndex(topViewIndex, topModelIndex, bottomViewIndex, bottomModelIndex);\n\t\t\t}\n\t\t};\n\n\t\tthis._localDisposableStore.add(this.view.onDidChangeContentHeight(() => {\n\t\t\tif (this._isInLayout) {\n\t\t\t\tDOM.scheduleAtNextAnimationFrame(() => {\n\t\t\t\t\tupdateVisibleRanges();\n\t\t\t\t});\n\t\t\t}\n\t\t\tupdateVisibleRanges();\n\t\t}));\n\t\tthis._localDisposableStore.add(this.view.onDidScroll(() => {\n\t\t\tif (this._isInLayout) {\n\t\t\t\tDOM.scheduleAtNextAnimationFrame(() => {\n\t\t\t\t\tupdateVisibleRanges();\n\t\t\t\t});\n\t\t\t}\n\t\t\tupdateVisibleRanges();\n\t\t}));\n\t}\n\n\telementAt(position: number): ICellViewModel | undefined {\n\t\tif (!this.view.length) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst idx = this.view.indexAt(position);\n\t\tconst clamped = clamp(idx, 0, this.view.length - 1);\n\t\treturn this.element(clamped);\n\t}\n\n\telementHeight(element: ICellViewModel): number {\n\t\tconst index = this._getViewIndexUpperBound(element);\n\t\tif (index === undefined || index < 0 || index >= this.length) {\n\t\t\tthis._getViewIndexUpperBound(element);\n\t\t\tthrow new ListError(this.listUser, `Invalid index ${index}`);\n\t\t}\n\n\t\treturn this.view.elementHeight(index);\n\t}\n\n\tdetachViewModel() {\n\t\tthis._viewModelStore.clear();\n\t\tthis._viewModel = null;\n\t\tthis.hiddenRangesPrefixSum = null;\n\t}\n\n\tattachViewModel(model: NotebookViewModel) {\n\t\tthis._viewModel = model;\n\t\tthis._viewModelStore.add(model.onDidChangeViewCells((e) => {\n\t\t\tif (this._isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst currentRanges = this._hiddenRangeIds.map(id => this._viewModel!.getTrackedRange(id)).filter(range => range !== null) as ICellRange[];\n\t\t\tconst newVisibleViewCells: CellViewModel[] = getVisibleCells(this._viewModel!.viewCells as CellViewModel[], currentRanges);\n\n\t\t\tconst oldVisibleViewCells: CellViewModel[] = [];\n\t\t\tconst oldViewCellMapping = new Set<string>();\n\t\t\tfor (let i = 0; i < this.length; i++) {\n\t\t\t\toldVisibleViewCells.push(this.element(i));\n\t\t\t\toldViewCellMapping.add(this.element(i).uri.toString());\n\t\t\t}\n\n\t\t\tconst viewDiffs = diff<CellViewModel>(oldVisibleViewCells, newVisibleViewCells, a => {\n\t\t\t\treturn oldViewCellMapping.has(a.uri.toString());\n\t\t\t});\n\n\t\t\tif (e.synchronous) {\n\t\t\t\tthis._updateElementsInWebview(viewDiffs);\n\t\t\t} else {\n\t\t\t\tthis._viewModelStore.add(DOM.scheduleAtNextAnimationFrame(() => {\n\t\t\t\t\tif (this._isDisposed) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis._updateElementsInWebview(viewDiffs);\n\t\t\t\t}));\n\t\t\t}\n\t\t}));\n\n\t\tthis._viewModelStore.add(model.onDidChangeSelection((e) => {\n\t\t\tif (e === 'view') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// convert model selections to view selections\n\t\t\tconst viewSelections = cellRangesToIndexes(model.getSelections()).map(index => model.cellAt(index)).filter(cell => !!cell).map(cell => this._getViewIndexUpperBound(cell!));\n\t\t\tthis.setSelection(viewSelections, undefined, true);\n\t\t\tconst primary = cellRangesToIndexes([model.getFocus()]).map(index => model.cellAt(index)).filter(cell => !!cell).map(cell => this._getViewIndexUpperBound(cell!));\n\n\t\t\tif (primary.length) {\n\t\t\t\tthis.setFocus(primary, undefined, true);\n\t\t\t}\n\t\t}));\n\n\t\tconst hiddenRanges = model.getHiddenRanges();\n\t\tthis.setHiddenAreas(hiddenRanges, false);\n\t\tconst newRanges = reduceCellRanges(hiddenRanges);\n\t\tconst viewCells = model.viewCells.slice(0) as CellViewModel[];\n\t\tnewRanges.reverse().forEach(range => {\n\t\t\tconst removedCells = viewCells.splice(range.start, range.end - range.start + 1);\n\t\t\tthis._onDidRemoveCellsFromView.fire(removedCells);\n\t\t});\n\n\t\tthis.splice2(0, 0, viewCells);\n\t}\n\n\tprivate _updateElementsInWebview(viewDiffs: ISplice<CellViewModel>[]) {\n\t\tviewDiffs.reverse().forEach((diff) => {\n\t\t\tconst hiddenOutputs: ICellOutputViewModel[] = [];\n\t\t\tconst deletedOutputs: ICellOutputViewModel[] = [];\n\t\t\tconst removedMarkdownCells: ICellViewModel[] = [];\n\n\t\t\tfor (let i = diff.start; i < diff.start + diff.deleteCount; i++) {\n\t\t\t\tconst cell = this.element(i);\n\t\t\t\tif (cell.cellKind === CellKind.Code) {\n\t\t\t\t\tif (this._viewModel!.hasCell(cell.handle)) {\n\t\t\t\t\t\thiddenOutputs.push(...cell?.outputsViewModels);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdeletedOutputs.push(...cell?.outputsViewModels);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tremovedMarkdownCells.push(cell);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.splice2(diff.start, diff.deleteCount, diff.toInsert);\n\n\t\t\tthis._onDidHideOutputs.fire(hiddenOutputs);\n\t\t\tthis._onDidRemoveOutputs.fire(deletedOutputs);\n\t\t\tthis._onDidRemoveCellsFromView.fire(removedMarkdownCells);\n\t\t});\n\t}\n\n\tclear() {\n\t\tsuper.splice(0, this.length);\n\t}\n\n\tsetHiddenAreas(_ranges: ICellRange[], triggerViewUpdate: boolean): boolean {\n\t\tif (!this._viewModel) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst newRanges = reduceCellRanges(_ranges);\n\t\t// delete old tracking ranges\n\t\tconst oldRanges = this._hiddenRangeIds.map(id => this._viewModel!.getTrackedRange(id)).filter(range => range !== null) as ICellRange[];\n\t\tif (newRanges.length === oldRanges.length) {\n\t\t\tlet hasDifference = false;\n\t\t\tfor (let i = 0; i < newRanges.length; i++) {\n\t\t\t\tif (!(newRanges[i].start === oldRanges[i].start && newRanges[i].end === oldRanges[i].end)) {\n\t\t\t\t\thasDifference = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!hasDifference) {\n\t\t\t\t// they call 'setHiddenAreas' for a reason, even if the ranges are still the same, it's possible that the hiddenRangeSum is not update to date\n\t\t\t\tthis._updateHiddenRangePrefixSum(newRanges);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tthis._hiddenRangeIds.forEach(id => this._viewModel!.setTrackedRange(id, null, TrackedRangeStickiness.GrowsOnlyWhenTypingAfter));\n\t\tconst hiddenAreaIds = newRanges.map(range => this._viewModel!.setTrackedRange(null, range, TrackedRangeStickiness.GrowsOnlyWhenTypingAfter)).filter(id => id !== null) as string[];\n\n\t\tthis._hiddenRangeIds = hiddenAreaIds;\n\n\t\t// set hidden ranges prefix sum\n\t\tthis._updateHiddenRangePrefixSum(newRanges);\n\n\t\tif (triggerViewUpdate) {\n\t\t\tthis.updateHiddenAreasInView(oldRanges, newRanges);\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tprivate _updateHiddenRangePrefixSum(newRanges: ICellRange[]) {\n\t\tlet start = 0;\n\t\tlet index = 0;\n\t\tconst ret: number[] = [];\n\n\t\twhile (index < newRanges.length) {\n\t\t\tfor (let j = start; j < newRanges[index].start - 1; j++) {\n\t\t\t\tret.push(1);\n\t\t\t}\n\n\t\t\tret.push(newRanges[index].end - newRanges[index].start + 1 + 1);\n\t\t\tstart = newRanges[index].end + 1;\n\t\t\tindex++;\n\t\t}\n\n\t\tfor (let i = start; i < this._viewModel!.length; i++) {\n\t\t\tret.push(1);\n\t\t}\n\n\t\tconst values = new Uint32Array(ret.length);\n\t\tfor (let i = 0; i < ret.length; i++) {\n\t\t\tvalues[i] = ret[i];\n\t\t}\n\n\t\tthis.hiddenRangesPrefixSum = new PrefixSumComputer(values);\n\t}\n\n\t/**\n\t * oldRanges and newRanges are all reduced and sorted.\n\t */\n\tupdateHiddenAreasInView(oldRanges: ICellRange[], newRanges: ICellRange[]) {\n\t\tconst oldViewCellEntries: CellViewModel[] = getVisibleCells(this._viewModel!.viewCells as CellViewModel[], oldRanges);\n\t\tconst oldViewCellMapping = new Set<string>();\n\t\toldViewCellEntries.forEach(cell => {\n\t\t\toldViewCellMapping.add(cell.uri.toString());\n\t\t});\n\n\t\tconst newViewCellEntries: CellViewModel[] = getVisibleCells(this._viewModel!.viewCells as CellViewModel[], newRanges);\n\n\t\tconst viewDiffs = diff<CellViewModel>(oldViewCellEntries, newViewCellEntries, a => {\n\t\t\treturn oldViewCellMapping.has(a.uri.toString());\n\t\t});\n\n\t\tthis._updateElementsInWebview(viewDiffs);\n\t}\n\n\tsplice2(start: number, deleteCount: number, elements: CellViewModel[] = []): void {\n\t\t// we need to convert start and delete count based on hidden ranges\n\t\tif (start < 0 || start > this.view.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focusInside = DOM.isAncestor(document.activeElement, this.rowsContainer);\n\t\tsuper.splice(start, deleteCount, elements);\n\t\tif (focusInside) {\n\t\t\tthis.domFocus();\n\t\t}\n\n\t\tconst selectionsLeft = [];\n\t\tthis.getSelectedElements().map(el => el.handle).forEach(handle => {\n\t\t\tif (this._viewModel!.hasCell(handle)) {\n\t\t\t\tselectionsLeft.push(handle);\n\t\t\t}\n\t\t});\n\n\t\tif (!selectionsLeft.length && this._viewModel!.viewCells.length) {\n\t\t\t// after splice, the selected cells are deleted\n\t\t\tthis._viewModel!.updateSelectionsState({ kind: SelectionStateType.Index, focus: { start: 0, end: 1 }, selections: [{ start: 0, end: 1 }] });\n\t\t}\n\t}\n\n\tgetModelIndex(cell: CellViewModel): number | undefined {\n\t\tconst viewIndex = this.indexOf(cell);\n\t\treturn this.getModelIndex2(viewIndex);\n\t}\n\n\tgetModelIndex2(viewIndex: number): number | undefined {\n\t\tif (!this.hiddenRangesPrefixSum) {\n\t\t\treturn viewIndex;\n\t\t}\n\n\t\tconst modelIndex = this.hiddenRangesPrefixSum.getAccumulatedValue(viewIndex - 1);\n\t\treturn modelIndex;\n\t}\n\n\tgetViewIndex(cell: ICellViewModel) {\n\t\tconst modelIndex = this._viewModel!.getCellIndex(cell);\n\t\treturn this.getViewIndex2(modelIndex);\n\t}\n\n\tgetViewIndex2(modelIndex: number): number | undefined {\n\t\tif (!this.hiddenRangesPrefixSum) {\n\t\t\treturn modelIndex;\n\t\t}\n\n\t\tconst viewIndexInfo = this.hiddenRangesPrefixSum.getIndexOf(modelIndex);\n\n\t\tif (viewIndexInfo.remainder !== 0) {\n\t\t\tif (modelIndex >= this.hiddenRangesPrefixSum.getTotalValue()) {\n\t\t\t\t// it's already after the last hidden range\n\t\t\t\treturn modelIndex - (this.hiddenRangesPrefixSum.getTotalValue() - this.hiddenRangesPrefixSum.getCount());\n\t\t\t}\n\t\t\treturn undefined;\n\t\t} else {\n\t\t\treturn viewIndexInfo.index;\n\t\t}\n\t}\n\n\tprivate _getVisibleRangesFromIndex(topViewIndex: number, topModelIndex: number, bottomViewIndex: number, bottomModelIndex: number) {\n\t\tlet stack: number[] = [];\n\t\tconst ranges: ICellRange[] = [];\n\t\t// there are hidden ranges\n\t\tlet index = topViewIndex;\n\t\tlet modelIndex = topModelIndex;\n\n\t\twhile (index <= bottomViewIndex) {\n\t\t\tconst accu = this.hiddenRangesPrefixSum!.getAccumulatedValue(index);\n\t\t\tif (accu === modelIndex + 1) {\n\t\t\t\t// no hidden area after it\n\t\t\t\tif (stack.length) {\n\t\t\t\t\tif (stack[stack.length - 1] === modelIndex - 1) {\n\t\t\t\t\t\tranges.push({ start: stack[stack.length - 1], end: modelIndex });\n\t\t\t\t\t} else {\n\t\t\t\t\t\tranges.push({ start: stack[stack.length - 1], end: stack[stack.length - 1] });\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstack.push(modelIndex);\n\t\t\t\tindex++;\n\t\t\t\tmodelIndex++;\n\t\t\t} else {\n\t\t\t\t// there are hidden ranges after it\n\t\t\t\tif (stack.length) {\n\t\t\t\t\tif (stack[stack.length - 1] === modelIndex - 1) {\n\t\t\t\t\t\tranges.push({ start: stack[stack.length - 1], end: modelIndex });\n\t\t\t\t\t} else {\n\t\t\t\t\t\tranges.push({ start: stack[stack.length - 1], end: stack[stack.length - 1] });\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tstack.push(modelIndex);\n\t\t\t\tindex++;\n\t\t\t\tmodelIndex = accu;\n\t\t\t}\n\t\t}\n\n\t\tif (stack.length) {\n\t\t\tranges.push({ start: stack[stack.length - 1], end: stack[stack.length - 1] });\n\t\t}\n\n\t\treturn reduceCellRanges(ranges);\n\t}\n\n\tgetVisibleRangesPlusViewportAboveBelow() {\n\t\tif (this.view.length <= 0) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst top = clamp(this.getViewScrollTop() - this.renderHeight, 0, this.scrollHeight);\n\t\tconst bottom = clamp(this.getViewScrollBottom() + this.renderHeight, 0, this.scrollHeight);\n\t\tconst topViewIndex = clamp(this.view.indexAt(top), 0, this.view.length - 1);\n\t\tconst topElement = this.view.element(topViewIndex);\n\t\tconst topModelIndex = this._viewModel!.getCellIndex(topElement);\n\t\tconst bottomViewIndex = clamp(this.view.indexAt(bottom), 0, this.view.length - 1);\n\t\tconst bottomElement = this.view.element(bottomViewIndex);\n\t\tconst bottomModelIndex = this._viewModel!.getCellIndex(bottomElement);\n\n\t\tif (bottomModelIndex - topModelIndex === bottomViewIndex - topViewIndex) {\n\t\t\treturn [{ start: topModelIndex, end: bottomModelIndex }];\n\t\t} else {\n\t\t\treturn this._getVisibleRangesFromIndex(topViewIndex, topModelIndex, bottomViewIndex, bottomModelIndex);\n\t\t}\n\t}\n\n\tprivate _getViewIndexUpperBound(cell: ICellViewModel): number {\n\t\tif (!this._viewModel) {\n\t\t\treturn -1;\n\t\t}\n\n\t\tconst modelIndex = this._viewModel.getCellIndex(cell);\n\t\tif (!this.hiddenRangesPrefixSum) {\n\t\t\treturn modelIndex;\n\t\t}\n\n\t\tconst viewIndexInfo = this.hiddenRangesPrefixSum.getIndexOf(modelIndex);\n\n\t\tif (viewIndexInfo.remainder !== 0) {\n\t\t\tif (modelIndex >= this.hiddenRangesPrefixSum.getTotalValue()) {\n\t\t\t\treturn modelIndex - (this.hiddenRangesPrefixSum.getTotalValue() - this.hiddenRangesPrefixSum.getCount());\n\t\t\t}\n\t\t}\n\n\t\treturn viewIndexInfo.index;\n\t}\n\n\tprivate _getViewIndexUpperBound2(modelIndex: number) {\n\t\tif (!this.hiddenRangesPrefixSum) {\n\t\t\treturn modelIndex;\n\t\t}\n\n\t\tconst viewIndexInfo = this.hiddenRangesPrefixSum.getIndexOf(modelIndex);\n\n\t\tif (viewIndexInfo.remainder !== 0) {\n\t\t\tif (modelIndex >= this.hiddenRangesPrefixSum.getTotalValue()) {\n\t\t\t\treturn modelIndex - (this.hiddenRangesPrefixSum.getTotalValue() - this.hiddenRangesPrefixSum.getCount());\n\t\t\t}\n\t\t}\n\n\t\treturn viewIndexInfo.index;\n\t}\n\n\tfocusElement(cell: ICellViewModel) {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\n\t\tif (index >= 0 && this._viewModel) {\n\t\t\t// update view model first, which will update both `focus` and `selection` in a single transaction\n\t\t\tconst focusedElementHandle = this.element(index).handle;\n\t\t\tthis._viewModel.updateSelectionsState({\n\t\t\t\tkind: SelectionStateType.Handle,\n\t\t\t\tprimary: focusedElementHandle,\n\t\t\t\tselections: [focusedElementHandle]\n\t\t\t}, 'view');\n\n\t\t\t// update the view as previous model update will not trigger event\n\t\t\tthis.setFocus([index], undefined, false);\n\t\t}\n\t}\n\n\tselectElements(elements: ICellViewModel[]) {\n\t\tconst indices = elements.map(cell => this._getViewIndexUpperBound(cell)).filter(index => index >= 0);\n\t\tthis.setSelection(indices);\n\t}\n\n\toverride focusNext(n: number | undefined, loop: boolean | undefined, browserEvent?: UIEvent, filter?: (element: CellViewModel) => boolean): void {\n\t\tthis._focusNextPreviousDelegate.onFocusNext(() => {\n\t\t\tsuper.focusNext(n, loop, browserEvent, filter);\n\t\t});\n\t}\n\n\toverride focusPrevious(n: number | undefined, loop: boolean | undefined, browserEvent?: UIEvent, filter?: (element: CellViewModel) => boolean): void {\n\t\tthis._focusNextPreviousDelegate.onFocusPrevious(() => {\n\t\t\tsuper.focusPrevious(n, loop, browserEvent, filter);\n\t\t});\n\t}\n\n\toverride setFocus(indexes: number[], browserEvent?: UIEvent, ignoreTextModelUpdate?: boolean): void {\n\t\tif (ignoreTextModelUpdate) {\n\t\t\tsuper.setFocus(indexes, browserEvent);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!indexes.length) {\n\t\t\tif (this._viewModel) {\n\t\t\t\tthis._viewModel.updateSelectionsState({\n\t\t\t\t\tkind: SelectionStateType.Handle,\n\t\t\t\t\tprimary: null,\n\t\t\t\t\tselections: []\n\t\t\t\t}, 'view');\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._viewModel) {\n\t\t\t\tconst focusedElementHandle = this.element(indexes[0]).handle;\n\t\t\t\tthis._viewModel.updateSelectionsState({\n\t\t\t\t\tkind: SelectionStateType.Handle,\n\t\t\t\t\tprimary: focusedElementHandle,\n\t\t\t\t\tselections: this.getSelection().map(selection => this.element(selection).handle)\n\t\t\t\t}, 'view');\n\t\t\t}\n\t\t}\n\n\t\tsuper.setFocus(indexes, browserEvent);\n\t}\n\n\toverride setSelection(indexes: number[], browserEvent?: UIEvent | undefined, ignoreTextModelUpdate?: boolean) {\n\t\tif (ignoreTextModelUpdate) {\n\t\t\tsuper.setSelection(indexes, browserEvent);\n\t\t\treturn;\n\t\t}\n\n\t\tif (!indexes.length) {\n\t\t\tif (this._viewModel) {\n\t\t\t\tthis._viewModel.updateSelectionsState({\n\t\t\t\t\tkind: SelectionStateType.Handle,\n\t\t\t\t\tprimary: this.getFocusedElements()[0]?.handle ?? null,\n\t\t\t\t\tselections: []\n\t\t\t\t}, 'view');\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._viewModel) {\n\t\t\t\tthis._viewModel.updateSelectionsState({\n\t\t\t\t\tkind: SelectionStateType.Handle,\n\t\t\t\t\tprimary: this.getFocusedElements()[0]?.handle ?? null,\n\t\t\t\t\tselections: indexes.map(index => this.element(index)).map(cell => cell.handle)\n\t\t\t\t}, 'view');\n\t\t\t}\n\t\t}\n\n\t\tsuper.setSelection(indexes, browserEvent);\n\t}\n\n\t/**\n\t * The range will be revealed with as little scrolling as possible.\n\t */\n\trevealElementsInView(range: ICellRange) {\n\t\tconst startIndex = this._getViewIndexUpperBound2(range.start);\n\n\t\tif (startIndex < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst endIndex = this._getViewIndexUpperBound2(range.end - 1);\n\n\t\tconst scrollTop = this.getViewScrollTop();\n\t\tconst wrapperBottom = this.getViewScrollBottom();\n\t\tconst elementTop = this.view.elementTop(startIndex);\n\t\tif (elementTop >= scrollTop\n\t\t\t&& elementTop < wrapperBottom) {\n\t\t\t// start element is visible\n\t\t\t// check end\n\n\t\t\tconst endElementTop = this.view.elementTop(endIndex);\n\t\t\tconst endElementHeight = this.view.elementHeight(endIndex);\n\n\t\t\tif (endElementTop + endElementHeight <= wrapperBottom) {\n\t\t\t\t// fully visible\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (endElementTop >= wrapperBottom) {\n\t\t\t\treturn this._revealInternal(endIndex, false, CellRevealPosition.Bottom);\n\t\t\t}\n\n\t\t\tif (endElementTop < wrapperBottom) {\n\t\t\t\t// end element partially visible\n\t\t\t\tif (endElementTop + endElementHeight - wrapperBottom < elementTop - scrollTop) {\n\t\t\t\t\t// there is enough space to just scroll up a little bit to make the end element visible\n\t\t\t\t\treturn this.view.setScrollTop(scrollTop + endElementTop + endElementHeight - wrapperBottom);\n\t\t\t\t} else {\n\t\t\t\t\t// don't even try it\n\t\t\t\t\treturn this._revealInternal(startIndex, false, CellRevealPosition.Top);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\n\t\tthis._revealInView(startIndex);\n\t}\n\n\trevealElementInView(cell: ICellViewModel) {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\n\t\tif (index >= 0) {\n\t\t\tthis._revealInView(index);\n\t\t}\n\t}\n\n\trevealElementInViewAtTop(cell: ICellViewModel) {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\n\t\tif (index >= 0) {\n\t\t\tthis._revealInternal(index, false, CellRevealPosition.Top);\n\t\t}\n\t}\n\n\trevealElementInCenterIfOutsideViewport(cell: ICellViewModel) {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\n\t\tif (index >= 0) {\n\t\t\tthis._revealInCenterIfOutsideViewport(index);\n\t\t}\n\t}\n\n\trevealElementInCenter(cell: ICellViewModel) {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\n\t\tif (index >= 0) {\n\t\t\tthis._revealInCenter(index);\n\t\t}\n\t}\n\n\tasync revealElementInCenterIfOutsideViewportAsync(cell: ICellViewModel): Promise<void> {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\n\t\tif (index >= 0) {\n\t\t\treturn this._revealInCenterIfOutsideViewportAsync(index);\n\t\t}\n\t}\n\n\tasync revealElementLineInViewAsync(cell: ICellViewModel, line: number): Promise<void> {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\n\t\tif (index >= 0) {\n\t\t\treturn this._revealLineInViewAsync(index, line);\n\t\t}\n\t}\n\n\tasync revealElementLineInCenterAsync(cell: ICellViewModel, line: number): Promise<void> {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\n\t\tif (index >= 0) {\n\t\t\treturn this._revealLineInCenterAsync(index, line);\n\t\t}\n\t}\n\n\tasync revealElementLineInCenterIfOutsideViewportAsync(cell: ICellViewModel, line: number): Promise<void> {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\n\t\tif (index >= 0) {\n\t\t\treturn this._revealLineInCenterIfOutsideViewportAsync(index, line);\n\t\t}\n\t}\n\n\tasync revealElementRangeInViewAsync(cell: ICellViewModel, range: Range): Promise<void> {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\n\t\tif (index >= 0) {\n\t\t\treturn this._revealRangeInView(index, range);\n\t\t}\n\t}\n\n\tasync revealElementRangeInCenterAsync(cell: ICellViewModel, range: Range): Promise<void> {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\n\t\tif (index >= 0) {\n\t\t\treturn this._revealRangeInCenterAsync(index, range);\n\t\t}\n\t}\n\n\tasync revealElementRangeInCenterIfOutsideViewportAsync(cell: ICellViewModel, range: Range): Promise<void> {\n\t\tconst index = this._getViewIndexUpperBound(cell);\n\n\t\tif (index >= 0) {\n\t\t\treturn this._revealRangeInCenterIfOutsideViewportAsync(index, range);\n\t\t}\n\t}\n\n\tdomElementOfElement(element: ICellViewModel): HTMLElement | null {\n\t\tconst index = this._getViewIndexUpperBound(element);\n\t\tif (index >= 0) {\n\t\t\treturn this.view.domElement(index);\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tfocusView() {\n\t\tthis.view.domNode.focus();\n\t}\n\n\tgetAbsoluteTopOfElement(element: ICellViewModel): number {\n\t\tconst index = this._getViewIndexUpperBound(element);\n\t\tif (index === undefined || index < 0 || index >= this.length) {\n\t\t\tthis._getViewIndexUpperBound(element);\n\t\t\tthrow new ListError(this.listUser, `Invalid index ${index}`);\n\t\t}\n\n\t\treturn this.view.elementTop(index);\n\t}\n\n\ttriggerScrollFromMouseWheelEvent(browserEvent: IMouseWheelEvent) {\n\t\tthis.view.triggerScrollFromMouseWheelEvent(browserEvent);\n\t}\n\n\n\tupdateElementHeight2(element: ICellViewModel, size: number): void {\n\t\tconst index = this._getViewIndexUpperBound(element);\n\t\tif (index === undefined || index < 0 || index >= this.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focused = this.getFocus();\n\t\tif (!focused.length) {\n\t\t\tthis.view.updateElementHeight(index, size, null);\n\t\t\treturn;\n\t\t}\n\n\t\tconst focus = focused[0];\n\n\t\tif (focus <= index) {\n\t\t\tthis.view.updateElementHeight(index, size, focus);\n\t\t\treturn;\n\t\t}\n\n\t\t// the `element` is in the viewport, it's very often that the height update is triggerred by user interaction (collapse, run cell)\n\t\t// then we should make sure that the `element`'s visual view position doesn't change.\n\n\t\tif (this.view.elementTop(index) > this.view.scrollTop) {\n\t\t\tthis.view.updateElementHeight(index, size, index);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.view.updateElementHeight(index, size, focus);\n\t}\n\n\t// override\n\toverride domFocus() {\n\t\tconst focused = this.getFocusedElements()[0];\n\t\tconst focusedDomElement = focused && this.domElementOfElement(focused);\n\n\t\tif (document.activeElement && focusedDomElement && focusedDomElement.contains(document.activeElement)) {\n\t\t\t// for example, when focus goes into monaco editor, if we refocus the list view, the editor will lose focus.\n\t\t\treturn;\n\t\t}\n\n\t\tif (!isMacintosh && document.activeElement && isContextMenuFocused()) {\n\t\t\treturn;\n\t\t}\n\n\t\tsuper.domFocus();\n\t}\n\n\tgetViewScrollTop() {\n\t\treturn this.view.getScrollTop();\n\t}\n\n\tgetViewScrollBottom() {\n\t\treturn this.getViewScrollTop() + this.view.renderHeight - SCROLLABLE_ELEMENT_PADDING_TOP;\n\t}\n\n\tprivate _revealRange(viewIndex: number, range: Range, revealType: CellRevealType, newlyCreated: boolean, alignToBottom: boolean) {\n\t\tconst element = this.view.element(viewIndex);\n\t\tconst scrollTop = this.getViewScrollTop();\n\t\tconst wrapperBottom = this.getViewScrollBottom();\n\t\tconst positionOffset = element.getPositionScrollTopOffset(range.startLineNumber, range.startColumn);\n\t\tconst elementTop = this.view.elementTop(viewIndex);\n\t\tconst positionTop = elementTop + positionOffset;\n\n\t\t// TODO@rebornix 30 ---> line height * 1.5\n\t\tif (positionTop < scrollTop) {\n\t\t\tthis.view.setScrollTop(positionTop - 30);\n\t\t} else if (positionTop > wrapperBottom) {\n\t\t\tthis.view.setScrollTop(scrollTop + positionTop - wrapperBottom + 30);\n\t\t} else if (newlyCreated) {\n\t\t\t// newly scrolled into view\n\t\t\tif (alignToBottom) {\n\t\t\t\t// align to the bottom\n\t\t\t\tthis.view.setScrollTop(scrollTop + positionTop - wrapperBottom + 30);\n\t\t\t} else {\n\t\t\t\t// align to to top\n\t\t\t\tthis.view.setScrollTop(positionTop - 30);\n\t\t\t}\n\t\t}\n\n\t\tif (revealType === CellRevealType.Range) {\n\t\t\telement.revealRangeInCenter(range);\n\t\t}\n\t}\n\n\t// List items have real dynamic heights, which means after we set `scrollTop` based on the `elementTop(index)`, the element at `index` might still be removed from the view once all relayouting tasks are done.\n\t// For example, we scroll item 10 into the view upwards, in the first round, items 7, 8, 9, 10 are all in the viewport. Then item 7 and 8 resize themselves to be larger and finally item 10 is removed from the view.\n\t// To ensure that item 10 is always there, we need to scroll item 10 to the top edge of the viewport.\n\tprivate async _revealRangeInternalAsync(viewIndex: number, range: Range, revealType: CellRevealType): Promise<void> {\n\t\tconst scrollTop = this.getViewScrollTop();\n\t\tconst wrapperBottom = this.getViewScrollBottom();\n\t\tconst elementTop = this.view.elementTop(viewIndex);\n\t\tconst element = this.view.element(viewIndex);\n\n\t\tif (element.editorAttached) {\n\t\t\tthis._revealRange(viewIndex, range, revealType, false, false);\n\t\t} else {\n\t\t\tconst elementHeight = this.view.elementHeight(viewIndex);\n\t\t\tlet upwards = false;\n\n\t\t\tif (elementTop + elementHeight < scrollTop) {\n\t\t\t\t// scroll downwards\n\t\t\t\tthis.view.setScrollTop(elementTop);\n\t\t\t\tupwards = false;\n\t\t\t} else if (elementTop > wrapperBottom) {\n\t\t\t\t// scroll upwards\n\t\t\t\tthis.view.setScrollTop(elementTop - this.view.renderHeight / 2);\n\t\t\t\tupwards = true;\n\t\t\t}\n\n\t\t\tconst editorAttachedPromise = new Promise<void>((resolve, reject) => {\n\t\t\t\telement.onDidChangeEditorAttachState(() => {\n\t\t\t\t\telement.editorAttached ? resolve() : reject();\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn editorAttachedPromise.then(() => {\n\t\t\t\tthis._revealRange(viewIndex, range, revealType, true, upwards);\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate async _revealLineInViewAsync(viewIndex: number, line: number): Promise<void> {\n\t\treturn this._revealRangeInternalAsync(viewIndex, new Range(line, 1, line, 1), CellRevealType.Line);\n\t}\n\n\tprivate async _revealRangeInView(viewIndex: number, range: Range): Promise<void> {\n\t\treturn this._revealRangeInternalAsync(viewIndex, range, CellRevealType.Range);\n\t}\n\n\tprivate async _revealRangeInCenterInternalAsync(viewIndex: number, range: Range, revealType: CellRevealType): Promise<void> {\n\t\tconst reveal = (viewIndex: number, range: Range, revealType: CellRevealType) => {\n\t\t\tconst element = this.view.element(viewIndex);\n\t\t\tconst positionOffset = element.getPositionScrollTopOffset(range.startLineNumber, range.startColumn);\n\t\t\tconst positionOffsetInView = this.view.elementTop(viewIndex) + positionOffset;\n\t\t\tthis.view.setScrollTop(positionOffsetInView - this.view.renderHeight / 2);\n\n\t\t\tif (revealType === CellRevealType.Range) {\n\t\t\t\telement.revealRangeInCenter(range);\n\t\t\t}\n\t\t};\n\n\t\tconst elementTop = this.view.elementTop(viewIndex);\n\t\tconst viewItemOffset = elementTop;\n\t\tthis.view.setScrollTop(viewItemOffset - this.view.renderHeight / 2);\n\t\tconst element = this.view.element(viewIndex);\n\n\t\tif (!element.editorAttached) {\n\t\t\treturn getEditorAttachedPromise(element).then(() => reveal(viewIndex, range, revealType));\n\t\t} else {\n\t\t\treveal(viewIndex, range, revealType);\n\t\t}\n\t}\n\n\tprivate async _revealLineInCenterAsync(viewIndex: number, line: number): Promise<void> {\n\t\treturn this._revealRangeInCenterInternalAsync(viewIndex, new Range(line, 1, line, 1), CellRevealType.Line);\n\t}\n\n\tprivate _revealRangeInCenterAsync(viewIndex: number, range: Range): Promise<void> {\n\t\treturn this._revealRangeInCenterInternalAsync(viewIndex, range, CellRevealType.Range);\n\t}\n\n\tprivate async _revealRangeInCenterIfOutsideViewportInternalAsync(viewIndex: number, range: Range, revealType: CellRevealType): Promise<void> {\n\t\tconst reveal = (viewIndex: number, range: Range, revealType: CellRevealType) => {\n\t\t\tconst element = this.view.element(viewIndex);\n\t\t\tconst positionOffset = element.getPositionScrollTopOffset(range.startLineNumber, range.startColumn);\n\t\t\tconst positionOffsetInView = this.view.elementTop(viewIndex) + positionOffset;\n\t\t\tthis.view.setScrollTop(positionOffsetInView - this.view.renderHeight / 2);\n\n\t\t\tif (revealType === CellRevealType.Range) {\n\t\t\t\telement.revealRangeInCenter(range);\n\t\t\t}\n\t\t};\n\n\t\tconst scrollTop = this.getViewScrollTop();\n\t\tconst wrapperBottom = this.getViewScrollBottom();\n\t\tconst elementTop = this.view.elementTop(viewIndex);\n\t\tconst viewItemOffset = elementTop;\n\t\tconst element = this.view.element(viewIndex);\n\t\tconst positionOffset = viewItemOffset + element.getPositionScrollTopOffset(range.startLineNumber, range.startColumn);\n\n\t\tif (positionOffset < scrollTop || positionOffset > wrapperBottom) {\n\t\t\t// let it render\n\t\t\tthis.view.setScrollTop(positionOffset - this.view.renderHeight / 2);\n\n\t\t\t// after rendering, it might be pushed down due to markdown cell dynamic height\n\t\t\tconst newPositionOffset = this.view.elementTop(viewIndex) + element.getPositionScrollTopOffset(range.startLineNumber, range.startColumn);\n\t\t\tthis.view.setScrollTop(newPositionOffset - this.view.renderHeight / 2);\n\n\t\t\t// reveal editor\n\t\t\tif (!element.editorAttached) {\n\t\t\t\treturn getEditorAttachedPromise(element).then(() => reveal(viewIndex, range, revealType));\n\t\t\t} else {\n\t\t\t\t// for example markdown\n\t\t\t}\n\t\t} else {\n\t\t\tif (element.editorAttached) {\n\t\t\t\telement.revealRangeInCenter(range);\n\t\t\t} else {\n\t\t\t\t// for example, markdown cell in preview mode\n\t\t\t\treturn getEditorAttachedPromise(element).then(() => reveal(viewIndex, range, revealType));\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async _revealInCenterIfOutsideViewportAsync(viewIndex: number): Promise<void> {\n\t\tthis._revealInternal(viewIndex, true, CellRevealPosition.Center);\n\t\tconst element = this.view.element(viewIndex);\n\n\t\t// wait for the editor to be created only if the cell is in editing mode (meaning it has an editor and will focus the editor)\n\t\tif (element.getEditState() === CellEditState.Editing && !element.editorAttached) {\n\t\t\treturn getEditorAttachedPromise(element);\n\t\t}\n\n\t\treturn;\n\t}\n\n\tprivate async _revealLineInCenterIfOutsideViewportAsync(viewIndex: number, line: number): Promise<void> {\n\t\treturn this._revealRangeInCenterIfOutsideViewportInternalAsync(viewIndex, new Range(line, 1, line, 1), CellRevealType.Line);\n\t}\n\n\tprivate async _revealRangeInCenterIfOutsideViewportAsync(viewIndex: number, range: Range): Promise<void> {\n\t\treturn this._revealRangeInCenterIfOutsideViewportInternalAsync(viewIndex, range, CellRevealType.Range);\n\t}\n\n\tprivate _revealInternal(viewIndex: number, ignoreIfInsideViewport: boolean, revealPosition: CellRevealPosition) {\n\t\tif (viewIndex >= this.view.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst scrollTop = this.getViewScrollTop();\n\t\tconst wrapperBottom = this.getViewScrollBottom();\n\t\tconst elementTop = this.view.elementTop(viewIndex);\n\t\tconst elementBottom = this.view.elementHeight(viewIndex) + elementTop;\n\n\t\tif (ignoreIfInsideViewport\n\t\t\t&& elementTop >= scrollTop\n\t\t\t&& elementTop < wrapperBottom) {\n\n\t\t\tif (revealPosition === CellRevealPosition.Center\n\t\t\t\t&& elementBottom > wrapperBottom\n\t\t\t\t&& elementTop > (scrollTop + wrapperBottom) / 2) {\n\t\t\t\t// the element is partially visible and it's below the center of the viewport\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tswitch (revealPosition) {\n\t\t\tcase CellRevealPosition.Top:\n\t\t\t\tthis.view.setScrollTop(elementTop);\n\t\t\t\tthis.view.setScrollTop(this.view.elementTop(viewIndex));\n\t\t\t\tbreak;\n\t\t\tcase CellRevealPosition.Center:\n\t\t\t\tthis.view.setScrollTop(elementTop - this.view.renderHeight / 2);\n\t\t\t\tthis.view.setScrollTop(this.view.elementTop(viewIndex) - this.view.renderHeight / 2);\n\t\t\t\tbreak;\n\t\t\tcase CellRevealPosition.Bottom:\n\t\t\t\tthis.view.setScrollTop(this.scrollTop + (elementBottom - wrapperBottom));\n\t\t\t\tthis.view.setScrollTop(this.scrollTop + (this.view.elementTop(viewIndex) + this.view.elementHeight(viewIndex) - this.getViewScrollBottom()));\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate _revealInView(viewIndex: number) {\n\t\tconst firstIndex = this.view.firstVisibleIndex;\n\t\tif (viewIndex < firstIndex) {\n\t\t\tthis._revealInternal(viewIndex, true, CellRevealPosition.Top);\n\t\t} else {\n\t\t\tthis._revealInternal(viewIndex, true, CellRevealPosition.Bottom);\n\t\t}\n\t}\n\n\tprivate _revealInCenter(viewIndex: number) {\n\t\tthis._revealInternal(viewIndex, false, CellRevealPosition.Center);\n\t}\n\n\tprivate _revealInCenterIfOutsideViewport(viewIndex: number) {\n\t\tthis._revealInternal(viewIndex, true, CellRevealPosition.Center);\n\t}\n\n\tsetCellSelection(cell: ICellViewModel, range: Range) {\n\t\tconst element = cell as CellViewModel;\n\t\tif (element.editorAttached) {\n\t\t\telement.setSelection(range);\n\t\t} else {\n\t\t\tgetEditorAttachedPromise(element).then(() => { element.setSelection(range); });\n\t\t}\n\t}\n\n\n\toverride style(styles: IListStyles) {\n\t\tconst selectorSuffix = this.view.domId;\n\t\tif (!this.styleElement) {\n\t\t\tthis.styleElement = DOM.createStyleSheet(this.view.domNode);\n\t\t}\n\t\tconst suffix = selectorSuffix && `.${selectorSuffix}`;\n\t\tconst content: string[] = [];\n\n\t\tif (styles.listBackground) {\n\t\t\tif (styles.listBackground.isOpaque()) {\n\t\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows { background: ${styles.listBackground}; }`);\n\t\t\t} else if (!isMacintosh) { // subpixel AA doesn't exist in macOS\n\t\t\t\tconsole.warn(`List with id '${selectorSuffix}' was styled with a non-opaque background color. This will break sub-pixel antialiasing.`);\n\t\t\t}\n\t\t}\n\n\t\tif (styles.listFocusBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.focused { background-color: ${styles.listFocusBackground}; }`);\n\t\t\tcontent.push(`.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.focused:hover { background-color: ${styles.listFocusBackground}; }`); // overwrite :hover style in this case!\n\t\t}\n\n\t\tif (styles.listFocusForeground) {\n\t\t\tcontent.push(`.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.focused { color: ${styles.listFocusForeground}; }`);\n\t\t}\n\n\t\tif (styles.listActiveSelectionBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected { background-color: ${styles.listActiveSelectionBackground}; }`);\n\t\t\tcontent.push(`.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected:hover { background-color: ${styles.listActiveSelectionBackground}; }`); // overwrite :hover style in this case!\n\t\t}\n\n\t\tif (styles.listActiveSelectionForeground) {\n\t\t\tcontent.push(`.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected { color: ${styles.listActiveSelectionForeground}; }`);\n\t\t}\n\n\t\tif (styles.listFocusAndSelectionBackground) {\n\t\t\tcontent.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected.focused { background-color: ${styles.listFocusAndSelectionBackground}; }\n\t\t\t`);\n\t\t}\n\n\t\tif (styles.listFocusAndSelectionForeground) {\n\t\t\tcontent.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected.focused { color: ${styles.listFocusAndSelectionForeground}; }\n\t\t\t`);\n\t\t}\n\n\t\tif (styles.listInactiveFocusBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.focused { background-color:  ${styles.listInactiveFocusBackground}; }`);\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.focused:hover { background-color:  ${styles.listInactiveFocusBackground}; }`); // overwrite :hover style in this case!\n\t\t}\n\n\t\tif (styles.listInactiveSelectionBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected { background-color:  ${styles.listInactiveSelectionBackground}; }`);\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected:hover { background-color:  ${styles.listInactiveSelectionBackground}; }`); // overwrite :hover style in this case!\n\t\t}\n\n\t\tif (styles.listInactiveSelectionForeground) {\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected { color: ${styles.listInactiveSelectionForeground}; }`);\n\t\t}\n\n\t\tif (styles.listHoverBackground) {\n\t\t\tcontent.push(`.monaco-list${suffix}:not(.drop-target) > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row:hover:not(.selected):not(.focused) { background-color:  ${styles.listHoverBackground}; }`);\n\t\t}\n\n\t\tif (styles.listHoverForeground) {\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row:hover:not(.selected):not(.focused) { color:  ${styles.listHoverForeground}; }`);\n\t\t}\n\n\t\tif (styles.listSelectionOutline) {\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.selected { outline: 1px dotted ${styles.listSelectionOutline}; outline-offset: -1px; }`);\n\t\t}\n\n\t\tif (styles.listFocusOutline) {\n\t\t\tcontent.push(`\n\t\t\t\t.monaco-drag-image,\n\t\t\t\t.monaco-list${suffix}:focus > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.focused { outline: 1px solid ${styles.listFocusOutline}; outline-offset: -1px; }\n\t\t\t`);\n\t\t}\n\n\t\tif (styles.listInactiveFocusOutline) {\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row.focused { outline: 1px dotted ${styles.listInactiveFocusOutline}; outline-offset: -1px; }`);\n\t\t}\n\n\t\tif (styles.listHoverOutline) {\n\t\t\tcontent.push(`.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows > .monaco-list-row:hover { outline: 1px dashed ${styles.listHoverOutline}; outline-offset: -1px; }`);\n\t\t}\n\n\t\tif (styles.listDropBackground) {\n\t\t\tcontent.push(`\n\t\t\t\t.monaco-list${suffix}.drop-target,\n\t\t\t\t.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-rows.drop-target,\n\t\t\t\t.monaco-list${suffix} > div.monaco-scrollable-element > .monaco-list-row.drop-target { background-color: ${styles.listDropBackground} !important; color: inherit !important; }\n\t\t\t`);\n\t\t}\n\n\t\tif (styles.listFilterWidgetBackground) {\n\t\t\tcontent.push(`.monaco-list-type-filter { background-color: ${styles.listFilterWidgetBackground} }`);\n\t\t}\n\n\t\tif (styles.listFilterWidgetOutline) {\n\t\t\tcontent.push(`.monaco-list-type-filter { border: 1px solid ${styles.listFilterWidgetOutline}; }`);\n\t\t}\n\n\t\tif (styles.listFilterWidgetNoMatchesOutline) {\n\t\t\tcontent.push(`.monaco-list-type-filter.no-matches { border: 1px solid ${styles.listFilterWidgetNoMatchesOutline}; }`);\n\t\t}\n\n\t\tif (styles.listMatchesShadow) {\n\t\t\tcontent.push(`.monaco-list-type-filter { box-shadow: 1px 1px 1px ${styles.listMatchesShadow}; }`);\n\t\t}\n\n\t\tconst newStyles = content.join('\\n');\n\t\tif (newStyles !== this.styleElement.textContent) {\n\t\t\tthis.styleElement.textContent = newStyles;\n\t\t}\n\t}\n\n\tgetRenderHeight() {\n\t\treturn this.view.renderHeight;\n\t}\n\n\toverride layout(height?: number, width?: number): void {\n\t\tthis._isInLayout = true;\n\t\tsuper.layout(height, width);\n\t\tif (this.renderHeight === 0) {\n\t\t\tthis.view.domNode.style.visibility = 'hidden';\n\t\t} else {\n\t\t\tthis.view.domNode.style.visibility = 'initial';\n\t\t}\n\t\tthis._isInLayout = false;\n\t}\n\n\toverride dispose() {\n\t\tthis._isDisposed = true;\n\t\tthis._viewModelStore.dispose();\n\t\tthis._localDisposableStore.dispose();\n\t\tsuper.dispose();\n\t}\n}\n\nfunction getEditorAttachedPromise(element: CellViewModel) {\n\treturn new Promise<void>((resolve, reject) => {\n\t\tEvent.once(element.onDidChangeEditorAttachState)(() => element.editorAttached ? resolve() : reject());\n\t});\n}\n\nfunction isContextMenuFocused() {\n\treturn !!DOM.findParentWithClass(<HTMLElement>document.activeElement, 'context-view');\n}\n"]}