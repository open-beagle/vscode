{"version":3,"sources":["vs/workbench/contrib/notebook/browser/contrib/coreActions.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;;;;IAiChG,oBAAoB;IACpB,MAAM,2BAA2B,GAAG,kBAAkB,CAAC;IACvD,MAAM,0BAA0B,GAAG,0BAA0B,CAAC;IAC9D,MAAM,kCAAkC,GAAG,+BAA+B,CAAC;IAC3E,MAAM,yBAAyB,GAAG,iCAAiC,CAAC;IAEpE,gBAAgB;IAChB,MAAM,iCAAiC,GAAG,mCAAmC,CAAC;IAC9E,MAAM,iCAAiC,GAAG,mCAAmC,CAAC;IAC9E,MAAM,kCAAkC,GAAG,mCAAmC,CAAC;IAC/E,MAAM,qCAAqC,GAAG,uCAAuC,CAAC;IACtF,MAAM,qCAAqC,GAAG,uCAAuC,CAAC;IACtF,MAAM,sCAAsC,GAAG,uCAAuC,CAAC;IACvF,MAAM,8BAA8B,GAAG,4BAA4B,CAAC;IACpE,MAAM,kCAAkC,GAAG,gCAAgC,CAAC;IAE5E,MAAM,oBAAoB,GAAG,oBAAoB,CAAC;IAClD,MAAM,sBAAsB,GAAG,sBAAsB,CAAC;IAEtD,MAAM,sBAAsB,GAAG,+BAA+B,CAAC;IAC/D,MAAM,yBAAyB,GAAG,qCAAqC,CAAC;IACxE,MAAM,yBAAyB,GAAG,qCAAqC,CAAC;IACxE,MAAM,6BAA6B,GAAG,4BAA4B,CAAC;IACnE,MAAM,kBAAkB,GAAG,2BAA2B,CAAC;IAEvD,MAAM,8BAA8B,GAAG,iCAAiC,CAAC;IACzE,MAAM,+BAA+B,GAAG,kCAAkC,CAAC;IAC3E,MAAM,6BAA6B,GAAG,gCAAgC,CAAC;IAE1D,QAAA,yBAAyB,GAAG,EAAE,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,CAA0B,EAAE,IAAU,CAAC,EAAE,QAAQ,EAAE,UAAU,EAAE,CAAC;IAE9G,QAAA,wBAAwB,GAAG,aAAa,CAAC;IACzC,QAAA,0BAA0B,GAAG,eAAe,CAAC;IAE7C,QAAA,oCAAoC,2BAAkC,CAAC,mCAAmC;IAEvH,IAAkB,gBAKjB;IALD,WAAkB,gBAAgB;QACjC,+DAAQ,CAAA;QACR,iEAAS,CAAA;QACT,+DAAQ,CAAA;QACR,6EAAe,CAAA;IAChB,CAAC,EALiB,gBAAgB,GAAhB,wBAAgB,KAAhB,wBAAgB,QAKjC;IAED,IAAkB,yBAKjB;IALD,WAAkB,yBAAyB;QAC1C,4CAAe,CAAA;QACf,gDAAmB,CAAA;QACnB,4CAAe,CAAA;QACf,oDAAuB,CAAA;IACxB,CAAC,EALiB,yBAAyB,GAAzB,iCAAyB,KAAzB,iCAAyB,QAK1C;IAcD,SAAS,0BAA0B,CAAC,aAA6B;QAChE,MAAM,MAAM,GAAG,CAAA,GAAA,iDAA+B,CAAA,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC;QAC/E,IAAI,CAAC,MAAM,IAAI,CAAC,MAAM,CAAC,QAAQ,EAAE,EAAE;YAClC,OAAO;SACP;QAED,MAAM,UAAU,GAAG,MAAM,CAAC,aAAa,EAAE,CAAC;QAC1C,MAAM,aAAa,GAAG,MAAM,CAAC,sBAAsB,EAAE,CAAC;QACtD,OAAO;YACN,IAAI,EAAE,UAAU;YAChB,aAAa;YACb,cAAc,EAAE,MAAM;SACtB,CAAC;IACH,CAAC;IAED,SAAS,gBAAgB,CAAC,QAA0B,EAAE,GAAQ;QAC7D,MAAM,aAAa,GAAG,QAAQ,CAAC,GAAG,CAAC,8BAAc,CAAC,CAAC;QACnD,MAAM,qBAAqB,GAAG,QAAQ,CAAC,GAAG,CAAC,8CAAsB,CAAC,CAAC;QACnE,MAAM,QAAQ,GAAG,aAAa,CAAC,UAAU,oBAAyB,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,WAAC,OAAA,QAAQ,CAAC,MAAM,YAAY,yCAAmB,IAAI,CAAA,MAAA,QAAQ,CAAC,MAAM,CAAC,QAAQ,0CAAE,QAAQ,EAAE,MAAK,GAAG,CAAC,QAAQ,EAAE,CAAA,EAAA,CAAC,CAAC;QAC/L,IAAI,CAAC,QAAQ,EAAE;YACd,OAAO,SAAS,CAAC;SACjB;QAED,MAAM,mBAAmB,GAAG,QAAQ,CAAC,MAA6B,CAAC;QACnE,IAAI,CAAC,mBAAmB,CAAC,QAAQ,EAAE;YAClC,OAAO,SAAS,CAAC;SACjB;QAED,MAAM,MAAM,GAAG,qBAAqB,CAAC,mBAAmB,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,EAAE,eAAC,OAAA,CAAA,MAAA,MAAM,CAAC,SAAS,0CAAE,QAAQ,MAAK,mBAAmB,CAAC,QAAQ,IAAI,CAAA,MAAA,MAAM,CAAC,SAAS,0CAAE,GAAG,CAAC,QAAQ,EAAE,MAAK,mBAAmB,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAA,EAAA,CAAC,CAAC;QAEvN,IAAI,MAAM,IAAI,MAAM,CAAC,QAAQ,EAAE,EAAE;YAChC,OAAO,MAAM,CAAC;SACd;QAED,OAAO,SAAS,CAAC;IAClB,CAAC;IAED,SAAS,iBAAiB,CAAC,QAA0B,EAAE,OAAa;QACnE,MAAM,GAAG,GAAG,SAAG,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QAEhC,IAAI,GAAG,EAAE;YACR,MAAM,MAAM,GAAG,gBAAgB,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;YAE/C,IAAI,MAAM,EAAE;gBACX,OAAO;oBACN,cAAc,EAAE,MAAM;iBACtB,CAAC;aACF;SACD;QAED,OAAO,SAAS,CAAC;IAClB,CAAC;IAED,MAAsB,cAAe,SAAQ,iBAAO;QACnD,YAAY,IAAqB;YAChC,IAAI,IAAI,CAAC,EAAE,KAAK,KAAK,EAAE;gBACtB,IAAI,CAAC,EAAE,GAAG,KAAK,CAAC;gBAChB,MAAM,MAAM,GAAG;oBACd,EAAE,EAAE,gBAAM,CAAC,cAAc;oBACzB,IAAI,EAAE,2CAAyB;iBAC/B,CAAC;gBAEF,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;oBACf,IAAI,CAAC,IAAI,GAAG,EAAE,CAAC;iBACf;qBAAM,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;oBACrC,IAAI,CAAC,IAAI,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBACxB;gBAED,IAAI,CAAC,IAAI,GAAG;oBACX,GAAG,IAAI,CAAC,IAAI;oBACZ,MAAM;iBACN,CAAC;aACF;YAED,IAAI,CAAC,QAAQ,GAAG,iCAAyB,CAAC;YAE1C,KAAK,CAAC,IAAI,CAAC,CAAC;QACb,CAAC;QAED,KAAK,CAAC,GAAG,CAAC,QAA0B,EAAE,OAAa;YAClD,MAAM,QAAQ,GAAG,CAAC,CAAC,OAAO,CAAC;YAC3B,MAAM,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;YAClH,IAAI,CAAC,IAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC,EAAE;gBAC3C,OAAO,GAAG,IAAI,CAAC,gCAAgC,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;gBACnE,IAAI,CAAC,OAAO,EAAE;oBACb,OAAO;iBACP;aACD;YAED,IAAI,IAAI,KAAK,SAAS,EAAE;gBACvB,MAAM,gBAAgB,GAAG,QAAQ,CAAC,GAAG,CAAC,6BAAiB,CAAC,CAAC;gBACzD,gBAAgB,CAAC,UAAU,CAAsE,yBAAyB,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;aAC9J;YAED,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;QACxC,CAAC;QAIO,uBAAuB,CAAC,OAAiB;YAChD,OAAO,CAAC,CAAC,OAAO,IAAI,CAAC,CAAE,OAAkC,CAAC,cAAc,CAAC;QAC1E,CAAC;QAES,gCAAgC,CAAC,QAA0B,EAAE,OAAa;YACnF,OAAO,0BAA0B,CAAC,QAAQ,CAAC,GAAG,CAAC,8BAAc,CAAC,CAAC,CAAC;QACjE,CAAC;KACD;IArDD,wCAqDC;IAED,MAAsB,kBAAmD,SAAQ,cAAc;QACpF,mBAAmB,CAAC,OAAiB;YAC9C,OAAO,CAAC,CAAC,OAAO,IAAI,CAAC,CAAE,OAAsC,CAAC,cAAc,IAAI,CAAC,CAAE,OAAsC,CAAC,IAAI,CAAC;QAChI,CAAC;QAES,sBAAsB,CAAC,QAA0B,EAAE,OAAW,EAAE,GAAG,cAAqB;YACjG,OAAO,SAAS,CAAC;QAClB,CAAC;QAEQ,KAAK,CAAC,GAAG,CAAC,QAA0B,EAAE,OAAoC,EAAE,GAAG,cAAqB;YAC5G,IAAI,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,EAAE;gBACtC,MAAM,gBAAgB,GAAG,QAAQ,CAAC,GAAG,CAAC,6BAAiB,CAAC,CAAC;gBACzD,gBAAgB,CAAC,UAAU,CAAsE,yBAAyB,EAAE,EAAE,EAAE,EAAE,IAAI,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,EAAE,aAAa,EAAE,CAAC,CAAC;gBAEvK,OAAO,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;aAC9C;YAED,MAAM,eAAe,GAAG,IAAI,CAAC,sBAAsB,CAAC,QAAQ,EAAE,OAAO,EAAE,GAAG,cAAc,CAAC,CAAC;YAE1F,IAAI,eAAe,EAAE;gBACpB,OAAO,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,eAAe,CAAC,CAAC;aACtD;YAED,MAAM,mBAAmB,GAAG,IAAI,CAAC,gCAAgC,CAAC,QAAQ,CAAC,CAAC;YAC5E,IAAI,IAAI,CAAC,mBAAmB,CAAC,mBAAmB,CAAC,EAAE;gBAClD,OAAO,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,mBAAmB,CAAC,CAAC;aAC1D;QACF,CAAC;KAGD;IA9BD,gDA8BC;IAED,MAAM,oBAAoB,GAAG,2BAAc,CAAC,EAAE,CAC7C,2BAAc,CAAC,GAAG,CACjB,2BAAc,CAAC,EAAE,CAChB,2BAAc,CAAC,MAAM,CAAC,+CAA6B,CAAC,GAAG,EAAE,MAAM,CAAC,EAChE,2BAAc,CAAC,MAAM,CAAC,+CAA6B,CAAC,GAAG,EAAE,WAAW,CAAC,EACrE,2BAAc,CAAC,MAAM,CAAC,+CAA6B,CAAC,GAAG,EAAE,QAAQ,CAAC,CAClE,EACD,2BAAc,CAAC,OAAO,CAAC,uCAAqB,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC,EACtD,oCAAkB,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,CAAC;IAE3C,MAAM,wBAAwB,GAAG,2BAAc,CAAC,OAAO,CAAC,uCAAqB,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;IAEtF,CAAA,GAAA,yBAAe,CAAA,CAAC,MAAM,WAAY,SAAQ,kBAA8B;QACvE;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,yCAAuB;gBAC3B,YAAY,EAAE,oBAAoB;gBAClC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,CAAyB,EAAE,IAAc,CAAC;gBAC1D,UAAU,EAAE;oBACX,IAAI,EAAE,4CAA0B;oBAChC,OAAO,EAAE,iCAA8B;oBACvC,GAAG,EAAE;wBACJ,OAAO,EAAE,kCAA2B,gBAAgB;qBACpD;oBACD,MAAM,EAAE,4CAAoC;iBAC5C;gBACD,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,mBAAmB;oBAC9B,IAAI,EAAE,oBAAoB;oBAC1B,KAAK,EAAE,QAAQ;iBACf;gBACD,WAAW,EAAE;oBACZ,WAAW,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,CAAyB,EAAE,IAAc,CAAC;oBAChE,IAAI,EAAE;wBACL;4BACC,IAAI,EAAE,OAAO;4BACb,WAAW,EAAE,gBAAgB;4BAC7B,MAAM,EAAE;gCACP,MAAM,EAAE,QAAQ;gCAChB,UAAU,EAAE,CAAC,OAAO,EAAE,KAAK,CAAC;gCAC5B,YAAY,EAAE;oCACb,OAAO,EAAE;wCACR,MAAM,EAAE,QAAQ;qCAChB;oCACD,KAAK,EAAE;wCACN,MAAM,EAAE,QAAQ;qCAChB;iCACD;6BACD;yBACD;wBACD;4BACC,IAAI,EAAE,KAAK;4BACX,WAAW,EAAE,kBAAkB;4BAC/B,UAAU,EAAE,SAAG;yBACf;qBACD;iBACD;gBACD,IAAI,EAAE,KAAK,CAAC,WAAW;aACvB,CAAC,CAAC;QACJ,CAAC;QAEQ,sBAAsB,CAAC,QAA0B,EAAE,OAAoB,EAAE,GAAG,cAAqB;YACzG,IAAI,CAAC,OAAO,EAAE;gBACb,OAAO;aACP;YAED,IAAI,OAAO,OAAO,CAAC,KAAK,KAAK,QAAQ,IAAI,OAAO,OAAO,CAAC,GAAG,KAAK,QAAQ,IAAI,OAAO,CAAC,KAAK,IAAI,OAAO,CAAC,GAAG,EAAE;gBACzG,MAAM,IAAI,KAAK,CAAC,uBAAuB,OAAO,4BAA4B,CAAC,CAAC;aAC5E;YAED,IAAI,cAAc,CAAC,MAAM,IAAI,cAAc,CAAC,CAAC,CAAC,EAAE;gBAC/C,MAAM,GAAG,GAAG,SAAG,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC;gBAE1C,IAAI,CAAC,GAAG,EAAE;oBACT,MAAM,IAAI,KAAK,CAAC,wBAAwB,GAAG,sBAAsB,CAAC,CAAC;iBACnE;gBAED,MAAM,MAAM,GAAG,gBAAgB,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;gBAC/C,IAAI,MAAM,EAAE;oBACX,OAAO;wBACN,cAAc,EAAE,MAAM;wBACtB,IAAI,EAAE,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAE;qBAC7C,CAAC;iBACF;qBAAM;oBACN,MAAM,IAAI,KAAK,CAAC,0CAA0C,GAAG,EAAE,CAAC,CAAC;iBACjE;aACD;YAED,MAAM,mBAAmB,GAAG,IAAI,CAAC,gCAAgC,CAAC,QAAQ,CAAC,CAAC;YAE5E,IAAI,CAAC,mBAAmB,IAAI,CAAC,mBAAmB,CAAC,cAAc,CAAC,SAAS,IAAI,OAAO,CAAC,KAAK,IAAI,mBAAmB,CAAC,cAAc,CAAC,SAAS,CAAC,MAAM,EAAE;gBAClJ,OAAO;aACP;YAED,wCAAwC;YACxC,OAAO;gBACN,cAAc,EAAE,mBAAmB,CAAC,cAAc;gBAClD,IAAI,EAAE,mBAAmB,CAAC,cAAc,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAE;aACzE,CAAC;QACH,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAAmC;YACnF,OAAO,OAAO,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;QACnC,CAAC;KACD,CAAC,CAAC;IAEH,MAAM,mBAAmB,GAAG,2BAAc,CAAC,EAAE,CAC5C,2BAAc,CAAC,MAAM,CAAC,+CAA6B,CAAC,GAAG,EAAE,WAAW,CAAC,EACrE,2BAAc,CAAC,MAAM,CAAC,+CAA6B,CAAC,GAAG,EAAE,SAAS,CAAC,CACnE,CAAC;IAEF,CAAA,GAAA,yBAAe,CAAA,CAAC,MAAM,iBAAkB,SAAQ,kBAA8B;QAC7E;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,sBAAsB;gBAC1B,YAAY,EAAE,mBAAmB;gBACjC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,CAAwB,EAAE,IAAqB,CAAC;gBAChE,IAAI,EAAE,KAAK,CAAC,QAAQ;gBACpB,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,mBAAmB;oBAC9B,IAAI,EAAE,mBAAmB;oBACzB,KAAK,EAAE,QAAQ;iBACf;gBACD,WAAW,EAAE;oBACZ,WAAW,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,CAAwB,EAAE,IAAqB,CAAC;oBACtE,IAAI,EAAE;wBACL;4BACC,IAAI,EAAE,OAAO;4BACb,WAAW,EAAE,gBAAgB;4BAC7B,MAAM,EAAE;gCACP,MAAM,EAAE,QAAQ;gCAChB,UAAU,EAAE,CAAC,OAAO,EAAE,KAAK,CAAC;gCAC5B,YAAY,EAAE;oCACb,OAAO,EAAE;wCACR,MAAM,EAAE,QAAQ;qCAChB;oCACD,KAAK,EAAE;wCACN,MAAM,EAAE,QAAQ;qCAChB;iCACD;6BACD;yBACD;wBACD;4BACC,IAAI,EAAE,KAAK;4BACX,WAAW,EAAE,kBAAkB;4BAC/B,UAAU,EAAE,SAAG;yBACf;qBACD;iBACD;aACD,CAAC,CAAC;QACJ,CAAC;QAEQ,sBAAsB,CAAC,QAA0B,EAAE,OAAoB,EAAE,GAAG,cAAqB;YACzG,IAAI,CAAC,OAAO,IAAI,OAAO,OAAO,CAAC,KAAK,KAAK,QAAQ,IAAI,OAAO,OAAO,CAAC,GAAG,KAAK,QAAQ,IAAI,OAAO,CAAC,KAAK,IAAI,OAAO,CAAC,GAAG,EAAE;gBACrH,OAAO;aACP;YAED,IAAI,cAAc,CAAC,MAAM,IAAI,cAAc,CAAC,CAAC,CAAC,EAAE;gBAC/C,MAAM,GAAG,GAAG,SAAG,CAAC,MAAM,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC;gBAE1C,IAAI,GAAG,EAAE;oBACR,MAAM,MAAM,GAAG,gBAAgB,CAAC,QAAQ,EAAE,GAAG,CAAC,CAAC;oBAC/C,IAAI,MAAM,EAAE;wBACX,OAAO;4BACN,cAAc,EAAE,MAAM;4BACtB,IAAI,EAAE,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAE;yBAC7C,CAAC;qBACF;iBACD;aACD;YAED,MAAM,mBAAmB,GAAG,IAAI,CAAC,gCAAgC,CAAC,QAAQ,CAAC,CAAC;YAE5E,IAAI,CAAC,mBAAmB,IAAI,CAAC,mBAAmB,CAAC,cAAc,CAAC,SAAS,IAAI,OAAO,CAAC,KAAK,IAAI,mBAAmB,CAAC,cAAc,CAAC,SAAS,CAAC,MAAM,EAAE;gBAClJ,OAAO;aACP;YAED,wCAAwC;YACxC,OAAO;gBACN,cAAc,EAAE,mBAAmB,CAAC,cAAc;gBAClD,IAAI,EAAE,mBAAmB,CAAC,cAAc,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAE;aACzE,CAAC;QACH,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAAmC;YACnF,OAAO,OAAO,CAAC,cAAc,CAAC,mBAAmB,CAAC,mBAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;QAClF,CAAC;KACD,CAAC,CAAC;IAEH,IAAa,gBAAgB,GAA7B,MAAa,gBAAiB,SAAQ,wBAAc;QACnD,YACqB,iBAAqC,EACxC,cAA+B;YAEhD,KAAK,CACJ;gBACC,EAAE,EAAE,sBAAsB;gBAC1B,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,CAA4B,EAAE,IAAa,CAAC;gBAC5D,IAAI,EAAE,KAAK,CAAC,cAAc;gBAC1B,YAAY,EAAE,0CAAwB,CAAC,SAAS,CAAC,IAAI,CAAC;aACtD,EACD,SAAS,EACT,EAAE,iBAAiB,EAAE,IAAI,EAAE,EAC3B,iBAAiB,EACjB,cAAc,CAAC,CAAC;QAClB,CAAC;KACD,CAAA;IAjBY,gBAAgB;QAE1B,WAAA,+BAAkB,CAAA;QAClB,WAAA,0BAAe,CAAA;OAHL,gBAAgB,CAiB5B;IAjBY,4CAAgB;IAmB7B,CAAA,GAAA,yBAAe,CAAA,CAAC,MAAM,sBAAuB,SAAQ,kBAAkB;QACtE;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,yBAAyB;gBAC7B,YAAY,EAAE,oBAAoB;gBAClC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,CAAuC,EAAE,IAAwC,CAAC;gBAClG,UAAU,EAAE;oBACX,IAAI,EAAE,4CAA0B;oBAChC,OAAO,EAAE,gCAA4B;oBACrC,MAAM,EAAE,4CAAoC;iBAC5C;aACD,CAAC,CAAC;QACJ,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAAmC;YACnF,MAAM,GAAG,GAAG,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC,YAAY,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;YACxE,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;gBAC5B,OAAO;aACP;YAED,MAAM,UAAU,GAAG,OAAO,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;YAE9C,8CAA8C;YAC9C,MAAM,QAAQ,GAAG,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC;YAClE,IAAI,QAAQ,EAAE;gBACb,OAAO,CAAC,cAAc,CAAC,iBAAiB,CAAC,QAAQ,EAAE,WAAW,CAAC,CAAC;aAChE;iBAAM;gBACN,MAAM,OAAO,GAAG,OAAO,CAAC,cAAc,CAAC,kBAAkB,CAAC,OAAO,CAAC,IAAI,EAAE,yBAAQ,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;gBAChG,IAAI,OAAO,EAAE;oBACZ,OAAO,CAAC,cAAc,CAAC,iBAAiB,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;iBAC5D;aACD;YAED,OAAO,UAAU,CAAC;QACnB,CAAC;KACD,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,MAAM,sBAAuB,SAAQ,kBAAkB;QACtE;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,yBAAyB;gBAC7B,YAAY,EAAE,oBAAoB;gBAClC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,CAAuC,EAAE,IAAwC,CAAC;gBAClG,UAAU,EAAE;oBACX,IAAI,EAAE,4CAA0B;oBAChC,OAAO,EAAE,6BAA0B;oBACnC,MAAM,EAAE,4CAAoC;iBAC5C;aACD,CAAC,CAAC;QACJ,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAAmC;YACnF,MAAM,YAAY,GAAG,OAAO,CAAC,IAAI,CAAC,SAAS,KAAK,+BAAa,CAAC,MAAM,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,WAAW,CAAC;YAE9F,MAAM,UAAU,GAAG,OAAO,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;YAC9C,MAAM,OAAO,GAAG,OAAO,CAAC,cAAc,CAAC,kBAAkB,CAAC,OAAO,CAAC,IAAI,EAAE,yBAAQ,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;YAChG,IAAI,OAAO,EAAE;gBACZ,OAAO,CAAC,cAAc,CAAC,iBAAiB,CAAC,OAAO,EAAE,YAAY,CAAC,CAAC;aAChE;YAED,OAAO,UAAU,CAAC;QACnB,CAAC;KACD,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,cAAc;QAC3C;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,yBAAyB;gBAC7B,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,CAAgC,EAAE,IAA2B,CAAC;aAC9E,CAAC,CAAC;QACJ,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAA+B;YAC/E,sBAAsB,CAAC,OAAO,CAAC,CAAC;QACjC,CAAC;KACD,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,cAAc;QAC3C;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,2BAA2B;gBAC/B,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,CAAiC,EAAE,IAAkC,CAAC;gBACtF,IAAI,EAAE,KAAK,CAAC,cAAc;gBAC1B,WAAW,EAAE;oBACZ,WAAW,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAiC,EAAE,IAAkC,CAAC;oBAC5F,IAAI,EAAE;wBACL;4BACC,IAAI,EAAE,KAAK;4BACX,WAAW,EAAE,kBAAkB;4BAC/B,UAAU,EAAE,SAAG;yBACf;qBACD;iBACD;gBACD,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,WAAW;oBACtB,KAAK,EAAE,CAAC,CAAC;oBACT,KAAK,EAAE,YAAY;oBACnB,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,2CAAyB,EAAE,wBAAwB,EAAE,2BAAc,CAAC,EAAE,CAAC,+CAA6B,CAAC,SAAS,EAAE,EAAE,2CAAyB,CAAC,SAAS,EAAE,CAAC,CAAC;iBAClL;aACD,CAAC,CAAC;QACJ,CAAC;QAEQ,gCAAgC,CAAC,QAA0B,EAAE,OAAuB;;YAC5F,OAAO,MAAA,iBAAiB,CAAC,QAAQ,EAAE,OAAO,CAAC,mCAAI,0BAA0B,CAAC,QAAQ,CAAC,GAAG,CAAC,8BAAc,CAAC,CAAC,CAAC;QACzG,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAA+B;YAC/E,sBAAsB,CAAC,OAAO,CAAC,CAAC;YAEhC,MAAM,aAAa,GAAG,QAAQ,CAAC,GAAG,CAAC,8BAAc,CAAC,CAAC;YACnD,MAAM,MAAM,GAAG,aAAa,CAAC,UAAU,8BAAmC,CAAC,IAAI,CAC9E,MAAM,CAAC,EAAE,CAAC,MAAM,CAAC,MAAM,YAAY,yCAAmB,IAAI,MAAM,CAAC,MAAM,CAAC,QAAQ,KAAK,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC,QAAQ,IAAI,MAAM,CAAC,MAAM,CAAC,QAAQ,CAAC,QAAQ,EAAE,KAAK,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAC;YAC1N,MAAM,kBAAkB,GAAG,QAAQ,CAAC,GAAG,CAAC,0CAAoB,CAAC,CAAC;YAE9D,IAAI,MAAM,EAAE;gBACX,MAAM,KAAK,GAAG,kBAAkB,CAAC,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;gBAC1D,KAAK,aAAL,KAAK,uBAAL,KAAK,CAAE,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;aAChC;YAED,OAAO,OAAO,CAAC,cAAc,CAAC,oBAAoB,EAAE,CAAC;QACtD,CAAC;KACD,CAAC,CAAC;IAEH,SAAS,sBAAsB,CAAC,OAA+B;QAC9D,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;YACzD,IAAI,IAAI,CAAC,QAAQ,KAAK,yBAAQ,CAAC,QAAQ,EAAE;gBACxC,IAAI,CAAC,eAAe,CAAC,+BAAa,CAAC,OAAO,EAAE,wBAAwB,CAAC,CAAC;aACtE;QACF,CAAC,CAAC,CAAC;IACJ,CAAC;IAED,CAAA,GAAA,yBAAe,CAAA,CAAC,MAAM,cAAe,SAAQ,cAAc;QAC1D;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,0BAA0B;gBAC9B,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAgC,EAAE,IAAyB,CAAC;gBAC5E,IAAI,EAAE,KAAK,CAAC,QAAQ;gBACpB,WAAW,EAAE;oBACZ,WAAW,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAgC,EAAE,IAAyB,CAAC;oBAClF,IAAI,EAAE;wBACL;4BACC,IAAI,EAAE,KAAK;4BACX,WAAW,EAAE,kBAAkB;4BAC/B,UAAU,EAAE,SAAG;yBACf;qBACD;iBACD;gBACD,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,WAAW;oBACtB,KAAK,EAAE,CAAC,CAAC;oBACT,KAAK,EAAE,YAAY;oBACnB,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,2CAAyB,EAAE,2CAAyB,EAAE,+CAA6B,CAAC;iBAC7G;aACD,CAAC,CAAC;QACJ,CAAC;QAEQ,gCAAgC,CAAC,QAA0B,EAAE,OAAuB;;YAC5F,OAAO,MAAA,iBAAiB,CAAC,QAAQ,EAAE,OAAO,CAAC,mCAAI,0BAA0B,CAAC,QAAQ,CAAC,GAAG,CAAC,8BAAc,CAAC,CAAC,CAAC;QACzG,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAA+B;YAC/E,OAAO,OAAO,CAAC,cAAc,CAAC,mBAAmB,EAAE,CAAC;QACrD,CAAC;KACD,CAAC,CAAC;IAEH,sBAAY,CAAC,cAAc,CAAC,gBAAM,CAAC,iBAAiB,EAAE;QACrD,OAAO,EAAE,gBAAM,CAAC,kBAAkB;QAClC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAyB,EAAE,IAAa,CAAC;QACzD,KAAK,yBAAkC;QACvC,IAAI,EAAE,0CAAwB,CAAC,SAAS,CAAC,IAAI,CAAC;KAC9C,CAAC,CAAC;IAEH,sBAAY,CAAC,cAAc,CAAC,gBAAM,CAAC,aAAa,EAAE;QACjD,OAAO,EAAE,gBAAM,CAAC,iBAAiB;QACjC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAwB,EAAE,IAAe,CAAC;QAC1D,KAAK,yBAAkC;QACvC,IAAI,EAAE,yCAAuB;KAC7B,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,kBAAkB;QAC/C;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,8BAA8B;gBAClC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAkC,EAAE,IAAqB,CAAC;gBAC1E,UAAU,EAAE;oBACX,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,yCAAuB,EAAE,2BAAc,CAAC,GAAG,CAAC,oCAAsB,CAAC,CAAC;oBAC7F,OAAO,gBAAe;oBACtB,MAAM,4BAAmC;iBACzC;gBACD,YAAY,EAAE,2BAAc,CAAC,GAAG,CAAC,2CAAyB,EAAE,oCAAkB,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;gBACrG,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,iBAAiB;oBAC5B,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,yCAAuB,EAAE,0CAAwB,EAAE,wCAAsB,EAAE,oCAAkB,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;oBAC7I,KAAK,qBAAgC;iBACrC;aACD,CAAC,CAAC;QACJ,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAAmC;YACnF,MAAM,gBAAgB,CAAC,yBAAQ,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QAChD,CAAC;KACD,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,kBAAkB;QAC/C;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,kCAAkC;gBACtC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAsC,EAAE,IAAyB,CAAC;gBAClF,UAAU,EAAE;oBACX,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,yCAAuB,EAAE,2BAAc,CAAC,GAAG,CAAC,oCAAsB,CAAC,CAAC;oBAC7F,OAAO,gBAAe;oBACtB,MAAM,4BAAmC;iBACzC;gBACD,YAAY,EAAE,2BAAc,CAAC,GAAG,CAAC,2CAAyB,EAAE,oCAAkB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;gBACjG,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,iBAAiB;oBAC5B,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,yCAAuB,EAAE,0CAAwB,EAAE,wCAAsB,EAAE,oCAAkB,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC;oBACzI,KAAK,qBAAgC;iBACrC;aACD,CAAC,CAAC;QACJ,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAAmC;YACnF,MAAM,gBAAgB,CAAC,yBAAQ,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;QACpD,CAAC;KACD,CAAC,CAAC;IAEH,KAAK,UAAU,OAAO,CAAC,QAA0B,EAAE,OAAmC;;QACrF,IAAI,CAAA,MAAA,OAAO,CAAC,IAAI,CAAC,QAAQ,0CAAE,QAAQ,MAAK,2CAA0B,CAAC,SAAS,EAAE;YAC7E,OAAO;SACP;QAED,MAAM,kBAAkB,GAAG,QAAQ,CAAC,GAAG,CAAC,0CAAoB,CAAC,CAAC;QAC9D,MAAM,KAAK,GAAG,kBAAkB,CAAC,WAAW,CAAC;QAE7C,IAAI,KAAK,EAAE;YACV,IAAI,KAAK,CAAC,YAAY,EAAE;gBACvB,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;aACpC;SACD;QAED,IAAI,OAAO,CAAC,IAAI,CAAC,QAAQ,KAAK,yBAAQ,CAAC,QAAQ,EAAE;YAChD,OAAO,CAAC,cAAc,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;YACpE,OAAO;SACP;aAAM;YACN,OAAO,OAAO,CAAC,cAAc,CAAC,oBAAoB,CAAC,mBAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;SAClF;IACF,CAAC;IAEM,KAAK,UAAU,gBAAgB,CAAC,IAAc,EAAE,OAAmC,EAAE,QAAiB;;QAC5G,MAAM,EAAE,IAAI,EAAE,cAAc,EAAE,GAAG,OAAO,CAAC;QAEzC,IAAI,IAAI,CAAC,QAAQ,KAAK,IAAI,EAAE;YAC3B,OAAO,IAAI,CAAC;SACZ;QAED,IAAI,CAAC,cAAc,CAAC,SAAS,EAAE;YAC9B,OAAO,IAAI,CAAC;SACZ;QAED,IAAI,cAAc,CAAC,SAAS,CAAC,OAAO,CAAC,UAAU,EAAE;YAChD,OAAO,IAAI,CAAC;SACZ;QAED,MAAM,IAAI,GAAG,IAAI,CAAC,OAAO,EAAE,CAAC;QAC5B,MAAM,GAAG,GAAG,cAAc,CAAC,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;QAExD,IAAI,QAAQ,KAAK,SAAS,EAAE;YAC3B,MAAM,kBAAkB,GAAG,MAAA,MAAA,cAAc,CAAC,YAAY,0CAAE,kBAAkB,mCAAI,EAAE,CAAC;YACjF,QAAQ,GAAG,MAAA,kBAAkB,CAAC,CAAC,CAAC,mCAAI,WAAW,CAAC;SAChD;QAED,cAAc,CAAC,SAAS,CAAC,gBAAgB,CAAC,UAAU,CAAC;YACpD;gBACC,QAAQ,iBAAsB;gBAC9B,KAAK,EAAE,GAAG;gBACV,KAAK,EAAE,CAAC;gBACR,KAAK,EAAE,CAAC;wBACP,QAAQ,EAAE,IAAI;wBACd,MAAM,EAAE,IAAI;wBACZ,QAAQ,EAAE,QAAS;wBACnB,OAAO,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO;wBAC3B,QAAQ,EAAE,IAAI,CAAC,QAAQ;qBACvB,CAAC;aACF;SACD,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,CAAC,SAAS,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;QACtD,MAAM,OAAO,GAAG,cAAc,CAAC,SAAS,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;QAErD,IAAI,CAAC,OAAO,EAAE;YACb,OAAO,IAAI,CAAC;SACZ;QAED,cAAc,CAAC,iBAAiB,CAAC,OAAO,EAAE,IAAI,CAAC,YAAY,EAAE,KAAK,+BAAa,CAAC,OAAO,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;QAElH,OAAO,OAAO,CAAC;IAChB,CAAC;IA9CD,4CA8CC;IAED,MAAe,iBAAkB,SAAQ,cAAc;QACtD,YACC,IAA+B,EACvB,IAAc,EACd,SAA4B;YAEpC,KAAK,CAAC,IAAI,CAAC,CAAC;YAHJ,SAAI,GAAJ,IAAI,CAAU;YACd,cAAS,GAAT,SAAS,CAAmB;QAGrC,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAA+B;YAC/E,OAAO,CAAC,cAAc,CAAC,kBAAkB,CAAC,OAAO,CAAC,IAAI,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,SAAS,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;QACrG,CAAC;KACD;IAED,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,iBAAiB;QAC9C;YACC,KAAK,CACJ;gBACC,EAAE,EAAE,iCAAiC;gBACrC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAqC,EAAE,IAAwB,CAAC;gBAChF,UAAU,EAAE;oBACX,OAAO,EAAE,qCAA6B,gBAAgB;oBACtD,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,4CAA0B,EAAE,iCAAmB,CAAC,SAAS,EAAE,CAAC;oBACrF,MAAM,4BAAmC;iBACzC;gBACD,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,kBAAkB;oBAC7B,KAAK,EAAE,CAAC;iBACR;aACD,EACD,yBAAQ,CAAC,IAAI,EACb,OAAO,CAAC,CAAC;QACX,CAAC;KACD,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,iBAAiB;QAC9C;YACC,KAAK,CACJ;gBACC,EAAE,EAAE,iCAAiC;gBACrC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAqC,EAAE,IAAwB,CAAC;gBAChF,UAAU,EAAE;oBACX,OAAO,EAAE,kCAA8B;oBACvC,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,4CAA0B,EAAE,iCAAmB,CAAC,SAAS,EAAE,CAAC;oBACrF,MAAM,4BAAmC;iBACzC;gBACD,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,kBAAkB;oBAC7B,KAAK,EAAE,CAAC;iBACR;aACD,EACD,yBAAQ,CAAC,IAAI,EACb,OAAO,CAAC,CAAC;QACX,CAAC;KACD,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,cAAc;QAC3C;YACC,KAAK,CACJ;gBACC,EAAE,EAAE,kCAAkC;gBACtC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAqC,EAAE,IAAsB,CAAC;gBAC9E,EAAE,EAAE,KAAK;aACT,CAAC,CAAC;QACL,CAAC;QAEQ,KAAK,CAAC,GAAG,CAAC,QAA0B,EAAE,OAAgC;YAC9E,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,IAAI,CAAC,gCAAgC,CAAC,QAAQ,CAAC,CAAC;YACrE,IAAI,OAAO,EAAE;gBACZ,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;aACvC;QACF,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAA+B;YAC/E,MAAM,OAAO,GAAG,OAAO,CAAC,cAAc,CAAC,kBAAkB,CAAC,SAAS,EAAE,yBAAQ,CAAC,IAAI,EAAE,OAAO,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;YAC9G,IAAI,OAAO,EAAE;gBACZ,OAAO,CAAC,cAAc,CAAC,iBAAiB,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;aAC5D;QACF,CAAC;KACD,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,cAAc;QAC3C;YACC,KAAK,CACJ;gBACC,EAAE,EAAE,sCAAsC;gBAC1C,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAyC,EAAE,IAA0B,CAAC;gBACtF,EAAE,EAAE,KAAK;aACT,CAAC,CAAC;QACL,CAAC;QAEQ,KAAK,CAAC,GAAG,CAAC,QAA0B,EAAE,OAAgC;YAC9E,OAAO,GAAG,OAAO,aAAP,OAAO,cAAP,OAAO,GAAI,IAAI,CAAC,gCAAgC,CAAC,QAAQ,CAAC,CAAC;YACrE,IAAI,OAAO,EAAE;gBACZ,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;aACvC;QACF,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAA+B;YAC/E,MAAM,OAAO,GAAG,OAAO,CAAC,cAAc,CAAC,kBAAkB,CAAC,SAAS,EAAE,yBAAQ,CAAC,QAAQ,EAAE,OAAO,EAAE,SAAS,EAAE,IAAI,CAAC,CAAC;YAClH,IAAI,OAAO,EAAE;gBACZ,OAAO,CAAC,cAAc,CAAC,iBAAiB,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;aAC5D;QACF,CAAC;KACD,CAAC,CAAC;IAEH,sBAAY,CAAC,cAAc,CAAC,gBAAM,CAAC,mBAAmB,EAAE;QACvD,OAAO,EAAE;YACR,EAAE,EAAE,iCAAiC;YACrC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAiC,EAAE,IAAa,CAAC;YACjE,OAAO,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAyC,EAAE,IAAe,CAAC;SAC7E;QACD,KAAK,EAAE,CAAC;QACR,KAAK,EAAE,QAAQ;QACf,IAAI,EAAE,0CAAwB,CAAC,SAAS,CAAC,IAAI,CAAC;KAC9C,CAAC,CAAC;IAEH,sBAAY,CAAC,cAAc,CAAC,gBAAM,CAAC,mBAAmB,EAAE;QACvD,OAAO,EAAE;YACR,EAAE,EAAE,kCAAkC;YACtC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAiC,EAAE,IAAa,CAAC;YACjE,OAAO,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAyC,EAAE,IAAe,CAAC;SAC7E;QACD,KAAK,EAAE,CAAC;QACR,KAAK,EAAE,QAAQ;QACf,IAAI,EAAE,0CAAwB,CAAC,SAAS,CAAC,IAAI,CAAC;KAC9C,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,iBAAiB;QAC9C;YACC,KAAK,CACJ;gBACC,EAAE,EAAE,qCAAqC;gBACzC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAyC,EAAE,IAA4B,CAAC;gBACxF,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,kBAAkB;oBAC7B,KAAK,EAAE,CAAC;iBACR;aACD,EACD,yBAAQ,CAAC,QAAQ,EACjB,OAAO,CAAC,CAAC;QACX,CAAC;KACD,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,iBAAiB;QAC9C;YACC,KAAK,CACJ;gBACC,EAAE,EAAE,qCAAqC;gBACzC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAyC,EAAE,IAA4B,CAAC;gBACxF,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,kBAAkB;oBAC7B,KAAK,EAAE,CAAC;iBACR;aACD,EACD,yBAAQ,CAAC,QAAQ,EACjB,OAAO,CAAC,CAAC;QACX,CAAC;KACD,CAAC,CAAC;IAEH,sBAAY,CAAC,cAAc,CAAC,gBAAM,CAAC,mBAAmB,EAAE;QACvD,OAAO,EAAE;YACR,EAAE,EAAE,qCAAqC;YACzC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAqC,EAAE,IAAiB,CAAC;YACzE,OAAO,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAA6C,EAAE,IAAmB,CAAC;SACrF;QACD,KAAK,EAAE,CAAC;QACR,KAAK,EAAE,QAAQ;QACf,IAAI,EAAE,0CAAwB,CAAC,SAAS,CAAC,IAAI,CAAC;KAC9C,CAAC,CAAC;IAEH,sBAAY,CAAC,cAAc,CAAC,gBAAM,CAAC,mBAAmB,EAAE;QACvD,OAAO,EAAE;YACR,EAAE,EAAE,sCAAsC;YAC1C,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAqC,EAAE,IAAiB,CAAC;YACzE,OAAO,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAA6C,EAAE,IAAmB,CAAC;SACrF;QACD,KAAK,EAAE,CAAC;QACR,KAAK,EAAE,QAAQ;QACf,IAAI,EAAE,0CAAwB,CAAC,SAAS,CAAC,IAAI,CAAC;KAC9C,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,kBAAkB;QAC/C;YACC,KAAK,CACJ;gBACC,EAAE,EAAE,oBAAoB;gBACxB,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAA0B,EAAE,IAAW,CAAC;gBACxD,UAAU,EAAE;oBACX,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,4CAA0B,EAAE,2BAAc,CAAC,GAAG,CAAC,oCAAsB,CAAC,CAAC;oBAChG,OAAO,eAAe;oBACtB,MAAM,4BAAmC;iBACzC;gBACD,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,iBAAiB;oBAC5B,IAAI,EAAE,2BAAc,CAAC,GAAG,CACvB,oCAAkB,CAAC,SAAS,CAAC,UAAU,CAAC,EACxC,kDAAgC,CAAC,SAAS,EAAE,EAC5C,wCAAsB,CAAC;oBACxB,KAAK,kBAA2B;oBAChC,KAAK,EAAE,gCAAwB;iBAC/B;gBACD,IAAI,EAAE,KAAK,CAAC,QAAQ;aACpB,CAAC,CAAC;QACL,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAAmC;YACnF,OAAO,CAAC,cAAc,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;QAClE,CAAC;KACD,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,kBAAkB;QAC/C;YACC,KAAK,CACJ;gBACC,EAAE,EAAE,2CAAyB;gBAC7B,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAA0B,EAAE,IAAmB,CAAC;gBAChE,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,iBAAiB;oBAC5B,IAAI,EAAE,2BAAc,CAAC,GAAG,CACvB,oCAAkB,CAAC,SAAS,CAAC,UAAU,CAAC,EACxC,kDAAgC,EAChC,wCAAsB,CAAC;oBACxB,KAAK,kBAA2B;oBAChC,KAAK,EAAE,gCAAwB;iBAC/B;gBACD,IAAI,EAAE,KAAK,CAAC,YAAY;gBACxB,UAAU,EAAE;oBACX,IAAI,EAAE,2BAAc,CAAC,GAAG,CACvB,yCAAuB,EACvB,iCAAmB,EACnB,qCAAiB,CAAC,YAAY,CAAC,SAAS,EAAE,EAC1C,qCAAiB,CAAC,oBAAoB,CAAC,SAAS,EAAE,EAClD,qCAAiB,CAAC,qBAAqB,CAAC,SAAS,EAAE,CACnD;oBACD,OAAO,gBAAgB;oBACvB,MAAM,EAAE,4CAAoC,GAAG,CAAC;iBAChD;aACD,CAAC,CAAC;QACL,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAAmC;YACnF,IAAI,OAAO,CAAC,IAAI,CAAC,QAAQ,KAAK,yBAAQ,CAAC,QAAQ,EAAE;gBAChD,OAAO,CAAC,IAAI,CAAC,eAAe,CAAC,+BAAa,CAAC,OAAO,EAAE,2CAAyB,CAAC,CAAC;aAC/E;YAED,OAAO,OAAO,CAAC,cAAc,CAAC,iBAAiB,CAAC,OAAO,CAAC,IAAI,EAAE,WAAW,CAAC,CAAC;QAC5E,CAAC;KACD,CAAC,CAAC;IAEH,SAAgB,eAAe,CAAC,SAA4B,EAAE,IAAoB;QACjF,MAAM,UAAU,GAAG,SAAS,CAAC,aAAa,EAAE,CAAC;QAC7C,MAAM,eAAe,GAAG,SAAS,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;QACrD,MAAM,mBAAmB,GAAG,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC,SAAS,CAAC,KAAK,IAAI,eAAe,IAAI,eAAe,GAAG,SAAS,CAAC,GAAG,CAAC,CAAC;QAEhI,IAAI,mBAAmB,EAAE;YACxB,MAAM,KAAK,GAAuB,UAAU,CAAC,OAAO,EAAE,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;gBACxE,QAAQ,iBAAsB,EAAE,KAAK,EAAE,SAAS,CAAC,KAAK,EAAE,KAAK,EAAE,SAAS,CAAC,GAAG,GAAG,SAAS,CAAC,KAAK,EAAE,KAAK,EAAE,EAAE;aACzG,CAAC,CAAC,CAAC;YAEJ,MAAM,gCAAgC,GAAG,SAAS,CAAC,MAAM,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC;YAEnF,SAAS,CAAC,gBAAgB,CAAC,UAAU,CAAC,KAAK,EAAE,IAAI,EAAE,EAAE,IAAI,EAAE,mCAAkB,CAAC,KAAK,EAAE,KAAK,EAAE,SAAS,CAAC,QAAQ,EAAE,EAAE,UAAU,EAAE,SAAS,CAAC,aAAa,EAAE,EAAE,EAAE,GAAG,EAAE;gBAC/J,IAAI,gCAAgC,EAAE;oBACrC,MAAM,SAAS,GAAG,SAAS,CAAC,gBAAgB,CAAC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,MAAM,KAAK,gCAAgC,CAAC,MAAM,CAAC,CAAC;oBAC9H,OAAO,EAAE,IAAI,EAAE,mCAAkB,CAAC,KAAK,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,EAAE,SAAS,GAAG,CAAC,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,KAAK,EAAE,SAAS,EAAE,GAAG,EAAE,SAAS,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC;iBACnJ;qBAAM;oBACN,IAAI,SAAS,CAAC,gBAAgB,CAAC,MAAM,EAAE;wBACtC,MAAM,aAAa,GAAG,SAAS,CAAC,gBAAgB,CAAC,MAAM,GAAG,CAAC,CAAC;wBAC5D,OAAO,EAAE,IAAI,EAAE,mCAAkB,CAAC,KAAK,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,aAAa,EAAE,GAAG,EAAE,aAAa,GAAG,CAAC,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,KAAK,EAAE,aAAa,EAAE,GAAG,EAAE,aAAa,GAAG,CAAC,EAAE,CAAC,EAAE,CAAC;qBAEnK;yBAAM;wBACN,OAAO,EAAE,IAAI,EAAE,mCAAkB,CAAC,KAAK,EAAE,KAAK,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,EAAE,UAAU,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC;qBAC3G;iBACD;YACF,CAAC,EAAE,SAAS,CAAC,CAAC;SACd;aAAM;YACN,MAAM,KAAK,GAAG,SAAS,CAAC,QAAQ,EAAE,CAAC;YACnC,MAAM,KAAK,GAAuB,CAAC;oBAClC,QAAQ,iBAAsB,EAAE,KAAK,EAAE,eAAe,EAAE,KAAK,EAAE,CAAC,EAAE,KAAK,EAAE,EAAE;iBAC3E,CAAC,CAAC;YAEH,IAAI,eAAe,GAAiB,EAAE,CAAC;YACvC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,UAAU,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAC3C,MAAM,SAAS,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC;gBAEhC,IAAI,SAAS,CAAC,GAAG,IAAI,eAAe,EAAE;oBACrC,eAAe,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;iBAChC;qBAAM,IAAI,SAAS,CAAC,KAAK,GAAG,eAAe,EAAE;oBAC7C,eAAe,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,SAAS,CAAC,KAAK,GAAG,CAAC,EAAE,GAAG,EAAE,SAAS,CAAC,GAAG,GAAG,CAAC,EAAE,CAAC,CAAC;iBAC7E;qBAAM;oBACN,eAAe,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,eAAe,EAAE,GAAG,EAAE,eAAe,GAAG,CAAC,EAAE,CAAC,CAAC;iBAC3E;aACD;YAED,IAAI,SAAS,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,IAAI,EAAE;gBAC3C,+DAA+D;gBAC/D,MAAM,QAAQ,GAAG,KAAK,CAAC,GAAG,KAAK,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,KAAK,CAAC,KAAK,GAAG,CAAC,EAAE,GAAG,EAAE,KAAK,CAAC,GAAG,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC;gBAEzG,SAAS,CAAC,gBAAgB,CAAC,UAAU,CAAC,KAAK,EAAE,IAAI,EAAE,EAAE,IAAI,EAAE,mCAAkB,CAAC,KAAK,EAAE,KAAK,EAAE,SAAS,CAAC,QAAQ,EAAE,EAAE,UAAU,EAAE,SAAS,CAAC,aAAa,EAAE,EAAE,EAAE,GAAG,EAAE,CAAC,CAAC;oBACjK,IAAI,EAAE,mCAAkB,CAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,UAAU,EAAE,eAAe;iBAC5E,CAAC,EAAE,SAAS,CAAC,CAAC;aACf;iBAAM;gBACN,+DAA+D;gBAC/D,MAAM,QAAQ,GAAG,KAAK,CAAC,KAAK,GAAG,eAAe,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,KAAK,CAAC,KAAK,GAAG,CAAC,EAAE,GAAG,EAAE,KAAK,CAAC,GAAG,GAAG,CAAC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC;gBAExG,SAAS,CAAC,gBAAgB,CAAC,UAAU,CAAC,KAAK,EAAE,IAAI,EAAE,EAAE,IAAI,EAAE,mCAAkB,CAAC,KAAK,EAAE,KAAK,EAAE,SAAS,CAAC,QAAQ,EAAE,EAAE,UAAU,EAAE,SAAS,CAAC,aAAa,EAAE,EAAE,EAAE,GAAG,EAAE,CAAC,CAAC;oBACjK,IAAI,EAAE,mCAAkB,CAAC,KAAK,EAAE,KAAK,EAAE,QAAQ,EAAE,UAAU,EAAE,eAAe;iBAC5E,CAAC,EAAE,SAAS,CAAC,CAAC;aACf;SACD;IACF,CAAC;IA7DD,0CA6DC;IAED,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,kBAAkB;QAC/C;YACC,KAAK,CACJ;gBACC,EAAE,EAAE,sBAAsB;gBAC1B,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAA4B,EAAE,IAAa,CAAC;gBAC5D,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,iBAAiB;oBAC5B,IAAI,EAAE,0CAAwB;iBAC9B;gBACD,UAAU,EAAE;oBACX,OAAO,iBAAgB;oBACvB,GAAG,EAAE;wBACJ,OAAO,EAAE,sCAAkC;qBAC3C;oBACD,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,yCAAuB,EAAE,0CAAwB,EAAE,2BAAc,CAAC,GAAG,CAAC,oCAAsB,CAAC,CAAC;oBACvH,MAAM,4BAAmC;iBACzC;gBACD,IAAI,EAAE,KAAK,CAAC,cAAc;aAC1B,CAAC,CAAC;QACL,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAAmC;YACnF,MAAM,SAAS,GAAG,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC;YACnD,IAAI,CAAC,SAAS,IAAI,SAAS,CAAC,OAAO,CAAC,UAAU,EAAE;gBAC/C,OAAO;aACP;YAED,eAAe,CAAC,SAAS,EAAE,OAAO,CAAC,IAAI,CAAC,CAAC;QAC1C,CAAC;KACD,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,kBAAkB;QAC/C;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,6BAA6B;gBACjC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAkB,EAAE,IAAoB,CAAC;gBACzD,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,iBAAiB;oBAC5B,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,oCAAkB,CAAC,SAAS,CAAC,MAAM,CAAC,EAAE,wBAAwB,EAAE,2CAAyB,EAAE,0CAAwB,EAAE,wCAAsB,CAAC;oBACrK,KAAK,yBAAkC;oBACvC,KAAK,EAAE,kCAA0B;iBACjC;gBACD,UAAU,EAAE;oBACX,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,yCAAuB,EAAE,2BAAc,CAAC,GAAG,CAAC,oCAAsB,CAAC,EAAE,2CAAyB,EAAE,0CAAwB,EAAE,wCAAsB,CAAC;oBAC1K,OAAO,EAAE,+BAA2B;oBACpC,MAAM,4BAAmC;iBACzC;gBACD,IAAI,EAAE,KAAK,CAAC,SAAS;aACrB,CAAC,CAAC;QACJ,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAAmC;;YACnF,MAAM,MAAM,GAAG,OAAO,CAAC,cAAc,CAAC;YACtC,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE;gBAClD,OAAO;aACP;YAED,MAAM,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC;YAC1B,MAAM,KAAK,GAAG,MAAM,CAAC,SAAS,CAAC,gBAAgB,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAE1E,IAAI,KAAK,GAAG,CAAC,EAAE;gBACd,OAAO;aACP;YAED,MAAM,CAAC,SAAS,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC,EAAE,QAAQ,gBAAqB,EAAE,KAAK,EAAE,OAAO,EAAE,EAAE,EAAE,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;YAEnJ,IAAI,OAAO,CAAC,IAAI,CAAC,QAAQ,IAAI,CAAA,MAAA,OAAO,CAAC,IAAI,CAAC,QAAQ,0CAAE,QAAQ,MAAK,2CAA0B,CAAC,SAAS,EAAE;gBACtG,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC;wBAC7D,QAAQ,kBAAuB,EAAE,KAAK,EAAE,QAAQ,kCAC5C,OAAO,CAAC,IAAI,CAAC,QAAQ,KACxB,QAAQ,EAAE,2CAA0B,CAAC,IAAI,EACzC,YAAY,EAAE,SAAS,EACvB,sBAAsB,EAAE,SAAS,EACjC,UAAU,EAAE,SAAS,EACrB,cAAc,EAAE,SAAS,EACzB,cAAc,EAAE,SAAS,GACzB;qBACD,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;aACjD;QACF,CAAC;KACD,CAAC,CAAC;IAcH,CAAA,GAAA,yBAAe,CAAA,CAAC,MAAM,wBAAyB,SAAQ,kBAA8B;QACpF;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,sCAAoB;gBACxB,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAgB,EAAE,IAAsB,CAAC;gBACzD,WAAW,EAAE;oBACZ,WAAW,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAgB,EAAE,IAAsB,CAAC;oBAC/D,IAAI,EAAE;wBACL;4BACC,IAAI,EAAE,OAAO;4BACb,WAAW,EAAE,gBAAgB;4BAC7B,MAAM,EAAE;gCACP,MAAM,EAAE,QAAQ;gCAChB,UAAU,EAAE,CAAC,OAAO,EAAE,KAAK,CAAC;gCAC5B,YAAY,EAAE;oCACb,OAAO,EAAE;wCACR,MAAM,EAAE,QAAQ;qCAChB;oCACD,KAAK,EAAE;wCACN,MAAM,EAAE,QAAQ;qCAChB;iCACD;6BACD;yBACD;wBACD;4BACC,IAAI,EAAE,UAAU;4BAChB,WAAW,EAAE,0BAA0B;4BACvC,MAAM,EAAE;gCACP,MAAM,EAAE,QAAQ;6BAChB;yBACD;qBACD;iBACD;aACD,CAAC,CAAC;QACJ,CAAC;QAEkB,sBAAsB,CAAC,QAA0B,EAAE,OAAoB,EAAE,GAAG,cAAqB;YACnH,IAAI,CAAC,OAAO,IAAI,OAAO,OAAO,CAAC,KAAK,KAAK,QAAQ,IAAI,OAAO,OAAO,CAAC,GAAG,KAAK,QAAQ,IAAI,OAAO,CAAC,KAAK,IAAI,OAAO,CAAC,GAAG,EAAE;gBACrH,OAAO;aACP;YAED,MAAM,QAAQ,GAAG,cAAc,CAAC,MAAM,IAAI,OAAO,cAAc,CAAC,CAAC,CAAC,KAAK,QAAQ,CAAC,CAAC,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC;YAChH,MAAM,mBAAmB,GAAG,IAAI,CAAC,gCAAgC,CAAC,QAAQ,CAAC,CAAC;YAE5E,IAAI,CAAC,mBAAmB,IAAI,CAAC,mBAAmB,CAAC,cAAc,CAAC,SAAS,IAAI,OAAO,CAAC,KAAK,IAAI,mBAAmB,CAAC,cAAc,CAAC,SAAS,CAAC,MAAM,EAAE;gBAClJ,OAAO;aACP;YAED,wCAAwC;YACxC,OAAO;gBACN,cAAc,EAAE,mBAAmB,CAAC,cAAc;gBAClD,IAAI,EAAE,mBAAmB,CAAC,cAAc,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAE;gBACzE,QAAQ;aACR,CAAC;QACH,CAAC;QAGD,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAA2B;YAC3E,IAAI,OAAO,CAAC,QAAQ,EAAE;gBACrB,MAAM,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,OAAO,CAAC,QAAQ,CAAC,CAAC;aAClD;iBAAM;gBACN,MAAM,IAAI,CAAC,kBAAkB,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;aACjD;QACF,CAAC;QAEO,KAAK,CAAC,kBAAkB,CAAC,QAA0B,EAAE,OAA2B;;YACvF,MAAM,QAAQ,GAAyB,EAAE,CAAC;YAC1C,MAAM,SAAS,GAAyB,EAAE,CAAC;YAE3C,MAAM,WAAW,GAAG,QAAQ,CAAC,GAAG,CAAC,0BAAY,CAAC,CAAC;YAC/C,MAAM,YAAY,GAAG,QAAQ,CAAC,GAAG,CAAC,4BAAa,CAAC,CAAC;YACjD,MAAM,iBAAiB,GAAG,QAAQ,CAAC,GAAG,CAAC,+BAAkB,CAAC,CAAC;YAE3D,MAAM,iBAAiB,GAAG,IAAI,GAAG,CAAC;gBACjC,GAAG,CAAC,MAAA,MAAA,OAAO,CAAC,cAAc,CAAC,YAAY,0CAAE,kBAAkB,mCAAI,WAAW,CAAC,kBAAkB,EAAE,CAAC;gBAChG,UAAU;aACV,CAAC,CAAC;YAEH,iBAAiB,CAAC,OAAO,CAAC,UAAU,CAAC,EAAE;gBACtC,IAAI,WAAmB,CAAC;gBACxB,IAAI,OAAO,CAAC,IAAI,CAAC,QAAQ,KAAK,yBAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,UAAU,KAAK,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC,UAAU,KAAK,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;oBACvH,WAAW,GAAG,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAqB,EAAE,IAA0B,EAAE,UAAU,CAAC,CAAC;iBACtF;qBAAM;oBACN,WAAW,GAAG,CAAA,GAAA,cAAQ,CAAA,CAAC,EAA+B,EAAE,IAAO,EAAE,UAAU,CAAC,CAAC;iBAC7E;gBAED,MAAM,YAAY,GAAG,WAAW,CAAC,eAAe,CAAC,UAAU,CAAC,CAAC;gBAC7D,IAAI,CAAC,YAAY,EAAE;oBAClB,qCAAqC;oBACrC,OAAO;iBACP;gBAED,MAAM,IAAI,GAAuB;oBAChC,KAAK,EAAE,YAAY;oBACnB,WAAW,EAAE,CAAA,GAAA,+BAAc,CAAA,CAAC,YAAY,EAAE,WAAW,EAAE,IAAI,CAAC,eAAe,CAAC,YAAY,EAAE,WAAW,CAAC,CAAC;oBACvG,WAAW;oBACX,UAAU;iBACV,CAAC;gBAEF,IAAI,UAAU,KAAK,UAAU,IAAI,UAAU,KAAK,OAAO,CAAC,IAAI,CAAC,QAAQ,EAAE;oBACtE,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBACpB;qBAAM;oBACN,SAAS,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;iBACrB;YACF,CAAC,CAAC,CAAC;YAEH,SAAS,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE;gBACvB,OAAO,CAAC,CAAC,WAAW,CAAC,aAAa,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC;YACnD,CAAC,CAAC,CAAC;YAEH,MAAM,KAAK,GAAqB;gBAC/B,GAAG,QAAQ;gBACX,EAAE,IAAI,EAAE,WAAW,EAAE;gBACrB,GAAG,SAAS;aACZ,CAAC;YAEF,MAAM,SAAS,GAAG,MAAM,iBAAiB,CAAC,IAAI,CAAC,KAAK,EAAE,EAAE,WAAW,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAyB,EAAE,IAAsB,CAAC,EAAE,CAAmC,CAAC;YACtK,IAAI,SAAS,IAAI,SAAS,CAAC,UAAU,EAAE;gBACtC,MAAM,IAAI,CAAC,WAAW,CAAC,OAAO,EAAE,SAAS,CAAC,UAAU,CAAC,CAAC;aACtD;QACF,CAAC;QAEO,KAAK,CAAC,WAAW,CAAC,OAA2B,EAAE,UAAkB;;YACxE,IAAI,UAAU,KAAK,UAAU,IAAI,CAAA,MAAA,OAAO,CAAC,IAAI,0CAAE,QAAQ,MAAK,UAAU,EAAE;gBACvE,MAAM,OAAO,GAAG,MAAM,gBAAgB,CAAC,yBAAQ,CAAC,QAAQ,EAAE,EAAE,IAAI,EAAE,OAAO,CAAC,IAAI,EAAE,cAAc,EAAE,OAAO,CAAC,cAAc,EAAE,EAAE,UAAU,CAAC,CAAC;gBACtI,IAAI,OAAO,EAAE;oBACZ,OAAO,CAAC,cAAc,CAAC,iBAAiB,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;iBAC5D;aACD;iBAAM,IAAI,UAAU,KAAK,UAAU,IAAI,CAAA,MAAA,OAAO,CAAC,IAAI,0CAAE,QAAQ,MAAK,yBAAQ,CAAC,QAAQ,EAAE;gBACrF,MAAM,gBAAgB,CAAC,yBAAQ,CAAC,IAAI,EAAE,EAAE,IAAI,EAAE,OAAO,CAAC,IAAI,EAAE,cAAc,EAAE,OAAO,CAAC,cAAc,EAAE,EAAE,UAAU,CAAC,CAAC;aAClH;iBAAM;gBACN,MAAM,KAAK,GAAG,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC,gBAAgB,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBAClG,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC,gBAAgB,CAAC,UAAU,CAC3D,CAAC,EAAE,QAAQ,sBAA2B,EAAE,KAAK,EAAE,QAAQ,EAAE,UAAU,EAAE,CAAC,EACtE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,CAAC,SAAS,EAAE,SAAS,CAC3C,CAAC;aACF;QACF,CAAC;QAED;;WAEG;QACK,eAAe,CAAC,IAAY,EAAE,WAAyB;YAC9D,IAAI,YAA6B,CAAC;YAElC,MAAM,UAAU,GAAG,WAAW,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;YACnD,IAAI,UAAU,aAAV,UAAU,uBAAV,UAAU,CAAE,MAAM,EAAE;gBACvB,YAAY,GAAG,SAAG,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,CAAC,CAAC,CAAC;aACvC;iBAAM;gBACN,MAAM,SAAS,GAAG,WAAW,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;gBACjD,IAAI,SAAS,aAAT,SAAS,uBAAT,SAAS,CAAE,MAAM,EAAE;oBACtB,YAAY,GAAG,SAAG,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC;iBACtC;aACD;YAED,OAAO,YAAY,CAAC;QACrB,CAAC;KACD,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,cAAc;QAC3C;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,kCAAkC;gBACtC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAsB,EAAE,IAAyB,CAAC;gBAClE,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,WAAW;oBACtB,IAAI,EAAE,2CAAyB;oBAC/B,KAAK,EAAE,YAAY;oBACnB,KAAK,EAAE,CAAC;iBACR;gBACD,IAAI,EAAE,KAAK,CAAC,SAAS;aACrB,CAAC,CAAC;QACJ,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAA+B;YAC/E,MAAM,MAAM,GAAG,OAAO,CAAC,cAAc,CAAC;YACtC,IAAI,CAAC,MAAM,CAAC,SAAS,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,MAAM,EAAE;gBAClD,OAAO;aACP;YAED,MAAM,CAAC,SAAS,CAAC,gBAAgB,CAAC,UAAU,CAC3C,MAAM,CAAC,SAAS,CAAC,gBAAgB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,KAAK,EAAE,EAAE,CAAC,CAAC;gBAC7D,QAAQ,gBAAqB,EAAE,KAAK,EAAE,OAAO,EAAE,EAAE;aACjD,CAAC,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;YAEnD,MAAM,2BAA2B,GAAG,MAAM,CAAC,SAAS,CAAC,gBAAgB,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,IAAI,EAAE,KAAK,EAAE,EAAE;;gBAC/F,IAAI,IAAI,CAAC,QAAQ,IAAI,CAAA,MAAA,IAAI,CAAC,QAAQ,0CAAE,QAAQ,MAAK,2CAA0B,CAAC,SAAS,EAAE;oBACtF,OAAO;wBACN,QAAQ,kBAAuB,EAAE,KAAK,EAAE,QAAQ,kCAC5C,IAAI,CAAC,QAAQ,KAChB,QAAQ,EAAE,2CAA0B,CAAC,IAAI,EACzC,YAAY,EAAE,SAAS,EACvB,sBAAsB,EAAE,SAAS,EACjC,UAAU,EAAE,SAAS,EACrB,cAAc,EAAE,SAAS,GACzB;qBACD,CAAC;iBACF;qBAAM;oBACN,OAAO,SAAS,CAAC;iBACjB;YACF,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAyB,CAAC;YAClD,IAAI,2BAA2B,CAAC,MAAM,EAAE;gBACvC,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC,gBAAgB,CAAC,UAAU,CAAC,2BAA2B,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;aACvI;QACF,CAAC;KACD,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,kBAAkB;QAC/C;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,kBAAkB;gBACtB,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAkC,EAAE,IAAoB,CAAC;gBACzE,UAAU,EAAE;oBACX,IAAI,EAAE,yCAAuB;oBAC7B,OAAO,EAAE,mCAA8B;oBACvC,GAAG,EAAE;wBACJ,OAAO,EAAE,kCAA8B;qBACvC;oBACD,MAAM,4BAAmC;iBACzC;aACD,CAAC,CAAC;QACJ,CAAC;QAED,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAAmC;YACnF,OAAO,OAAO,CAAC,cAAc,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QAC5D,CAAC;KACD,CAAC,CAAC;IAEH,MAAe,gCAAiC,SAAQ,kBAAkB;QACzE,KAAK,CAAC,cAAc,CAAC,QAA0B,EAAE,OAAmC;;YACnF,MAAM,SAAS,GAAG,OAAO,CAAC,cAAc,CAAC,SAAS,CAAC,gBAAgB,CAAC;YACpE,IAAI,CAAC,SAAS,EAAE;gBACf,OAAO;aACP;YAED,MAAM,aAAa,GAAG,IAAI,CAAC,gBAAgB,EAAE,CAAC;YAC9C,MAAM,KAAK,GAAyB,EAAE,CAAC;YACvC,MAAM,WAAW,GAAG,MAAA,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,mCAAI,EAAE,CAAC;YAClF,KAAK,MAAM,IAAI,IAAI,WAAW,EAAE;gBAC/B,MAAM,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;gBAClD,IAAI,KAAK,IAAI,CAAC,EAAE;oBACf,KAAK,CAAC,IAAI,CAAC,EAAE,QAAQ,kBAAuB,EAAE,KAAK,EAAE,QAAQ,kCAAO,OAAO,CAAC,IAAI,CAAC,QAAQ,GAAK,aAAa,CAAE,EAAE,CAAC,CAAC;iBACjH;aACD;YAED,SAAS,CAAC,UAAU,CAAC,KAAK,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;QAC1E,CAAC;KAGD;IAED,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,gCAAgC;QAC7D;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,8BAA8B;gBAClC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAmC,EAAE,IAAqB,CAAC;gBAC3E,UAAU,EAAE;oBACX,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,4CAA0B,EAAE,+CAA6B,CAAC,SAAS,EAAE,EAAE,iCAAmB,CAAC,SAAS,EAAE,CAAC;oBAChI,OAAO,EAAE,CAAA,GAAA,mBAAQ,CAAA,CAAC,mCAA8B,EAAE,mCAA8B,CAAC;oBACjF,MAAM,4BAAmC;iBACzC;gBACD,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,iBAAiB;oBAC5B,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,+CAA6B,CAAC,SAAS,EAAE,CAAC;oBACnE,KAAK,6BAAoC;iBACzC;aACD,CAAC,CAAC;QACJ,CAAC;QAED,gBAAgB;YACf,OAAO,EAAE,cAAc,EAAE,IAAI,EAAE,CAAC;QACjC,CAAC;KACD,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,gCAAgC;QAC7D;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,8CAA4B;gBAChC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAiC,EAAE,IAAmB,CAAC;gBACvE,UAAU,EAAE;oBACX,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,4CAA0B,EAAE,+CAA6B,CAAC;oBACnF,OAAO,EAAE,CAAA,GAAA,mBAAQ,CAAA,CAAC,mCAA8B,EAAE,mCAA8B,CAAC;oBACjF,MAAM,4BAAmC;iBACzC;gBACD,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,iBAAiB;oBAC5B,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,+CAA6B,CAAC;oBACvD,KAAK,6BAAoC;iBACzC;aACD,CAAC,CAAC;QACJ,CAAC;QAED,gBAAgB;YACf,OAAO,EAAE,cAAc,EAAE,KAAK,EAAE,CAAC;QAClC,CAAC;KACD,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,gCAAgC;QAC7D;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,+BAA+B;gBACnC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAoC,EAAE,IAAsB,CAAC;gBAC7E,UAAU,EAAE;oBACX,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,4CAA0B,EAAE,gDAA8B,CAAC,SAAS,EAAE,EAAE,iCAAmB,CAAC,SAAS,EAAE,EAAE,2CAAyB,CAAC;oBAC5J,OAAO,EAAE,CAAA,GAAA,mBAAQ,CAAA,CAAC,mCAA8B,iBAAgB;oBAChE,MAAM,4BAAmC;iBACzC;gBACD,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,iBAAiB;oBAC5B,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,gDAA8B,CAAC,SAAS,EAAE,EAAE,2CAAyB,CAAC;oBAC/F,KAAK,6BAAoC;iBACzC;aACD,CAAC,CAAC;QACJ,CAAC;QAED,gBAAgB;YACf,OAAO,EAAE,eAAe,EAAE,IAAI,EAAE,CAAC;QAClC,CAAC;KACD,CAAC,CAAC;IAEH,CAAA,GAAA,yBAAe,CAAA,CAAC,KAAM,SAAQ,gCAAgC;QAC7D;YACC,KAAK,CAAC;gBACL,EAAE,EAAE,6BAA6B;gBACjC,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,EAAkC,EAAE,IAAoB,CAAC;gBACzE,UAAU,EAAE;oBACX,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,4CAA0B,EAAE,gDAA8B,CAAC;oBACpF,OAAO,EAAE,CAAA,GAAA,mBAAQ,CAAA,CAAC,mCAA8B,iBAAgB;oBAChE,MAAM,4BAAmC;iBACzC;gBACD,IAAI,EAAE;oBACL,EAAE,EAAE,gBAAM,CAAC,iBAAiB;oBAC5B,IAAI,EAAE,2BAAc,CAAC,GAAG,CAAC,gDAA8B,CAAC;oBACxD,KAAK,6BAAoC;iBACzC;aACD,CAAC,CAAC;QACJ,CAAC;QAED,gBAAgB;YACf,OAAO,EAAE,eAAe,EAAE,KAAK,EAAE,CAAC;QACnC,CAAC;KACD,CAAC,CAAC;IAEH,qDAAqD;IACrD,2BAAgB,CAAC,eAAe,CAAC,gBAAgB,EAAE,CAAC,QAAQ,EAAE,IAAI,EAAE,EAAE;QACrE,MAAM,GAAG,GAAG,SAAG,CAAC,MAAM,CAAC,IAAqB,CAAC,CAAC;QAC9C,MAAM,eAAe,GAAG,QAAQ,CAAC,GAAG,CAAmB,kCAAgB,CAAC,CAAC;QAGzE,MAAM,QAAQ,GAAG,eAAe,CAAC,qBAAqB,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC,QAAQ,CAAC,GAAG,CAAC,QAAQ,EAAE,KAAK,GAAG,CAAC,QAAQ,EAAE,CAAC,CAAC;QAEtH,IAAI,QAAQ,EAAE;YACb,QAAQ,CAAC,UAAU,CAAC,CAAC,EAAE,QAAQ,0BAA+B,EAAE,QAAQ,kCAAO,QAAQ,CAAC,QAAQ,GAAK,EAAE,OAAO,EAAE,IAAI,EAAE,CAAE,EAAE,CAAC,EAAE,IAAI,EAAE,SAAS,EAAE,GAAG,EAAE,CAAC,SAAS,EAAE,SAAS,EAAE,KAAK,CAAC,CAAC;SACjL;IACF,CAAC,CAAC,CAAC;IAEH,2BAAgB,CAAC,eAAe,CAAC,iCAAiC,EAAE,CAAC,QAAQ,EAAE,IAAI,EAK/E,EAAE;QACL,MAAM,eAAe,GAAG,QAAQ,CAAC,GAAG,CAAmB,kCAAgB,CAAC,CAAC;QACzE,MAAM,gBAAgB,GAAG,eAAe,CAAC,+BAA+B,EAAE,CAAC;QAC3E,OAAO,gBAAgB,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE;YACtC,MAAM,gBAAgB,GAAG,QAAQ,CAAC,SAAS,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE;gBAC1D,IAAI,OAAO,QAAQ,KAAK,QAAQ,EAAE;oBACjC,OAAO,QAAQ,CAAC;iBAChB;gBAED,IAAI,IAAI,CAAC,iBAAiB,CAAC,QAAQ,CAAC,EAAE;oBACrC,OAAO,QAAQ,CAAC;iBAChB;gBAED,IAAI,CAAA,GAAA,yCAAwB,CAAA,CAAC,QAAQ,CAAC,EAAE;oBACvC,OAAO;wBACN,OAAO,EAAE,QAAQ,CAAC,OAAO;wBACzB,OAAO,EAAE,QAAQ,CAAC,OAAO;qBACzB,CAAC;iBACF;gBAED,OAAO,IAAI,CAAC;YACb,CAAC,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,EAAE,CAAC,OAAO,KAAK,IAAI,CAA+H,CAAC;YAErK,OAAO;gBACN,QAAQ,EAAE,QAAQ,CAAC,EAAE;gBACrB,WAAW,EAAE,QAAQ,CAAC,WAAW;gBACjC,eAAe,EAAE,gBAAgB;gBACjC,OAAO,EAAE;oBACR,qBAAqB,EAAE,QAAQ,CAAC,OAAO,CAAC,qBAAqB;oBAC7D,yBAAyB,EAAE,QAAQ,CAAC,OAAO,CAAC,yBAAyB;oBACrE,gBAAgB,EAAE,QAAQ,CAAC,OAAO,CAAC,gBAAgB;iBACnD;aACD,CAAC;QACH,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC,CAAC;IAEH,2BAAgB,CAAC,eAAe,CAAC,yBAAyB,EAAE,KAAK,EAAE,QAAQ,EAAE,IAG5E,EAOI,EAAE;QACN,MAAM,qBAAqB,GAAG,QAAQ,CAAC,GAAG,CAAC,8CAAsB,CAAC,CAAC;QACnE,MAAM,GAAG,GAAG,SAAG,CAAC,MAAM,CAAC,IAAI,CAAC,GAAoB,CAAC,CAAC;QAClD,MAAM,OAAO,GAAG,qBAAqB,CAAC,iBAAiB,CAAC,EAAE,GAAG,EAAE,QAAQ,EAAE,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC;QAE1F,OAAO,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;YACnC,EAAE,EAAE,QAAQ,CAAC,EAAE;YACf,KAAK,EAAE,QAAQ,CAAC,KAAK;YACrB,WAAW,EAAE,QAAQ,CAAC,WAAW;YACjC,MAAM,EAAE,QAAQ,CAAC,MAAM;YACvB,WAAW,EAAE,KAAK;YAClB,QAAQ,EAAE,QAAQ,CAAC,WAAW;SAC9B,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC","file":"coreActions.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as glob from 'vs/base/common/glob';\nimport { KeyChord, KeyCode, KeyMod } from 'vs/base/common/keyCodes';\nimport { URI, UriComponents } from 'vs/base/common/uri';\nimport { EditorContextKeys } from 'vs/editor/common/editorContextKeys';\nimport { getIconClasses } from 'vs/editor/common/services/getIconClasses';\nimport { IModelService } from 'vs/editor/common/services/modelService';\nimport { IModeService } from 'vs/editor/common/services/modeService';\nimport { localize } from 'vs/nls';\nimport { Action2, IAction2Options, MenuId, MenuItemAction, MenuRegistry, registerAction2 } from 'vs/platform/actions/common/actions';\nimport { CommandsRegistry, ICommandService } from 'vs/platform/commands/common/commands';\nimport { ContextKeyExpr, IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { InputFocusedContext, InputFocusedContextKey } from 'vs/platform/contextkey/common/contextkeys';\nimport { ServicesAccessor } from 'vs/platform/instantiation/common/instantiation';\nimport { KeybindingWeight } from 'vs/platform/keybinding/common/keybindingsRegistry';\nimport { IQuickInputService, IQuickPickItem, QuickPickInput } from 'vs/platform/quickinput/common/quickInput';\nimport { BaseCellRenderTemplate, CellEditState, CellFocusMode, EXECUTE_CELL_COMMAND_ID, EXPAND_CELL_INPUT_COMMAND_ID, getNotebookEditorFromEditorPane, IActiveNotebookEditor, ICellViewModel, NOTEBOOK_CELL_EDITABLE, NOTEBOOK_CELL_HAS_OUTPUTS, NOTEBOOK_CELL_INPUT_COLLAPSED, NOTEBOOK_CELL_LIST_FOCUSED, NOTEBOOK_CELL_MARKDOWN_EDIT_MODE, NOTEBOOK_CELL_OUTPUT_COLLAPSED, NOTEBOOK_CELL_EXECUTION_STATE, NOTEBOOK_CELL_TYPE, NOTEBOOK_EDITOR_EDITABLE, NOTEBOOK_EDITOR_FOCUSED, NOTEBOOK_IS_ACTIVE_EDITOR, NOTEBOOK_KERNEL_COUNT, NOTEBOOK_INTERRUPTIBLE_KERNEL, NOTEBOOK_HAS_RUNNING_CELL, CHANGE_CELL_LANGUAGE, QUIT_EDIT_CELL_COMMAND_ID } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { CellEditType, CellKind, ICellEditOperation, isDocumentExcludePattern, NotebookCellMetadata, NotebookCellExecutionState, TransientCellMetadata, TransientDocumentMetadata, SelectionStateType, ICellReplaceEdit } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { ICellRange } from 'vs/workbench/contrib/notebook/common/notebookRange';\nimport { INotebookService } from 'vs/workbench/contrib/notebook/common/notebookService';\nimport { IEditorGroupsService } from 'vs/workbench/services/editor/common/editorGroupsService';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\nimport * as icons from 'vs/workbench/contrib/notebook/browser/notebookIcons';\nimport { NotebookEditorInput } from 'vs/workbench/contrib/notebook/common/notebookEditorInput';\nimport { EditorsOrder } from 'vs/workbench/common/editor';\nimport { INotebookEditorService } from 'vs/workbench/contrib/notebook/browser/notebookEditorService';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { WorkbenchActionExecutedClassification, WorkbenchActionExecutedEvent } from 'vs/base/common/actions';\nimport { NotebookViewModel } from 'vs/workbench/contrib/notebook/browser/viewModel/notebookViewModel';\nimport { INotebookKernelService } from 'vs/workbench/contrib/notebook/common/notebookKernelService';\nimport { Iterable } from 'vs/base/common/iterator';\n\n// Notebook Commands\nconst EXECUTE_NOTEBOOK_COMMAND_ID = 'notebook.execute';\nconst CANCEL_NOTEBOOK_COMMAND_ID = 'notebook.cancelExecution';\nconst CLEAR_ALL_CELLS_OUTPUTS_COMMAND_ID = 'notebook.clearAllCellsOutputs';\nconst RENDER_ALL_MARKDOWN_CELLS = 'notebook.renderAllMarkdownCells';\n\n// Cell Commands\nconst INSERT_CODE_CELL_ABOVE_COMMAND_ID = 'notebook.cell.insertCodeCellAbove';\nconst INSERT_CODE_CELL_BELOW_COMMAND_ID = 'notebook.cell.insertCodeCellBelow';\nconst INSERT_CODE_CELL_AT_TOP_COMMAND_ID = 'notebook.cell.insertCodeCellAtTop';\nconst INSERT_MARKDOWN_CELL_ABOVE_COMMAND_ID = 'notebook.cell.insertMarkdownCellAbove';\nconst INSERT_MARKDOWN_CELL_BELOW_COMMAND_ID = 'notebook.cell.insertMarkdownCellBelow';\nconst INSERT_MARKDOWN_CELL_AT_TOP_COMMAND_ID = 'notebook.cell.insertMarkdownCellAtTop';\nconst CHANGE_CELL_TO_CODE_COMMAND_ID = 'notebook.cell.changeToCode';\nconst CHANGE_CELL_TO_MARKDOWN_COMMAND_ID = 'notebook.cell.changeToMarkdown';\n\nconst EDIT_CELL_COMMAND_ID = 'notebook.cell.edit';\nconst DELETE_CELL_COMMAND_ID = 'notebook.cell.delete';\n\nconst CANCEL_CELL_COMMAND_ID = 'notebook.cell.cancelExecution';\nconst EXECUTE_CELL_SELECT_BELOW = 'notebook.cell.executeAndSelectBelow';\nconst EXECUTE_CELL_INSERT_BELOW = 'notebook.cell.executeAndInsertBelow';\nconst CLEAR_CELL_OUTPUTS_COMMAND_ID = 'notebook.cell.clearOutputs';\nconst CENTER_ACTIVE_CELL = 'notebook.centerActiveCell';\n\nconst COLLAPSE_CELL_INPUT_COMMAND_ID = 'notebook.cell.collapseCellInput';\nconst COLLAPSE_CELL_OUTPUT_COMMAND_ID = 'notebook.cell.collapseCellOutput';\nconst EXPAND_CELL_OUTPUT_COMMAND_ID = 'notebook.cell.expandCellOutput';\n\nexport const NOTEBOOK_ACTIONS_CATEGORY = { value: localize('notebookActions.category', \"Notebook\"), original: 'Notebook' };\n\nexport const CELL_TITLE_CELL_GROUP_ID = 'inline/cell';\nexport const CELL_TITLE_OUTPUT_GROUP_ID = 'inline/output';\n\nexport const NOTEBOOK_EDITOR_WIDGET_ACTION_WEIGHT = KeybindingWeight.EditorContrib; // smaller than Suggest Widget, etc\n\nexport const enum CellToolbarOrder {\n\tEditCell,\n\tSplitCell,\n\tSaveCell,\n\tClearCellOutput\n}\n\nexport const enum CellOverflowToolbarGroups {\n\tCopy = '1_copy',\n\tInsert = '2_insert',\n\tEdit = '3_edit',\n\tCollapse = '4_collapse',\n}\n\nexport interface INotebookActionContext {\n\treadonly cellTemplate?: BaseCellRenderTemplate;\n\treadonly cell?: ICellViewModel;\n\treadonly notebookEditor: IActiveNotebookEditor;\n\treadonly ui?: boolean;\n\treadonly selectedCells?: ICellViewModel[];\n}\n\nexport interface INotebookCellActionContext extends INotebookActionContext {\n\tcell: ICellViewModel;\n}\n\nfunction getContextFromActiveEditor(editorService: IEditorService): INotebookActionContext | undefined {\n\tconst editor = getNotebookEditorFromEditorPane(editorService.activeEditorPane);\n\tif (!editor || !editor.hasModel()) {\n\t\treturn;\n\t}\n\n\tconst activeCell = editor.getActiveCell();\n\tconst selectedCells = editor.getSelectionViewModels();\n\treturn {\n\t\tcell: activeCell,\n\t\tselectedCells,\n\t\tnotebookEditor: editor\n\t};\n}\n\nfunction getWidgetFromUri(accessor: ServicesAccessor, uri: URI) {\n\tconst editorService = accessor.get(IEditorService);\n\tconst notebookEditorService = accessor.get(INotebookEditorService);\n\tconst editorId = editorService.getEditors(EditorsOrder.SEQUENTIAL).find(editorId => editorId.editor instanceof NotebookEditorInput && editorId.editor.resource?.toString() === uri.toString());\n\tif (!editorId) {\n\t\treturn undefined;\n\t}\n\n\tconst notebookEditorInput = editorId.editor as NotebookEditorInput;\n\tif (!notebookEditorInput.resource) {\n\t\treturn undefined;\n\t}\n\n\tconst widget = notebookEditorService.listNotebookEditors().find(widget => widget.textModel?.viewType === notebookEditorInput.viewType && widget.textModel?.uri.toString() === notebookEditorInput.resource.toString());\n\n\tif (widget && widget.hasModel()) {\n\t\treturn widget;\n\t}\n\n\treturn undefined;\n}\n\nfunction getContextFromUri(accessor: ServicesAccessor, context?: any) {\n\tconst uri = URI.revive(context);\n\n\tif (uri) {\n\t\tconst widget = getWidgetFromUri(accessor, uri);\n\n\t\tif (widget) {\n\t\t\treturn {\n\t\t\t\tnotebookEditor: widget,\n\t\t\t};\n\t\t}\n\t}\n\n\treturn undefined;\n}\n\nexport abstract class NotebookAction extends Action2 {\n\tconstructor(desc: IAction2Options) {\n\t\tif (desc.f1 !== false) {\n\t\t\tdesc.f1 = false;\n\t\t\tconst f1Menu = {\n\t\t\t\tid: MenuId.CommandPalette,\n\t\t\t\twhen: NOTEBOOK_IS_ACTIVE_EDITOR\n\t\t\t};\n\n\t\t\tif (!desc.menu) {\n\t\t\t\tdesc.menu = [];\n\t\t\t} else if (!Array.isArray(desc.menu)) {\n\t\t\t\tdesc.menu = [desc.menu];\n\t\t\t}\n\n\t\t\tdesc.menu = [\n\t\t\t\t...desc.menu,\n\t\t\t\tf1Menu\n\t\t\t];\n\t\t}\n\n\t\tdesc.category = NOTEBOOK_ACTIONS_CATEGORY;\n\n\t\tsuper(desc);\n\t}\n\n\tasync run(accessor: ServicesAccessor, context?: any): Promise<void> {\n\t\tconst isFromUI = !!context;\n\t\tconst from = isFromUI ? (this.isNotebookActionContext(context) ? 'notebookToolbar' : 'editorToolbar') : undefined;\n\t\tif (!this.isNotebookActionContext(context)) {\n\t\t\tcontext = this.getEditorContextFromArgsOrActive(accessor, context);\n\t\t\tif (!context) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tif (from !== undefined) {\n\t\t\tconst telemetryService = accessor.get(ITelemetryService);\n\t\t\ttelemetryService.publicLog2<WorkbenchActionExecutedEvent, WorkbenchActionExecutedClassification>('workbenchActionExecuted', { id: this.desc.id, from: from });\n\t\t}\n\n\t\tthis.runWithContext(accessor, context);\n\t}\n\n\tabstract runWithContext(accessor: ServicesAccessor, context: INotebookActionContext): Promise<void>;\n\n\tprivate isNotebookActionContext(context?: unknown): context is INotebookActionContext {\n\t\treturn !!context && !!(context as INotebookActionContext).notebookEditor;\n\t}\n\n\tprotected getEditorContextFromArgsOrActive(accessor: ServicesAccessor, context?: any): INotebookActionContext | undefined {\n\t\treturn getContextFromActiveEditor(accessor.get(IEditorService));\n\t}\n}\n\nexport abstract class NotebookCellAction<T = INotebookCellActionContext> extends NotebookAction {\n\tprotected isCellActionContext(context?: unknown): context is INotebookCellActionContext {\n\t\treturn !!context && !!(context as INotebookCellActionContext).notebookEditor && !!(context as INotebookCellActionContext).cell;\n\t}\n\n\tprotected getCellContextFromArgs(accessor: ServicesAccessor, context?: T, ...additionalArgs: any[]): INotebookCellActionContext | undefined {\n\t\treturn undefined;\n\t}\n\n\toverride async run(accessor: ServicesAccessor, context?: INotebookCellActionContext, ...additionalArgs: any[]): Promise<void> {\n\t\tif (this.isCellActionContext(context)) {\n\t\t\tconst telemetryService = accessor.get(ITelemetryService);\n\t\t\ttelemetryService.publicLog2<WorkbenchActionExecutedEvent, WorkbenchActionExecutedClassification>('workbenchActionExecuted', { id: this.desc.id, from: 'cellToolbar' });\n\n\t\t\treturn this.runWithContext(accessor, context);\n\t\t}\n\n\t\tconst contextFromArgs = this.getCellContextFromArgs(accessor, context, ...additionalArgs);\n\n\t\tif (contextFromArgs) {\n\t\t\treturn this.runWithContext(accessor, contextFromArgs);\n\t\t}\n\n\t\tconst activeEditorContext = this.getEditorContextFromArgsOrActive(accessor);\n\t\tif (this.isCellActionContext(activeEditorContext)) {\n\t\t\treturn this.runWithContext(accessor, activeEditorContext);\n\t\t}\n\t}\n\n\tabstract override runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext): Promise<void>;\n}\n\nconst executeCellCondition = ContextKeyExpr.or(\n\tContextKeyExpr.and(\n\t\tContextKeyExpr.or(\n\t\t\tContextKeyExpr.equals(NOTEBOOK_CELL_EXECUTION_STATE.key, 'idle'),\n\t\t\tContextKeyExpr.equals(NOTEBOOK_CELL_EXECUTION_STATE.key, 'succeeded'),\n\t\t\tContextKeyExpr.equals(NOTEBOOK_CELL_EXECUTION_STATE.key, 'failed'),\n\t\t),\n\t\tContextKeyExpr.greater(NOTEBOOK_KERNEL_COUNT.key, 0)),\n\tNOTEBOOK_CELL_TYPE.isEqualTo('markdown'));\n\nconst executeNotebookCondition = ContextKeyExpr.greater(NOTEBOOK_KERNEL_COUNT.key, 0);\n\nregisterAction2(class ExecuteCell extends NotebookCellAction<ICellRange> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: EXECUTE_CELL_COMMAND_ID,\n\t\t\tprecondition: executeCellCondition,\n\t\t\ttitle: localize('notebookActions.execute', \"Execute Cell\"),\n\t\t\tkeybinding: {\n\t\t\t\twhen: NOTEBOOK_CELL_LIST_FOCUSED,\n\t\t\t\tprimary: KeyMod.WinCtrl | KeyCode.Enter,\n\t\t\t\twin: {\n\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyMod.Alt | KeyCode.Enter\n\t\t\t\t},\n\t\t\t\tweight: NOTEBOOK_EDITOR_WIDGET_ACTION_WEIGHT\n\t\t\t},\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.NotebookCellExecute,\n\t\t\t\twhen: executeCellCondition,\n\t\t\t\tgroup: 'inline'\n\t\t\t},\n\t\t\tdescription: {\n\t\t\t\tdescription: localize('notebookActions.execute', \"Execute Cell\"),\n\t\t\t\targs: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'range',\n\t\t\t\t\t\tdescription: 'The cell range',\n\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t'type': 'object',\n\t\t\t\t\t\t\t'required': ['start', 'end'],\n\t\t\t\t\t\t\t'properties': {\n\t\t\t\t\t\t\t\t'start': {\n\t\t\t\t\t\t\t\t\t'type': 'number'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'end': {\n\t\t\t\t\t\t\t\t\t'type': 'number'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'uri',\n\t\t\t\t\t\tdescription: 'The document uri',\n\t\t\t\t\t\tconstraint: URI\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ticon: icons.executeIcon\n\t\t});\n\t}\n\n\toverride getCellContextFromArgs(accessor: ServicesAccessor, context?: ICellRange, ...additionalArgs: any[]): INotebookCellActionContext | undefined {\n\t\tif (!context) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (typeof context.start !== 'number' || typeof context.end !== 'number' || context.start >= context.end) {\n\t\t\tthrow new Error(`The first argument '${context}' is not a valid CellRange`);\n\t\t}\n\n\t\tif (additionalArgs.length && additionalArgs[0]) {\n\t\t\tconst uri = URI.revive(additionalArgs[0]);\n\n\t\t\tif (!uri) {\n\t\t\t\tthrow new Error(`The second argument '${uri}' is not a valid Uri`);\n\t\t\t}\n\n\t\t\tconst widget = getWidgetFromUri(accessor, uri);\n\t\t\tif (widget) {\n\t\t\t\treturn {\n\t\t\t\t\tnotebookEditor: widget,\n\t\t\t\t\tcell: widget.viewModel.cellAt(context.start)!\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tthrow new Error(`There is no editor opened for resource ${uri}`);\n\t\t\t}\n\t\t}\n\n\t\tconst activeEditorContext = this.getEditorContextFromArgsOrActive(accessor);\n\n\t\tif (!activeEditorContext || !activeEditorContext.notebookEditor.viewModel || context.start >= activeEditorContext.notebookEditor.viewModel.length) {\n\t\t\treturn;\n\t\t}\n\n\t\t// TODO@rebornix, support multiple cells\n\t\treturn {\n\t\t\tnotebookEditor: activeEditorContext.notebookEditor,\n\t\t\tcell: activeEditorContext.notebookEditor.viewModel.cellAt(context.start)!\n\t\t};\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext): Promise<void> {\n\t\treturn runCell(accessor, context);\n\t}\n});\n\nconst cellCancelCondition = ContextKeyExpr.or(\n\tContextKeyExpr.equals(NOTEBOOK_CELL_EXECUTION_STATE.key, 'executing'),\n\tContextKeyExpr.equals(NOTEBOOK_CELL_EXECUTION_STATE.key, 'pending'),\n);\n\nregisterAction2(class CancelExecuteCell extends NotebookCellAction<ICellRange> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: CANCEL_CELL_COMMAND_ID,\n\t\t\tprecondition: cellCancelCondition,\n\t\t\ttitle: localize('notebookActions.cancel', \"Stop Cell Execution\"),\n\t\t\ticon: icons.stopIcon,\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.NotebookCellExecute,\n\t\t\t\twhen: cellCancelCondition,\n\t\t\t\tgroup: 'inline'\n\t\t\t},\n\t\t\tdescription: {\n\t\t\t\tdescription: localize('notebookActions.cancel', \"Stop Cell Execution\"),\n\t\t\t\targs: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'range',\n\t\t\t\t\t\tdescription: 'The cell range',\n\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t'type': 'object',\n\t\t\t\t\t\t\t'required': ['start', 'end'],\n\t\t\t\t\t\t\t'properties': {\n\t\t\t\t\t\t\t\t'start': {\n\t\t\t\t\t\t\t\t\t'type': 'number'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'end': {\n\t\t\t\t\t\t\t\t\t'type': 'number'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'uri',\n\t\t\t\t\t\tdescription: 'The document uri',\n\t\t\t\t\t\tconstraint: URI\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t});\n\t}\n\n\toverride getCellContextFromArgs(accessor: ServicesAccessor, context?: ICellRange, ...additionalArgs: any[]): INotebookCellActionContext | undefined {\n\t\tif (!context || typeof context.start !== 'number' || typeof context.end !== 'number' || context.start >= context.end) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (additionalArgs.length && additionalArgs[0]) {\n\t\t\tconst uri = URI.revive(additionalArgs[0]);\n\n\t\t\tif (uri) {\n\t\t\t\tconst widget = getWidgetFromUri(accessor, uri);\n\t\t\t\tif (widget) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tnotebookEditor: widget,\n\t\t\t\t\t\tcell: widget.viewModel.cellAt(context.start)!\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst activeEditorContext = this.getEditorContextFromArgsOrActive(accessor);\n\n\t\tif (!activeEditorContext || !activeEditorContext.notebookEditor.viewModel || context.start >= activeEditorContext.notebookEditor.viewModel.length) {\n\t\t\treturn;\n\t\t}\n\n\t\t// TODO@rebornix, support multiple cells\n\t\treturn {\n\t\t\tnotebookEditor: activeEditorContext.notebookEditor,\n\t\t\tcell: activeEditorContext.notebookEditor.viewModel.cellAt(context.start)!\n\t\t};\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext): Promise<void> {\n\t\treturn context.notebookEditor.cancelNotebookCells(Iterable.single(context.cell));\n\t}\n});\n\nexport class DeleteCellAction extends MenuItemAction {\n\tconstructor(\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@ICommandService commandService: ICommandService\n\t) {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: DELETE_CELL_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.deleteCell', \"Delete Cell\"),\n\t\t\t\ticon: icons.deleteCellIcon,\n\t\t\t\tprecondition: NOTEBOOK_EDITOR_EDITABLE.isEqualTo(true)\n\t\t\t},\n\t\t\tundefined,\n\t\t\t{ shouldForwardArgs: true },\n\t\t\tcontextKeyService,\n\t\t\tcommandService);\n\t}\n}\n\nregisterAction2(class ExecuteCellSelectBelow extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: EXECUTE_CELL_SELECT_BELOW,\n\t\t\tprecondition: executeCellCondition,\n\t\t\ttitle: localize('notebookActions.executeAndSelectBelow', \"Execute Notebook Cell and Select Below\"),\n\t\t\tkeybinding: {\n\t\t\t\twhen: NOTEBOOK_CELL_LIST_FOCUSED,\n\t\t\t\tprimary: KeyMod.Shift | KeyCode.Enter,\n\t\t\t\tweight: NOTEBOOK_EDITOR_WIDGET_ACTION_WEIGHT\n\t\t\t},\n\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext): Promise<void> {\n\t\tconst idx = context.notebookEditor.viewModel.getCellIndex(context.cell);\n\t\tif (typeof idx !== 'number') {\n\t\t\treturn;\n\t\t}\n\n\t\tconst executionP = runCell(accessor, context);\n\n\t\t// Try to select below, fall back on inserting\n\t\tconst nextCell = context.notebookEditor.viewModel.cellAt(idx + 1);\n\t\tif (nextCell) {\n\t\t\tcontext.notebookEditor.focusNotebookCell(nextCell, 'container');\n\t\t} else {\n\t\t\tconst newCell = context.notebookEditor.insertNotebookCell(context.cell, CellKind.Code, 'below');\n\t\t\tif (newCell) {\n\t\t\t\tcontext.notebookEditor.focusNotebookCell(newCell, 'editor');\n\t\t\t}\n\t\t}\n\n\t\treturn executionP;\n\t}\n});\n\nregisterAction2(class ExecuteCellInsertBelow extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: EXECUTE_CELL_INSERT_BELOW,\n\t\t\tprecondition: executeCellCondition,\n\t\t\ttitle: localize('notebookActions.executeAndInsertBelow', \"Execute Notebook Cell and Insert Below\"),\n\t\t\tkeybinding: {\n\t\t\t\twhen: NOTEBOOK_CELL_LIST_FOCUSED,\n\t\t\t\tprimary: KeyMod.Alt | KeyCode.Enter,\n\t\t\t\tweight: NOTEBOOK_EDITOR_WIDGET_ACTION_WEIGHT\n\t\t\t},\n\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext): Promise<void> {\n\t\tconst newFocusMode = context.cell.focusMode === CellFocusMode.Editor ? 'editor' : 'container';\n\n\t\tconst executionP = runCell(accessor, context);\n\t\tconst newCell = context.notebookEditor.insertNotebookCell(context.cell, CellKind.Code, 'below');\n\t\tif (newCell) {\n\t\t\tcontext.notebookEditor.focusNotebookCell(newCell, newFocusMode);\n\t\t}\n\n\t\treturn executionP;\n\t}\n});\n\nregisterAction2(class extends NotebookAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: RENDER_ALL_MARKDOWN_CELLS,\n\t\t\ttitle: localize('notebookActions.renderMarkdown', \"Render All Markdown Cells\"),\n\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookActionContext): Promise<void> {\n\t\trenderAllMarkdownCells(context);\n\t}\n});\n\nregisterAction2(class extends NotebookAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: EXECUTE_NOTEBOOK_COMMAND_ID,\n\t\t\ttitle: localize('notebookActions.executeNotebook', \"Execute Notebook (Run all cells)\"),\n\t\t\ticon: icons.executeAllIcon,\n\t\t\tdescription: {\n\t\t\t\tdescription: localize('notebookActions.executeNotebook', \"Execute Notebook (Run all cells)\"),\n\t\t\t\targs: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'uri',\n\t\t\t\t\t\tdescription: 'The document uri',\n\t\t\t\t\t\tconstraint: URI\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.EditorTitle,\n\t\t\t\torder: -1,\n\t\t\t\tgroup: 'navigation',\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_IS_ACTIVE_EDITOR, executeNotebookCondition, ContextKeyExpr.or(NOTEBOOK_INTERRUPTIBLE_KERNEL.toNegated(), NOTEBOOK_HAS_RUNNING_CELL.toNegated())),\n\t\t\t}\n\t\t});\n\t}\n\n\toverride getEditorContextFromArgsOrActive(accessor: ServicesAccessor, context?: UriComponents): INotebookActionContext | undefined {\n\t\treturn getContextFromUri(accessor, context) ?? getContextFromActiveEditor(accessor.get(IEditorService));\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookActionContext): Promise<void> {\n\t\trenderAllMarkdownCells(context);\n\n\t\tconst editorService = accessor.get(IEditorService);\n\t\tconst editor = editorService.getEditors(EditorsOrder.MOST_RECENTLY_ACTIVE).find(\n\t\t\teditor => editor.editor instanceof NotebookEditorInput && editor.editor.viewType === context.notebookEditor.viewModel.viewType && editor.editor.resource.toString() === context.notebookEditor.viewModel.uri.toString());\n\t\tconst editorGroupService = accessor.get(IEditorGroupsService);\n\n\t\tif (editor) {\n\t\t\tconst group = editorGroupService.getGroup(editor.groupId);\n\t\t\tgroup?.pinEditor(editor.editor);\n\t\t}\n\n\t\treturn context.notebookEditor.executeNotebookCells();\n\t}\n});\n\nfunction renderAllMarkdownCells(context: INotebookActionContext): void {\n\tcontext.notebookEditor.viewModel.viewCells.forEach(cell => {\n\t\tif (cell.cellKind === CellKind.Markdown) {\n\t\t\tcell.updateEditState(CellEditState.Preview, 'renderAllMarkdownCells');\n\t\t}\n\t});\n}\n\nregisterAction2(class CancelNotebook extends NotebookAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: CANCEL_NOTEBOOK_COMMAND_ID,\n\t\t\ttitle: localize('notebookActions.cancelNotebook', \"Stop Notebook Execution\"),\n\t\t\ticon: icons.stopIcon,\n\t\t\tdescription: {\n\t\t\t\tdescription: localize('notebookActions.cancelNotebook', \"Stop Notebook Execution\"),\n\t\t\t\targs: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'uri',\n\t\t\t\t\t\tdescription: 'The document uri',\n\t\t\t\t\t\tconstraint: URI\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.EditorTitle,\n\t\t\t\torder: -1,\n\t\t\t\tgroup: 'navigation',\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_IS_ACTIVE_EDITOR, NOTEBOOK_HAS_RUNNING_CELL, NOTEBOOK_INTERRUPTIBLE_KERNEL)\n\t\t\t}\n\t\t});\n\t}\n\n\toverride getEditorContextFromArgsOrActive(accessor: ServicesAccessor, context?: UriComponents): INotebookActionContext | undefined {\n\t\treturn getContextFromUri(accessor, context) ?? getContextFromActiveEditor(accessor.get(IEditorService));\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookActionContext): Promise<void> {\n\t\treturn context.notebookEditor.cancelNotebookCells();\n\t}\n});\n\nMenuRegistry.appendMenuItem(MenuId.NotebookCellTitle, {\n\tsubmenu: MenuId.NotebookCellInsert,\n\ttitle: localize('notebookMenu.insertCell', \"Insert Cell\"),\n\tgroup: CellOverflowToolbarGroups.Insert,\n\twhen: NOTEBOOK_EDITOR_EDITABLE.isEqualTo(true)\n});\n\nMenuRegistry.appendMenuItem(MenuId.EditorContext, {\n\tsubmenu: MenuId.NotebookCellTitle,\n\ttitle: localize('notebookMenu.cellTitle', \"Notebook Cell\"),\n\tgroup: CellOverflowToolbarGroups.Insert,\n\twhen: NOTEBOOK_EDITOR_FOCUSED\n});\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: CHANGE_CELL_TO_CODE_COMMAND_ID,\n\t\t\ttitle: localize('notebookActions.changeCellToCode', \"Change Cell to Code\"),\n\t\t\tkeybinding: {\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_EDITOR_FOCUSED, ContextKeyExpr.not(InputFocusedContextKey)),\n\t\t\t\tprimary: KeyCode.KEY_Y,\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t},\n\t\t\tprecondition: ContextKeyExpr.and(NOTEBOOK_IS_ACTIVE_EDITOR, NOTEBOOK_CELL_TYPE.isEqualTo('markdown')),\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_EDITOR_FOCUSED, NOTEBOOK_EDITOR_EDITABLE, NOTEBOOK_CELL_EDITABLE, NOTEBOOK_CELL_TYPE.isEqualTo('markdown')),\n\t\t\t\tgroup: CellOverflowToolbarGroups.Edit,\n\t\t\t}\n\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext): Promise<void> {\n\t\tawait changeCellToKind(CellKind.Code, context);\n\t}\n});\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: CHANGE_CELL_TO_MARKDOWN_COMMAND_ID,\n\t\t\ttitle: localize('notebookActions.changeCellToMarkdown', \"Change Cell to Markdown\"),\n\t\t\tkeybinding: {\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_EDITOR_FOCUSED, ContextKeyExpr.not(InputFocusedContextKey)),\n\t\t\t\tprimary: KeyCode.KEY_M,\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t},\n\t\t\tprecondition: ContextKeyExpr.and(NOTEBOOK_IS_ACTIVE_EDITOR, NOTEBOOK_CELL_TYPE.isEqualTo('code')),\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_EDITOR_FOCUSED, NOTEBOOK_EDITOR_EDITABLE, NOTEBOOK_CELL_EDITABLE, NOTEBOOK_CELL_TYPE.isEqualTo('code')),\n\t\t\t\tgroup: CellOverflowToolbarGroups.Edit,\n\t\t\t}\n\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext): Promise<void> {\n\t\tawait changeCellToKind(CellKind.Markdown, context);\n\t}\n});\n\nasync function runCell(accessor: ServicesAccessor, context: INotebookCellActionContext): Promise<void> {\n\tif (context.cell.metadata?.runState === NotebookCellExecutionState.Executing) {\n\t\treturn;\n\t}\n\n\tconst editorGroupService = accessor.get(IEditorGroupsService);\n\tconst group = editorGroupService.activeGroup;\n\n\tif (group) {\n\t\tif (group.activeEditor) {\n\t\t\tgroup.pinEditor(group.activeEditor);\n\t\t}\n\t}\n\n\tif (context.cell.cellKind === CellKind.Markdown) {\n\t\tcontext.notebookEditor.focusNotebookCell(context.cell, 'container');\n\t\treturn;\n\t} else {\n\t\treturn context.notebookEditor.executeNotebookCells(Iterable.single(context.cell));\n\t}\n}\n\nexport async function changeCellToKind(kind: CellKind, context: INotebookCellActionContext, language?: string): Promise<ICellViewModel | null> {\n\tconst { cell, notebookEditor } = context;\n\n\tif (cell.cellKind === kind) {\n\t\treturn null;\n\t}\n\n\tif (!notebookEditor.viewModel) {\n\t\treturn null;\n\t}\n\n\tif (notebookEditor.viewModel.options.isReadOnly) {\n\t\treturn null;\n\t}\n\n\tconst text = cell.getText();\n\tconst idx = notebookEditor.viewModel.getCellIndex(cell);\n\n\tif (language === undefined) {\n\t\tconst availableLanguages = notebookEditor.activeKernel?.supportedLanguages ?? [];\n\t\tlanguage = availableLanguages[0] ?? 'plaintext';\n\t}\n\n\tnotebookEditor.viewModel.notebookDocument.applyEdits([\n\t\t{\n\t\t\teditType: CellEditType.Replace,\n\t\t\tindex: idx,\n\t\t\tcount: 1,\n\t\t\tcells: [{\n\t\t\t\tcellKind: kind,\n\t\t\t\tsource: text,\n\t\t\t\tlanguage: language!,\n\t\t\t\toutputs: cell.model.outputs,\n\t\t\t\tmetadata: cell.metadata,\n\t\t\t}]\n\t\t}\n\t], true, undefined, () => undefined, undefined, true);\n\tconst newCell = notebookEditor.viewModel.cellAt(idx);\n\n\tif (!newCell) {\n\t\treturn null;\n\t}\n\n\tnotebookEditor.focusNotebookCell(newCell, cell.getEditState() === CellEditState.Editing ? 'editor' : 'container');\n\n\treturn newCell;\n}\n\nabstract class InsertCellCommand extends NotebookAction {\n\tconstructor(\n\t\tdesc: Readonly<IAction2Options>,\n\t\tprivate kind: CellKind,\n\t\tprivate direction: 'above' | 'below'\n\t) {\n\t\tsuper(desc);\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookActionContext): Promise<void> {\n\t\tcontext.notebookEditor.insertNotebookCell(context.cell, this.kind, this.direction, undefined, true);\n\t}\n}\n\nregisterAction2(class extends InsertCellCommand {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: INSERT_CODE_CELL_ABOVE_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.insertCodeCellAbove', \"Insert Code Cell Above\"),\n\t\t\t\tkeybinding: {\n\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.Enter,\n\t\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_CELL_LIST_FOCUSED, InputFocusedContext.toNegated()),\n\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t\t},\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.NotebookCellInsert,\n\t\t\t\t\torder: 0\n\t\t\t\t}\n\t\t\t},\n\t\t\tCellKind.Code,\n\t\t\t'above');\n\t}\n});\n\nregisterAction2(class extends InsertCellCommand {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: INSERT_CODE_CELL_BELOW_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.insertCodeCellBelow', \"Insert Code Cell Below\"),\n\t\t\t\tkeybinding: {\n\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.Enter,\n\t\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_CELL_LIST_FOCUSED, InputFocusedContext.toNegated()),\n\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t\t},\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.NotebookCellInsert,\n\t\t\t\t\torder: 1\n\t\t\t\t}\n\t\t\t},\n\t\t\tCellKind.Code,\n\t\t\t'below');\n\t}\n});\n\nregisterAction2(class extends NotebookAction {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: INSERT_CODE_CELL_AT_TOP_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.insertCodeCellAtTop', \"Add Code Cell At Top\"),\n\t\t\t\tf1: false\n\t\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor, context?: INotebookActionContext): Promise<void> {\n\t\tcontext = context ?? this.getEditorContextFromArgsOrActive(accessor);\n\t\tif (context) {\n\t\t\tthis.runWithContext(accessor, context);\n\t\t}\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookActionContext): Promise<void> {\n\t\tconst newCell = context.notebookEditor.insertNotebookCell(undefined, CellKind.Code, 'above', undefined, true);\n\t\tif (newCell) {\n\t\t\tcontext.notebookEditor.focusNotebookCell(newCell, 'editor');\n\t\t}\n\t}\n});\n\nregisterAction2(class extends NotebookAction {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: INSERT_MARKDOWN_CELL_AT_TOP_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.insertMarkdownCellAtTop', \"Add Markdown Cell At Top\"),\n\t\t\t\tf1: false\n\t\t\t});\n\t}\n\n\toverride async run(accessor: ServicesAccessor, context?: INotebookActionContext): Promise<void> {\n\t\tcontext = context ?? this.getEditorContextFromArgsOrActive(accessor);\n\t\tif (context) {\n\t\t\tthis.runWithContext(accessor, context);\n\t\t}\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookActionContext): Promise<void> {\n\t\tconst newCell = context.notebookEditor.insertNotebookCell(undefined, CellKind.Markdown, 'above', undefined, true);\n\t\tif (newCell) {\n\t\t\tcontext.notebookEditor.focusNotebookCell(newCell, 'editor');\n\t\t}\n\t}\n});\n\nMenuRegistry.appendMenuItem(MenuId.NotebookCellBetween, {\n\tcommand: {\n\t\tid: INSERT_CODE_CELL_BELOW_COMMAND_ID,\n\t\ttitle: localize('notebookActions.menu.insertCode', \"$(add) Code\"),\n\t\ttooltip: localize('notebookActions.menu.insertCode.tooltip', \"Add Code Cell\")\n\t},\n\torder: 0,\n\tgroup: 'inline',\n\twhen: NOTEBOOK_EDITOR_EDITABLE.isEqualTo(true)\n});\n\nMenuRegistry.appendMenuItem(MenuId.NotebookCellListTop, {\n\tcommand: {\n\t\tid: INSERT_CODE_CELL_AT_TOP_COMMAND_ID,\n\t\ttitle: localize('notebookActions.menu.insertCode', \"$(add) Code\"),\n\t\ttooltip: localize('notebookActions.menu.insertCode.tooltip', \"Add Code Cell\")\n\t},\n\torder: 0,\n\tgroup: 'inline',\n\twhen: NOTEBOOK_EDITOR_EDITABLE.isEqualTo(true)\n});\n\nregisterAction2(class extends InsertCellCommand {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: INSERT_MARKDOWN_CELL_ABOVE_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.insertMarkdownCellAbove', \"Insert Markdown Cell Above\"),\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.NotebookCellInsert,\n\t\t\t\t\torder: 2\n\t\t\t\t}\n\t\t\t},\n\t\t\tCellKind.Markdown,\n\t\t\t'above');\n\t}\n});\n\nregisterAction2(class extends InsertCellCommand {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: INSERT_MARKDOWN_CELL_BELOW_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.insertMarkdownCellBelow', \"Insert Markdown Cell Below\"),\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.NotebookCellInsert,\n\t\t\t\t\torder: 3\n\t\t\t\t}\n\t\t\t},\n\t\t\tCellKind.Markdown,\n\t\t\t'below');\n\t}\n});\n\nMenuRegistry.appendMenuItem(MenuId.NotebookCellBetween, {\n\tcommand: {\n\t\tid: INSERT_MARKDOWN_CELL_BELOW_COMMAND_ID,\n\t\ttitle: localize('notebookActions.menu.insertMarkdown', \"$(add) Markdown\"),\n\t\ttooltip: localize('notebookActions.menu.insertMarkdown.tooltip', \"Add Markdown Cell\")\n\t},\n\torder: 1,\n\tgroup: 'inline',\n\twhen: NOTEBOOK_EDITOR_EDITABLE.isEqualTo(true)\n});\n\nMenuRegistry.appendMenuItem(MenuId.NotebookCellListTop, {\n\tcommand: {\n\t\tid: INSERT_MARKDOWN_CELL_AT_TOP_COMMAND_ID,\n\t\ttitle: localize('notebookActions.menu.insertMarkdown', \"$(add) Markdown\"),\n\t\ttooltip: localize('notebookActions.menu.insertMarkdown.tooltip', \"Add Markdown Cell\")\n\t},\n\torder: 1,\n\tgroup: 'inline',\n\twhen: NOTEBOOK_EDITOR_EDITABLE.isEqualTo(true)\n});\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: EDIT_CELL_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.editCell', \"Edit Cell\"),\n\t\t\t\tkeybinding: {\n\t\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_CELL_LIST_FOCUSED, ContextKeyExpr.not(InputFocusedContextKey)),\n\t\t\t\t\tprimary: KeyCode.Enter,\n\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t\t},\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t\tNOTEBOOK_CELL_TYPE.isEqualTo('markdown'),\n\t\t\t\t\t\tNOTEBOOK_CELL_MARKDOWN_EDIT_MODE.toNegated(),\n\t\t\t\t\t\tNOTEBOOK_CELL_EDITABLE),\n\t\t\t\t\torder: CellToolbarOrder.EditCell,\n\t\t\t\t\tgroup: CELL_TITLE_CELL_GROUP_ID\n\t\t\t\t},\n\t\t\t\ticon: icons.editIcon,\n\t\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext): Promise<void> {\n\t\tcontext.notebookEditor.focusNotebookCell(context.cell, 'editor');\n\t}\n});\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: QUIT_EDIT_CELL_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.quitEdit', \"Stop Editing Cell\"),\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t\tNOTEBOOK_CELL_TYPE.isEqualTo('markdown'),\n\t\t\t\t\t\tNOTEBOOK_CELL_MARKDOWN_EDIT_MODE,\n\t\t\t\t\t\tNOTEBOOK_CELL_EDITABLE),\n\t\t\t\t\torder: CellToolbarOrder.SaveCell,\n\t\t\t\t\tgroup: CELL_TITLE_CELL_GROUP_ID\n\t\t\t\t},\n\t\t\t\ticon: icons.stopEditIcon,\n\t\t\t\tkeybinding: {\n\t\t\t\t\twhen: ContextKeyExpr.and(\n\t\t\t\t\t\tNOTEBOOK_EDITOR_FOCUSED,\n\t\t\t\t\t\tInputFocusedContext,\n\t\t\t\t\t\tEditorContextKeys.hoverVisible.toNegated(),\n\t\t\t\t\t\tEditorContextKeys.hasNonEmptySelection.toNegated(),\n\t\t\t\t\t\tEditorContextKeys.hasMultipleSelections.toNegated()\n\t\t\t\t\t),\n\t\t\t\t\tprimary: KeyCode.Escape,\n\t\t\t\t\tweight: NOTEBOOK_EDITOR_WIDGET_ACTION_WEIGHT - 5\n\t\t\t\t},\n\t\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext) {\n\t\tif (context.cell.cellKind === CellKind.Markdown) {\n\t\t\tcontext.cell.updateEditState(CellEditState.Preview, QUIT_EDIT_CELL_COMMAND_ID);\n\t\t}\n\n\t\treturn context.notebookEditor.focusNotebookCell(context.cell, 'container');\n\t}\n});\n\nexport function runDeleteAction(viewModel: NotebookViewModel, cell: ICellViewModel) {\n\tconst selections = viewModel.getSelections();\n\tconst targetCellIndex = viewModel.getCellIndex(cell);\n\tconst containingSelection = selections.find(selection => selection.start <= targetCellIndex && targetCellIndex < selection.end);\n\n\tif (containingSelection) {\n\t\tconst edits: ICellReplaceEdit[] = selections.reverse().map(selection => ({\n\t\t\teditType: CellEditType.Replace, index: selection.start, count: selection.end - selection.start, cells: []\n\t\t}));\n\n\t\tconst nextCellAfterContainingSelection = viewModel.cellAt(containingSelection.end);\n\n\t\tviewModel.notebookDocument.applyEdits(edits, true, { kind: SelectionStateType.Index, focus: viewModel.getFocus(), selections: viewModel.getSelections() }, () => {\n\t\t\tif (nextCellAfterContainingSelection) {\n\t\t\t\tconst cellIndex = viewModel.notebookDocument.cells.findIndex(cell => cell.handle === nextCellAfterContainingSelection.handle);\n\t\t\t\treturn { kind: SelectionStateType.Index, focus: { start: cellIndex, end: cellIndex + 1 }, selections: [{ start: cellIndex, end: cellIndex + 1 }] };\n\t\t\t} else {\n\t\t\t\tif (viewModel.notebookDocument.length) {\n\t\t\t\t\tconst lastCellIndex = viewModel.notebookDocument.length - 1;\n\t\t\t\t\treturn { kind: SelectionStateType.Index, focus: { start: lastCellIndex, end: lastCellIndex + 1 }, selections: [{ start: lastCellIndex, end: lastCellIndex + 1 }] };\n\n\t\t\t\t} else {\n\t\t\t\t\treturn { kind: SelectionStateType.Index, focus: { start: 0, end: 0 }, selections: [{ start: 0, end: 0 }] };\n\t\t\t\t}\n\t\t\t}\n\t\t}, undefined);\n\t} else {\n\t\tconst focus = viewModel.getFocus();\n\t\tconst edits: ICellReplaceEdit[] = [{\n\t\t\teditType: CellEditType.Replace, index: targetCellIndex, count: 1, cells: []\n\t\t}];\n\n\t\tlet finalSelections: ICellRange[] = [];\n\t\tfor (let i = 0; i < selections.length; i++) {\n\t\t\tconst selection = selections[i];\n\n\t\t\tif (selection.end <= targetCellIndex) {\n\t\t\t\tfinalSelections.push(selection);\n\t\t\t} else if (selection.start > targetCellIndex) {\n\t\t\t\tfinalSelections.push({ start: selection.start - 1, end: selection.end - 1 });\n\t\t\t} else {\n\t\t\t\tfinalSelections.push({ start: targetCellIndex, end: targetCellIndex + 1 });\n\t\t\t}\n\t\t}\n\n\t\tif (viewModel.cellAt(focus.start) === cell) {\n\t\t\t// focus is the target, focus is also not part of any selection\n\t\t\tconst newFocus = focus.end === viewModel.length ? { start: focus.start - 1, end: focus.end - 1 } : focus;\n\n\t\t\tviewModel.notebookDocument.applyEdits(edits, true, { kind: SelectionStateType.Index, focus: viewModel.getFocus(), selections: viewModel.getSelections() }, () => ({\n\t\t\t\tkind: SelectionStateType.Index, focus: newFocus, selections: finalSelections\n\t\t\t}), undefined);\n\t\t} else {\n\t\t\t// users decide to delete a cell out of current focus/selection\n\t\t\tconst newFocus = focus.start > targetCellIndex ? { start: focus.start - 1, end: focus.end - 1 } : focus;\n\n\t\t\tviewModel.notebookDocument.applyEdits(edits, true, { kind: SelectionStateType.Index, focus: viewModel.getFocus(), selections: viewModel.getSelections() }, () => ({\n\t\t\t\tkind: SelectionStateType.Index, focus: newFocus, selections: finalSelections\n\t\t\t}), undefined);\n\t\t}\n\t}\n}\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: DELETE_CELL_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.deleteCell', \"Delete Cell\"),\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\t\twhen: NOTEBOOK_EDITOR_EDITABLE\n\t\t\t\t},\n\t\t\t\tkeybinding: {\n\t\t\t\t\tprimary: KeyCode.Delete,\n\t\t\t\t\tmac: {\n\t\t\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.Backspace\n\t\t\t\t\t},\n\t\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_EDITOR_FOCUSED, NOTEBOOK_EDITOR_EDITABLE, ContextKeyExpr.not(InputFocusedContextKey)),\n\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t\t},\n\t\t\t\ticon: icons.deleteCellIcon\n\t\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext) {\n\t\tconst viewModel = context.notebookEditor.viewModel;\n\t\tif (!viewModel || viewModel.options.isReadOnly) {\n\t\t\treturn;\n\t\t}\n\n\t\trunDeleteAction(viewModel, context.cell);\n\t}\n});\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: CLEAR_CELL_OUTPUTS_COMMAND_ID,\n\t\t\ttitle: localize('clearCellOutputs', 'Clear Cell Outputs'),\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_CELL_TYPE.isEqualTo('code'), executeNotebookCondition, NOTEBOOK_CELL_HAS_OUTPUTS, NOTEBOOK_EDITOR_EDITABLE, NOTEBOOK_CELL_EDITABLE),\n\t\t\t\torder: CellToolbarOrder.ClearCellOutput,\n\t\t\t\tgroup: CELL_TITLE_OUTPUT_GROUP_ID\n\t\t\t},\n\t\t\tkeybinding: {\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_EDITOR_FOCUSED, ContextKeyExpr.not(InputFocusedContextKey), NOTEBOOK_CELL_HAS_OUTPUTS, NOTEBOOK_EDITOR_EDITABLE, NOTEBOOK_CELL_EDITABLE),\n\t\t\t\tprimary: KeyMod.Alt | KeyCode.Delete,\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t},\n\t\t\ticon: icons.clearIcon\n\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext): Promise<void> {\n\t\tconst editor = context.notebookEditor;\n\t\tif (!editor.viewModel || !editor.viewModel.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cell = context.cell;\n\t\tconst index = editor.viewModel.notebookDocument.cells.indexOf(cell.model);\n\n\t\tif (index < 0) {\n\t\t\treturn;\n\t\t}\n\n\t\teditor.viewModel.notebookDocument.applyEdits([{ editType: CellEditType.Output, index, outputs: [] }], true, undefined, () => undefined, undefined);\n\n\t\tif (context.cell.metadata && context.cell.metadata?.runState !== NotebookCellExecutionState.Executing) {\n\t\t\tcontext.notebookEditor.viewModel.notebookDocument.applyEdits([{\n\t\t\t\teditType: CellEditType.Metadata, index, metadata: {\n\t\t\t\t\t...context.cell.metadata,\n\t\t\t\t\trunState: NotebookCellExecutionState.Idle,\n\t\t\t\t\trunStartTime: undefined,\n\t\t\t\t\trunStartTimeAdjustment: undefined,\n\t\t\t\t\trunEndTime: undefined,\n\t\t\t\t\texecutionOrder: undefined,\n\t\t\t\t\tlastRunSuccess: undefined\n\t\t\t\t}\n\t\t\t}], true, undefined, () => undefined, undefined);\n\t\t}\n\t}\n});\n\ninterface ILanguagePickInput extends IQuickPickItem {\n\tlanguageId: string;\n\tdescription: string;\n}\n\n\ninterface IChangeCellContext extends INotebookCellActionContext {\n\t// TODO@rebornix : `cells`\n\t// range: ICellRange;\n\tlanguage?: string;\n}\n\nregisterAction2(class ChangeCellLanguageAction extends NotebookCellAction<ICellRange> {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: CHANGE_CELL_LANGUAGE,\n\t\t\ttitle: localize('changeLanguage', 'Change Cell Language'),\n\t\t\tdescription: {\n\t\t\t\tdescription: localize('changeLanguage', 'Change Cell Language'),\n\t\t\t\targs: [\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'range',\n\t\t\t\t\t\tdescription: 'The cell range',\n\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t'type': 'object',\n\t\t\t\t\t\t\t'required': ['start', 'end'],\n\t\t\t\t\t\t\t'properties': {\n\t\t\t\t\t\t\t\t'start': {\n\t\t\t\t\t\t\t\t\t'type': 'number'\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t'end': {\n\t\t\t\t\t\t\t\t\t'type': 'number'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tname: 'language',\n\t\t\t\t\t\tdescription: 'The target cell language',\n\t\t\t\t\t\tschema: {\n\t\t\t\t\t\t\t'type': 'string'\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected override getCellContextFromArgs(accessor: ServicesAccessor, context?: ICellRange, ...additionalArgs: any[]): IChangeCellContext | undefined {\n\t\tif (!context || typeof context.start !== 'number' || typeof context.end !== 'number' || context.start >= context.end) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst language = additionalArgs.length && typeof additionalArgs[0] === 'string' ? additionalArgs[0] : undefined;\n\t\tconst activeEditorContext = this.getEditorContextFromArgsOrActive(accessor);\n\n\t\tif (!activeEditorContext || !activeEditorContext.notebookEditor.viewModel || context.start >= activeEditorContext.notebookEditor.viewModel.length) {\n\t\t\treturn;\n\t\t}\n\n\t\t// TODO@rebornix, support multiple cells\n\t\treturn {\n\t\t\tnotebookEditor: activeEditorContext.notebookEditor,\n\t\t\tcell: activeEditorContext.notebookEditor.viewModel.cellAt(context.start)!,\n\t\t\tlanguage\n\t\t};\n\t}\n\n\n\tasync runWithContext(accessor: ServicesAccessor, context: IChangeCellContext): Promise<void> {\n\t\tif (context.language) {\n\t\t\tawait this.setLanguage(context, context.language);\n\t\t} else {\n\t\t\tawait this.showLanguagePicker(accessor, context);\n\t\t}\n\t}\n\n\tprivate async showLanguagePicker(accessor: ServicesAccessor, context: IChangeCellContext) {\n\t\tconst topItems: ILanguagePickInput[] = [];\n\t\tconst mainItems: ILanguagePickInput[] = [];\n\n\t\tconst modeService = accessor.get(IModeService);\n\t\tconst modelService = accessor.get(IModelService);\n\t\tconst quickInputService = accessor.get(IQuickInputService);\n\n\t\tconst providerLanguages = new Set([\n\t\t\t...(context.notebookEditor.activeKernel?.supportedLanguages ?? modeService.getRegisteredModes()),\n\t\t\t'markdown'\n\t\t]);\n\n\t\tproviderLanguages.forEach(languageId => {\n\t\t\tlet description: string;\n\t\t\tif (context.cell.cellKind === CellKind.Markdown ? (languageId === 'markdown') : (languageId === context.cell.language)) {\n\t\t\t\tdescription = localize('languageDescription', \"({0}) - Current Language\", languageId);\n\t\t\t} else {\n\t\t\t\tdescription = localize('languageDescriptionConfigured', \"({0})\", languageId);\n\t\t\t}\n\n\t\t\tconst languageName = modeService.getLanguageName(languageId);\n\t\t\tif (!languageName) {\n\t\t\t\t// Notebook has unrecognized language\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst item = <ILanguagePickInput>{\n\t\t\t\tlabel: languageName,\n\t\t\t\ticonClasses: getIconClasses(modelService, modeService, this.getFakeResource(languageName, modeService)),\n\t\t\t\tdescription,\n\t\t\t\tlanguageId\n\t\t\t};\n\n\t\t\tif (languageId === 'markdown' || languageId === context.cell.language) {\n\t\t\t\ttopItems.push(item);\n\t\t\t} else {\n\t\t\t\tmainItems.push(item);\n\t\t\t}\n\t\t});\n\n\t\tmainItems.sort((a, b) => {\n\t\t\treturn a.description.localeCompare(b.description);\n\t\t});\n\n\t\tconst picks: QuickPickInput[] = [\n\t\t\t...topItems,\n\t\t\t{ type: 'separator' },\n\t\t\t...mainItems\n\t\t];\n\n\t\tconst selection = await quickInputService.pick(picks, { placeHolder: localize('pickLanguageToConfigure', \"Select Language Mode\") }) as ILanguagePickInput | undefined;\n\t\tif (selection && selection.languageId) {\n\t\t\tawait this.setLanguage(context, selection.languageId);\n\t\t}\n\t}\n\n\tprivate async setLanguage(context: IChangeCellContext, languageId: string) {\n\t\tif (languageId === 'markdown' && context.cell?.language !== 'markdown') {\n\t\t\tconst newCell = await changeCellToKind(CellKind.Markdown, { cell: context.cell, notebookEditor: context.notebookEditor }, 'markdown');\n\t\t\tif (newCell) {\n\t\t\t\tcontext.notebookEditor.focusNotebookCell(newCell, 'editor');\n\t\t\t}\n\t\t} else if (languageId !== 'markdown' && context.cell?.cellKind === CellKind.Markdown) {\n\t\t\tawait changeCellToKind(CellKind.Code, { cell: context.cell, notebookEditor: context.notebookEditor }, languageId);\n\t\t} else {\n\t\t\tconst index = context.notebookEditor.viewModel.notebookDocument.cells.indexOf(context.cell.model);\n\t\t\tcontext.notebookEditor.viewModel.notebookDocument.applyEdits(\n\t\t\t\t[{ editType: CellEditType.CellLanguage, index, language: languageId }],\n\t\t\t\ttrue, undefined, () => undefined, undefined\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Copied from editorStatus.ts\n\t */\n\tprivate getFakeResource(lang: string, modeService: IModeService): URI | undefined {\n\t\tlet fakeResource: URI | undefined;\n\n\t\tconst extensions = modeService.getExtensions(lang);\n\t\tif (extensions?.length) {\n\t\t\tfakeResource = URI.file(extensions[0]);\n\t\t} else {\n\t\t\tconst filenames = modeService.getFilenames(lang);\n\t\t\tif (filenames?.length) {\n\t\t\t\tfakeResource = URI.file(filenames[0]);\n\t\t\t}\n\t\t}\n\n\t\treturn fakeResource;\n\t}\n});\n\nregisterAction2(class extends NotebookAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: CLEAR_ALL_CELLS_OUTPUTS_COMMAND_ID,\n\t\t\ttitle: localize('clearAllCellsOutputs', 'Clear All Cells Outputs'),\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.EditorTitle,\n\t\t\t\twhen: NOTEBOOK_IS_ACTIVE_EDITOR,\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: 0\n\t\t\t},\n\t\t\ticon: icons.clearIcon\n\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookActionContext): Promise<void> {\n\t\tconst editor = context.notebookEditor;\n\t\tif (!editor.viewModel || !editor.viewModel.length) {\n\t\t\treturn;\n\t\t}\n\n\t\teditor.viewModel.notebookDocument.applyEdits(\n\t\t\teditor.viewModel.notebookDocument.cells.map((cell, index) => ({\n\t\t\t\teditType: CellEditType.Output, index, outputs: []\n\t\t\t})), true, undefined, () => undefined, undefined);\n\n\t\tconst clearExecutionMetadataEdits = editor.viewModel.notebookDocument.cells.map((cell, index) => {\n\t\t\tif (cell.metadata && cell.metadata?.runState !== NotebookCellExecutionState.Executing) {\n\t\t\t\treturn {\n\t\t\t\t\teditType: CellEditType.Metadata, index, metadata: {\n\t\t\t\t\t\t...cell.metadata,\n\t\t\t\t\t\trunState: NotebookCellExecutionState.Idle,\n\t\t\t\t\t\trunStartTime: undefined,\n\t\t\t\t\t\trunStartTimeAdjustment: undefined,\n\t\t\t\t\t\trunEndTime: undefined,\n\t\t\t\t\t\texecutionOrder: undefined\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}).filter(edit => !!edit) as ICellEditOperation[];\n\t\tif (clearExecutionMetadataEdits.length) {\n\t\t\tcontext.notebookEditor.viewModel.notebookDocument.applyEdits(clearExecutionMetadataEdits, true, undefined, () => undefined, undefined);\n\t\t}\n\t}\n});\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: CENTER_ACTIVE_CELL,\n\t\t\ttitle: localize('notebookActions.centerActiveCell', \"Center Active Cell\"),\n\t\t\tkeybinding: {\n\t\t\t\twhen: NOTEBOOK_EDITOR_FOCUSED,\n\t\t\t\tprimary: KeyMod.CtrlCmd | KeyCode.KEY_L,\n\t\t\t\tmac: {\n\t\t\t\t\tprimary: KeyMod.WinCtrl | KeyCode.KEY_L,\n\t\t\t\t},\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t},\n\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext): Promise<void> {\n\t\treturn context.notebookEditor.revealInCenter(context.cell);\n\t}\n});\n\nabstract class ChangeNotebookCellMetadataAction extends NotebookCellAction {\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext): Promise<void> {\n\t\tconst textModel = context.notebookEditor.viewModel.notebookDocument;\n\t\tif (!textModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst metadataDelta = this.getMetadataDelta();\n\t\tconst edits: ICellEditOperation[] = [];\n\t\tconst targetCells = (context.cell ? [context.cell] : context.selectedCells) ?? [];\n\t\tfor (const cell of targetCells) {\n\t\t\tconst index = textModel.cells.indexOf(cell.model);\n\t\t\tif (index >= 0) {\n\t\t\t\tedits.push({ editType: CellEditType.Metadata, index, metadata: { ...context.cell.metadata, ...metadataDelta } });\n\t\t\t}\n\t\t}\n\n\t\ttextModel.applyEdits(edits, true, undefined, () => undefined, undefined);\n\t}\n\n\tabstract getMetadataDelta(): NotebookCellMetadata;\n}\n\nregisterAction2(class extends ChangeNotebookCellMetadataAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: COLLAPSE_CELL_INPUT_COMMAND_ID,\n\t\t\ttitle: localize('notebookActions.collapseCellInput', \"Collapse Cell Input\"),\n\t\t\tkeybinding: {\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_CELL_LIST_FOCUSED, NOTEBOOK_CELL_INPUT_COLLAPSED.toNegated(), InputFocusedContext.toNegated()),\n\t\t\t\tprimary: KeyChord(KeyMod.CtrlCmd | KeyCode.KEY_K, KeyMod.CtrlCmd | KeyCode.KEY_C),\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t},\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_CELL_INPUT_COLLAPSED.toNegated()),\n\t\t\t\tgroup: CellOverflowToolbarGroups.Collapse,\n\t\t\t}\n\t\t});\n\t}\n\n\tgetMetadataDelta(): NotebookCellMetadata {\n\t\treturn { inputCollapsed: true };\n\t}\n});\n\nregisterAction2(class extends ChangeNotebookCellMetadataAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: EXPAND_CELL_INPUT_COMMAND_ID,\n\t\t\ttitle: localize('notebookActions.expandCellInput', \"Expand Cell Input\"),\n\t\t\tkeybinding: {\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_CELL_LIST_FOCUSED, NOTEBOOK_CELL_INPUT_COLLAPSED),\n\t\t\t\tprimary: KeyChord(KeyMod.CtrlCmd | KeyCode.KEY_K, KeyMod.CtrlCmd | KeyCode.KEY_C),\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t},\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_CELL_INPUT_COLLAPSED),\n\t\t\t\tgroup: CellOverflowToolbarGroups.Collapse,\n\t\t\t}\n\t\t});\n\t}\n\n\tgetMetadataDelta(): NotebookCellMetadata {\n\t\treturn { inputCollapsed: false };\n\t}\n});\n\nregisterAction2(class extends ChangeNotebookCellMetadataAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: COLLAPSE_CELL_OUTPUT_COMMAND_ID,\n\t\t\ttitle: localize('notebookActions.collapseCellOutput', \"Collapse Cell Output\"),\n\t\t\tkeybinding: {\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_CELL_LIST_FOCUSED, NOTEBOOK_CELL_OUTPUT_COLLAPSED.toNegated(), InputFocusedContext.toNegated(), NOTEBOOK_CELL_HAS_OUTPUTS),\n\t\t\t\tprimary: KeyChord(KeyMod.CtrlCmd | KeyCode.KEY_K, KeyCode.KEY_T),\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t},\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_CELL_OUTPUT_COLLAPSED.toNegated(), NOTEBOOK_CELL_HAS_OUTPUTS),\n\t\t\t\tgroup: CellOverflowToolbarGroups.Collapse,\n\t\t\t}\n\t\t});\n\t}\n\n\tgetMetadataDelta(): NotebookCellMetadata {\n\t\treturn { outputCollapsed: true };\n\t}\n});\n\nregisterAction2(class extends ChangeNotebookCellMetadataAction {\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: EXPAND_CELL_OUTPUT_COMMAND_ID,\n\t\t\ttitle: localize('notebookActions.expandCellOutput', \"Expand Cell Output\"),\n\t\t\tkeybinding: {\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_CELL_LIST_FOCUSED, NOTEBOOK_CELL_OUTPUT_COLLAPSED),\n\t\t\t\tprimary: KeyChord(KeyMod.CtrlCmd | KeyCode.KEY_K, KeyCode.KEY_T),\n\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t},\n\t\t\tmenu: {\n\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_CELL_OUTPUT_COLLAPSED),\n\t\t\t\tgroup: CellOverflowToolbarGroups.Collapse,\n\t\t\t}\n\t\t});\n\t}\n\n\tgetMetadataDelta(): NotebookCellMetadata {\n\t\treturn { outputCollapsed: false };\n\t}\n});\n\n// Revisit once we have a story for trusted workspace\nCommandsRegistry.registerCommand('notebook.trust', (accessor, args) => {\n\tconst uri = URI.revive(args as UriComponents);\n\tconst notebookService = accessor.get<INotebookService>(INotebookService);\n\n\n\tconst document = notebookService.listNotebookDocuments().find(document => document.uri.toString() === uri.toString());\n\n\tif (document) {\n\t\tdocument.applyEdits([{ editType: CellEditType.DocumentMetadata, metadata: { ...document.metadata, ...{ trusted: true } } }], true, undefined, () => undefined, undefined, false);\n\t}\n});\n\nCommandsRegistry.registerCommand('_resolveNotebookContentProvider', (accessor, args): {\n\tviewType: string;\n\tdisplayName: string;\n\toptions: { transientOutputs: boolean; transientCellMetadata: TransientCellMetadata; transientDocumentMetadata: TransientDocumentMetadata; };\n\tfilenamePattern: (string | glob.IRelativePattern | { include: string | glob.IRelativePattern, exclude: string | glob.IRelativePattern; })[];\n}[] => {\n\tconst notebookService = accessor.get<INotebookService>(INotebookService);\n\tconst contentProviders = notebookService.getContributedNotebookProviders();\n\treturn contentProviders.map(provider => {\n\t\tconst filenamePatterns = provider.selectors.map(selector => {\n\t\t\tif (typeof selector === 'string') {\n\t\t\t\treturn selector;\n\t\t\t}\n\n\t\t\tif (glob.isRelativePattern(selector)) {\n\t\t\t\treturn selector;\n\t\t\t}\n\n\t\t\tif (isDocumentExcludePattern(selector)) {\n\t\t\t\treturn {\n\t\t\t\t\tinclude: selector.include,\n\t\t\t\t\texclude: selector.exclude\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn null;\n\t\t}).filter(pattern => pattern !== null) as (string | glob.IRelativePattern | { include: string | glob.IRelativePattern, exclude: string | glob.IRelativePattern; })[];\n\n\t\treturn {\n\t\t\tviewType: provider.id,\n\t\t\tdisplayName: provider.displayName,\n\t\t\tfilenamePattern: filenamePatterns,\n\t\t\toptions: {\n\t\t\t\ttransientCellMetadata: provider.options.transientCellMetadata,\n\t\t\t\ttransientDocumentMetadata: provider.options.transientDocumentMetadata,\n\t\t\t\ttransientOutputs: provider.options.transientOutputs\n\t\t\t}\n\t\t};\n\t});\n});\n\nCommandsRegistry.registerCommand('_resolveNotebookKernels', async (accessor, args: {\n\tviewType: string;\n\turi: UriComponents;\n}): Promise<{\n\tid?: string;\n\tlabel: string;\n\tdescription?: string;\n\tdetail?: string;\n\tisPreferred?: boolean;\n\tpreloads?: URI[];\n}[]> => {\n\tconst notebookKernelService = accessor.get(INotebookKernelService);\n\tconst uri = URI.revive(args.uri as UriComponents);\n\tconst kernels = notebookKernelService.getMatchingKernel({ uri, viewType: args.viewType });\n\n\treturn kernels.all.map(provider => ({\n\t\tid: provider.id,\n\t\tlabel: provider.label,\n\t\tdescription: provider.description,\n\t\tdetail: provider.detail,\n\t\tisPreferred: false, // todo@jrieken,@rebornix\n\t\tpreloads: provider.preloadUris,\n\t}));\n});\n"]}