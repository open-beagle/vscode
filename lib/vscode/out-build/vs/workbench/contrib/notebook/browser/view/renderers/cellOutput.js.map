{"version":3,"sources":["vs/workbench/contrib/notebook/browser/view/renderers/cellOutput.ts"],"names":[],"mappings":"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","file":"cellOutput.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as DOM from 'vs/base/browser/dom';\nimport * as nls from 'vs/nls';\nimport { StandardKeyboardEvent } from 'vs/base/browser/keyboardEvent';\nimport { KeyCode } from 'vs/base/common/keyCodes';\nimport { Disposable, DisposableStore } from 'vs/base/common/lifecycle';\nimport { IQuickPickItem, IQuickInputService } from 'vs/platform/quickinput/common/quickInput';\nimport { CodeCellRenderTemplate, ICellOutputViewModel, IInsetRenderOutput, INotebookEditor, IRenderOutput, RenderOutputType } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { getResizesObserver } from 'vs/workbench/contrib/notebook/browser/view/renderers/cellWidgets';\nimport { CodeCellViewModel } from 'vs/workbench/contrib/notebook/browser/viewModel/codeCellViewModel';\nimport { BUILTIN_RENDERER_ID, CellUri, NotebookCellOutputsSplice, IOrderedMimeType, mimeTypeIsAlwaysSecure, INotebookKernel } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { INotebookService } from 'vs/workbench/contrib/notebook/common/notebookService';\nimport { IMarkdownString } from 'vs/base/common/htmlContent';\nimport { renderMarkdown } from 'vs/base/browser/markdownRenderer';\nimport { IOpenerService } from 'vs/platform/opener/common/opener';\nimport { ITextFileService } from 'vs/workbench/services/textfile/common/textfiles';\nimport { format } from 'vs/base/common/jsonFormatter';\nimport { applyEdits } from 'vs/base/common/jsonEdit';\nimport { ThemeIcon } from 'vs/platform/theme/common/themeService';\nimport { mimetypeIcon } from 'vs/workbench/contrib/notebook/browser/notebookIcons';\nimport { NotebookTextModel } from 'vs/workbench/contrib/notebook/common/model/notebookTextModel';\n\nconst OUTPUT_COUNT_LIMIT = 500;\n\ninterface IMimeTypeRenderer extends IQuickPickItem {\n\tindex: number;\n}\n\ninterface IRenderResult {\n\tinitRenderIsSynchronous: boolean;\n}\n\nexport class CellOutputElement extends Disposable {\n\treadonly localDisposableStore = new DisposableStore();\n\tdomNode!: HTMLElement;\n\trenderResult?: IRenderOutput;\n\n\tpublic useDedicatedDOM: boolean = true;\n\n\tget domOffsetHeight() {\n\t\tif (this.useDedicatedDOM) {\n\t\t\treturn this.domNode.offsetHeight;\n\t\t} else {\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tconstructor(\n\t\tprivate notebookEditor: INotebookEditor,\n\t\tprivate notebookService: INotebookService,\n\t\tprivate quickInputService: IQuickInputService,\n\t\tprivate viewCell: CodeCellViewModel,\n\t\tprivate outputContainer: HTMLElement,\n\t\treadonly output: ICellOutputViewModel\n\t) {\n\t\tsuper();\n\n\t\tthis._register(this.output.model.onDidChangeData(() => {\n\t\t\tthis.updateOutputRendering();\n\t\t}));\n\n\t\tthis._register(this.localDisposableStore);\n\t}\n\n\tdetach() {\n\t\tif (this.domNode) {\n\t\t\tthis.domNode.parentElement?.removeChild(this.domNode);\n\t\t}\n\t}\n\n\tupdateDOMTop(top: number) {\n\t\tif (this.useDedicatedDOM) {\n\t\t\tif (this.domNode) {\n\t\t\t\tthis.domNode.style.top = `${top}px`;\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateOutputRendering() {\n\t\tif (!this.domNode) {\n\t\t\treturn;\n\t\t}\n\n\t\t// user chooses another mimetype\n\t\tconst index = this.viewCell.outputsViewModels.indexOf(this.output);\n\t\tconst nextElement = this.domNode.nextElementSibling;\n\t\tthis.localDisposableStore.clear();\n\t\tconst element = this.domNode;\n\t\tif (element) {\n\t\t\telement.parentElement?.removeChild(element);\n\t\t\tthis.notebookEditor.removeInset(this.output);\n\t\t}\n\n\t\t// this.output.pickedMimeType = pick;\n\t\tthis.render(index, nextElement as HTMLElement);\n\t\tthis.relayoutCell();\n\t}\n\n\trender(index: number, beforeElement?: HTMLElement): IRenderResult | undefined {\n\t\tif (this.viewCell.metadata.outputCollapsed || !this.notebookEditor.hasModel()) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst notebookTextModel = this.notebookEditor.viewModel.notebookDocument;\n\n\t\tconst [mimeTypes, pick] = this.output.resolveMimeTypes(notebookTextModel, this.notebookEditor.activeKernel?.preloadProvides);\n\n\t\tif (!mimeTypes.find(mimeType => mimeType.isTrusted) || mimeTypes.length === 0) {\n\t\t\tthis.viewCell.updateOutputHeight(index, 0, 'CellOutputElement#noMimeType');\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst pickedMimeTypeRenderer = mimeTypes[pick];\n\t\t// Reuse output item div\n\t\tthis.useDedicatedDOM = !(!beforeElement && this.output.supportAppend() && this.previousDivSupportAppend(pickedMimeTypeRenderer.mimeType));\n\t\tthis.domNode = this.useDedicatedDOM ? DOM.$('.output-inner-container') : this.outputContainer.lastChild as HTMLElement;\n\t\tthis.domNode.setAttribute('output-mime-type', pickedMimeTypeRenderer.mimeType);\n\n\t\tif (mimeTypes.filter(mimeType => mimeType.isTrusted).length > 1) {\n\t\t\tthis.attachMimetypeSwitcher(this.domNode, notebookTextModel, this.notebookEditor.activeKernel, mimeTypes);\n\t\t}\n\n\t\tconst notebookUri = CellUri.parse(this.viewCell.uri)?.notebook;\n\n\t\tif (pickedMimeTypeRenderer.rendererId !== BUILTIN_RENDERER_ID) {\n\t\t\tconst renderer = this.notebookService.getRendererInfo(pickedMimeTypeRenderer.rendererId);\n\t\t\tthis.renderResult = renderer\n\t\t\t\t? { type: RenderOutputType.Extension, renderer, source: this.output, mimeType: pickedMimeTypeRenderer.mimeType }\n\t\t\t\t: this.notebookEditor.getOutputRenderer().render(this.output, this.domNode, pickedMimeTypeRenderer.mimeType, notebookUri);\n\t\t} else {\n\t\t\tthis.renderResult = this.notebookEditor.getOutputRenderer().render(this.output, this.domNode, pickedMimeTypeRenderer.mimeType, notebookUri);\n\t\t}\n\n\t\tthis.output.pickedMimeType = pick;\n\n\t\tif (!this.renderResult) {\n\t\t\tthis.viewCell.updateOutputHeight(index, 0, 'CellOutputElement#renderResultUndefined');\n\t\t\treturn undefined;\n\t\t}\n\n\t\tif (beforeElement) {\n\t\t\tthis.outputContainer.insertBefore(this.domNode, beforeElement);\n\t\t} else if (this.useDedicatedDOM) {\n\t\t\tthis.outputContainer.appendChild(this.domNode);\n\t\t}\n\n\t\tif (this.renderResult.type !== RenderOutputType.Mainframe) {\n\t\t\tthis.notebookEditor.createOutput(this.viewCell, this.renderResult, this.viewCell.getOutputOffset(index));\n\t\t\tthis.domNode.classList.add('background');\n\t\t} else {\n\t\t\tthis.domNode.classList.add('foreground', 'output-element');\n\t\t\tthis.domNode.style.position = 'absolute';\n\t\t}\n\n\t\tif (this.renderResult.type === RenderOutputType.Html || this.renderResult.type === RenderOutputType.Extension) {\n\t\t\t// the output is rendered in the webview, which has resize listener internally\n\t\t\t// no-op\n\t\t\treturn { initRenderIsSynchronous: false };\n\t\t}\n\n\t\tif (!this.useDedicatedDOM) {\n\t\t\t// we only support text streaming, which is sync.\n\t\t\treturn { initRenderIsSynchronous: true };\n\t\t}\n\n\t\t// let's use resize listener for them\n\t\tconst offsetHeight = this.renderResult?.initHeight !== undefined ? this.renderResult?.initHeight : Math.ceil(this.domNode.offsetHeight);\n\t\tconst dimension = {\n\t\t\twidth: this.viewCell.layoutInfo.editorWidth,\n\t\t\theight: offsetHeight\n\t\t};\n\t\tthis.bindResizeListener(dimension);\n\t\tthis.viewCell.updateOutputHeight(index, offsetHeight, 'CellOutputElement#renderResultInitHeight');\n\t\tconst top = this.viewCell.getOutputOffsetInContainer(index);\n\t\tthis.domNode.style.top = `${top}px`;\n\t\treturn { initRenderIsSynchronous: true };\n\t}\n\n\tprivate bindResizeListener(dimension: DOM.IDimension) {\n\t\tconst elementSizeObserver = getResizesObserver(this.domNode, dimension, () => {\n\t\t\tif (this.outputContainer && document.body.contains(this.outputContainer)) {\n\t\t\t\tconst height = this.domNode.offsetHeight;\n\n\t\t\t\tif (dimension.height === height) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst currIndex = this.viewCell.outputsViewModels.indexOf(this.output);\n\t\t\t\tif (currIndex < 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tdimension = {\n\t\t\t\t\twidth: this.viewCell.layoutInfo.editorWidth,\n\t\t\t\t\theight: height\n\t\t\t\t};\n\n\t\t\t\tthis._validateFinalOutputHeight(true);\n\t\t\t\tthis.viewCell.updateOutputHeight(currIndex, height, 'CellOutputElement#outputResize');\n\t\t\t\tthis.relayoutCell();\n\t\t\t}\n\t\t});\n\n\t\telementSizeObserver.startObserving();\n\t\tthis.localDisposableStore.add(elementSizeObserver);\n\t}\n\n\tprivate previousDivSupportAppend(mimeType: string) {\n\t\tconst lastChild = this.outputContainer.lastChild as HTMLElement | null;\n\n\t\tif (lastChild) {\n\t\t\treturn lastChild.getAttribute('output-mime-type') === mimeType;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprivate async attachMimetypeSwitcher(outputItemDiv: HTMLElement, notebookTextModel: NotebookTextModel, kernel: INotebookKernel | undefined, mimeTypes: readonly IOrderedMimeType[]) {\n\t\toutputItemDiv.style.position = 'relative';\n\t\tconst mimeTypePicker = DOM.$('.multi-mimetype-output');\n\t\tmimeTypePicker.classList.add(...ThemeIcon.asClassNameArray(mimetypeIcon));\n\t\tmimeTypePicker.tabIndex = 0;\n\t\tmimeTypePicker.title = nls.localize('mimeTypePicker', \"Choose a different output mimetype, available mimetypes: {0}\", mimeTypes.map(mimeType => mimeType.mimeType).join(', '));\n\t\toutputItemDiv.appendChild(mimeTypePicker);\n\t\tthis.localDisposableStore.add(DOM.addStandardDisposableListener(mimeTypePicker, 'mousedown', async e => {\n\t\t\tif (e.leftButton) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tawait this.pickActiveMimeTypeRenderer(notebookTextModel, kernel, this.output);\n\t\t\t}\n\t\t}));\n\n\t\tthis.localDisposableStore.add((DOM.addDisposableListener(mimeTypePicker, DOM.EventType.KEY_DOWN, async e => {\n\t\t\tconst event = new StandardKeyboardEvent(e);\n\t\t\tif ((event.equals(KeyCode.Enter) || event.equals(KeyCode.Space))) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tawait this.pickActiveMimeTypeRenderer(notebookTextModel, kernel, this.output);\n\t\t\t}\n\t\t})));\n\t}\n\n\tprivate async pickActiveMimeTypeRenderer(notebookTextModel: NotebookTextModel, kernel: INotebookKernel | undefined, viewModel: ICellOutputViewModel) {\n\t\tconst [mimeTypes, currIndex] = viewModel.resolveMimeTypes(notebookTextModel, kernel?.preloadProvides);\n\n\t\tlet items: IMimeTypeRenderer[] = [];\n\t\tmimeTypes.forEach((mimeType, index) => {\n\t\t\tif (mimeType.isTrusted) {\n\t\t\t\titems.push({\n\t\t\t\t\tlabel: mimeType.mimeType,\n\t\t\t\t\tid: mimeType.mimeType,\n\t\t\t\t\tindex: index,\n\t\t\t\t\tpicked: index === currIndex,\n\t\t\t\t\tdetail: this.generateRendererInfo(mimeType.rendererId),\n\t\t\t\t\tdescription: index === currIndex ? nls.localize('curruentActiveMimeType', \"Currently Active\") : undefined\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tconst picker = this.quickInputService.createQuickPick();\n\t\tpicker.items = items;\n\t\tpicker.activeItems = items.filter(item => !!item.picked);\n\t\tpicker.placeholder = items.length !== mimeTypes.length\n\t\t\t? nls.localize('promptChooseMimeTypeInSecure.placeHolder', \"Select mimetype to render for current output. Rich mimetypes are available only when the notebook is trusted\")\n\t\t\t: nls.localize('promptChooseMimeType.placeHolder', \"Select mimetype to render for current output\");\n\n\t\tconst pick = await new Promise<IMimeTypeRenderer | undefined>(resolve => {\n\t\t\tpicker.onDidAccept(() => {\n\t\t\t\tresolve(picker.selectedItems.length === 1 ? (picker.selectedItems[0] as IMimeTypeRenderer) : undefined);\n\t\t\t\tpicker.dispose();\n\t\t\t});\n\t\t\tpicker.show();\n\t\t});\n\n\t\tif (pick === undefined || pick.index === currIndex) {\n\t\t\treturn;\n\t\t}\n\n\t\t// user chooses another mimetype\n\t\tconst index = this.viewCell.outputsViewModels.indexOf(viewModel);\n\t\tconst nextElement = this.domNode.nextElementSibling;\n\t\tthis.localDisposableStore.clear();\n\t\tconst element = this.domNode;\n\t\tif (element) {\n\t\t\telement.parentElement?.removeChild(element);\n\t\t\tthis.notebookEditor.removeInset(viewModel);\n\t\t}\n\n\t\tviewModel.pickedMimeType = pick.index;\n\t\tthis.viewCell.updateOutputMinHeight(this.viewCell.layoutInfo.outputTotalHeight);\n\n\t\tconst { mimeType, rendererId } = mimeTypes[pick.index];\n\t\tthis.notebookService.updateMimePreferredRenderer(mimeType, rendererId);\n\t\tthis.render(index, nextElement as HTMLElement);\n\t\tthis._validateFinalOutputHeight(false);\n\t\tthis.relayoutCell();\n\t}\n\n\tprivate generateRendererInfo(renderId: string | undefined): string {\n\t\tif (renderId === undefined || renderId === BUILTIN_RENDERER_ID) {\n\t\t\treturn nls.localize('builtinRenderInfo', \"built-in\");\n\t\t}\n\n\t\tconst renderInfo = this.notebookService.getRendererInfo(renderId);\n\n\t\tif (renderInfo) {\n\t\t\tconst displayName = renderInfo.displayName !== '' ? renderInfo.displayName : renderInfo.id;\n\t\t\treturn `${displayName} (${renderInfo.extensionId.value})`;\n\t\t}\n\n\t\treturn nls.localize('builtinRenderInfo', \"built-in\");\n\t}\n\n\tprivate _outputHeightTimer: any = null;\n\n\tprivate _validateFinalOutputHeight(synchronous: boolean) {\n\t\tif (this._outputHeightTimer !== null) {\n\t\t\tclearTimeout(this._outputHeightTimer);\n\t\t}\n\n\t\tif (synchronous) {\n\t\t\tthis.viewCell.updateOutputMinHeight(0);\n\t\t\tthis.viewCell.layoutChange({ outputHeight: true }, 'CellOutputElement#_validateFinalOutputHeight_sync');\n\t\t} else {\n\t\t\tthis._outputHeightTimer = setTimeout(() => {\n\t\t\t\tthis.viewCell.updateOutputMinHeight(0);\n\t\t\t\tthis.viewCell.layoutChange({ outputHeight: true }, 'CellOutputElement#_validateFinalOutputHeight_async_1000');\n\t\t\t}, 1000);\n\t\t}\n\t}\n\n\tprivate relayoutCell() {\n\t\tthis.notebookEditor.layoutNotebookCell(this.viewCell, this.viewCell.layoutInfo.totalHeight);\n\t}\n\n\toverride dispose() {\n\t\tthis.viewCell.updateOutputMinHeight(0);\n\n\t\tif (this._outputHeightTimer) {\n\t\t\tclearTimeout(this._outputHeightTimer);\n\t\t}\n\n\t\tsuper.dispose();\n\t}\n}\n\nexport class CellOutputContainer extends Disposable {\n\tprivate outputEntries = new Map<ICellOutputViewModel, CellOutputElement>();\n\n\tconstructor(\n\t\tprivate notebookEditor: INotebookEditor,\n\t\tprivate viewCell: CodeCellViewModel,\n\t\tprivate templateData: CodeCellRenderTemplate,\n\t\t@INotebookService private readonly notebookService: INotebookService,\n\t\t@IQuickInputService private readonly quickInputService: IQuickInputService,\n\t\t@IOpenerService private readonly openerService: IOpenerService,\n\t\t@ITextFileService private readonly textFileService: ITextFileService,\n\t) {\n\t\tsuper();\n\n\t\tthis._register(viewCell.onDidChangeOutputs(splices => {\n\t\t\tthis._updateOutputs(splices);\n\t\t}));\n\n\t\tthis._register(viewCell.onDidChangeLayout(() => {\n\t\t\tthis.outputEntries.forEach((value, key) => {\n\t\t\t\tconst index = viewCell.outputsViewModels.indexOf(key);\n\t\t\t\tif (index >= 0) {\n\t\t\t\t\tconst top = this.viewCell.getOutputOffsetInContainer(index);\n\t\t\t\t\tvalue.updateDOMTop(top);\n\t\t\t\t}\n\t\t\t});\n\t\t}));\n\t}\n\n\trender(editorHeight: number) {\n\t\tif (this.viewCell.outputsViewModels.length > 0) {\n\t\t\tif (this.viewCell.layoutInfo.totalHeight !== 0 && this.viewCell.layoutInfo.editorHeight > editorHeight) {\n\t\t\t\tthis.viewCell.updateOutputMinHeight(this.viewCell.layoutInfo.outputTotalHeight);\n\t\t\t\tthis._relayoutCell();\n\t\t\t}\n\n\t\t\tDOM.show(this.templateData.outputContainer);\n\t\t\tconst outputsToRender = this._calcuateOutputsToRender();\n\t\t\tfor (let index = 0; index < outputsToRender.length; index++) {\n\t\t\t\tconst currOutput = this.viewCell.outputsViewModels[index];\n\n\t\t\t\t// always add to the end\n\t\t\t\tthis._renderOutput(currOutput, index, undefined);\n\t\t\t}\n\n\t\t\tthis.viewCell.editorHeight = editorHeight;\n\t\t\tif (this.viewCell.outputsViewModels.length > OUTPUT_COUNT_LIMIT) {\n\t\t\t\tDOM.show(this.templateData.outputShowMoreContainer);\n\t\t\t\tthis.viewCell.updateOutputShowMoreContainerHeight(46);\n\t\t\t}\n\n\t\t\tthis._relayoutCell();\n\t\t\tthis._validateFinalOutputHeight(false);\n\t\t} else {\n\t\t\t// noop\n\t\t\tthis.viewCell.editorHeight = editorHeight;\n\t\t\tthis._relayoutCell();\n\t\t\tDOM.hide(this.templateData.outputContainer);\n\t\t}\n\n\t\tthis.templateData.outputShowMoreContainer.innerText = '';\n\t\tif (this.viewCell.outputsViewModels.length > OUTPUT_COUNT_LIMIT) {\n\t\t\tthis.templateData.outputShowMoreContainer.appendChild(this._generateShowMoreElement());\n\t\t} else {\n\t\t\tDOM.hide(this.templateData.outputShowMoreContainer);\n\t\t\tthis.viewCell.updateOutputShowMoreContainerHeight(0);\n\t\t}\n\t}\n\n\tviewUpdateShowOutputs(): void {\n\t\tfor (let index = 0; index < this.viewCell.outputsViewModels.length; index++) {\n\t\t\tconst currOutput = this.viewCell.outputsViewModels[index];\n\n\t\t\tconst renderedOutput = this.outputEntries.get(currOutput);\n\t\t\tif (renderedOutput && renderedOutput.renderResult) {\n\t\t\t\tif (renderedOutput.renderResult.type !== RenderOutputType.Mainframe) {\n\t\t\t\t\tthis.notebookEditor.createOutput(this.viewCell, renderedOutput.renderResult as IInsetRenderOutput, this.viewCell.getOutputOffset(index));\n\t\t\t\t} else {\n\t\t\t\t\tthis.viewCell.updateOutputHeight(index, renderedOutput.domOffsetHeight, 'CellOutputContainer#viewUpdateShowOutputs');\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Wasn't previously rendered, render it now\n\t\t\t\tthis._renderOutput(currOutput, index);\n\t\t\t}\n\t\t}\n\n\t\tthis._relayoutCell();\n\t}\n\n\tviewUpdateHideOuputs(): void {\n\t\tfor (const e of this.outputEntries.keys()) {\n\t\t\tthis.notebookEditor.hideInset(e);\n\t\t}\n\t}\n\n\tprivate _calcuateOutputsToRender(): ICellOutputViewModel[] {\n\t\tconst outputs = this.viewCell.outputsViewModels.slice(0, Math.min(OUTPUT_COUNT_LIMIT, this.viewCell.outputsViewModels.length));\n\t\tif (!this.notebookEditor.viewModel!.metadata.trusted) {\n\t\t\t// not trusted\n\t\t\tconst secureOutput = outputs.filter(output => {\n\t\t\t\tconst mimeTypes = output.model.outputs.map(op => op.mime);\n\t\t\t\treturn mimeTypes.some(mimeTypeIsAlwaysSecure);\n\t\t\t});\n\n\t\t\treturn secureOutput;\n\t\t}\n\n\t\treturn outputs;\n\t}\n\n\tprivate _outputHeightTimer: any = null;\n\n\tprivate _validateFinalOutputHeight(synchronous: boolean) {\n\t\tif (this._outputHeightTimer !== null) {\n\t\t\tclearTimeout(this._outputHeightTimer);\n\t\t}\n\n\t\tif (synchronous) {\n\t\t\tthis.viewCell.updateOutputMinHeight(0);\n\t\t\tthis.viewCell.layoutChange({ outputHeight: true }, 'CellOutputContainer#_validateFinalOutputHeight_sync');\n\t\t} else {\n\t\t\tthis._outputHeightTimer = setTimeout(() => {\n\t\t\t\tthis.viewCell.updateOutputMinHeight(0);\n\t\t\t\tthis.viewCell.layoutChange({ outputHeight: true }, 'CellOutputContainer#_validateFinalOutputHeight_async_1000');\n\t\t\t}, 1000);\n\t\t}\n\t}\n\n\tprivate _updateOutputs(splices: NotebookCellOutputsSplice[]) {\n\t\tif (!splices.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst previousOutputHeight = this.viewCell.layoutInfo.outputTotalHeight;\n\n\t\t// for cell output update, we make sure the cell does not shrink before the new outputs are rendered.\n\t\tthis.viewCell.updateOutputMinHeight(previousOutputHeight);\n\n\t\tif (this.viewCell.outputsViewModels.length) {\n\t\t\tDOM.show(this.templateData.outputContainer);\n\t\t} else {\n\t\t\tDOM.hide(this.templateData.outputContainer);\n\t\t}\n\n\t\tconst reversedSplices = splices.reverse();\n\n\t\treversedSplices.forEach(splice => {\n\t\t\tthis.viewCell.spliceOutputHeights(splice[0], splice[1], splice[2].map(_ => 0));\n\t\t});\n\n\t\tconst removedOutputs: ICellOutputViewModel[] = [];\n\n\t\tthis.outputEntries.forEach((value, key) => {\n\t\t\tif (this.viewCell.outputsViewModels.indexOf(key) < 0) {\n\t\t\t\tremovedOutputs.push(key);\n\t\t\t\t// remove element from DOM\n\t\t\t\tvalue.detach();\n\t\t\t\tthis.notebookEditor.removeInset(key);\n\t\t\t}\n\t\t});\n\n\t\tremovedOutputs.forEach(key => {\n\t\t\tthis.outputEntries.get(key)?.dispose();\n\t\t\tthis.outputEntries.delete(key);\n\t\t});\n\n\t\tlet prevElement: HTMLElement | undefined = undefined;\n\t\tconst outputsToRender = this._calcuateOutputsToRender();\n\n\t\tlet outputHasDynamicHeight = false;\n\t\toutputsToRender.reverse().forEach(output => {\n\t\t\tif (this.outputEntries.has(output)) {\n\t\t\t\t// already exist\n\t\t\t\tprevElement = this.outputEntries.get(output)!.domNode;\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// newly added element\n\t\t\tconst currIndex = this.viewCell.outputsViewModels.indexOf(output);\n\t\t\tconst renderResult = this._renderOutput(output, currIndex, prevElement);\n\t\t\tif (renderResult) {\n\t\t\t\toutputHasDynamicHeight = outputHasDynamicHeight || !renderResult.initRenderIsSynchronous;\n\t\t\t}\n\n\t\t\tprevElement = this.outputEntries.get(output)?.domNode;\n\t\t});\n\n\t\tif (this.viewCell.outputsViewModels.length > OUTPUT_COUNT_LIMIT) {\n\t\t\tDOM.show(this.templateData.outputShowMoreContainer);\n\t\t\tif (!this.templateData.outputShowMoreContainer.hasChildNodes()) {\n\t\t\t\tthis.templateData.outputShowMoreContainer.appendChild(this._generateShowMoreElement());\n\t\t\t}\n\t\t\tthis.viewCell.updateOutputShowMoreContainerHeight(46);\n\t\t} else {\n\t\t\tDOM.hide(this.templateData.outputShowMoreContainer);\n\t\t}\n\n\t\tconst editorHeight = this.templateData.editor.getContentHeight();\n\t\tthis.viewCell.editorHeight = editorHeight;\n\n\t\tthis._relayoutCell();\n\t\t// if it's clearing all outputs\n\t\t// or outputs are all rendered synchronously\n\t\t// shrink immediately as the final output height will be zero.\n\t\tthis._validateFinalOutputHeight(!outputHasDynamicHeight || this.viewCell.outputsViewModels.length === 0);\n\t}\n\n\tprivate _renderOutput(currOutput: ICellOutputViewModel, index: number, beforeElement?: HTMLElement) {\n\t\tif (!this.outputEntries.has(currOutput)) {\n\t\t\tthis.outputEntries.set(currOutput, new CellOutputElement(this.notebookEditor, this.notebookService, this.quickInputService, this.viewCell, this.templateData.outputContainer, currOutput));\n\t\t}\n\n\t\treturn this.outputEntries.get(currOutput)!.render(index, beforeElement);\n\t}\n\n\tprivate _generateShowMoreElement(): any {\n\t\tconst md: IMarkdownString = {\n\t\t\tvalue: `There are more than ${OUTPUT_COUNT_LIMIT} outputs, [show more (open the raw output data in a text editor) ...](command:workbench.action.openLargeOutput)`,\n\t\t\tisTrusted: true,\n\t\t\tsupportThemeIcons: true\n\t\t};\n\n\t\tconst element = renderMarkdown(md, {\n\t\t\tactionHandler: {\n\t\t\t\tcallback: (content) => {\n\t\t\t\t\tif (content === 'command:workbench.action.openLargeOutput') {\n\t\t\t\t\t\tconst content = JSON.stringify(this.viewCell.outputsViewModels.map(output => {\n\t\t\t\t\t\t\treturn output.toRawJSON();\n\t\t\t\t\t\t}));\n\t\t\t\t\t\tconst edits = format(content, undefined, {});\n\t\t\t\t\t\tconst metadataSource = applyEdits(content, edits);\n\n\t\t\t\t\t\treturn this.textFileService.untitled.resolve({\n\t\t\t\t\t\t\tassociatedResource: undefined,\n\t\t\t\t\t\t\tmode: 'json',\n\t\t\t\t\t\t\tinitialValue: metadataSource\n\t\t\t\t\t\t}).then(model => {\n\t\t\t\t\t\t\tconst resource = model.resource;\n\t\t\t\t\t\t\tthis.openerService.open(resource);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t},\n\t\t\t\tdisposeables: new DisposableStore()\n\t\t\t}\n\t\t});\n\n\t\telement.classList.add('output-show-more');\n\t\treturn element;\n\t}\n\n\tprivate _relayoutCell() {\n\t\tthis.notebookEditor.layoutNotebookCell(this.viewCell, this.viewCell.layoutInfo.totalHeight);\n\t}\n\n\toverride dispose() {\n\t\tthis.viewCell.updateOutputMinHeight(0);\n\n\t\tif (this._outputHeightTimer) {\n\t\t\tclearTimeout(this._outputHeightTimer);\n\t\t}\n\n\t\tthis.outputEntries.forEach((value) => {\n\t\t\tvalue.dispose();\n\t\t});\n\n\t\tsuper.dispose();\n\t}\n}\n"]}