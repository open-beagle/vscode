{"version":3,"sources":["vs/workbench/contrib/notebook/browser/notebookEditorWidget.ts"],"names":[],"mappings":"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","file":"notebookEditorWidget.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { getPixelRatio, getZoomLevel } from 'vs/base/browser/browser';\nimport * as DOM from 'vs/base/browser/dom';\nimport * as aria from 'vs/base/browser/ui/aria/aria';\nimport { IMouseWheelEvent, StandardMouseEvent } from 'vs/base/browser/mouseEvent';\nimport { IListContextMenuEvent } from 'vs/base/browser/ui/list/list';\nimport { IAction } from 'vs/base/common/actions';\nimport { SequencerByKey } from 'vs/base/common/async';\nimport { Color, RGBA } from 'vs/base/common/color';\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { combinedDisposable, Disposable, DisposableStore, dispose, IDisposable, toDisposable } from 'vs/base/common/lifecycle';\nimport { extname, isEqual } from 'vs/base/common/resources';\nimport { URI } from 'vs/base/common/uri';\nimport { generateUuid } from 'vs/base/common/uuid';\nimport 'vs/css!./media/notebook';\nimport { ICodeEditor } from 'vs/editor/browser/editorBrowser';\nimport { IEditorOptions } from 'vs/editor/common/config/editorOptions';\nimport { BareFontInfo, FontInfo } from 'vs/editor/common/config/fontInfo';\nimport { Range } from 'vs/editor/common/core/range';\nimport { IEditor } from 'vs/editor/common/editorCommon';\nimport { IModeService } from 'vs/editor/common/services/modeService';\nimport * as nls from 'vs/nls';\nimport { createActionViewItem, createAndFillInContextMenuActions } from 'vs/platform/actions/browser/menuEntryActionViewItem';\nimport { IMenu, IMenuService, MenuId, MenuItemAction, MenuRegistry, SubmenuItemAction } from 'vs/platform/actions/common/actions';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IContextKey, IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IContextMenuService } from 'vs/platform/contextview/browser/contextView';\nimport { IInstantiationService, optional } from 'vs/platform/instantiation/common/instantiation';\nimport { ServiceCollection } from 'vs/platform/instantiation/common/serviceCollection';\nimport { ILayoutService } from 'vs/platform/layout/browser/layoutService';\nimport { IStorageService, StorageScope, StorageTarget } from 'vs/platform/storage/common/storage';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { contrastBorder, diffInserted, diffRemoved, editorBackground, errorForeground, focusBorder, foreground, listInactiveSelectionBackground, registerColor, scrollbarSliderActiveBackground, scrollbarSliderBackground, scrollbarSliderHoverBackground, textBlockQuoteBackground, textBlockQuoteBorder, textLinkActiveForeground, textLinkForeground, textPreformatForeground, transparent } from 'vs/platform/theme/common/colorRegistry';\nimport { IThemeService, registerThemingParticipant } from 'vs/platform/theme/common/themeService';\nimport { EditorMemento } from 'vs/workbench/browser/parts/editor/editorPane';\nimport { IEditorMemento } from 'vs/workbench/common/editor';\nimport { Memento, MementoObject } from 'vs/workbench/common/memento';\nimport { PANEL_BORDER } from 'vs/workbench/common/theme';\nimport { debugIconStartForeground } from 'vs/workbench/contrib/debug/browser/debugColors';\nimport { BOTTOM_CELL_TOOLBAR_GAP, BOTTOM_CELL_TOOLBAR_HEIGHT, CELL_BOTTOM_MARGIN, CELL_OUTPUT_PADDING, CELL_RIGHT_MARGIN, CELL_RUN_GUTTER, CELL_TOP_MARGIN, CODE_CELL_LEFT_MARGIN, COLLAPSED_INDICATOR_HEIGHT, MARKDOWN_CELL_BOTTOM_MARGIN, MARKDOWN_CELL_TOP_MARGIN, MARKDOWN_PREVIEW_PADDING, SCROLLABLE_ELEMENT_PADDING_TOP } from 'vs/workbench/contrib/notebook/browser/constants';\nimport { CellEditState, CellFocusMode, IActiveNotebookEditor, ICellOutputViewModel, ICellViewModel, ICommonCellInfo, IDisplayOutputLayoutUpdateRequest, IFocusNotebookCellOptions, IGenericCellViewModel, IInsetRenderOutput, INotebookCellList, INotebookCellOutputLayoutInfo, INotebookDeltaDecoration, INotebookEditor, INotebookEditorContribution, INotebookEditorContributionDescription, INotebookEditorCreationOptions, INotebookEditorMouseEvent, NotebookEditorOptions, NotebookLayoutInfo, NOTEBOOK_EDITOR_EDITABLE, NOTEBOOK_EDITOR_FOCUSED, NOTEBOOK_EDITOR_ID, NOTEBOOK_OUTPUT_FOCUSED } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { NotebookDecorationCSSRules, NotebookRefCountedStyleSheet } from 'vs/workbench/contrib/notebook/browser/notebookEditorDecorations';\nimport { NotebookEditorExtensionsRegistry } from 'vs/workbench/contrib/notebook/browser/notebookEditorExtensions';\nimport { NotebookEditorKernelManager } from 'vs/workbench/contrib/notebook/browser/notebookEditorKernelManager';\nimport { INotebookEditorService } from 'vs/workbench/contrib/notebook/browser/notebookEditorService';\nimport { NotebookCellList } from 'vs/workbench/contrib/notebook/browser/view/notebookCellList';\nimport { OutputRenderer } from 'vs/workbench/contrib/notebook/browser/view/output/outputRenderer';\nimport { BackLayerWebView, INotebookWebviewMessage } from 'vs/workbench/contrib/notebook/browser/view/renderers/backLayerWebView';\nimport { CellContextKeyManager } from 'vs/workbench/contrib/notebook/browser/view/renderers/cellContextKeys';\nimport { CellDragAndDropController } from 'vs/workbench/contrib/notebook/browser/view/renderers/cellDnd';\nimport { CodeCellRenderer, ListTopCellToolbar, MarkdownCellRenderer, NotebookCellListDelegate } from 'vs/workbench/contrib/notebook/browser/view/renderers/cellRenderer';\nimport { CodeCellViewModel } from 'vs/workbench/contrib/notebook/browser/viewModel/codeCellViewModel';\nimport { NotebookEventDispatcher, NotebookLayoutChangedEvent } from 'vs/workbench/contrib/notebook/browser/viewModel/eventDispatcher';\nimport { MarkdownCellViewModel } from 'vs/workbench/contrib/notebook/browser/viewModel/markdownCellViewModel';\nimport { CellViewModel, IModelDecorationsChangeAccessor, INotebookEditorViewState, NotebookViewModel } from 'vs/workbench/contrib/notebook/browser/viewModel/notebookViewModel';\nimport { NotebookTextModel } from 'vs/workbench/contrib/notebook/common/model/notebookTextModel';\nimport { CellKind, CellToolbarLocKey, ExperimentalUseMarkdownRenderer, SelectionStateType, ShowCellStatusBarKey } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { ICellRange } from 'vs/workbench/contrib/notebook/common/notebookRange';\nimport { editorGutterModifiedBackground } from 'vs/workbench/contrib/scm/browser/dirtydiffDecorator';\nimport { Webview } from 'vs/workbench/contrib/webview/browser/webview';\nimport { IEditorGroupsService } from 'vs/workbench/services/editor/common/editorGroupsService';\nimport { IAccessibilityService } from 'vs/platform/accessibility/common/accessibility';\nimport { CellMenus } from 'vs/workbench/contrib/notebook/browser/view/renderers/cellMenus';\nimport { ToolBar } from 'vs/base/browser/ui/toolbar/toolbar';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { ITASExperimentService } from 'vs/workbench/services/experiment/common/experimentService';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\nimport { isWeb } from 'vs/base/common/platform';\nimport { mark } from 'vs/workbench/contrib/notebook/common/notebookPerformance';\nimport { readFontInfo } from 'vs/editor/browser/config/configuration';\nimport { INotebookKernelService } from 'vs/workbench/contrib/notebook/common/notebookKernelService';\nimport { NotebookEditorContextKeys } from 'vs/workbench/contrib/notebook/browser/notebookEditorWidgetContextKeys';\n\nconst $ = DOM.$;\n\nexport class ListViewInfoAccessor extends Disposable {\n\tconstructor(\n\t\treadonly list: INotebookCellList\n\t) {\n\t\tsuper();\n\t}\n\n\trevealCellRangeInView(range: ICellRange) {\n\t\treturn this.list.revealElementsInView(range);\n\t}\n\n\trevealInView(cell: ICellViewModel) {\n\t\tthis.list.revealElementInView(cell);\n\t}\n\n\trevealInViewAtTop(cell: ICellViewModel) {\n\t\tthis.list.revealElementInViewAtTop(cell);\n\t}\n\n\trevealInCenterIfOutsideViewport(cell: ICellViewModel) {\n\t\tthis.list.revealElementInCenterIfOutsideViewport(cell);\n\t}\n\n\tasync revealInCenterIfOutsideViewportAsync(cell: ICellViewModel) {\n\t\treturn this.list.revealElementInCenterIfOutsideViewportAsync(cell);\n\t}\n\n\trevealInCenter(cell: ICellViewModel) {\n\t\tthis.list.revealElementInCenter(cell);\n\t}\n\n\tasync revealLineInViewAsync(cell: ICellViewModel, line: number): Promise<void> {\n\t\treturn this.list.revealElementLineInViewAsync(cell, line);\n\t}\n\n\tasync revealLineInCenterAsync(cell: ICellViewModel, line: number): Promise<void> {\n\t\treturn this.list.revealElementLineInCenterAsync(cell, line);\n\t}\n\n\tasync revealLineInCenterIfOutsideViewportAsync(cell: ICellViewModel, line: number): Promise<void> {\n\t\treturn this.list.revealElementLineInCenterIfOutsideViewportAsync(cell, line);\n\t}\n\n\tasync revealRangeInViewAsync(cell: ICellViewModel, range: Range): Promise<void> {\n\t\treturn this.list.revealElementRangeInViewAsync(cell, range);\n\t}\n\n\tasync revealRangeInCenterAsync(cell: ICellViewModel, range: Range): Promise<void> {\n\t\treturn this.list.revealElementRangeInCenterAsync(cell, range);\n\t}\n\n\tasync revealRangeInCenterIfOutsideViewportAsync(cell: ICellViewModel, range: Range): Promise<void> {\n\t\treturn this.list.revealElementRangeInCenterIfOutsideViewportAsync(cell, range);\n\t}\n\n\tgetViewIndex(cell: ICellViewModel): number {\n\t\treturn this.list.getViewIndex(cell) ?? -1;\n\t}\n\n\tgetViewHeight(cell: ICellViewModel): number {\n\t\tif (!this.list.viewModel) {\n\t\t\treturn -1;\n\t\t}\n\n\t\treturn this.list.elementHeight(cell);\n\t}\n\n\tgetCellRangeFromViewRange(startIndex: number, endIndex: number): ICellRange | undefined {\n\t\tif (!this.list.viewModel) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst modelIndex = this.list.getModelIndex2(startIndex);\n\t\tif (modelIndex === undefined) {\n\t\t\tthrow new Error(`startIndex ${startIndex} out of boundary`);\n\t\t}\n\n\t\tif (endIndex >= this.list.length) {\n\t\t\t// it's the end\n\t\t\tconst endModelIndex = this.list.viewModel.length;\n\t\t\treturn { start: modelIndex, end: endModelIndex };\n\t\t} else {\n\t\t\tconst endModelIndex = this.list.getModelIndex2(endIndex);\n\t\t\tif (endModelIndex === undefined) {\n\t\t\t\tthrow new Error(`endIndex ${endIndex} out of boundary`);\n\t\t\t}\n\t\t\treturn { start: modelIndex, end: endModelIndex };\n\t\t}\n\t}\n\n\tgetCellsFromViewRange(startIndex: number, endIndex: number): ReadonlyArray<ICellViewModel> {\n\t\tif (!this.list.viewModel) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst range = this.getCellRangeFromViewRange(startIndex, endIndex);\n\t\tif (!range) {\n\t\t\treturn [];\n\t\t}\n\n\t\treturn this.list.viewModel.getCells(range);\n\t}\n\n\tsetCellEditorSelection(cell: ICellViewModel, range: Range): void {\n\t\tthis.list.setCellSelection(cell, range);\n\t}\n\n\tsetHiddenAreas(_ranges: ICellRange[]): boolean {\n\t\treturn this.list.setHiddenAreas(_ranges, true);\n\t}\n\n\tgetVisibleRangesPlusViewportAboveBelow(): ICellRange[] {\n\t\treturn this.list?.getVisibleRangesPlusViewportAboveBelow() ?? [];\n\t}\n\n\ttriggerScroll(event: IMouseWheelEvent) {\n\t\tthis.list.triggerScrollFromMouseWheelEvent(event);\n\t}\n}\n\nexport class NotebookEditorWidget extends Disposable implements INotebookEditor {\n\tprivate static readonly EDITOR_MEMENTOS = new Map<string, EditorMemento<unknown>>();\n\tprivate _overlayContainer!: HTMLElement;\n\tprivate _notebookTopToolbarContainer!: HTMLElement;\n\tprivate _body!: HTMLElement;\n\tprivate _overflowContainer!: HTMLElement;\n\tprivate _webview: BackLayerWebView<ICommonCellInfo> | null = null;\n\tprivate _webviewResolvePromise: Promise<BackLayerWebView<ICommonCellInfo> | null> | null = null;\n\tprivate _webviewTransparentCover: HTMLElement | null = null;\n\tprivate _list!: INotebookCellList;\n\tprivate _listViewInfoAccessor!: ListViewInfoAccessor;\n\tprivate _dndController: CellDragAndDropController | null = null;\n\tprivate _listTopCellToolbar: ListTopCellToolbar | null = null;\n\tprivate _renderedEditors: Map<ICellViewModel, ICodeEditor | undefined> = new Map();\n\tprivate _eventDispatcher: NotebookEventDispatcher | undefined;\n\tprivate _notebookViewModel: NotebookViewModel | undefined;\n\tprivate _localStore: DisposableStore = this._register(new DisposableStore());\n\tprivate _localCellStateListeners: DisposableStore[] = [];\n\tprivate _fontInfo: FontInfo | undefined;\n\tprivate _dimension: DOM.Dimension | null = null;\n\tprivate _shadowElementViewInfo: { height: number, width: number, top: number; left: number; } | null = null;\n\n\tprivate readonly _editorFocus: IContextKey<boolean>;\n\tprivate readonly _outputFocus: IContextKey<boolean>;\n\tprivate readonly _editorEditable: IContextKey<boolean>;\n\n\tprivate _outputRenderer: OutputRenderer;\n\tprotected readonly _contributions = new Map<string, INotebookEditorContribution>();\n\tprivate _scrollBeyondLastLine: boolean;\n\tprivate readonly _memento: Memento;\n\tprivate readonly _onDidFocusEmitter = this._register(new Emitter<void>());\n\tpublic readonly onDidFocus = this._onDidFocusEmitter.event;\n\tprivate readonly _onDidBlurEmitter = this._register(new Emitter<void>());\n\tpublic readonly onDidBlur = this._onDidBlurEmitter.event;\n\tprivate readonly _insetModifyQueueByOutputId = new SequencerByKey<string>();\n\tprivate _kernelManger: NotebookEditorKernelManager;\n\tprivate _cellContextKeyManager: CellContextKeyManager | null = null;\n\tprivate _isVisible = false;\n\tprivate readonly _uuid = generateUuid();\n\tprivate _webiewFocused: boolean = false;\n\n\tprivate _isDisposed: boolean = false;\n\n\tprivate useRenderer = false;\n\n\tget isDisposed() {\n\t\treturn this._isDisposed;\n\t}\n\n\tprivate readonly _onDidChangeModel = this._register(new Emitter<NotebookTextModel | undefined>());\n\treadonly onDidChangeModel: Event<NotebookTextModel | undefined> = this._onDidChangeModel.event;\n\n\tprivate readonly _onDidFocusEditorWidget = this._register(new Emitter<void>());\n\treadonly onDidFocusEditorWidget = this._onDidFocusEditorWidget.event;\n\n\tset viewModel(newModel: NotebookViewModel | undefined) {\n\t\tthis._notebookViewModel = newModel;\n\t\tthis._onDidChangeModel.fire(newModel?.notebookDocument);\n\t}\n\n\tget viewModel() {\n\t\treturn this._notebookViewModel;\n\t}\n\n\tget textModel() {\n\t\treturn this._notebookViewModel?.notebookDocument;\n\t}\n\n\tprivate readonly _onDidChangeActiveEditor = this._register(new Emitter<this>());\n\treadonly onDidChangeActiveEditor: Event<this> = this._onDidChangeActiveEditor.event;\n\n\tget activeCodeEditor(): IEditor | undefined {\n\t\tif (this._isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst [focused] = this._list.getFocusedElements();\n\t\treturn this._renderedEditors.get(focused);\n\t}\n\n\tprivate readonly _onDidScroll = this._register(new Emitter<void>());\n\treadonly onDidScroll: Event<void> = this._onDidScroll.event;\n\tprivate readonly _onDidChangeActiveCell = this._register(new Emitter<void>());\n\treadonly onDidChangeActiveCell: Event<void> = this._onDidChangeActiveCell.event;\n\tprivate _cursorNavigationMode: boolean = false;\n\tget cursorNavigationMode(): boolean {\n\t\treturn this._cursorNavigationMode;\n\t}\n\n\tset cursorNavigationMode(v: boolean) {\n\t\tthis._cursorNavigationMode = v;\n\t}\n\n\tprivate readonly _onDidChangeSelection = this._register(new Emitter<void>());\n\tget onDidChangeSelection(): Event<void> { return this._onDidChangeSelection.event; }\n\n\tprivate readonly _onDidChangeVisibleRanges = this._register(new Emitter<void>());\n\tonDidChangeVisibleRanges: Event<void> = this._onDidChangeVisibleRanges.event;\n\n\tget visibleRanges() {\n\t\treturn this._list.visibleRanges || [];\n\t}\n\n\treadonly isEmbedded: boolean;\n\n\tpublic readonly scopedContextKeyService: IContextKeyService;\n\tprivate readonly instantiationService: IInstantiationService;\n\n\tconstructor(\n\t\treadonly creationOptions: INotebookEditorCreationOptions,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IAccessibilityService accessibilityService: IAccessibilityService,\n\t\t@INotebookEditorService private readonly notebookEditorService: INotebookEditorService,\n\t\t@INotebookKernelService notebookKernelService: INotebookKernelService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@ILayoutService private readonly layoutService: ILayoutService,\n\t\t@IContextMenuService private readonly contextMenuService: IContextMenuService,\n\t\t@IMenuService private readonly menuService: IMenuService,\n\t\t@IThemeService private readonly themeService: IThemeService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@IModeService private readonly modeService: IModeService,\n\t\t@IKeybindingService private readonly keybindingService: IKeybindingService,\n\t\t@optional(ITASExperimentService) private readonly experimentService: ITASExperimentService\n\t) {\n\t\tsuper();\n\t\tthis.isEmbedded = creationOptions.isEmbedded || false;\n\n\t\tthis.useRenderer = !isWeb && !!this.configurationService.getValue<boolean>(ExperimentalUseMarkdownRenderer) && !accessibilityService.isScreenReaderOptimized();\n\n\t\tthis._overlayContainer = document.createElement('div');\n\t\tthis.scopedContextKeyService = contextKeyService.createScoped(this._overlayContainer);\n\t\tthis.instantiationService = instantiationService.createChild(new ServiceCollection([IContextKeyService, this.scopedContextKeyService]));\n\n\t\tthis._register(this.instantiationService.createInstance(NotebookEditorContextKeys, this));\n\n\t\tthis._kernelManger = this.instantiationService.createInstance(NotebookEditorKernelManager);\n\t\tthis._register(notebookKernelService.onDidChangeNotebookKernelBinding(e => {\n\t\t\tif (isEqual(e.notebook, this.viewModel?.uri)) {\n\t\t\t\tthis._loadKernelPreloads();\n\t\t\t}\n\t\t}));\n\n\t\tthis._memento = new Memento(NOTEBOOK_EDITOR_ID, storageService);\n\n\t\tthis._outputRenderer = new OutputRenderer(this, this.instantiationService);\n\t\tthis._scrollBeyondLastLine = this.configurationService.getValue<boolean>('editor.scrollBeyondLastLine');\n\n\t\tthis.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('editor.scrollBeyondLastLine')) {\n\t\t\t\tthis._scrollBeyondLastLine = this.configurationService.getValue<boolean>('editor.scrollBeyondLastLine');\n\t\t\t\tif (this._dimension && this._isVisible) {\n\t\t\t\t\tthis.layout(this._dimension);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (e.affectsConfiguration(CellToolbarLocKey) || e.affectsConfiguration(ShowCellStatusBarKey)) {\n\t\t\t\tthis._updateForNotebookConfiguration();\n\t\t\t}\n\t\t});\n\n\t\tthis.notebookEditorService.addNotebookEditor(this);\n\n\t\tconst id = generateUuid();\n\t\tthis._overlayContainer.id = `notebook-${id}`;\n\t\tthis._overlayContainer.className = 'notebookOverlay';\n\t\tthis._overlayContainer.classList.add('notebook-editor');\n\t\tthis._overlayContainer.style.visibility = 'hidden';\n\n\t\tthis.layoutService.container.appendChild(this._overlayContainer);\n\t\tthis._createBody(this._overlayContainer);\n\t\tthis._generateFontInfo();\n\t\tthis._isVisible = true;\n\t\tthis._editorFocus = NOTEBOOK_EDITOR_FOCUSED.bindTo(this.scopedContextKeyService);\n\t\tthis._outputFocus = NOTEBOOK_OUTPUT_FOCUSED.bindTo(this.scopedContextKeyService);\n\t\tthis._editorEditable = NOTEBOOK_EDITOR_EDITABLE.bindTo(this.scopedContextKeyService);\n\n\t\tlet contributions: INotebookEditorContributionDescription[];\n\t\tif (Array.isArray(this.creationOptions.contributions)) {\n\t\t\tcontributions = this.creationOptions.contributions;\n\t\t} else {\n\t\t\tcontributions = NotebookEditorExtensionsRegistry.getEditorContributions();\n\t\t}\n\t\tfor (const desc of contributions) {\n\t\t\ttry {\n\t\t\t\tconst contribution = this.instantiationService.createInstance(desc.ctor, this);\n\t\t\t\tthis._contributions.set(desc.id, contribution);\n\t\t\t} catch (err) {\n\t\t\t\tonUnexpectedError(err);\n\t\t\t}\n\t\t}\n\n\t\tthis._updateForNotebookConfiguration();\n\n\t\tif (this._debugFlag) {\n\t\t\tthis._domFrameLog();\n\t\t}\n\t}\n\n\tprivate _debugFlag: boolean = false;\n\tprivate _frameId = 0;\n\tprivate _domFrameLog() {\n\t\tDOM.scheduleAtNextAnimationFrame(() => {\n\t\t\tthis._frameId++;\n\n\t\t\tthis._domFrameLog();\n\t\t}, 1000000);\n\t}\n\n\tprivate _debug(...args: any[]) {\n\t\tif (!this._debugFlag) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst date = new Date();\n\t\tconsole.log(`${date.getSeconds()}:${date.getMilliseconds().toString().padStart(3, '0')}`, `frame #${this._frameId}: `, ...args);\n\t}\n\n\t/**\n\t * EditorId\n\t */\n\tpublic getId(): string {\n\t\treturn this._uuid;\n\t}\n\n\tgetSelections() {\n\t\treturn this.viewModel?.getSelections() ?? [];\n\t}\n\n\tgetFocus() {\n\t\treturn this.viewModel?.getFocus() ?? { start: 0, end: 0 };\n\t}\n\n\tgetSelectionViewModels(): ICellViewModel[] {\n\t\tif (!this.viewModel) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst cellsSet = new Set<number>();\n\n\t\treturn this.viewModel.getSelections().map(range => this.viewModel!.viewCells.slice(range.start, range.end)).reduce((a, b) => {\n\t\t\tb.forEach(cell => {\n\t\t\t\tif (!cellsSet.has(cell.handle)) {\n\t\t\t\t\tcellsSet.add(cell.handle);\n\t\t\t\t\ta.push(cell);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn a;\n\t\t}, [] as ICellViewModel[]);\n\t}\n\n\thasModel(): this is IActiveNotebookEditor {\n\t\treturn !!this._notebookViewModel;\n\t}\n\n\t//#region Editor Core\n\n\tprotected getEditorMemento<T>(editorGroupService: IEditorGroupsService, key: string, limit: number = 10): IEditorMemento<T> {\n\t\tconst mementoKey = `${NOTEBOOK_EDITOR_ID}${key}`;\n\n\t\tlet editorMemento = NotebookEditorWidget.EDITOR_MEMENTOS.get(mementoKey);\n\t\tif (!editorMemento) {\n\t\t\teditorMemento = new EditorMemento(NOTEBOOK_EDITOR_ID, key, this.getMemento(StorageScope.WORKSPACE), limit, editorGroupService);\n\t\t\tNotebookEditorWidget.EDITOR_MEMENTOS.set(mementoKey, editorMemento);\n\t\t}\n\n\t\treturn editorMemento as IEditorMemento<T>;\n\t}\n\n\tprotected getMemento(scope: StorageScope): MementoObject {\n\t\treturn this._memento.getMemento(scope, StorageTarget.MACHINE);\n\t}\n\n\tprivate _updateForNotebookConfiguration() {\n\t\tif (!this._overlayContainer) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cellToolbarLocation = this.configurationService.getValue<string | { [key: string]: string }>(CellToolbarLocKey);\n\t\tthis._overlayContainer.classList.remove('cell-title-toolbar-left');\n\t\tthis._overlayContainer.classList.remove('cell-title-toolbar-right');\n\t\tthis._overlayContainer.classList.remove('cell-title-toolbar-hidden');\n\n\t\tif (typeof cellToolbarLocation === 'string') {\n\t\t\tif (cellToolbarLocation === 'left' || cellToolbarLocation === 'right' || cellToolbarLocation === 'hidden') {\n\t\t\t\tthis._overlayContainer.classList.add(`cell-title-toolbar-${cellToolbarLocation}`);\n\t\t\t}\n\t\t} else {\n\t\t\tif (this.viewModel) {\n\t\t\t\tconst notebookSpecificSetting = cellToolbarLocation[this.viewModel.viewType] ?? cellToolbarLocation['default'];\n\t\t\t\tlet cellToolbarLocationForCurrentView = 'right';\n\n\t\t\t\tswitch (notebookSpecificSetting) {\n\t\t\t\t\tcase 'left':\n\t\t\t\t\t\tcellToolbarLocationForCurrentView = 'left';\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'right':\n\t\t\t\t\t\tcellToolbarLocationForCurrentView = 'right';\n\t\t\t\t\tcase 'hidden':\n\t\t\t\t\t\tcellToolbarLocationForCurrentView = 'hidden';\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tcellToolbarLocationForCurrentView = 'right';\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tthis._overlayContainer.classList.add(`cell-title-toolbar-${cellToolbarLocationForCurrentView}`);\n\t\t\t} else {\n\t\t\t\tthis._overlayContainer.classList.add(`cell-title-toolbar-right`);\n\t\t\t}\n\t\t}\n\n\t\tconst showCellStatusBar = this.configurationService.getValue<boolean>(ShowCellStatusBarKey);\n\t\tthis._overlayContainer.classList.toggle('cell-statusbar-hidden', !showCellStatusBar);\n\t}\n\n\tprivate _generateFontInfo(): void {\n\t\tconst editorOptions = this.configurationService.getValue<IEditorOptions>('editor');\n\t\tthis._fontInfo = readFontInfo(BareFontInfo.createFromRawSettings(editorOptions, getZoomLevel(), getPixelRatio()));\n\t}\n\n\tprivate _createBody(parent: HTMLElement): void {\n\t\tthis._notebookTopToolbarContainer = document.createElement('div');\n\t\tthis._notebookTopToolbarContainer.classList.add('notebook-top-toolbar');\n\t\tthis._notebookTopToolbarContainer.style.display = 'none';\n\t\tDOM.append(parent, this._notebookTopToolbarContainer);\n\t\tthis._body = document.createElement('div');\n\t\tthis._body.classList.add('cell-list-container');\n\t\tthis._createCellList();\n\t\tDOM.append(parent, this._body);\n\n\t\tthis._overflowContainer = document.createElement('div');\n\t\tthis._overflowContainer.classList.add('notebook-overflow-widget-container', 'monaco-editor');\n\t\tDOM.append(parent, this._overflowContainer);\n\t}\n\n\tprivate _createCellList(): void {\n\t\tthis._body.classList.add('cell-list-container');\n\n\t\tthis._dndController = this._register(new CellDragAndDropController(this, this._body));\n\t\tconst getScopedContextKeyService = (container: HTMLElement) => this._list.contextKeyService.createScoped(container);\n\t\tconst renderers = [\n\t\t\tthis.instantiationService.createInstance(CodeCellRenderer, this, this._renderedEditors, this._dndController, getScopedContextKeyService),\n\t\t\tthis.instantiationService.createInstance(MarkdownCellRenderer, this, this._dndController, this._renderedEditors, getScopedContextKeyService, { useRenderer: this.useRenderer }),\n\t\t];\n\n\t\tthis._list = this.instantiationService.createInstance(\n\t\t\tNotebookCellList,\n\t\t\t'NotebookCellList',\n\t\t\tthis._overlayContainer,\n\t\t\tthis._body,\n\t\t\tthis.instantiationService.createInstance(NotebookCellListDelegate),\n\t\t\trenderers,\n\t\t\tthis.scopedContextKeyService,\n\t\t\t{\n\t\t\t\tsetRowLineHeight: false,\n\t\t\t\tsetRowHeight: false,\n\t\t\t\tsupportDynamicHeights: true,\n\t\t\t\thorizontalScrolling: false,\n\t\t\t\tkeyboardSupport: false,\n\t\t\t\tmouseSupport: true,\n\t\t\t\tmultipleSelectionSupport: true,\n\t\t\t\tselectionNavigation: true,\n\t\t\t\tenableKeyboardNavigation: true,\n\t\t\t\tadditionalScrollHeight: 0,\n\t\t\t\ttransformOptimization: false, //(isMacintosh && isNative) || getTitleBarStyle(this.configurationService, this.environmentService) === 'native',\n\t\t\t\tstyleController: (_suffix: string) => { return this._list; },\n\t\t\t\toverrideStyles: {\n\t\t\t\t\tlistBackground: editorBackground,\n\t\t\t\t\tlistActiveSelectionBackground: editorBackground,\n\t\t\t\t\tlistActiveSelectionForeground: foreground,\n\t\t\t\t\tlistFocusAndSelectionBackground: editorBackground,\n\t\t\t\t\tlistFocusAndSelectionForeground: foreground,\n\t\t\t\t\tlistFocusBackground: editorBackground,\n\t\t\t\t\tlistFocusForeground: foreground,\n\t\t\t\t\tlistHoverForeground: foreground,\n\t\t\t\t\tlistHoverBackground: editorBackground,\n\t\t\t\t\tlistHoverOutline: focusBorder,\n\t\t\t\t\tlistFocusOutline: focusBorder,\n\t\t\t\t\tlistInactiveSelectionBackground: editorBackground,\n\t\t\t\t\tlistInactiveSelectionForeground: foreground,\n\t\t\t\t\tlistInactiveFocusBackground: editorBackground,\n\t\t\t\t\tlistInactiveFocusOutline: editorBackground,\n\t\t\t\t},\n\t\t\t\taccessibilityProvider: {\n\t\t\t\t\tgetAriaLabel: (element) => {\n\t\t\t\t\t\tif (!this.viewModel) {\n\t\t\t\t\t\t\treturn '';\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst index = this.viewModel.getCellIndex(element);\n\n\t\t\t\t\t\tif (index >= 0) {\n\t\t\t\t\t\t\treturn `Cell ${index}, ${element.cellKind === CellKind.Markdown ? 'markdown' : 'code'}  cell`;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn '';\n\t\t\t\t\t},\n\t\t\t\t\tgetWidgetAriaLabel() {\n\t\t\t\t\t\treturn nls.localize('notebookTreeAriaLabel', \"Notebook\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tfocusNextPreviousDelegate: {\n\t\t\t\t\tonFocusNext: (applyFocusNext: () => void) => this._updateForCursorNavigationMode(applyFocusNext),\n\t\t\t\t\tonFocusPrevious: (applyFocusPrevious: () => void) => this._updateForCursorNavigationMode(applyFocusPrevious),\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\t\tthis._dndController.setList(this._list);\n\n\t\t// create Webview\n\n\t\tthis._register(this._list);\n\t\tthis._listViewInfoAccessor = new ListViewInfoAccessor(this._list);\n\t\tthis._register(this._listViewInfoAccessor);\n\n\t\tthis._register(combinedDisposable(...renderers));\n\n\t\t// top cell toolbar\n\t\tthis._listTopCellToolbar = this._register(this.instantiationService.createInstance(ListTopCellToolbar, this, this.scopedContextKeyService, this._list.rowsContainer));\n\n\t\t// transparent cover\n\t\tthis._webviewTransparentCover = DOM.append(this._list.rowsContainer, $('.webview-cover'));\n\t\tthis._webviewTransparentCover.style.display = 'none';\n\n\t\tthis._register(DOM.addStandardDisposableGenericMouseDownListner(this._overlayContainer, (e: StandardMouseEvent) => {\n\t\t\tif (e.target.classList.contains('slider') && this._webviewTransparentCover) {\n\t\t\t\tthis._webviewTransparentCover.style.display = 'block';\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addStandardDisposableGenericMouseUpListner(this._overlayContainer, () => {\n\t\t\tif (this._webviewTransparentCover) {\n\t\t\t\t// no matter when\n\t\t\t\tthis._webviewTransparentCover.style.display = 'none';\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._list.onMouseDown(e => {\n\t\t\tif (e.element) {\n\t\t\t\tthis._onMouseDown.fire({ event: e.browserEvent, target: e.element });\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._list.onMouseUp(e => {\n\t\t\tif (e.element) {\n\t\t\t\tthis._onMouseUp.fire({ event: e.browserEvent, target: e.element });\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._list.onDidChangeFocus(_e => {\n\t\t\tthis._onDidChangeActiveEditor.fire(this);\n\t\t\tthis._onDidChangeActiveCell.fire();\n\t\t\tthis._cursorNavigationMode = false;\n\t\t}));\n\n\t\tthis._register(this._list.onContextMenu(e => {\n\t\t\tthis.showListContextMenu(e);\n\t\t}));\n\n\t\tthis._register(this._list.onDidChangeVisibleRanges(() => {\n\t\t\tthis._onDidChangeVisibleRanges.fire();\n\t\t}));\n\n\t\tthis._register(this._list.onDidScroll(() => {\n\t\t\tthis._onDidScroll.fire();\n\t\t}));\n\n\t\tconst widgetFocusTracker = DOM.trackFocus(this.getDomNode());\n\t\tthis._register(widgetFocusTracker);\n\t\tthis._register(widgetFocusTracker.onDidFocus(() => this._onDidFocusEmitter.fire()));\n\t\tthis._register(widgetFocusTracker.onDidBlur(() => this._onDidBlurEmitter.fire()));\n\n\t\tthis._reigsterNotebookActionsToolbar();\n\t\tthis._register(this.editorService.onDidActiveEditorChange(() => {\n\t\t\tif (this.editorService.activeEditorPane?.getId() === NOTEBOOK_EDITOR_ID) {\n\t\t\t\tconst notebookEditor = this.editorService.activeEditorPane.getControl() as INotebookEditor;\n\t\t\t\tif (notebookEditor === this) {\n\t\t\t\t\t// this is the active editor\n\t\t\t\t\tthis._showNotebookActionsinEditorToolbar();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._editorToolbarDisposable.clear();\n\t\t\tthis._toolbarActionDisposable.clear();\n\t\t}));\n\t}\n\n\tprivate showListContextMenu(e: IListContextMenuEvent<CellViewModel>) {\n\t\tthis.contextMenuService.showContextMenu({\n\t\t\tgetActions: () => {\n\t\t\t\tconst result: IAction[] = [];\n\t\t\t\tconst menu = this.menuService.createMenu(MenuId.NotebookCellTitle, this.scopedContextKeyService);\n\t\t\t\tcreateAndFillInContextMenuActions(menu, undefined, result);\n\t\t\t\tmenu.dispose();\n\t\t\t\treturn result;\n\t\t\t},\n\t\t\tgetAnchor: () => e.anchor\n\t\t});\n\t}\n\n\tprivate _notebookGlobalActionsMenu!: IMenu;\n\tprivate _toolbarActionDisposable = this._register(new DisposableStore());\n\tprivate _topToolbar!: ToolBar;\n\tprivate _useGlobalToolbar: boolean = false;\n\tprivate _editorToolbarDisposable = this._register(new DisposableStore());\n\tprivate _reigsterNotebookActionsToolbar() {\n\t\tconst cellMenu = this.instantiationService.createInstance(CellMenus);\n\t\tthis._notebookGlobalActionsMenu = this._register(cellMenu.getNotebookToolbar(this.scopedContextKeyService));\n\t\tthis._register(this._notebookGlobalActionsMenu);\n\n\t\tthis._useGlobalToolbar = this.configurationService.getValue<boolean | undefined>('notebook.experimental.globalToolbar') ?? false;\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('notebook.experimental.globalToolbar')) {\n\t\t\t\tthis._useGlobalToolbar = this.configurationService.getValue<boolean>('notebook.experimental.globalToolbar');\n\t\t\t\tthis._showNotebookActionsinEditorToolbar();\n\t\t\t}\n\t\t}));\n\n\t\tthis._topToolbar = new ToolBar(this._notebookTopToolbarContainer, this.contextMenuService, {\n\t\t\tgetKeyBinding: action => this.keybindingService.lookupKeybinding(action.id),\n\t\t\tactionViewItemProvider: action => {\n\t\t\t\treturn createActionViewItem(this.instantiationService, action);\n\t\t\t},\n\t\t\trenderDropdownAsChildElement: true\n\t\t});\n\t\tthis._register(this._topToolbar);\n\t\tthis._topToolbar.context = {\n\t\t\tui: true,\n\t\t\tnotebookEditor: this\n\t\t};\n\n\t\tthis._showNotebookActionsinEditorToolbar();\n\t\tthis._register(this._notebookGlobalActionsMenu.onDidChange(() => {\n\t\t\tthis._showNotebookActionsinEditorToolbar();\n\t\t}));\n\n\t\tif (this.experimentService) {\n\t\t\tthis.experimentService.getTreatment<boolean>('nbtoolbarineditor').then(treatment => {\n\t\t\t\tif (treatment === undefined) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif (this._useGlobalToolbar !== treatment) {\n\t\t\t\t\tthis._useGlobalToolbar = treatment;\n\t\t\t\t\tthis._showNotebookActionsinEditorToolbar();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate _showNotebookActionsinEditorToolbar() {\n\t\t// when there is no view model, just ignore.\n\t\tif (!this.viewModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._useGlobalToolbar) {\n\t\t\t// schedule actions registration in next frame, otherwise we are seeing duplicated notbebook actions temporarily\n\t\t\tthis._editorToolbarDisposable.clear();\n\t\t\tthis._editorToolbarDisposable.add(DOM.scheduleAtNextAnimationFrame(() => {\n\t\t\t\tconst groups = this._notebookGlobalActionsMenu.getActions({ shouldForwardArgs: true });\n\t\t\t\tthis._toolbarActionDisposable.clear();\n\t\t\t\tthis._topToolbar.setActions([], []);\n\t\t\t\tif (!this.viewModel) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (!this._isVisible) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this.editorService.activeEditorPane?.getId() === NOTEBOOK_EDITOR_ID) {\n\t\t\t\t\tconst notebookEditor = this.editorService.activeEditorPane.getControl() as INotebookEditor;\n\t\t\t\t\tif (notebookEditor !== this) {\n\t\t\t\t\t\t// clear actions but not recreate because it is not active editor\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tgroups.forEach(group => {\n\t\t\t\t\tconst groupName = group[0];\n\t\t\t\t\tconst actions = group[1];\n\n\t\t\t\t\tlet order = groupName === 'navigation' ? -10 : 0;\n\t\t\t\t\tfor (let i = 0; i < actions.length; i++) {\n\t\t\t\t\t\tconst menuItemAction = actions[i] as MenuItemAction;\n\t\t\t\t\t\tthis._toolbarActionDisposable.add(MenuRegistry.appendMenuItem(MenuId.EditorTitle, {\n\t\t\t\t\t\t\tcommand: {\n\t\t\t\t\t\t\t\tid: menuItemAction.item.id,\n\t\t\t\t\t\t\t\ttitle: menuItemAction.item.title,\n\t\t\t\t\t\t\t\tcategory: menuItemAction.item.category,\n\t\t\t\t\t\t\t\ttooltip: menuItemAction.item.tooltip,\n\t\t\t\t\t\t\t\ticon: menuItemAction.item.icon,\n\t\t\t\t\t\t\t\tprecondition: menuItemAction.item.precondition,\n\t\t\t\t\t\t\t\ttoggled: menuItemAction.item.toggled,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttitle: menuItemAction.item.title + ' ' + this.viewModel?.uri.scheme,\n\t\t\t\t\t\t\tgroup: groupName,\n\t\t\t\t\t\t\torder: order\n\t\t\t\t\t\t}));\n\t\t\t\t\t\torder++;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}));\n\n\t\t\tthis._notebookTopToolbarContainer.style.display = 'none';\n\t\t} else {\n\t\t\tthis._toolbarActionDisposable.clear();\n\t\t\tthis._topToolbar.setActions([], []);\n\t\t\tconst groups = this._notebookGlobalActionsMenu.getActions({ shouldForwardArgs: true });\n\t\t\tthis._notebookTopToolbarContainer.style.display = 'flex';\n\t\t\tconst primaryGroup = groups.find(group => group[0] === 'navigation');\n\t\t\tconst primaryActions = primaryGroup ? primaryGroup[1] : [];\n\t\t\tconst secondaryActions = groups.filter(group => group[0] !== 'navigation').reduce((prev: (MenuItemAction | SubmenuItemAction)[], curr) => { prev.push(...curr[1]); return prev; }, []);\n\n\t\t\tthis._topToolbar.setActions(primaryActions, secondaryActions);\n\t\t}\n\n\t\tif (this._dimension && this._isVisible) {\n\t\t\tthis.layout(this._dimension);\n\t\t}\n\t}\n\n\tprivate _updateForCursorNavigationMode(applyFocusChange: () => void): void {\n\t\tif (this._cursorNavigationMode) {\n\t\t\t// Will fire onDidChangeFocus, resetting the state to Container\n\t\t\tapplyFocusChange();\n\n\t\t\tconst newFocusedCell = this._list.getFocusedElements()[0];\n\t\t\tif (newFocusedCell.cellKind === CellKind.Code || newFocusedCell.getEditState() === CellEditState.Editing) {\n\t\t\t\tthis.focusNotebookCell(newFocusedCell, 'editor');\n\t\t\t} else {\n\t\t\t\t// Reset to \"Editor\", the state has not been consumed\n\t\t\t\tthis._cursorNavigationMode = true;\n\t\t\t}\n\t\t} else {\n\t\t\tapplyFocusChange();\n\t\t}\n\t}\n\n\tgetDomNode() {\n\t\treturn this._overlayContainer;\n\t}\n\n\tgetOverflowContainerDomNode() {\n\t\treturn this._overflowContainer;\n\t}\n\n\tgetInnerWebview(): Webview | undefined {\n\t\treturn this._webview?.webview;\n\t}\n\n\tsetParentContextKeyService(parentContextKeyService: IContextKeyService): void {\n\t\tthis.scopedContextKeyService.updateParent(parentContextKeyService);\n\t}\n\n\tasync setModel(textModel: NotebookTextModel, viewState: INotebookEditorViewState | undefined): Promise<void> {\n\t\tif (this.viewModel === undefined || !this.viewModel.equal(textModel)) {\n\t\t\tthis._detachModel();\n\t\t\tawait this._attachModel(textModel, viewState);\n\n\t\t\ttype WorkbenchNotebookOpenClassification = {\n\t\t\t\tscheme: { classification: 'SystemMetaData', purpose: 'FeatureInsight'; };\n\t\t\t\text: { classification: 'SystemMetaData', purpose: 'FeatureInsight'; };\n\t\t\t\tviewType: { classification: 'SystemMetaData', purpose: 'FeatureInsight'; };\n\t\t\t};\n\n\t\t\ttype WorkbenchNotebookOpenEvent = {\n\t\t\t\tscheme: string;\n\t\t\t\text: string;\n\t\t\t\tviewType: string;\n\t\t\t};\n\n\t\t\tthis.telemetryService.publicLog2<WorkbenchNotebookOpenEvent, WorkbenchNotebookOpenClassification>('notebook/editorOpened', {\n\t\t\t\tscheme: textModel.uri.scheme,\n\t\t\t\text: extname(textModel.uri),\n\t\t\t\tviewType: textModel.viewType\n\t\t\t});\n\t\t} else {\n\t\t\tthis.restoreListViewState(viewState);\n\t\t}\n\n\t\t// load preloads for matching kernel\n\t\tthis._loadKernelPreloads();\n\n\t\t// clear state\n\t\tthis._dndController?.clearGlobalDragState();\n\n\t\tthis._localStore.add(this._list.onDidChangeFocus(() => {\n\t\t\tthis.updateContextKeysOnFocusChange();\n\t\t}));\n\n\t\tthis.updateContextKeysOnFocusChange();\n\t}\n\n\tprivate updateContextKeysOnFocusChange() {\n\t\tif (!this.viewModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focused = this._list.getFocusedElements()[0];\n\t\tif (focused) {\n\t\t\tif (!this._cellContextKeyManager) {\n\t\t\t\tthis._cellContextKeyManager = this._localStore.add(new CellContextKeyManager(this.scopedContextKeyService, this, focused as CellViewModel));\n\t\t\t}\n\n\t\t\tthis._cellContextKeyManager.updateForElement(focused as CellViewModel);\n\t\t}\n\t}\n\n\tasync setOptions(options: NotebookEditorOptions | undefined) {\n\t\tif (!this.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (options?.isReadOnly !== undefined) {\n\t\t\tthis.viewModel.updateOptions({ isReadOnly: options.isReadOnly });\n\t\t}\n\n\t\t// reveal cell if editor options tell to do so\n\t\tif (options?.cellOptions) {\n\t\t\tconst cellOptions = options.cellOptions;\n\t\t\tconst cell = this.viewModel.viewCells.find(cell => cell.uri.toString() === cellOptions.resource.toString());\n\t\t\tif (cell) {\n\t\t\t\tthis.focusElement(cell);\n\t\t\t\tawait this.revealInCenterIfOutsideViewportAsync(cell);\n\t\t\t\tconst editor = this._renderedEditors.get(cell)!;\n\t\t\t\tif (editor) {\n\t\t\t\t\tif (cellOptions.options?.selection) {\n\t\t\t\t\t\tconst { selection } = cellOptions.options;\n\t\t\t\t\t\teditor.setSelection({\n\t\t\t\t\t\t\t...selection,\n\t\t\t\t\t\t\tendLineNumber: selection.endLineNumber || selection.startLineNumber,\n\t\t\t\t\t\t\tendColumn: selection.endColumn || selection.startColumn\n\t\t\t\t\t\t});\n\t\t\t\t\t\teditor.revealPositionInCenterIfOutsideViewport({\n\t\t\t\t\t\t\tlineNumber: selection.startLineNumber,\n\t\t\t\t\t\t\tcolumn: selection.startColumn\n\t\t\t\t\t\t});\n\t\t\t\t\t\tawait this.revealLineInCenterIfOutsideViewportAsync(cell, selection.startLineNumber);\n\t\t\t\t\t}\n\t\t\t\t\tif (!cellOptions.options?.preserveFocus) {\n\t\t\t\t\t\teditor.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// select cells if options tell to do so\n\t\t// todo@rebornix https://github.com/microsoft/vscode/issues/118108 support selections not just focus\n\t\t// todo@rebornix support multipe selections\n\t\tif (options?.cellSelections) {\n\t\t\tconst focusCellIndex = options.cellSelections[0].start;\n\t\t\tconst focusedCell = this.viewModel.cellAt(focusCellIndex);\n\t\t\tif (focusedCell) {\n\t\t\t\tthis.viewModel.updateSelectionsState({\n\t\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\t\tfocus: { start: focusCellIndex, end: focusCellIndex + 1 },\n\t\t\t\t\tselections: options.cellSelections\n\t\t\t\t});\n\t\t\t\tthis.revealInCenterIfOutsideViewport(focusedCell);\n\t\t\t}\n\t\t}\n\n\t\tthis._updateForOptions();\n\t}\n\n\tprivate _detachModel() {\n\t\tthis._localStore.clear();\n\t\tdispose(this._localCellStateListeners);\n\t\tthis._list.detachViewModel();\n\t\tthis.viewModel?.dispose();\n\t\t// avoid event\n\t\tthis.viewModel = undefined;\n\t\tthis._webview?.dispose();\n\t\tthis._webview?.element.remove();\n\t\tthis._webview = null;\n\t\tthis._list.clear();\n\t}\n\n\n\tprivate _updateForOptions(): void {\n\t\tif (!this.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._editorEditable.set(!this.viewModel.options.isReadOnly);\n\t\tthis._overflowContainer.classList.toggle('notebook-editor-editable', !this.viewModel.options.isReadOnly);\n\t\tthis.getDomNode().classList.toggle('notebook-editor-editable', !this.viewModel.options.isReadOnly);\n\t}\n\n\tprivate async _resolveWebview(): Promise<BackLayerWebView<ICommonCellInfo> | null> {\n\t\tif (!this.textModel) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this._webviewResolvePromise) {\n\t\t\treturn this._webviewResolvePromise;\n\t\t}\n\n\t\tif (!this._webview) {\n\t\t\tthis._createWebview(this.getId(), this.textModel.uri);\n\t\t}\n\n\t\tthis._webviewResolvePromise = new Promise(async resolve => {\n\t\t\tif (!this._webview) {\n\t\t\t\tthrow new Error('Notebook output webview object is not created successfully.');\n\t\t\t}\n\n\t\t\tawait this._webview.createWebview();\n\t\t\tif (!this._webview.webview) {\n\t\t\t\tthrow new Error('Notebook output webview elemented is not created successfully.');\n\t\t\t}\n\n\t\t\tthis._webview.webview.onDidBlur(() => {\n\t\t\t\tthis._outputFocus.set(false);\n\t\t\t\tthis.updateEditorFocus();\n\n\t\t\t\tif (this._overlayContainer.contains(document.activeElement)) {\n\t\t\t\t\tthis._webiewFocused = false;\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis._webview.webview.onDidFocus(() => {\n\t\t\t\tthis._outputFocus.set(true);\n\t\t\t\tthis.updateEditorFocus();\n\t\t\t\tthis._onDidFocusEmitter.fire();\n\n\t\t\t\tif (this._overlayContainer.contains(document.activeElement)) {\n\t\t\t\t\tthis._webiewFocused = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis._localStore.add(this._webview.onMessage(e => {\n\t\t\t\tthis._onDidReceiveMessage.fire(e);\n\t\t\t}));\n\n\t\t\tresolve(this._webview);\n\t\t});\n\n\t\treturn this._webviewResolvePromise;\n\t}\n\n\tprivate async _createWebview(id: string, resource: URI): Promise<void> {\n\t\tthis._webview = this.instantiationService.createInstance(BackLayerWebView, this, id, resource, {\n\t\t\toutputNodePadding: CELL_OUTPUT_PADDING,\n\t\t\toutputNodeLeftPadding: CELL_OUTPUT_PADDING,\n\t\t\tpreviewNodePadding: MARKDOWN_PREVIEW_PADDING,\n\t\t\tleftMargin: CODE_CELL_LEFT_MARGIN,\n\t\t\trightMargin: CELL_RIGHT_MARGIN,\n\t\t\trunGutter: CELL_RUN_GUTTER,\n\t\t});\n\t\tthis._webview.element.style.width = '100%';\n\n\t\t// attach the webview container to the DOM tree first\n\t\tthis._list.rowsContainer.insertAdjacentElement('afterbegin', this._webview.element);\n\t}\n\n\tprivate async _attachModel(textModel: NotebookTextModel, viewState: INotebookEditorViewState | undefined) {\n\t\tawait this._createWebview(this.getId(), textModel.uri);\n\n\t\tthis._eventDispatcher = new NotebookEventDispatcher();\n\t\tthis.viewModel = this.instantiationService.createInstance(NotebookViewModel, textModel.viewType, textModel, this._eventDispatcher, this.getLayoutInfo());\n\t\tthis._eventDispatcher.emit([new NotebookLayoutChangedEvent({ width: true, fontInfo: true }, this.getLayoutInfo())]);\n\n\t\tthis._updateForOptions();\n\t\tthis._updateForNotebookConfiguration();\n\n\t\t// restore view states, including contributions\n\n\t\t{\n\t\t\t// restore view state\n\t\t\tthis.viewModel.restoreEditorViewState(viewState);\n\n\t\t\t// contribution state restore\n\n\t\t\tconst contributionsState = viewState?.contributionsState || {};\n\t\t\tfor (const [id, contribution] of this._contributions) {\n\t\t\t\tif (typeof contribution.restoreViewState === 'function') {\n\t\t\t\t\tcontribution.restoreViewState(contributionsState[id]);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthis._localStore.add(this.viewModel.onDidChangeSelection(() => {\n\t\t\tthis._onDidChangeSelection.fire();\n\t\t\tthis.updateSelectedMarkdownPreviews();\n\t\t}));\n\n\t\tthis._localStore.add(this._list.onWillScroll(e => {\n\t\t\tif (this._webview?.isResolved()) {\n\t\t\t\tthis._webviewTransparentCover!.style.top = `${e.scrollTop}px`;\n\t\t\t}\n\t\t}));\n\n\t\tlet hasPendingChangeContentHeight = false;\n\t\tthis._localStore.add(this._list.onDidChangeContentHeight(() => {\n\t\t\tif (hasPendingChangeContentHeight) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\thasPendingChangeContentHeight = true;\n\n\t\t\tDOM.scheduleAtNextAnimationFrame(() => {\n\t\t\t\thasPendingChangeContentHeight = false;\n\t\t\t\tthis.updateScrollHeight();\n\t\t\t}, 100);\n\t\t}));\n\n\t\tthis._localStore.add(this._list.onDidRemoveOutputs(outputs => {\n\t\t\toutputs.forEach(output => this.removeInset(output));\n\t\t}));\n\t\tthis._localStore.add(this._list.onDidHideOutputs(outputs => {\n\t\t\toutputs.forEach(output => this.hideInset(output));\n\t\t}));\n\t\tthis._localStore.add(this._list.onDidRemoveCellsFromView(cells => {\n\t\t\tconst hiddenCells: MarkdownCellViewModel[] = [];\n\t\t\tconst deletedCells: MarkdownCellViewModel[] = [];\n\n\t\t\tfor (const cell of cells) {\n\t\t\t\tif (cell.cellKind === CellKind.Markdown) {\n\t\t\t\t\tconst mdCell = cell as MarkdownCellViewModel;\n\t\t\t\t\tif (this.viewModel?.viewCells.find(cell => cell.handle === mdCell.handle)) {\n\t\t\t\t\t\t// Cell has been folded but is still in model\n\t\t\t\t\t\thiddenCells.push(mdCell);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Cell was deleted\n\t\t\t\t\t\tdeletedCells.push(mdCell);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.hideMarkdownPreviews(hiddenCells);\n\t\t\tthis.deleteMarkdownPreviews(deletedCells);\n\t\t}));\n\n\t\t// init rendering\n\t\tif (this.useRenderer) {\n\t\t\tawait this._warmupWithMarkdownRenderer(this.viewModel, viewState);\n\t\t} else {\n\t\t\tthis._list.attachViewModel(this.viewModel);\n\t\t}\n\n\t\tmark(textModel.uri, 'customMarkdownLoaded');\n\n\t\t// model attached\n\t\tthis._localCellStateListeners = this.viewModel.viewCells.map(cell => this._bindCellListener(cell));\n\n\t\tthis._localStore.add(this.viewModel.onDidChangeViewCells((e) => {\n\t\t\tif (this._isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// update resize listener\n\t\t\te.splices.reverse().forEach(splice => {\n\t\t\t\tconst [start, deleted, newCells] = splice;\n\t\t\t\tconst deletedCells = this._localCellStateListeners.splice(start, deleted, ...newCells.map(cell => this._bindCellListener(cell)));\n\n\t\t\t\tdispose(deletedCells);\n\t\t\t});\n\t\t}));\n\n\t\tif (this._dimension) {\n\t\t\tthis._list.layout(this._dimension.height - SCROLLABLE_ELEMENT_PADDING_TOP, this._dimension.width);\n\t\t} else {\n\t\t\tthis._list.layout();\n\t\t}\n\n\t\tthis._dndController?.clearGlobalDragState();\n\n\t\t// restore list state at last, it must be after list layout\n\t\tthis.restoreListViewState(viewState);\n\t}\n\n\tprivate _bindCellListener(cell: ICellViewModel) {\n\t\tconst store = new DisposableStore();\n\n\t\tstore.add(cell.onDidChangeLayout(e => {\n\t\t\tif (e.totalHeight !== undefined || e.outerWidth) {\n\t\t\t\tthis.layoutNotebookCell(cell, cell.layoutInfo.totalHeight);\n\t\t\t}\n\t\t}));\n\n\t\tif (cell.cellKind === CellKind.Code) {\n\t\t\tstore.add((cell as CodeCellViewModel).onDidRemoveOutputs((outputs) => {\n\t\t\t\toutputs.forEach(output => this.removeInset(output));\n\t\t\t}));\n\n\t\t\tstore.add((cell as CodeCellViewModel).onDidHideOutputs((outputs) => {\n\t\t\t\toutputs.forEach(output => this.hideInset(output));\n\t\t\t}));\n\t\t}\n\n\t\tif (cell.cellKind === CellKind.Markdown) {\n\t\t\tstore.add((cell as MarkdownCellViewModel).onDidHideInput(() => {\n\t\t\t\tthis.hideMarkdownPreviews([(cell as MarkdownCellViewModel)]);\n\t\t\t}));\n\t\t}\n\n\t\treturn store;\n\t}\n\n\tprivate async _warmupWithMarkdownRenderer(viewModel: NotebookViewModel, viewState: INotebookEditorViewState | undefined) {\n\n\t\tawait this._resolveWebview();\n\n\t\t// make sure that the webview is not visible otherwise users will see pre-rendered markdown cells in wrong position as the list view doesn't have a correct `top` offset yet\n\t\tthis._webview!.element.style.visibility = 'hidden';\n\t\t// warm up can take around 200ms to load markdown libraries, etc.\n\t\tawait this._warmupViewport(viewModel, viewState);\n\n\t\t// todo@rebornix @mjbvz, is this too complicated?\n\n\t\t/* now the webview is ready, and requests to render markdown are fast enough\n\t\t * we can start rendering the list view\n\t\t * render\n\t\t *   - markdown cell -> request to webview to (10ms, basically just latency between UI and iframe)\n\t\t *   - code cell -> render in place\n\t\t */\n\t\tthis._list.layout(0, 0);\n\t\tthis._list.attachViewModel(viewModel);\n\n\t\t// now the list widget has a correct contentHeight/scrollHeight\n\t\t// setting scrollTop will work properly\n\t\t// after setting scroll top, the list view will update `top` of the scrollable element, e.g. `top: -584px`\n\t\tthis._list.scrollTop = viewState?.scrollPosition?.top ?? 0;\n\t\tthis._debug('finish initial viewport warmup and view state restore.');\n\t\tthis._webview!.element.style.visibility = 'visible';\n\n\t}\n\n\tprivate async _warmupViewport(viewModel: NotebookViewModel, viewState: INotebookEditorViewState | undefined) {\n\t\tif (viewState && viewState.cellTotalHeights) {\n\t\t\tconst totalHeightCache = viewState.cellTotalHeights;\n\t\t\tconst scrollTop = viewState.scrollPosition?.top ?? 0;\n\t\t\tconst scrollBottom = scrollTop + Math.max(this._dimension?.height ?? 0, 1080);\n\n\t\t\tlet offset = 0;\n\t\t\tlet requests: [ICellViewModel, number][] = [];\n\n\t\t\tfor (let i = 0; i < viewModel.length; i++) {\n\t\t\t\tconst cell = viewModel.cellAt(i)!;\n\n\t\t\t\tif (offset + (totalHeightCache[i] ?? 0) < scrollTop) {\n\t\t\t\t\toffset += (totalHeightCache ? totalHeightCache[i] : 0);\n\t\t\t\t\tcontinue;\n\t\t\t\t} else {\n\t\t\t\t\tif (cell.cellKind === CellKind.Markdown) {\n\t\t\t\t\t\trequests.push([cell, offset]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\toffset += (totalHeightCache ? totalHeightCache[i] : 0);\n\n\t\t\t\tif (offset > scrollBottom) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tawait this._webview!.initializeMarkdown(requests\n\t\t\t\t.map(request => ({ cellId: request[0].id, cellHandle: request[0].handle, content: request[0].getText(), offset: request[1] })));\n\t\t} else {\n\t\t\tconst initRequests = viewModel.viewCells.filter(cell => cell.cellKind === CellKind.Markdown).slice(0, 5).map(cell => ({ cellId: cell.id, cellHandle: cell.handle, content: cell.getText(), offset: -10000 }));\n\t\t\tawait this._webview!.initializeMarkdown(initRequests);\n\n\t\t\t// no cached view state so we are rendering the first viewport\n\t\t\t// after above async call, we already get init height for markdown cells, we can update their offset\n\t\t\tlet offset = 0;\n\t\t\tconst offsetUpdateRequests: { id: string, top: number }[] = [];\n\t\t\tconst scrollBottom = Math.max(this._dimension?.height ?? 0, 1080);\n\t\t\tfor (const cell of viewModel.viewCells) {\n\t\t\t\tif (cell.cellKind === CellKind.Markdown) {\n\t\t\t\t\toffsetUpdateRequests.push({ id: cell.id, top: offset });\n\t\t\t\t}\n\n\t\t\t\toffset += cell.getHeight(this.getLayoutInfo().fontInfo.lineHeight);\n\n\t\t\t\tif (offset > scrollBottom) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._webview?.updateScrollTops([], offsetUpdateRequests);\n\t\t}\n\t}\n\n\trestoreListViewState(viewState: INotebookEditorViewState | undefined): void {\n\t\tif (viewState?.scrollPosition !== undefined) {\n\t\t\tthis._list.scrollTop = viewState!.scrollPosition.top;\n\t\t\tthis._list.scrollLeft = viewState!.scrollPosition.left;\n\t\t} else {\n\t\t\tthis._list.scrollTop = 0;\n\t\t\tthis._list.scrollLeft = 0;\n\t\t}\n\n\t\tconst focusIdx = typeof viewState?.focus === 'number' ? viewState.focus : 0;\n\t\tif (focusIdx < this._list.length) {\n\t\t\tconst element = this._list.element(focusIdx);\n\t\t\tif (element) {\n\t\t\t\tthis.viewModel?.updateSelectionsState({\n\t\t\t\t\tkind: SelectionStateType.Handle,\n\t\t\t\t\tprimary: element.handle,\n\t\t\t\t\tselections: [element.handle]\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (this._list.length > 0) {\n\t\t\tthis.viewModel?.updateSelectionsState({\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: { start: 0, end: 1 },\n\t\t\t\tselections: [{ start: 0, end: 1 }]\n\t\t\t});\n\t\t}\n\n\t\tif (viewState?.editorFocused) {\n\t\t\tconst cell = this.viewModel?.cellAt(focusIdx);\n\t\t\tif (cell) {\n\t\t\t\tcell.focusMode = CellFocusMode.Editor;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetEditorViewState(): INotebookEditorViewState {\n\t\tconst state = this.viewModel?.getEditorViewState();\n\t\tif (!state) {\n\t\t\treturn {\n\t\t\t\teditingCells: {},\n\t\t\t\teditorViewStates: {}\n\t\t\t};\n\t\t}\n\n\t\tif (this._list) {\n\t\t\tstate.scrollPosition = { left: this._list.scrollLeft, top: this._list.scrollTop };\n\t\t\tconst cellHeights: { [key: number]: number } = {};\n\t\t\tfor (let i = 0; i < this.viewModel!.length; i++) {\n\t\t\t\tconst elm = this.viewModel!.cellAt(i) as CellViewModel;\n\t\t\t\tif (elm.cellKind === CellKind.Code) {\n\t\t\t\t\tcellHeights[i] = elm.layoutInfo.totalHeight;\n\t\t\t\t} else {\n\t\t\t\t\tcellHeights[i] = elm.layoutInfo.totalHeight;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tstate.cellTotalHeights = cellHeights;\n\n\t\t\tif (this.viewModel) {\n\t\t\t\tconst focusRange = this.viewModel.getFocus();\n\t\t\t\tconst element = this.viewModel.cellAt(focusRange.start);\n\t\t\t\tif (element) {\n\t\t\t\t\tconst itemDOM = this._list.domElementOfElement(element);\n\t\t\t\t\tconst editorFocused = element.getEditState() === CellEditState.Editing && !!(document.activeElement && itemDOM && itemDOM.contains(document.activeElement));\n\n\t\t\t\t\tstate.editorFocused = editorFocused;\n\t\t\t\t\tstate.focus = focusRange.start;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Save contribution view states\n\t\tconst contributionsState: { [key: string]: unknown } = {};\n\t\tfor (const [id, contribution] of this._contributions) {\n\t\t\tif (typeof contribution.saveViewState === 'function') {\n\t\t\t\tcontributionsState[id] = contribution.saveViewState();\n\t\t\t}\n\t\t}\n\n\t\tstate.contributionsState = contributionsState;\n\t\treturn state;\n\t}\n\n\tlayout(dimension: DOM.Dimension, shadowElement?: HTMLElement): void {\n\t\tif (!shadowElement && this._shadowElementViewInfo === null) {\n\t\t\tthis._dimension = dimension;\n\t\t\treturn;\n\t\t}\n\n\t\tif (shadowElement) {\n\t\t\tconst containerRect = shadowElement.getBoundingClientRect();\n\n\t\t\tthis._shadowElementViewInfo = {\n\t\t\t\theight: containerRect.height,\n\t\t\t\twidth: containerRect.width,\n\t\t\t\ttop: containerRect.top,\n\t\t\t\tleft: containerRect.left\n\t\t\t};\n\t\t}\n\n\t\tthis._dimension = new DOM.Dimension(dimension.width, dimension.height);\n\t\tDOM.size(this._body, dimension.width, dimension.height - (this._useGlobalToolbar ? /** Toolbar height */ 26 : 0));\n\t\tif (this._list.getRenderHeight() < dimension.height - SCROLLABLE_ELEMENT_PADDING_TOP) {\n\t\t\t// the new dimension is larger than the list viewport, update its additional height first, otherwise the list view will move down a bit (as the `scrollBottom` will move down)\n\t\t\tthis._list.updateOptions({ additionalScrollHeight: this._scrollBeyondLastLine ? Math.max(0, (dimension.height - SCROLLABLE_ELEMENT_PADDING_TOP - 50)) : SCROLLABLE_ELEMENT_PADDING_TOP });\n\t\t\tthis._list.layout(dimension.height - SCROLLABLE_ELEMENT_PADDING_TOP, dimension.width);\n\t\t} else {\n\t\t\t// the new dimension is smaller than the list viewport, if we update the additional height, the `scrollBottom` will move up, which moves the whole list view upwards a bit. So we run a layout first.\n\t\t\tthis._list.layout(dimension.height - SCROLLABLE_ELEMENT_PADDING_TOP, dimension.width);\n\t\t\tthis._list.updateOptions({ additionalScrollHeight: this._scrollBeyondLastLine ? Math.max(0, (dimension.height - SCROLLABLE_ELEMENT_PADDING_TOP - 50)) : SCROLLABLE_ELEMENT_PADDING_TOP });\n\t\t}\n\n\t\tthis._overlayContainer.style.visibility = 'visible';\n\t\tthis._overlayContainer.style.display = 'block';\n\t\tthis._overlayContainer.style.position = 'absolute';\n\n\t\tconst containerRect = this._overlayContainer.parentElement?.getBoundingClientRect();\n\t\tthis._overlayContainer.style.top = `${this._shadowElementViewInfo!.top - (containerRect?.top || 0)}px`;\n\t\tthis._overlayContainer.style.left = `${this._shadowElementViewInfo!.left - (containerRect?.left || 0)}px`;\n\t\tthis._overlayContainer.style.width = `${dimension ? dimension.width : this._shadowElementViewInfo!.width}px`;\n\t\tthis._overlayContainer.style.height = `${dimension ? dimension.height : this._shadowElementViewInfo!.height}px`;\n\n\t\tif (this._webviewTransparentCover) {\n\t\t\tthis._webviewTransparentCover.style.height = `${dimension.height}px`;\n\t\t\tthis._webviewTransparentCover.style.width = `${dimension.width}px`;\n\t\t}\n\n\t\tthis._eventDispatcher?.emit([new NotebookLayoutChangedEvent({ width: true, fontInfo: true }, this.getLayoutInfo())]);\n\t}\n\t//#endregion\n\n\t//#region Focus tracker\n\tfocus() {\n\t\tthis._isVisible = true;\n\t\tthis._editorFocus.set(true);\n\n\t\tif (this._webiewFocused) {\n\t\t\tthis._webview?.focusWebview();\n\t\t} else {\n\t\t\tif (this.viewModel) {\n\t\t\t\tconst focusRange = this.viewModel.getFocus();\n\t\t\t\tconst element = this.viewModel.cellAt(focusRange.start);\n\n\t\t\t\tif (element && element.focusMode === CellFocusMode.Editor) {\n\t\t\t\t\telement.updateEditState(CellEditState.Editing, 'editorWidget.focus');\n\t\t\t\t\telement.focusMode = CellFocusMode.Editor;\n\t\t\t\t\tthis._onDidFocusEditorWidget.fire();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._list.domFocus();\n\t\t}\n\n\t\tthis._onDidFocusEditorWidget.fire();\n\t}\n\n\tonWillHide() {\n\t\tthis._isVisible = false;\n\t\tthis._editorFocus.set(false);\n\t\tthis._overlayContainer.style.visibility = 'hidden';\n\t\tthis._overlayContainer.style.left = '-50000px';\n\t}\n\n\tupdateEditorFocus() {\n\t\t// Note - focus going to the webview will fire 'blur', but the webview element will be\n\t\t// a descendent of the notebook editor root.\n\t\tconst focused = DOM.isAncestor(document.activeElement, this._overlayContainer);\n\t\tthis._editorFocus.set(focused);\n\t\tthis.viewModel?.setFocus(focused);\n\n\t\tif (!focused) {\n\t\t\tthis._editorToolbarDisposable.clear();\n\t\t\tthis._toolbarActionDisposable.clear();\n\t\t}\n\t}\n\n\thasFocus() {\n\t\treturn this._editorFocus.get() || false;\n\t}\n\n\thasWebviewFocus() {\n\t\treturn this._webiewFocused;\n\t}\n\n\thasOutputTextSelection() {\n\t\tif (!this.hasFocus()) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst windowSelection = window.getSelection();\n\t\tif (windowSelection?.rangeCount !== 1) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst activeSelection = windowSelection.getRangeAt(0);\n\t\tif (activeSelection.endOffset - activeSelection.startOffset === 0) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet container: any = activeSelection.commonAncestorContainer;\n\n\t\tif (!this._body.contains(container)) {\n\t\t\treturn false;\n\t\t}\n\n\t\twhile (container\n\t\t\t&&\n\t\t\tcontainer !== this._body) {\n\t\t\tif ((container as HTMLElement).classList && (container as HTMLElement).classList.contains('output')) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tcontainer = container.parentNode;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t//#endregion\n\n\t//#region Editor Features\n\n\tfocusElement(cell: ICellViewModel) {\n\t\tthis.viewModel?.updateSelectionsState({\n\t\t\tkind: SelectionStateType.Handle,\n\t\t\tprimary: cell.handle,\n\t\t\tselections: [cell.handle]\n\t\t});\n\t}\n\n\trevealCellRangeInView(range: ICellRange) {\n\t\treturn this._listViewInfoAccessor.revealCellRangeInView(range);\n\t}\n\n\trevealInView(cell: ICellViewModel) {\n\t\tthis._listViewInfoAccessor.revealInView(cell);\n\t}\n\n\trevealInViewAtTop(cell: ICellViewModel) {\n\t\tthis._listViewInfoAccessor.revealInViewAtTop(cell);\n\t}\n\n\trevealInCenterIfOutsideViewport(cell: ICellViewModel) {\n\t\tthis._listViewInfoAccessor.revealInCenterIfOutsideViewport(cell);\n\t}\n\n\tasync revealInCenterIfOutsideViewportAsync(cell: ICellViewModel) {\n\t\treturn this._listViewInfoAccessor.revealInCenterIfOutsideViewportAsync(cell);\n\t}\n\n\trevealInCenter(cell: ICellViewModel) {\n\t\tthis._listViewInfoAccessor.revealInCenter(cell);\n\t}\n\n\tasync revealLineInViewAsync(cell: ICellViewModel, line: number): Promise<void> {\n\t\treturn this._listViewInfoAccessor.revealLineInViewAsync(cell, line);\n\t}\n\n\tasync revealLineInCenterAsync(cell: ICellViewModel, line: number): Promise<void> {\n\t\treturn this._listViewInfoAccessor.revealLineInCenterAsync(cell, line);\n\t}\n\n\tasync revealLineInCenterIfOutsideViewportAsync(cell: ICellViewModel, line: number): Promise<void> {\n\t\treturn this._listViewInfoAccessor.revealLineInCenterIfOutsideViewportAsync(cell, line);\n\t}\n\n\tasync revealRangeInViewAsync(cell: ICellViewModel, range: Range): Promise<void> {\n\t\treturn this._listViewInfoAccessor.revealRangeInViewAsync(cell, range);\n\t}\n\n\tasync revealRangeInCenterAsync(cell: ICellViewModel, range: Range): Promise<void> {\n\t\treturn this._listViewInfoAccessor.revealRangeInCenterAsync(cell, range);\n\t}\n\n\tasync revealRangeInCenterIfOutsideViewportAsync(cell: ICellViewModel, range: Range): Promise<void> {\n\t\treturn this._listViewInfoAccessor.revealRangeInCenterIfOutsideViewportAsync(cell, range);\n\t}\n\n\tgetViewIndex(cell: ICellViewModel): number {\n\t\tif (!this._listViewInfoAccessor) {\n\t\t\treturn -1;\n\t\t}\n\t\treturn this._listViewInfoAccessor.getViewIndex(cell);\n\t}\n\n\tgetViewHeight(cell: ICellViewModel): number {\n\t\tif (!this._listViewInfoAccessor) {\n\t\t\treturn -1;\n\t\t}\n\n\t\treturn this._listViewInfoAccessor.getViewHeight(cell);\n\t}\n\n\tgetCellRangeFromViewRange(startIndex: number, endIndex: number): ICellRange | undefined {\n\t\treturn this._listViewInfoAccessor.getCellRangeFromViewRange(startIndex, endIndex);\n\t}\n\n\tgetCellsFromViewRange(startIndex: number, endIndex: number): ReadonlyArray<ICellViewModel> {\n\t\treturn this._listViewInfoAccessor.getCellsFromViewRange(startIndex, endIndex);\n\t}\n\n\tsetCellEditorSelection(cell: ICellViewModel, range: Range): void {\n\t\tthis._listViewInfoAccessor.setCellEditorSelection(cell, range);\n\t}\n\n\tsetHiddenAreas(_ranges: ICellRange[]): boolean {\n\t\treturn this._listViewInfoAccessor.setHiddenAreas(_ranges);\n\t}\n\n\tgetVisibleRangesPlusViewportAboveBelow(): ICellRange[] {\n\t\treturn this._listViewInfoAccessor.getVisibleRangesPlusViewportAboveBelow();\n\t}\n\n\ttriggerScroll(event: IMouseWheelEvent) {\n\t\tthis._listViewInfoAccessor.triggerScroll(event);\n\t}\n\n\t//#endregion\n\n\t//#region Decorations\n\tprivate _editorStyleSheets = new Map<string, NotebookRefCountedStyleSheet>();\n\tprivate _decorationRules = new Map<string, NotebookDecorationCSSRules>();\n\tprivate _decortionKeyToIds = new Map<string, string[]>();\n\n\tprivate _registerDecorationType(key: string) {\n\t\tconst options = this.notebookEditorService.resolveEditorDecorationOptions(key);\n\n\t\tif (options) {\n\t\t\tconst styleElement = DOM.createStyleSheet(this._body);\n\t\t\tconst styleSheet = new NotebookRefCountedStyleSheet({\n\t\t\t\tremoveEditorStyleSheets: (key) => {\n\t\t\t\t\tthis._editorStyleSheets.delete(key);\n\t\t\t\t}\n\t\t\t}, key, styleElement);\n\t\t\tthis._editorStyleSheets.set(key, styleSheet);\n\t\t\tthis._decorationRules.set(key, new NotebookDecorationCSSRules(this.themeService, styleSheet, {\n\t\t\t\tkey,\n\t\t\t\toptions,\n\t\t\t\tstyleSheet\n\t\t\t}));\n\t\t}\n\t}\n\n\tsetEditorDecorations(key: string, range: ICellRange): void {\n\t\tif (!this.viewModel) {\n\t\t\treturn;\n\t\t}\n\n\t\t// create css style for the decoration\n\t\tif (!this._editorStyleSheets.has(key)) {\n\t\t\tthis._registerDecorationType(key);\n\t\t}\n\n\t\tconst decorationRule = this._decorationRules.get(key);\n\t\tif (!decorationRule) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst existingDecorations = this._decortionKeyToIds.get(key) || [];\n\t\tconst newDecorations = this.viewModel.getCells(range).map(cell => ({\n\t\t\thandle: cell.handle,\n\t\t\toptions: { className: decorationRule.className, outputClassName: decorationRule.className, topClassName: decorationRule.topClassName }\n\t\t}));\n\n\t\tthis._decortionKeyToIds.set(key, this.deltaCellDecorations(existingDecorations, newDecorations));\n\t}\n\n\tremoveEditorDecorations(key: string): void {\n\t\tif (this._decorationRules.has(key)) {\n\t\t\tthis._decorationRules.get(key)?.dispose();\n\t\t}\n\n\t\tconst cellDecorations = this._decortionKeyToIds.get(key);\n\t\tthis.deltaCellDecorations(cellDecorations || [], []);\n\t}\n\n\tdeltaCellDecorations(oldDecorations: string[], newDecorations: INotebookDeltaDecoration[]): string[] {\n\t\treturn this.viewModel?.deltaCellDecorations(oldDecorations, newDecorations) || [];\n\t}\n\n\tdeltaCellOutputContainerClassNames(cellId: string, added: string[], removed: string[]) {\n\t\tthis._webview?.deltaCellOutputContainerClassNames(cellId, added, removed);\n\t}\n\n\tchangeModelDecorations<T>(callback: (changeAccessor: IModelDecorationsChangeAccessor) => T): T | null {\n\t\treturn this.viewModel?.changeModelDecorations<T>(callback) || null;\n\t}\n\n\t//#endregion\n\n\t//#region Mouse Events\n\tprivate readonly _onMouseUp: Emitter<INotebookEditorMouseEvent> = this._register(new Emitter<INotebookEditorMouseEvent>());\n\tpublic readonly onMouseUp: Event<INotebookEditorMouseEvent> = this._onMouseUp.event;\n\n\tprivate readonly _onMouseDown: Emitter<INotebookEditorMouseEvent> = this._register(new Emitter<INotebookEditorMouseEvent>());\n\tpublic readonly onMouseDown: Event<INotebookEditorMouseEvent> = this._onMouseDown.event;\n\n\t//#endregion\n\n\t//#region Kernel/Execution\n\n\tprivate async _loadKernelPreloads() {\n\t\tconst kernel = this.activeKernel;\n\t\tif (!kernel) {\n\t\t\treturn;\n\t\t}\n\t\tconst preloadUris = kernel.preloadUris;\n\t\tif (!preloadUris.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._webview?.isResolved()) {\n\t\t\tawait this._resolveWebview();\n\t\t}\n\n\t\tthis._webview?.updateKernelPreloads([kernel.localResourceRoot], kernel.preloadUris);\n\t}\n\n\tget activeKernel() {\n\t\treturn this.viewModel && this._kernelManger.getSelectedOrSuggestedKernel(this.viewModel.notebookDocument);\n\t}\n\n\tasync cancelNotebookCells(cells?: Iterable<ICellViewModel>): Promise<void> {\n\t\tif (!this.hasModel()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!cells) {\n\t\t\tcells = this.viewModel.viewCells;\n\t\t}\n\t\treturn this._kernelManger.cancelNotebookCells(this.viewModel.notebookDocument, cells);\n\t}\n\n\tasync executeNotebookCells(cells?: Iterable<ICellViewModel>): Promise<void> {\n\t\tif (!this.hasModel()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!cells) {\n\t\t\tcells = this.viewModel.viewCells;\n\t\t}\n\t\treturn this._kernelManger.executeNotebookCells(this.viewModel.notebookDocument, cells);\n\t}\n\n\t//#endregion\n\n\t//#region Cell operations/layout API\n\tprivate _pendingLayouts = new WeakMap<ICellViewModel, IDisposable>();\n\tasync layoutNotebookCell(cell: ICellViewModel, height: number): Promise<void> {\n\t\tthis._debug('layout cell', cell.handle, height);\n\t\tconst viewIndex = this._list.getViewIndex(cell);\n\t\tif (viewIndex === undefined) {\n\t\t\t// the cell is hidden\n\t\t\treturn;\n\t\t}\n\n\t\tconst relayout = (cell: ICellViewModel, height: number) => {\n\t\t\tif (this._isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._list.updateElementHeight2(cell, height);\n\t\t};\n\n\t\tif (this._pendingLayouts.has(cell)) {\n\t\t\tthis._pendingLayouts.get(cell)!.dispose();\n\t\t}\n\n\t\tlet r: () => void;\n\t\tconst layoutDisposable = DOM.scheduleAtNextAnimationFrame(() => {\n\t\t\tif (this._isDisposed) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this._list.elementHeight(cell) === height) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._pendingLayouts.delete(cell);\n\n\t\t\trelayout(cell, height);\n\t\t\tr();\n\t\t});\n\n\t\tthis._pendingLayouts.set(cell, toDisposable(() => {\n\t\t\tlayoutDisposable.dispose();\n\t\t\tr();\n\t\t}));\n\n\t\treturn new Promise(resolve => { r = resolve; });\n\t}\n\n\tprivate _nearestCodeCellIndex(index: number /* exclusive */) {\n\t\tif (!this.viewModel) {\n\t\t\treturn -1;\n\t\t}\n\n\t\treturn this.viewModel.nearestCodeCellIndex(index);\n\t}\n\n\tinsertNotebookCell(cell: ICellViewModel | undefined, type: CellKind, direction: 'above' | 'below' = 'above', initialText: string = '', ui: boolean = false): CellViewModel | null {\n\t\tif (!this.viewModel) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.viewModel.options.isReadOnly) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst index = cell ? this.viewModel.getCellIndex(cell) : 0;\n\t\tconst nextIndex = ui ? this.viewModel.getNextVisibleCellIndex(index) : index + 1;\n\t\tlet language;\n\t\tif (type === CellKind.Code) {\n\t\t\tconst supportedLanguages = this.activeKernel?.supportedLanguages ?? this.modeService.getRegisteredModes();\n\t\t\tconst defaultLanguage = supportedLanguages[0] || 'plaintext';\n\t\t\tif (cell?.cellKind === CellKind.Code) {\n\t\t\t\tlanguage = cell.language;\n\t\t\t} else if (cell?.cellKind === CellKind.Markdown) {\n\t\t\t\tconst nearestCodeCellIndex = this._nearestCodeCellIndex(index);\n\t\t\t\tif (nearestCodeCellIndex > -1) {\n\t\t\t\t\tlanguage = this.viewModel.cellAt(nearestCodeCellIndex)!.language;\n\t\t\t\t} else {\n\t\t\t\t\tlanguage = defaultLanguage;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (cell === undefined && direction === 'above') {\n\t\t\t\t\t// insert cell at the very top\n\t\t\t\t\tlanguage = this.viewModel.viewCells.find(cell => cell.cellKind === CellKind.Code)?.language || defaultLanguage;\n\t\t\t\t} else {\n\t\t\t\t\tlanguage = defaultLanguage;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!supportedLanguages.includes(language)) {\n\t\t\t\t// the language no longer exists\n\t\t\t\tlanguage = defaultLanguage;\n\t\t\t}\n\t\t} else {\n\t\t\tlanguage = 'markdown';\n\t\t}\n\n\t\tconst insertIndex = cell ?\n\t\t\t(direction === 'above' ? index : nextIndex) :\n\t\t\tindex;\n\t\tconst focused = this._list.getFocusedElements();\n\t\tconst selections = this._list.getSelectedElements();\n\t\treturn this.viewModel.createCell(insertIndex, initialText, language, type, undefined, [], true, undefined, focused[0]?.handle ?? null, selections);\n\t}\n\n\tasync splitNotebookCell(cell: ICellViewModel): Promise<CellViewModel[] | null> {\n\t\tif (!this.viewModel) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.viewModel.options.isReadOnly) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst index = this.viewModel.getCellIndex(cell);\n\n\t\treturn this.viewModel.splitNotebookCell(index);\n\t}\n\n\tasync deleteNotebookCell(cell: ICellViewModel): Promise<boolean> {\n\t\tif (!this.viewModel) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.viewModel.options.isReadOnly) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this._pendingLayouts.has(cell)) {\n\t\t\tthis._pendingLayouts.get(cell)!.dispose();\n\t\t}\n\n\t\tconst index = this.viewModel.getCellIndex(cell);\n\t\tthis.viewModel.deleteCell(index, true);\n\t\treturn true;\n\t}\n\n\tasync moveCellDown(cell: ICellViewModel): Promise<ICellViewModel | null> {\n\t\tif (!this.viewModel) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.viewModel.options.isReadOnly) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst index = this.viewModel.getCellIndex(cell);\n\t\tif (index === this.viewModel.length - 1) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst newIdx = index + 2; // This is the adjustment for the index before the cell has been \"removed\" from its original index\n\t\treturn this._moveCellToIndex(index, 1, newIdx);\n\t}\n\n\tasync moveCellUp(cell: ICellViewModel): Promise<ICellViewModel | null> {\n\t\tif (!this.viewModel) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.viewModel.options.isReadOnly) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst index = this.viewModel.getCellIndex(cell);\n\t\tif (index === 0) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst newIdx = index - 1;\n\t\treturn this._moveCellToIndex(index, 1, newIdx);\n\t}\n\n\tasync moveCellsToIdx(index: number, length: number, toIdx: number): Promise<ICellViewModel | null> {\n\t\tif (!this.viewModel) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this.viewModel.options.isReadOnly) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn this._moveCellToIndex(index, length, toIdx);\n\t}\n\n\t/**\n\t * @param index The current index of the cell\n\t * @param desiredIndex The desired index, in an index scheme for the state of the tree before the current cell has been \"removed\".\n\t * @example to move the cell from index 0 down one spot, call with (0, 2)\n\t */\n\tprivate async _moveCellToIndex(index: number, length: number, desiredIndex: number): Promise<ICellViewModel | null> {\n\t\tif (!this.viewModel) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (index < desiredIndex) {\n\t\t\t// The cell is moving \"down\", it will free up one index spot and consume a new one\n\t\t\tdesiredIndex -= length;\n\t\t}\n\n\t\tif (index === desiredIndex) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (!this.viewModel.moveCellToIdx(index, length, desiredIndex, true)) {\n\t\t\tthrow new Error('Notebook Editor move cell, index out of range');\n\t\t}\n\n\t\t// this._list.move(index, desiredIndex);\n\n\t\tlet r: (val: ICellViewModel | null) => void;\n\t\tDOM.scheduleAtNextAnimationFrame(() => {\n\t\t\tif (this._isDisposed) {\n\t\t\t\tr(null);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this.viewModel) {\n\t\t\t\tr(null);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst viewCell = this.viewModel.cellAt(desiredIndex);\n\t\t\tif (viewCell) {\n\t\t\t\tthis._list.revealElementInView(viewCell);\n\t\t\t\tr(viewCell);\n\t\t\t} else {\n\t\t\t\tr(null);\n\t\t\t}\n\t\t});\n\n\t\treturn new Promise(resolve => { r = resolve; });\n\t}\n\n\tgetActiveCell() {\n\t\tconst elements = this._list.getFocusedElements();\n\n\t\tif (elements && elements.length) {\n\t\t\treturn elements[0];\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tprivate _cellFocusAria(cell: ICellViewModel, focusItem: 'editor' | 'container' | 'output') {\n\t\tconst index = this._notebookViewModel?.getCellIndex(cell);\n\n\t\tif (index !== undefined && index >= 0) {\n\t\t\tlet position = '';\n\t\t\tswitch (focusItem) {\n\t\t\t\tcase 'editor':\n\t\t\t\t\tposition = `the inner ${cell.cellKind === CellKind.Markdown ? 'markdown' : 'code'} editor is focused, press escape to focus the cell container`;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'output':\n\t\t\t\t\tposition = `the cell output is focused, press escape to focus the cell container`;\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'container':\n\t\t\t\t\tposition = `the ${cell.cellKind === CellKind.Markdown ? 'markdown preview' : 'cell container'} is focused, press enter to focus the inner ${cell.cellKind === CellKind.Markdown ? 'markdown' : 'code'} editor`;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\taria.alert(`Cell ${this._notebookViewModel?.getCellIndex(cell)}, ${position} `);\n\t\t}\n\t}\n\n\ttoggleNotebookCellSelection(cell: ICellViewModel): void {\n\t\tconst currentSelections = this._list.getSelectedElements();\n\n\t\tconst isSelected = currentSelections.includes(cell);\n\t\tif (isSelected) {\n\t\t\t// Deselect\n\t\t\tthis._list.selectElements(currentSelections.filter(current => current !== cell));\n\t\t} else {\n\t\t\t// Add to selection\n\t\t\tthis._list.selectElements([...currentSelections, cell]);\n\t\t}\n\t}\n\n\tfocusNotebookCell(cell: ICellViewModel, focusItem: 'editor' | 'container' | 'output', options?: IFocusNotebookCellOptions) {\n\t\tif (this._isDisposed) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (focusItem === 'editor') {\n\t\t\tthis.focusElement(cell);\n\t\t\tthis._cellFocusAria(cell, focusItem);\n\t\t\tthis._list.focusView();\n\n\t\t\tcell.updateEditState(CellEditState.Editing, 'focusNotebookCell');\n\t\t\tcell.focusMode = CellFocusMode.Editor;\n\t\t\tif (!options?.skipReveal) {\n\t\t\t\tthis.revealInCenterIfOutsideViewport(cell);\n\t\t\t}\n\t\t} else if (focusItem === 'output') {\n\t\t\tthis.focusElement(cell);\n\t\t\tthis._cellFocusAria(cell, focusItem);\n\t\t\tthis._list.focusView();\n\n\t\t\tif (!this._webview) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._webview.focusOutput(cell.id);\n\n\t\t\tcell.updateEditState(CellEditState.Preview, 'focusNotebookCell');\n\t\t\tcell.focusMode = CellFocusMode.Container;\n\t\t\tif (!options?.skipReveal) {\n\t\t\t\tthis.revealInCenterIfOutsideViewport(cell);\n\t\t\t}\n\t\t} else {\n\t\t\tconst itemDOM = this._list.domElementOfElement(cell);\n\t\t\tif (document.activeElement && itemDOM && itemDOM.contains(document.activeElement)) {\n\t\t\t\t(document.activeElement as HTMLElement).blur();\n\t\t\t}\n\n\t\t\tcell.updateEditState(CellEditState.Preview, 'focusNotebookCell');\n\t\t\tcell.focusMode = CellFocusMode.Container;\n\n\t\t\tthis.focusElement(cell);\n\t\t\tthis._cellFocusAria(cell, focusItem);\n\t\t\tif (!options?.skipReveal) {\n\t\t\t\tthis.revealInCenterIfOutsideViewport(cell);\n\t\t\t}\n\t\t\tthis._list.focusView();\n\t\t}\n\t}\n\n\tfocusNextNotebookCell(cell: ICellViewModel, focusItem: 'editor' | 'container' | 'output') {\n\t\tconst idx = this.viewModel?.getCellIndex(cell);\n\t\tif (typeof idx !== 'number') {\n\t\t\treturn;\n\t\t}\n\n\t\tconst newCell = this.viewModel?.cellAt(idx + 1);\n\t\tif (!newCell) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.focusNotebookCell(newCell, focusItem);\n\t}\n\n\t//#endregion\n\n\t//#region MISC\n\n\tgetLayoutInfo(): NotebookLayoutInfo {\n\t\tif (!this._list) {\n\t\t\tthrow new Error('Editor is not initalized successfully');\n\t\t}\n\n\t\treturn {\n\t\t\twidth: this._dimension!.width,\n\t\t\theight: this._dimension!.height,\n\t\t\tfontInfo: this._fontInfo!\n\t\t};\n\t}\n\n\tgetCellOutputLayoutInfo(cell: IGenericCellViewModel): INotebookCellOutputLayoutInfo {\n\t\tif (!this._list) {\n\t\t\tthrow new Error('Editor is not initalized successfully');\n\t\t}\n\n\t\treturn {\n\t\t\twidth: this._dimension!.width,\n\t\t\theight: this._dimension!.height,\n\t\t\tfontInfo: this._fontInfo!\n\t\t};\n\t}\n\n\tasync createMarkdownPreview(cell: MarkdownCellViewModel) {\n\t\tif (!this.useRenderer) {\n\t\t\t// TODO: handle case where custom renderer is disabled?\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._webview) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._webview.isResolved()) {\n\t\t\tawait this._resolveWebview();\n\t\t}\n\n\t\tif (!this._webview) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cellTop = this._list.getAbsoluteTopOfElement(cell);\n\t\tawait this._webview.showMarkdownPreview(cell.id, cell.handle, cell.getText(), cellTop, cell.contentHash);\n\t}\n\n\tasync unhideMarkdownPreviews(cells: readonly MarkdownCellViewModel[]) {\n\t\tif (!this.useRenderer) {\n\t\t\t// TODO: handle case where custom renderer is disabled?\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._webview) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._webview.isResolved()) {\n\t\t\tawait this._resolveWebview();\n\t\t}\n\n\t\tawait this._webview?.unhideMarkdownPreviews(cells.map(cell => cell.id));\n\t}\n\n\tasync hideMarkdownPreviews(cells: readonly MarkdownCellViewModel[]) {\n\t\tif (!this.useRenderer) {\n\t\t\t// TODO: handle case where custom renderer is disabled?\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._webview || !cells.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._webview.isResolved()) {\n\t\t\tawait this._resolveWebview();\n\t\t}\n\n\t\tawait this._webview?.hideMarkdownPreviews(cells.map(cell => cell.id));\n\t}\n\n\tasync deleteMarkdownPreviews(cells: readonly MarkdownCellViewModel[]) {\n\t\tif (!this.useRenderer) {\n\t\t\t// TODO: handle case where custom renderer is disabled?\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._webview) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._webview.isResolved()) {\n\t\t\tawait this._resolveWebview();\n\t\t}\n\n\t\tawait this._webview?.deleteMarkdownPreviews(cells.map(cell => cell.id));\n\t}\n\n\tprivate async updateSelectedMarkdownPreviews(): Promise<void> {\n\t\tif (!this.useRenderer || !this._webview) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._webview.isResolved()) {\n\t\t\tawait this._resolveWebview();\n\t\t}\n\n\t\tconst selectedCells = this.getSelectionViewModels().map(cell => cell.id);\n\n\t\t// Only show selection when there is more than 1 cell selected\n\t\tawait this._webview?.updateMarkdownPreviewSelections(selectedCells.length > 1 ? selectedCells : []);\n\t}\n\n\tasync createOutput(cell: CodeCellViewModel, output: IInsetRenderOutput, offset: number): Promise<void> {\n\t\tthis._insetModifyQueueByOutputId.queue(output.source.model.outputId, async () => {\n\t\t\tif (!this._webview) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!this._webview.isResolved()) {\n\t\t\t\tawait this._resolveWebview();\n\t\t\t}\n\n\t\t\tif (!this._webview) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst cellTop = this._list.getAbsoluteTopOfElement(cell);\n\t\t\tif (!this._webview.insetMapping.has(output.source)) {\n\t\t\t\tawait this._webview.createOutput({ cellId: cell.id, cellHandle: cell.handle, cellUri: cell.uri }, output, cellTop, offset);\n\t\t\t} else {\n\t\t\t\tconst outputIndex = cell.outputsViewModels.indexOf(output.source);\n\t\t\t\tconst outputOffset = cell.getOutputOffset(outputIndex);\n\t\t\t\tthis._webview.updateScrollTops([{\n\t\t\t\t\tcell,\n\t\t\t\t\toutput: output.source,\n\t\t\t\t\tcellTop,\n\t\t\t\t\toutputOffset,\n\t\t\t\t\tforceDisplay: !cell.metadata.outputCollapsed,\n\t\t\t\t}], []);\n\t\t\t}\n\t\t});\n\t}\n\n\tremoveInset(output: ICellOutputViewModel) {\n\t\tthis._insetModifyQueueByOutputId.queue(output.model.outputId, async () => {\n\t\t\tif (this._webview?.isResolved()) {\n\t\t\t\tthis._webview.removeInsets([output]);\n\t\t\t}\n\t\t});\n\t}\n\n\thideInset(output: ICellOutputViewModel) {\n\t\tif (this._webview?.isResolved()) {\n\t\t\tthis._insetModifyQueueByOutputId.queue(output.model.outputId, async () => {\n\t\t\t\tthis._webview!.hideInset(output);\n\t\t\t});\n\t\t}\n\t}\n\n\tgetOutputRenderer(): OutputRenderer {\n\t\treturn this._outputRenderer;\n\t}\n\n\t//#region --- webview IPC ----\n\n\tprivate readonly _onDidReceiveMessage = new Emitter<INotebookWebviewMessage>();\n\n\treadonly onDidReceiveMessage: Event<INotebookWebviewMessage> = this._onDidReceiveMessage.event;\n\n\tpostMessage(forRendererId: string | undefined, message: any) {\n\t\tif (this._webview?.isResolved()) {\n\t\t\tif (forRendererId === undefined) {\n\t\t\t\tthis._webview.webview.postMessage(message);\n\t\t\t} else {\n\t\t\t\tthis._webview.postRendererMessage(forRendererId, message);\n\t\t\t}\n\t\t}\n\t}\n\n\t//#endregion\n\n\taddClassName(className: string) {\n\t\tthis._overlayContainer.classList.add(className);\n\t}\n\n\tremoveClassName(className: string) {\n\t\tthis._overlayContainer.classList.remove(className);\n\t}\n\n\tgetCellByInfo(cellInfo: ICommonCellInfo): ICellViewModel {\n\t\tconst { cellHandle } = cellInfo;\n\t\treturn this.viewModel?.viewCells.find(vc => vc.handle === cellHandle) as CodeCellViewModel;\n\t}\n\n\tgetCellById(cellId: string): ICellViewModel | undefined {\n\t\treturn this.viewModel?.viewCells.find(vc => vc.id === cellId);\n\t}\n\n\tupdateOutputHeight(cellInfo: ICommonCellInfo, output: ICellOutputViewModel, outputHeight: number, isInit: boolean, source?: string): void {\n\t\tconst cell = this.viewModel?.viewCells.find(vc => vc.handle === cellInfo.cellHandle);\n\t\tif (cell && cell instanceof CodeCellViewModel) {\n\t\t\tconst outputIndex = cell.outputsViewModels.indexOf(output);\n\t\t\tif (isInit && outputHeight !== 0) {\n\t\t\t\tcell.updateOutputMinHeight(0);\n\t\t\t}\n\t\t\tthis._debug('update cell output', cell.handle, outputHeight);\n\t\t\tcell.updateOutputHeight(outputIndex, outputHeight, source);\n\t\t\tthis.layoutNotebookCell(cell, cell.layoutInfo.totalHeight);\n\t\t}\n\t}\n\n\tupdateScrollHeight() {\n\t\tif (this._isDisposed || !this._webview?.isResolved()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst scrollHeight = this._list.scrollHeight;\n\t\tthis._webview!.element.style.height = `${scrollHeight}px`;\n\n\t\tconst updateItems: IDisplayOutputLayoutUpdateRequest[] = [];\n\t\tconst removedItems: ICellOutputViewModel[] = [];\n\t\tthis._webview?.insetMapping.forEach((value, key) => {\n\t\t\tconst cell = this.viewModel?.getCellByHandle(value.cellInfo.cellHandle);\n\t\t\tif (!cell || !(cell instanceof CodeCellViewModel)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.viewModel?.viewCells.find(cell => cell.handle === value.cellInfo.cellHandle);\n\t\t\tconst viewIndex = this._list.getViewIndex(cell);\n\n\t\t\tif (viewIndex === undefined) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (cell.outputsViewModels.indexOf(key) < 0) {\n\t\t\t\t// output is already gone\n\t\t\t\tremovedItems.push(key);\n\t\t\t}\n\n\t\t\tconst cellTop = this._list.getAbsoluteTopOfElement(cell);\n\t\t\tconst outputIndex = cell.outputsViewModels.indexOf(key);\n\t\t\tconst outputOffset = cell.getOutputOffset(outputIndex);\n\t\t\tupdateItems.push({\n\t\t\t\tcell,\n\t\t\t\toutput: key,\n\t\t\t\tcellTop,\n\t\t\t\toutputOffset,\n\t\t\t\tforceDisplay: false,\n\t\t\t});\n\t\t});\n\n\t\tthis._webview.removeInsets(removedItems);\n\n\t\tconst markdownUpdateItems: { id: string, top: number }[] = [];\n\t\tfor (const cellId of this._webview.markdownPreviewMapping.keys()) {\n\t\t\tconst cell = this.viewModel?.viewCells.find(cell => cell.id === cellId);\n\t\t\tif (cell) {\n\t\t\t\tconst cellTop = this._list.getAbsoluteTopOfElement(cell);\n\t\t\t\tmarkdownUpdateItems.push({ id: cellId, top: cellTop });\n\t\t\t}\n\t\t}\n\n\t\tif (markdownUpdateItems.length || updateItems.length) {\n\t\t\tthis._debug('_list.onDidChangeContentHeight/markdown', markdownUpdateItems);\n\t\t\tthis._webview?.updateScrollTops(updateItems, markdownUpdateItems);\n\t\t}\n\t}\n\n\tscheduleOutputHeightAck(cellInfo: ICommonCellInfo, outputId: string, height: number) {\n\t\tDOM.scheduleAtNextAnimationFrame(() => {\n\t\t\tthis.updateScrollHeight();\n\n\t\t\tthis._debug('ack height', height);\n\t\t\tthis._webview?.ackHeight(cellInfo.cellId, outputId, height);\n\t\t}, 10);\n\t}\n\n\tupdateMarkdownCellHeight(cellId: string, height: number, isInit: boolean) {\n\t\tconst cell = this.getCellById(cellId);\n\t\tif (cell && cell instanceof MarkdownCellViewModel) {\n\t\t\tif (height + BOTTOM_CELL_TOOLBAR_GAP !== cell.layoutInfo.totalHeight) {\n\t\t\t\tthis._debug('updateMarkdownCellHeight', cell.handle, height + BOTTOM_CELL_TOOLBAR_GAP, isInit);\n\t\t\t\tcell.renderedMarkdownHeight = height;\n\t\t\t}\n\t\t}\n\t}\n\n\tsetMarkdownCellEditState(cellId: string, editState: CellEditState): void {\n\t\tconst cell = this.getCellById(cellId);\n\t\tif (cell instanceof MarkdownCellViewModel) {\n\t\t\tcell.updateEditState(editState, 'setMarkdownCellEditState');\n\t\t}\n\t}\n\n\tmarkdownCellDragStart(cellId: string, ctx: { clientY: number }): void {\n\t\tconst cell = this.getCellById(cellId);\n\t\tif (cell instanceof MarkdownCellViewModel) {\n\t\t\tthis._dndController?.startExplicitDrag(cell, ctx);\n\t\t}\n\t}\n\n\tmarkdownCellDrag(cellId: string, ctx: { clientY: number }): void {\n\t\tconst cell = this.getCellById(cellId);\n\t\tif (cell instanceof MarkdownCellViewModel) {\n\t\t\tthis._dndController?.explicitDrag(cell, ctx);\n\t\t}\n\t}\n\n\tmarkdownCellDrop(cellId: string, ctx: { clientY: number, ctrlKey: boolean, altKey: boolean }): void {\n\t\tconst cell = this.getCellById(cellId);\n\t\tif (cell instanceof MarkdownCellViewModel) {\n\t\t\tthis._dndController?.explicitDrop(cell, ctx);\n\t\t}\n\t}\n\n\tmarkdownCellDragEnd(cellId: string): void {\n\t\tconst cell = this.getCellById(cellId);\n\t\tif (cell instanceof MarkdownCellViewModel) {\n\t\t\tthis._dndController?.endExplicitDrag(cell);\n\t\t}\n\t}\n\n\t//#endregion\n\n\t//#region Editor Contributions\n\tgetContribution<T extends INotebookEditorContribution>(id: string): T {\n\t\treturn <T>(this._contributions.get(id) || null);\n\t}\n\n\t//#endregion\n\n\toverride dispose() {\n\t\tthis._isDisposed = true;\n\t\t// dispose webview first\n\t\tthis._webview?.dispose();\n\t\tthis._webview = null;\n\n\t\tthis.notebookEditorService.removeNotebookEditor(this);\n\t\tdispose(this._contributions.values());\n\t\tthis._contributions.clear();\n\n\t\tthis._localStore.clear();\n\t\tdispose(this._localCellStateListeners);\n\t\tthis._list.dispose();\n\t\tthis._listTopCellToolbar?.dispose();\n\n\t\tthis._overlayContainer.remove();\n\t\tthis.viewModel?.dispose();\n\t\tsuper.dispose();\n\t}\n\n\ttoJSON(): { notebookUri: URI | undefined } {\n\t\treturn {\n\t\t\tnotebookUri: this.viewModel?.uri,\n\t\t};\n\t}\n}\n\nexport const notebookCellBorder = registerColor('notebook.cellBorderColor', {\n\tdark: transparent(listInactiveSelectionBackground, 1),\n\tlight: transparent(listInactiveSelectionBackground, 1),\n\thc: PANEL_BORDER\n}, nls.localize('notebook.cellBorderColor', \"The border color for notebook cells.\"));\n\nexport const focusedEditorBorderColor = registerColor('notebook.focusedEditorBorder', {\n\tlight: focusBorder,\n\tdark: focusBorder,\n\thc: focusBorder\n}, nls.localize('notebook.focusedEditorBorder', \"The color of the notebook cell editor border.\"));\n\nexport const cellStatusIconSuccess = registerColor('notebookStatusSuccessIcon.foreground', {\n\tlight: debugIconStartForeground,\n\tdark: debugIconStartForeground,\n\thc: debugIconStartForeground\n}, nls.localize('notebookStatusSuccessIcon.foreground', \"The error icon color of notebook cells in the cell status bar.\"));\n\nexport const cellStatusIconError = registerColor('notebookStatusErrorIcon.foreground', {\n\tlight: errorForeground,\n\tdark: errorForeground,\n\thc: errorForeground\n}, nls.localize('notebookStatusErrorIcon.foreground', \"The error icon color of notebook cells in the cell status bar.\"));\n\nexport const cellStatusIconRunning = registerColor('notebookStatusRunningIcon.foreground', {\n\tlight: foreground,\n\tdark: foreground,\n\thc: foreground\n}, nls.localize('notebookStatusRunningIcon.foreground', \"The running icon color of notebook cells in the cell status bar.\"));\n\nexport const notebookOutputContainerColor = registerColor('notebook.outputContainerBackgroundColor', {\n\tdark: notebookCellBorder,\n\tlight: notebookCellBorder,\n\thc: null\n}, nls.localize('notebook.outputContainerBackgroundColor', \"The Color of the notebook output container background.\"));\n\n// TODO@rebornix currently also used for toolbar border, if we keep all of this, pick a generic name\nexport const CELL_TOOLBAR_SEPERATOR = registerColor('notebook.cellToolbarSeparator', {\n\tdark: Color.fromHex('#808080').transparent(0.35),\n\tlight: Color.fromHex('#808080').transparent(0.35),\n\thc: contrastBorder\n}, nls.localize('notebook.cellToolbarSeparator', \"The color of the separator in the cell bottom toolbar\"));\n\nexport const focusedCellBackground = registerColor('notebook.focusedCellBackground', {\n\tdark: null,\n\tlight: null,\n\thc: null\n}, nls.localize('focusedCellBackground', \"The background color of a cell when the cell is focused.\"));\n\nexport const selectedCellBackground = registerColor('notebook.selectedCellBackground', {\n\tdark: listInactiveSelectionBackground,\n\tlight: listInactiveSelectionBackground,\n\thc: null\n}, nls.localize('selectedCellBackground', \"The background color of a cell when the cell is selected.\"));\n\n\nexport const cellHoverBackground = registerColor('notebook.cellHoverBackground', {\n\tdark: transparent(focusedCellBackground, .5),\n\tlight: transparent(focusedCellBackground, .7),\n\thc: null\n}, nls.localize('notebook.cellHoverBackground', \"The background color of a cell when the cell is hovered.\"));\n\nexport const selectedCellBorder = registerColor('notebook.selectedCellBorder', {\n\tdark: notebookCellBorder,\n\tlight: notebookCellBorder,\n\thc: contrastBorder\n}, nls.localize('notebook.selectedCellBorder', \"The color of the cell's top and bottom border when the cell is selected but not focused.\"));\n\nexport const inactiveSelectedCellBorder = registerColor('notebook.inactiveSelectedCellBorder', {\n\tdark: null,\n\tlight: null,\n\thc: focusBorder\n}, nls.localize('notebook.inactiveSelectedCellBorder', \"The color of the cell's borders when multiple cells are selected.\"));\n\nexport const focusedCellBorder = registerColor('notebook.focusedCellBorder', {\n\tdark: focusBorder,\n\tlight: focusBorder,\n\thc: focusBorder\n}, nls.localize('notebook.focusedCellBorder', \"The color of the cell's borders when the cell is focused.\"));\n\nexport const inactiveFocusedCellBorder = registerColor('notebook.inactiveFocusedCellBorder', {\n\tdark: notebookCellBorder,\n\tlight: notebookCellBorder,\n\thc: notebookCellBorder\n}, nls.localize('notebook.inactiveFocusedCellBorder', \"The color of the cell's top and bottom border when a cell is focused while the primary focus is outside of the editor.\"));\n\nexport const cellStatusBarItemHover = registerColor('notebook.cellStatusBarItemHoverBackground', {\n\tlight: new Color(new RGBA(0, 0, 0, 0.08)),\n\tdark: new Color(new RGBA(255, 255, 255, 0.15)),\n\thc: new Color(new RGBA(255, 255, 255, 0.15)),\n}, nls.localize('notebook.cellStatusBarItemHoverBackground', \"The background color of notebook cell status bar items.\"));\n\nexport const cellInsertionIndicator = registerColor('notebook.cellInsertionIndicator', {\n\tlight: focusBorder,\n\tdark: focusBorder,\n\thc: focusBorder\n}, nls.localize('notebook.cellInsertionIndicator', \"The color of the notebook cell insertion indicator.\"));\n\nexport const listScrollbarSliderBackground = registerColor('notebookScrollbarSlider.background', {\n\tdark: scrollbarSliderBackground,\n\tlight: scrollbarSliderBackground,\n\thc: scrollbarSliderBackground\n}, nls.localize('notebookScrollbarSliderBackground', \"Notebook scrollbar slider background color.\"));\n\nexport const listScrollbarSliderHoverBackground = registerColor('notebookScrollbarSlider.hoverBackground', {\n\tdark: scrollbarSliderHoverBackground,\n\tlight: scrollbarSliderHoverBackground,\n\thc: scrollbarSliderHoverBackground\n}, nls.localize('notebookScrollbarSliderHoverBackground', \"Notebook scrollbar slider background color when hovering.\"));\n\nexport const listScrollbarSliderActiveBackground = registerColor('notebookScrollbarSlider.activeBackground', {\n\tdark: scrollbarSliderActiveBackground,\n\tlight: scrollbarSliderActiveBackground,\n\thc: scrollbarSliderActiveBackground\n}, nls.localize('notebookScrollbarSliderActiveBackground', \"Notebook scrollbar slider background color when clicked on.\"));\n\nexport const cellSymbolHighlight = registerColor('notebook.symbolHighlightBackground', {\n\tdark: Color.fromHex('#ffffff0b'),\n\tlight: Color.fromHex('#fdff0033'),\n\thc: null\n}, nls.localize('notebook.symbolHighlightBackground', \"Background color of highlighted cell\"));\n\nregisterThemingParticipant((theme, collector) => {\n\tcollector.addRule(`.notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element,\n\t.notebookOverlay > .cell-list-container > .notebook-gutter > .monaco-list > .monaco-scrollable-element {\n\t\tpadding-top: ${SCROLLABLE_ELEMENT_PADDING_TOP}px;\n\t\tbox-sizing: border-box;\n\t}`);\n\n\tconst link = theme.getColor(textLinkForeground);\n\tif (link) {\n\t\tcollector.addRule(`.notebookOverlay .output a,\n\t\t\t.notebookOverlay .cell.markdown a,\n\t\t\t.notebookOverlay .output-show-more-container a\n\t\t\t{ color: ${link};} `);\n\n\t}\n\tconst activeLink = theme.getColor(textLinkActiveForeground);\n\tif (activeLink) {\n\t\tcollector.addRule(`.notebookOverlay .output a:hover,\n\t\t\t.notebookOverlay .cell .output a:active,\n\t\t\t.notebookOverlay .output-show-more-container a:active\n\t\t\t{ color: ${activeLink}; }`);\n\t}\n\tconst shortcut = theme.getColor(textPreformatForeground);\n\tif (shortcut) {\n\t\tcollector.addRule(`.notebookOverlay code,\n\t\t\t.notebookOverlay .shortcut { color: ${shortcut}; }`);\n\t}\n\tconst border = theme.getColor(contrastBorder);\n\tif (border) {\n\t\tcollector.addRule(`.notebookOverlay .monaco-editor { border-color: ${border}; }`);\n\t}\n\tconst quoteBackground = theme.getColor(textBlockQuoteBackground);\n\tif (quoteBackground) {\n\t\tcollector.addRule(`.notebookOverlay blockquote { background: ${quoteBackground}; }`);\n\t}\n\tconst quoteBorder = theme.getColor(textBlockQuoteBorder);\n\tif (quoteBorder) {\n\t\tcollector.addRule(`.notebookOverlay blockquote { border-color: ${quoteBorder}; }`);\n\t}\n\n\tconst containerBackground = theme.getColor(notebookOutputContainerColor);\n\tif (containerBackground) {\n\t\tcollector.addRule(`.notebookOverlay .output { background-color: ${containerBackground}; }`);\n\t\tcollector.addRule(`.notebookOverlay .output-element { background-color: ${containerBackground}; }`);\n\t\tcollector.addRule(`.notebookOverlay .output-show-more-container { background-color: ${containerBackground}; }`);\n\t}\n\n\tconst editorBackgroundColor = theme.getColor(editorBackground);\n\tif (editorBackgroundColor) {\n\t\tcollector.addRule(`.notebookOverlay .cell .monaco-editor-background,\n\t\t\t.notebookOverlay .cell .margin-view-overlays,\n\t\t\t.notebookOverlay .cell .cell-statusbar-container { background: ${editorBackgroundColor}; }`);\n\t\tcollector.addRule(`.notebookOverlay .cell-drag-image .cell-editor-container > div { background: ${editorBackgroundColor} !important; }`);\n\n\t\tcollector.addRule(`.notebookOverlay .monaco-list-row .cell-title-toolbar { background-color: ${editorBackgroundColor}; }`);\n\t\tcollector.addRule(`.notebookOverlay .monaco-list-row.cell-drag-image { background-color: ${editorBackgroundColor}; }`);\n\t\tcollector.addRule(`.notebookOverlay .cell-bottom-toolbar-container .action-item { background-color: ${editorBackgroundColor} }`);\n\t\tcollector.addRule(`.notebookOverlay .cell-list-top-cell-toolbar-container .action-item { background-color: ${editorBackgroundColor} }`);\n\t}\n\n\tconst cellToolbarSeperator = theme.getColor(CELL_TOOLBAR_SEPERATOR);\n\tif (cellToolbarSeperator) {\n\t\tcollector.addRule(`.notebookOverlay .monaco-list-row .cell-title-toolbar { border: solid 1px ${cellToolbarSeperator}; }`);\n\t\tcollector.addRule(`.notebookOverlay .cell-bottom-toolbar-container .action-item { border: solid 1px ${cellToolbarSeperator} }`);\n\t\tcollector.addRule(`.notebookOverlay .cell-list-top-cell-toolbar-container .action-item { border: solid 1px ${cellToolbarSeperator} }`);\n\t\tcollector.addRule(`.monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .cell-collapsed-part { border-bottom: solid 1px ${cellToolbarSeperator} }`);\n\t\tcollector.addRule(`.notebookOverlay .monaco-action-bar .action-item.verticalSeparator { background-color: ${cellToolbarSeperator} }`);\n\t}\n\n\tconst focusedCellBackgroundColor = theme.getColor(focusedCellBackground);\n\tif (focusedCellBackgroundColor) {\n\t\tcollector.addRule(`.notebookOverlay .code-cell-row.focused .cell-focus-indicator,\n\t\t\t.notebookOverlay .markdown-cell-row.focused { background-color: ${focusedCellBackgroundColor} !important; }`);\n\t\tcollector.addRule(`.notebookOverlay .code-cell-row.focused .cell-collapsed-part { background-color: ${focusedCellBackgroundColor} !important; }`);\n\t}\n\n\tconst selectedCellBackgroundColor = theme.getColor(selectedCellBackground);\n\tif (selectedCellBackground) {\n\t\tcollector.addRule(`.notebookOverlay .monaco-list.selection-multiple .markdown-cell-row.selected { background-color: ${selectedCellBackgroundColor} !important; }`);\n\t\tcollector.addRule(`.notebookOverlay .monaco-list.selection-multiple .code-cell-row.selected .cell-focus-indicator-top { background-color: ${selectedCellBackgroundColor} !important; }`);\n\t\tcollector.addRule(`.notebookOverlay .monaco-list.selection-multiple .code-cell-row.selected .cell-focus-indicator-left { background-color: ${selectedCellBackgroundColor} !important; }`);\n\t\tcollector.addRule(`.notebookOverlay .monaco-list.selection-multiple .code-cell-row.selected .cell-focus-indicator-right { background-color: ${selectedCellBackgroundColor} !important; }`);\n\t\tcollector.addRule(`.notebookOverlay .monaco-list.selection-multiple .code-cell-row.selected .cell-focus-indicator-bottom { background-color: ${selectedCellBackgroundColor} !important; }`);\n\t}\n\n\tconst inactiveSelectedCellBorderColor = theme.getColor(inactiveSelectedCellBorder);\n\tcollector.addRule(`\n\t\t\t.notebookOverlay .monaco-list.selection-multiple:focus-within .monaco-list-row.selected .cell-focus-indicator-top:before,\n\t\t\t.notebookOverlay .monaco-list.selection-multiple:focus-within .monaco-list-row.selected .cell-focus-indicator-bottom:before,\n\t\t\t.notebookOverlay .monaco-list.selection-multiple:focus-within .monaco-list-row.selected .cell-inner-container:not(.cell-editor-focus) .cell-focus-indicator-left:before,\n\t\t\t.notebookOverlay .monaco-list.selection-multiple:focus-within .monaco-list-row.selected .cell-inner-container:not(.cell-editor-focus) .cell-focus-indicator-right:before {\n\t\t\t\t\tborder-color: ${inactiveSelectedCellBorderColor} !important;\n\t\t\t}\n\t`);\n\n\tconst cellHoverBackgroundColor = theme.getColor(cellHoverBackground);\n\tif (cellHoverBackgroundColor) {\n\t\tcollector.addRule(`.notebookOverlay .code-cell-row:not(.focused):hover .cell-focus-indicator,\n\t\t\t.notebookOverlay .code-cell-row:not(.focused).cell-output-hover .cell-focus-indicator,\n\t\t\t.notebookOverlay .markdown-cell-row:not(.focused):hover { background-color: ${cellHoverBackgroundColor} !important; }`);\n\t\tcollector.addRule(`.notebookOverlay .code-cell-row:not(.focused):hover .cell-collapsed-part,\n\t\t\t.notebookOverlay .code-cell-row:not(.focused).cell-output-hover .cell-collapsed-part { background-color: ${cellHoverBackgroundColor}; }`);\n\t}\n\n\tconst focusedCellBorderColor = theme.getColor(focusedCellBorder);\n\tcollector.addRule(`\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list:focus-within .monaco-list-row.focused .cell-focus-indicator-top:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list:focus-within .monaco-list-row.focused .cell-focus-indicator-bottom:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list:focus-within .monaco-list-row.focused .cell-inner-container:not(.cell-editor-focus) .cell-focus-indicator-left:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list:focus-within .monaco-list-row.focused .cell-inner-container:not(.cell-editor-focus) .cell-focus-indicator-right:before {\n\t\t\t\tborder-color: ${focusedCellBorderColor} !important;\n\t\t\t}`);\n\n\tconst inactiveFocusedBorderColor = theme.getColor(inactiveFocusedCellBorder);\n\tcollector.addRule(`\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.focused .cell-focus-indicator-top:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.focused .cell-focus-indicator-bottom:before {\n\t\t\t\tborder-color: ${inactiveFocusedBorderColor} !important;\n\t\t\t}`);\n\n\tconst selectedCellBorderColor = theme.getColor(selectedCellBorder);\n\tcollector.addRule(`\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list:focus-within .monaco-list-row.focused .cell-editor-focus .cell-focus-indicator-top:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list:focus-within .monaco-list-row.focused .cell-editor-focus .cell-focus-indicator-bottom:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list:focus-within .monaco-list-row.focused .cell-inner-container.cell-editor-focus:before {\n\t\t\t\tborder-color: ${selectedCellBorderColor} !important;\n\t\t\t}`);\n\n\tconst cellSymbolHighlightColor = theme.getColor(cellSymbolHighlight);\n\tif (cellSymbolHighlightColor) {\n\t\tcollector.addRule(`.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.code-cell-row.nb-symbolHighlight .cell-focus-indicator,\n\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.markdown-cell-row.nb-symbolHighlight {\n\t\t\tbackground-color: ${cellSymbolHighlightColor} !important;\n\t\t}`);\n\t}\n\n\tconst focusedEditorBorderColorColor = theme.getColor(focusedEditorBorderColor);\n\tif (focusedEditorBorderColorColor) {\n\t\tcollector.addRule(`.notebookOverlay .monaco-list-row .cell-editor-focus .cell-editor-part:before { outline: solid 1px ${focusedEditorBorderColorColor}; }`);\n\t}\n\n\tconst cellBorderColor = theme.getColor(notebookCellBorder);\n\tif (cellBorderColor) {\n\t\tcollector.addRule(`.notebookOverlay .cell.markdown h1 { border-color: ${cellBorderColor}; }`);\n\t\tcollector.addRule(`.notebookOverlay .monaco-list-row .cell-editor-part:before { outline: solid 1px ${cellBorderColor}; }`);\n\t}\n\n\tconst cellStatusBarHoverBg = theme.getColor(cellStatusBarItemHover);\n\tif (cellStatusBarHoverBg) {\n\t\tcollector.addRule(`.monaco-workbench .notebookOverlay .cell-statusbar-container .cell-language-picker:hover,\n\t\t.monaco-workbench .notebookOverlay .cell-statusbar-container .cell-status-item.cell-status-item-has-command:hover { background-color: ${cellStatusBarHoverBg}; }`);\n\t}\n\n\tconst cellInsertionIndicatorColor = theme.getColor(cellInsertionIndicator);\n\tif (cellInsertionIndicatorColor) {\n\t\tcollector.addRule(`.notebookOverlay > .cell-list-container > .cell-list-insertion-indicator { background-color: ${cellInsertionIndicatorColor}; }`);\n\t}\n\n\tconst scrollbarSliderBackgroundColor = theme.getColor(listScrollbarSliderBackground);\n\tif (scrollbarSliderBackgroundColor) {\n\t\tcollector.addRule(` .notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .scrollbar > .slider { background: ${scrollbarSliderBackgroundColor}; } `);\n\t\t// collector.addRule(` .monaco-workbench .notebookOverlay .output-plaintext::-webkit-scrollbar-track { background: ${scrollbarSliderBackgroundColor}; } `);\n\t}\n\n\tconst scrollbarSliderHoverBackgroundColor = theme.getColor(listScrollbarSliderHoverBackground);\n\tif (scrollbarSliderHoverBackgroundColor) {\n\t\tcollector.addRule(` .notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .scrollbar > .slider:hover { background: ${scrollbarSliderHoverBackgroundColor}; } `);\n\t\tcollector.addRule(` .monaco-workbench .notebookOverlay .output-plaintext::-webkit-scrollbar-thumb { background: ${scrollbarSliderHoverBackgroundColor}; } `);\n\t\tcollector.addRule(` .monaco-workbench .notebookOverlay .output .error::-webkit-scrollbar-thumb { background: ${scrollbarSliderHoverBackgroundColor}; } `);\n\t}\n\n\tconst scrollbarSliderActiveBackgroundColor = theme.getColor(listScrollbarSliderActiveBackground);\n\tif (scrollbarSliderActiveBackgroundColor) {\n\t\tcollector.addRule(` .notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .scrollbar > .slider.active { background: ${scrollbarSliderActiveBackgroundColor}; } `);\n\t}\n\n\t// case ChangeType.Modify: return theme.getColor(editorGutterModifiedBackground);\n\t// case ChangeType.Add: return theme.getColor(editorGutterAddedBackground);\n\t// case ChangeType.Delete: return theme.getColor(editorGutterDeletedBackground);\n\t// diff\n\n\tconst modifiedBackground = theme.getColor(editorGutterModifiedBackground);\n\tif (modifiedBackground) {\n\t\tcollector.addRule(`\n\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.code-cell-row.nb-cell-modified .cell-focus-indicator {\n\t\t\tbackground-color: ${modifiedBackground} !important;\n\t\t}\n\n\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.markdown-cell-row.nb-cell-modified {\n\t\t\tbackground-color: ${modifiedBackground} !important;\n\t\t}`);\n\t}\n\n\tconst addedBackground = theme.getColor(diffInserted);\n\tif (addedBackground) {\n\t\tcollector.addRule(`\n\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.code-cell-row.nb-cell-added .cell-focus-indicator {\n\t\t\tbackground-color: ${addedBackground} !important;\n\t\t}\n\n\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.markdown-cell-row.nb-cell-added {\n\t\t\tbackground-color: ${addedBackground} !important;\n\t\t}`);\n\t}\n\tconst deletedBackground = theme.getColor(diffRemoved);\n\tif (deletedBackground) {\n\t\tcollector.addRule(`\n\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.code-cell-row.nb-cell-deleted .cell-focus-indicator {\n\t\t\tbackground-color: ${deletedBackground} !important;\n\t\t}\n\n\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.markdown-cell-row.nb-cell-deleted {\n\t\t\tbackground-color: ${deletedBackground} !important;\n\t\t}`);\n\t}\n\n\t// Cell Margin\n\tcollector.addRule(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .markdown-cell-row div.cell.code { margin-left: ${CODE_CELL_LEFT_MARGIN}px; }`);\n\tcollector.addRule(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .code-cell-row div.cell.code { margin-left: ${CODE_CELL_LEFT_MARGIN + CELL_RUN_GUTTER}px; }`);\n\tcollector.addRule(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row div.cell { margin-right: ${CELL_RIGHT_MARGIN}px; }`);\n\tcollector.addRule(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row > .cell-inner-container { padding-top: ${CELL_TOP_MARGIN}px; }`);\n\tcollector.addRule(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .markdown-cell-row > .cell-inner-container { padding-bottom: ${MARKDOWN_CELL_BOTTOM_MARGIN}px; padding-top: ${MARKDOWN_CELL_TOP_MARGIN}px; }`);\n\tcollector.addRule(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .markdown-cell-row > .cell-inner-container.webview-backed-markdown-cell { padding: 0; }`);\n\tcollector.addRule(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .markdown-cell-row > .webview-backed-markdown-cell.markdown-cell-edit-mode .cell.code { padding-bottom: ${MARKDOWN_CELL_BOTTOM_MARGIN}px; padding-top: ${MARKDOWN_CELL_TOP_MARGIN}px; }`);\n\tcollector.addRule(`.notebookOverlay .output { margin: 0px ${CELL_RIGHT_MARGIN}px 0px ${CODE_CELL_LEFT_MARGIN + CELL_RUN_GUTTER}px; }`);\n\tcollector.addRule(`.notebookOverlay .output { width: calc(100% - ${CODE_CELL_LEFT_MARGIN + CELL_RUN_GUTTER + CELL_RIGHT_MARGIN}px); }`);\n\n\tcollector.addRule(`.notebookOverlay .output-show-more-container { margin: 0px ${CELL_RIGHT_MARGIN}px 0px ${CODE_CELL_LEFT_MARGIN + CELL_RUN_GUTTER}px; }`);\n\tcollector.addRule(`.notebookOverlay .output-show-more-container { width: calc(100% - ${CODE_CELL_LEFT_MARGIN + CELL_RUN_GUTTER + CELL_RIGHT_MARGIN}px); }`);\n\n\tcollector.addRule(`.notebookOverlay .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row div.cell.markdown { padding-left: ${CELL_RUN_GUTTER}px; }`);\n\tcollector.addRule(`.notebookOverlay .cell .run-button-container { width: 20px; left: ${CODE_CELL_LEFT_MARGIN + Math.floor(CELL_RUN_GUTTER - 20) / 2}px }`);\n\tcollector.addRule(`.notebookOverlay .monaco-list .monaco-list-row :not(.webview-backed-markdown-cell) .cell-focus-indicator-top { height: ${CELL_TOP_MARGIN}px; }`);\n\tcollector.addRule(`.notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator-side { bottom: ${BOTTOM_CELL_TOOLBAR_GAP}px; }`);\n\tcollector.addRule(`.notebookOverlay .monaco-list .monaco-list-row.code-cell-row .cell-focus-indicator-left,\n\t.notebookOverlay .monaco-list .monaco-list-row.code-cell-row .cell-drag-handle { width: ${CODE_CELL_LEFT_MARGIN + CELL_RUN_GUTTER}px; }`);\n\tcollector.addRule(`.notebookOverlay .monaco-list .monaco-list-row.markdown-cell-row .cell-focus-indicator-left { width: ${CODE_CELL_LEFT_MARGIN}px; }`);\n\tcollector.addRule(`.notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator.cell-focus-indicator-right { width: ${CELL_RIGHT_MARGIN}px; }`);\n\tcollector.addRule(`.notebookOverlay .monaco-list .monaco-list-row .cell-focus-indicator-bottom { height: ${CELL_BOTTOM_MARGIN}px; }`);\n\tcollector.addRule(`.notebookOverlay .monaco-list .monaco-list-row .cell-shadow-container-bottom { top: ${CELL_BOTTOM_MARGIN}px; }`);\n\n\tcollector.addRule(`.monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .cell-collapsed-part { margin-left: ${CODE_CELL_LEFT_MARGIN + CELL_RUN_GUTTER}px; height: ${COLLAPSED_INDICATOR_HEIGHT}px; }`);\n\tcollector.addRule(`.notebookOverlay .cell-list-top-cell-toolbar-container { top: -${SCROLLABLE_ELEMENT_PADDING_TOP}px }`);\n\n\tcollector.addRule(`.monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .monaco-list-row .cell-bottom-toolbar-container { height: ${BOTTOM_CELL_TOOLBAR_HEIGHT}px }`);\n\tcollector.addRule(`.monaco-workbench .notebookOverlay > .cell-list-container > .monaco-list > .monaco-scrollable-element > .monaco-list-rows > .cell-list-top-cell-toolbar-container { height: ${BOTTOM_CELL_TOOLBAR_HEIGHT}px }`);\n\n\t// left and right border margins\n\tcollector.addRule(`\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.code-cell-row.focused .cell-focus-indicator-left:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list .monaco-list-row.code-cell-row.focused .cell-focus-indicator-right:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list.selection-multiple .monaco-list-row.code-cell-row.selected .cell-focus-indicator-left:before,\n\t\t\t.monaco-workbench .notebookOverlay .monaco-list.selection-multiple .monaco-list-row.code-cell-row.selected .cell-focus-indicator-right:before {\n\t\t\t\ttop: -${CELL_TOP_MARGIN}px; height: calc(100% + ${CELL_TOP_MARGIN + CELL_BOTTOM_MARGIN}px)\n\t\t\t}`);\n});\n"]}