{"version":3,"sources":["vs/workbench/contrib/notebook/browser/diff/notebookTextDiffEditor.ts"],"names":[],"mappings":"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","file":"notebookTextDiffEditor.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport * as DOM from 'vs/base/browser/dom';\nimport { IStorageService } from 'vs/platform/storage/common/storage';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { IThemeService, registerThemingParticipant } from 'vs/platform/theme/common/themeService';\nimport { EditorOptions, IEditorOpenContext } from 'vs/workbench/common/editor';\nimport { notebookCellBorder, NotebookEditorWidget } from 'vs/workbench/contrib/notebook/browser/notebookEditorWidget';\nimport { IEditorGroup } from 'vs/workbench/services/editor/common/editorGroupsService';\nimport { NotebookDiffEditorInput } from '../notebookDiffEditorInput';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { DiffElementViewModelBase, SideBySideDiffElementViewModel, SingleSideDiffElementViewModel } from 'vs/workbench/contrib/notebook/browser/diff/diffElementViewModel';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { CellDiffSideBySideRenderer, CellDiffSingleSideRenderer, NotebookCellTextDiffListDelegate, NotebookTextDiffList } from 'vs/workbench/contrib/notebook/browser/diff/notebookTextDiffList';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { diffDiagonalFill, diffInserted, diffRemoved, editorBackground, focusBorder, foreground } from 'vs/platform/theme/common/colorRegistry';\nimport { INotebookEditorWorkerService } from 'vs/workbench/contrib/notebook/common/services/notebookWorkerService';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IEditorOptions } from 'vs/editor/common/config/editorOptions';\nimport { BareFontInfo, FontInfo } from 'vs/editor/common/config/fontInfo';\nimport { getPixelRatio, getZoomLevel } from 'vs/base/browser/browser';\nimport { CellEditState, ICellOutputViewModel, IDisplayOutputLayoutUpdateRequest, IGenericCellViewModel, IInsetRenderOutput, NotebookLayoutInfo, NOTEBOOK_DIFF_EDITOR_ID } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { DiffSide, DIFF_CELL_MARGIN, IDiffCellInfo, INotebookTextDiffEditor } from 'vs/workbench/contrib/notebook/browser/diff/notebookDiffEditorBrowser';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { DisposableStore, IDisposable, toDisposable } from 'vs/base/common/lifecycle';\nimport { EditorPane } from 'vs/workbench/browser/parts/editor/editorPane';\nimport { CellUri, INotebookDiffEditorModel, INotebookDiffResult } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { URI } from 'vs/base/common/uri';\nimport { IDiffChange, IDiffResult } from 'vs/base/common/diff/diff';\nimport { NotebookTextModel } from 'vs/workbench/contrib/notebook/common/model/notebookTextModel';\nimport { OutputRenderer } from 'vs/workbench/contrib/notebook/browser/view/output/outputRenderer';\nimport { SequencerByKey } from 'vs/base/common/async';\nimport { generateUuid } from 'vs/base/common/uuid';\nimport { IMouseWheelEvent, StandardMouseEvent } from 'vs/base/browser/mouseEvent';\nimport { DiffNestedCellViewModel } from 'vs/workbench/contrib/notebook/browser/diff/diffNestedCellViewModel';\nimport { BackLayerWebView } from 'vs/workbench/contrib/notebook/browser/view/renderers/backLayerWebView';\nimport { CELL_OUTPUT_PADDING, MARKDOWN_PREVIEW_PADDING } from 'vs/workbench/contrib/notebook/browser/constants';\nimport { NotebookDiffEditorEventDispatcher, NotebookDiffLayoutChangedEvent } from 'vs/workbench/contrib/notebook/browser/diff/eventDispatcher';\nimport { readFontInfo } from 'vs/editor/browser/config/configuration';\n\nconst $ = DOM.$;\n\nexport class NotebookTextDiffEditor extends EditorPane implements INotebookTextDiffEditor {\n\tstatic readonly ID: string = NOTEBOOK_DIFF_EDITOR_ID;\n\n\tprivate _rootElement!: HTMLElement;\n\tprivate _overflowContainer!: HTMLElement;\n\tprivate _dimension: DOM.Dimension | null = null;\n\tprivate _diffElementViewModels: DiffElementViewModelBase[] = [];\n\tprivate _list!: NotebookTextDiffList;\n\tprivate _modifiedWebview: BackLayerWebView<IDiffCellInfo> | null = null;\n\tprivate _originalWebview: BackLayerWebView<IDiffCellInfo> | null = null;\n\tprivate _webviewTransparentCover: HTMLElement | null = null;\n\tprivate _fontInfo: FontInfo | undefined;\n\n\tprivate readonly _onMouseUp = this._register(new Emitter<{ readonly event: MouseEvent; readonly target: DiffElementViewModelBase; }>());\n\tpublic readonly onMouseUp = this._onMouseUp.event;\n\tprivate _eventDispatcher: NotebookDiffEditorEventDispatcher | undefined;\n\tprotected _scopeContextKeyService!: IContextKeyService;\n\tprivate _model: INotebookDiffEditorModel | null = null;\n\tprivate readonly _modifiedResourceDisposableStore = this._register(new DisposableStore());\n\tprivate _outputRenderer: OutputRenderer;\n\n\tget textModel() {\n\t\treturn this._model?.modified.notebook;\n\t}\n\n\tprivate _revealFirst: boolean;\n\tprivate readonly _insetModifyQueueByOutputId = new SequencerByKey<string>();\n\n\tprotected _onDidDynamicOutputRendered = new Emitter<{ cell: IGenericCellViewModel, output: ICellOutputViewModel }>();\n\tonDidDynamicOutputRendered = this._onDidDynamicOutputRendered.event;\n\n\tprivate readonly _localStore = this._register(new DisposableStore());\n\n\tprivate _isDisposed: boolean = false;\n\n\tget isDisposed() {\n\t\treturn this._isDisposed;\n\t}\n\n\tconstructor(\n\t\t@IInstantiationService readonly instantiationService: IInstantiationService,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IContextKeyService readonly contextKeyService: IContextKeyService,\n\t\t@INotebookEditorWorkerService readonly notebookEditorWorkerService: INotebookEditorWorkerService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ITelemetryService telemetryService: ITelemetryService,\n\t\t@IStorageService storageService: IStorageService,\n\t) {\n\t\tsuper(NotebookTextDiffEditor.ID, telemetryService, themeService, storageService);\n\t\tconst editorOptions = this.configurationService.getValue<IEditorOptions>('editor');\n\t\tthis._fontInfo = readFontInfo(BareFontInfo.createFromRawSettings(editorOptions, getZoomLevel(), getPixelRatio()));\n\t\tthis._revealFirst = true;\n\n\t\tthis._outputRenderer = new OutputRenderer(this, this.instantiationService);\n\t}\n\n\ttoggleNotebookCellSelection(cell: IGenericCellViewModel) {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\n\tfocusNotebookCell(cell: IGenericCellViewModel, focus: 'output' | 'editor' | 'container'): void {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\n\tfocusNextNotebookCell(cell: IGenericCellViewModel, focus: 'output' | 'editor' | 'container'): void {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\n\tupdateOutputHeight(cellInfo: IDiffCellInfo, output: ICellOutputViewModel, outputHeight: number, isInit: boolean): void {\n\t\tconst diffElement = cellInfo.diffElement;\n\t\tconst cell = this.getCellByInfo(cellInfo);\n\t\tconst outputIndex = cell.outputsViewModels.indexOf(output);\n\n\t\tif (diffElement instanceof SideBySideDiffElementViewModel) {\n\t\t\tconst info = CellUri.parse(cellInfo.cellUri);\n\t\t\tif (!info) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdiffElement.updateOutputHeight(info.notebook.toString() === this._model?.original.resource.toString() ? DiffSide.Original : DiffSide.Modified, outputIndex, outputHeight);\n\t\t} else {\n\t\t\tdiffElement.updateOutputHeight(diffElement.type === 'insert' ? DiffSide.Modified : DiffSide.Original, outputIndex, outputHeight);\n\t\t}\n\n\t\tif (isInit) {\n\t\t\tthis._onDidDynamicOutputRendered.fire({ cell, output });\n\t\t}\n\t}\n\n\tsetMarkdownCellEditState(cellId: string, editState: CellEditState): void {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\tmarkdownCellDragStart(cellId: string, position: { clientY: number }): void {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\tmarkdownCellDrag(cellId: string, position: { clientY: number }): void {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\tmarkdownCellDragEnd(cellId: string): void {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\tmarkdownCellDrop(cellId: string) {\n\t\t// throw new Error('Method not implemented.');\n\t}\n\n\tprotected createEditor(parent: HTMLElement): void {\n\t\tthis._rootElement = DOM.append(parent, DOM.$('.notebook-text-diff-editor'));\n\t\tthis._overflowContainer = document.createElement('div');\n\t\tthis._overflowContainer.classList.add('notebook-overflow-widget-container', 'monaco-editor');\n\t\tDOM.append(parent, this._overflowContainer);\n\n\t\tconst renderers = [\n\t\t\tthis.instantiationService.createInstance(CellDiffSingleSideRenderer, this),\n\t\t\tthis.instantiationService.createInstance(CellDiffSideBySideRenderer, this),\n\t\t];\n\n\t\tthis._list = this.instantiationService.createInstance(\n\t\t\tNotebookTextDiffList,\n\t\t\t'NotebookTextDiff',\n\t\t\tthis._rootElement,\n\t\t\tthis.instantiationService.createInstance(NotebookCellTextDiffListDelegate),\n\t\t\trenderers,\n\t\t\tthis.contextKeyService,\n\t\t\t{\n\t\t\t\tsetRowLineHeight: false,\n\t\t\t\tsetRowHeight: false,\n\t\t\t\tsupportDynamicHeights: true,\n\t\t\t\thorizontalScrolling: false,\n\t\t\t\tkeyboardSupport: false,\n\t\t\t\tmouseSupport: true,\n\t\t\t\tmultipleSelectionSupport: false,\n\t\t\t\tenableKeyboardNavigation: true,\n\t\t\t\tadditionalScrollHeight: 0,\n\t\t\t\t// transformOptimization: (isMacintosh && isNative) || getTitleBarStyle(this.configurationService, this.environmentService) === 'native',\n\t\t\t\tstyleController: (_suffix: string) => { return this._list!; },\n\t\t\t\toverrideStyles: {\n\t\t\t\t\tlistBackground: editorBackground,\n\t\t\t\t\tlistActiveSelectionBackground: editorBackground,\n\t\t\t\t\tlistActiveSelectionForeground: foreground,\n\t\t\t\t\tlistFocusAndSelectionBackground: editorBackground,\n\t\t\t\t\tlistFocusAndSelectionForeground: foreground,\n\t\t\t\t\tlistFocusBackground: editorBackground,\n\t\t\t\t\tlistFocusForeground: foreground,\n\t\t\t\t\tlistHoverForeground: foreground,\n\t\t\t\t\tlistHoverBackground: editorBackground,\n\t\t\t\t\tlistHoverOutline: focusBorder,\n\t\t\t\t\tlistFocusOutline: focusBorder,\n\t\t\t\t\tlistInactiveSelectionBackground: editorBackground,\n\t\t\t\t\tlistInactiveSelectionForeground: foreground,\n\t\t\t\t\tlistInactiveFocusBackground: editorBackground,\n\t\t\t\t\tlistInactiveFocusOutline: editorBackground,\n\t\t\t\t},\n\t\t\t\taccessibilityProvider: {\n\t\t\t\t\tgetAriaLabel() { return null; },\n\t\t\t\t\tgetWidgetAriaLabel() {\n\t\t\t\t\t\treturn nls.localize('notebookTreeAriaLabel', \"Notebook Text Diff\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// focusNextPreviousDelegate: {\n\t\t\t\t// \tonFocusNext: (applyFocusNext: () => void) => this._updateForCursorNavigationMode(applyFocusNext),\n\t\t\t\t// \tonFocusPrevious: (applyFocusPrevious: () => void) => this._updateForCursorNavigationMode(applyFocusPrevious),\n\t\t\t\t// }\n\t\t\t}\n\t\t);\n\n\t\tthis._register(this._list);\n\n\t\tthis._register(this._list.onMouseUp(e => {\n\t\t\tif (e.element) {\n\t\t\t\tthis._onMouseUp.fire({ event: e.browserEvent, target: e.element });\n\t\t\t}\n\t\t}));\n\n\t\t// transparent cover\n\t\tthis._webviewTransparentCover = DOM.append(this._list.rowsContainer, $('.webview-cover'));\n\t\tthis._webviewTransparentCover.style.display = 'none';\n\n\t\tthis._register(DOM.addStandardDisposableGenericMouseDownListner(this._overflowContainer, (e: StandardMouseEvent) => {\n\t\t\tif (e.target.classList.contains('slider') && this._webviewTransparentCover) {\n\t\t\t\tthis._webviewTransparentCover.style.display = 'block';\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(DOM.addStandardDisposableGenericMouseUpListner(this._overflowContainer, () => {\n\t\t\tif (this._webviewTransparentCover) {\n\t\t\t\t// no matter when\n\t\t\t\tthis._webviewTransparentCover.style.display = 'none';\n\t\t\t}\n\t\t}));\n\n\t\tthis._register(this._list.onDidScroll(e => {\n\t\t\tthis._webviewTransparentCover!.style.top = `${e.scrollTop}px`;\n\t\t}));\n\n\n\t}\n\n\tprivate _updateOutputsOffsetsInWebview(scrollTop: number, scrollHeight: number, activeWebview: BackLayerWebView<IDiffCellInfo>, getActiveNestedCell: (diffElement: DiffElementViewModelBase) => DiffNestedCellViewModel | undefined, diffSide: DiffSide) {\n\t\tactiveWebview.element.style.height = `${scrollHeight}px`;\n\n\t\tif (activeWebview.insetMapping) {\n\t\t\tconst updateItems: IDisplayOutputLayoutUpdateRequest[] = [];\n\t\t\tconst removedItems: ICellOutputViewModel[] = [];\n\t\t\tactiveWebview.insetMapping.forEach((value, key) => {\n\t\t\t\tconst cell = getActiveNestedCell(value.cellInfo.diffElement);\n\t\t\t\tif (!cell) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst viewIndex = this._list.indexOf(value.cellInfo.diffElement);\n\n\t\t\t\tif (viewIndex === undefined) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (cell.outputsViewModels.indexOf(key) < 0) {\n\t\t\t\t\t// output is already gone\n\t\t\t\t\tremovedItems.push(key);\n\t\t\t\t} else {\n\t\t\t\t\tconst cellTop = this._list.getAbsoluteTopOfElement(value.cellInfo.diffElement);\n\t\t\t\t\tconst outputIndex = cell.outputsViewModels.indexOf(key);\n\t\t\t\t\tconst outputOffset = value.cellInfo.diffElement.getOutputOffsetInCell(diffSide, outputIndex);\n\t\t\t\t\tupdateItems.push({\n\t\t\t\t\t\tcell,\n\t\t\t\t\t\toutput: key,\n\t\t\t\t\t\tcellTop: cellTop,\n\t\t\t\t\t\toutputOffset: outputOffset,\n\t\t\t\t\t\tforceDisplay: false\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t});\n\n\t\t\tactiveWebview.removeInsets(removedItems);\n\n\t\t\tif (updateItems.length) {\n\t\t\t\tactiveWebview.updateScrollTops(updateItems, []);\n\t\t\t}\n\t\t}\n\t}\n\n\toverride async setInput(input: NotebookDiffEditorInput, options: EditorOptions | undefined, context: IEditorOpenContext, token: CancellationToken): Promise<void> {\n\t\tawait super.setInput(input, options, context, token);\n\n\t\tconst model = await input.resolve();\n\t\tif (this._model !== model) {\n\t\t\tthis._detachModel();\n\t\t\tthis._model = model;\n\t\t\tthis._attachModel();\n\t\t}\n\n\t\tthis._model = model;\n\t\tif (this._model === null) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis._revealFirst = true;\n\n\t\tthis._modifiedResourceDisposableStore.clear();\n\n\t\tthis._modifiedResourceDisposableStore.add(Event.any(this._model.original.notebook.onDidChangeContent, this._model.modified.notebook.onDidChangeContent)(e => {\n\t\t\tif (this._model !== null) {\n\t\t\t\tthis.updateLayout();\n\t\t\t}\n\t\t}));\n\n\t\tawait this._createOriginalWebview(generateUuid(), this._model.original.resource);\n\t\tif (this._originalWebview) {\n\t\t\tthis._modifiedResourceDisposableStore.add(this._originalWebview);\n\t\t}\n\t\tawait this._createModifiedWebview(generateUuid(), this._model.modified.resource);\n\t\tif (this._modifiedWebview) {\n\t\t\tthis._modifiedResourceDisposableStore.add(this._modifiedWebview);\n\t\t}\n\n\t\tawait this.updateLayout();\n\t}\n\n\tprivate _detachModel() {\n\t\tthis._localStore.clear();\n\t\tthis._originalWebview?.dispose();\n\t\tthis._originalWebview?.element.remove();\n\t\tthis._originalWebview = null;\n\t\tthis._modifiedWebview?.dispose();\n\t\tthis._modifiedWebview?.element.remove();\n\t\tthis._modifiedWebview = null;\n\n\t\tthis._modifiedResourceDisposableStore.clear();\n\t\tthis._list.clear();\n\n\t}\n\tprivate _attachModel() {\n\t\tthis._eventDispatcher = new NotebookDiffEditorEventDispatcher();\n\t\tconst updateInsets = () => {\n\t\t\tDOM.scheduleAtNextAnimationFrame(() => {\n\t\t\t\tif (this._isDisposed) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (this._modifiedWebview) {\n\t\t\t\t\tthis._updateOutputsOffsetsInWebview(this._list.scrollTop, this._list.scrollHeight, this._modifiedWebview, (diffElement: DiffElementViewModelBase) => {\n\t\t\t\t\t\treturn diffElement.modified;\n\t\t\t\t\t}, DiffSide.Modified);\n\t\t\t\t}\n\n\t\t\t\tif (this._originalWebview) {\n\t\t\t\t\tthis._updateOutputsOffsetsInWebview(this._list.scrollTop, this._list.scrollHeight, this._originalWebview, (diffElement: DiffElementViewModelBase) => {\n\t\t\t\t\t\treturn diffElement.original;\n\t\t\t\t\t}, DiffSide.Original);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\n\t\tthis._localStore.add(this._list.onDidChangeContentHeight(() => {\n\t\t\tupdateInsets();\n\t\t}));\n\n\t\tthis._localStore.add(this._eventDispatcher.onDidChangeCellLayout(() => {\n\t\t\tupdateInsets();\n\t\t}));\n\t}\n\n\tprivate readonly webviewOptions = {\n\t\toutputNodePadding: CELL_OUTPUT_PADDING,\n\t\toutputNodeLeftPadding: 32,\n\t\tpreviewNodePadding: MARKDOWN_PREVIEW_PADDING,\n\t\tleftMargin: 0,\n\t\trightMargin: 0,\n\t\trunGutter: 0\n\t};\n\n\tprivate async _createModifiedWebview(id: string, resource: URI): Promise<void> {\n\t\tif (this._modifiedWebview) {\n\t\t\tthis._modifiedWebview.dispose();\n\t\t}\n\n\t\tthis._modifiedWebview = this.instantiationService.createInstance(BackLayerWebView, this, id, resource, this.webviewOptions) as BackLayerWebView<IDiffCellInfo>;\n\t\t// attach the webview container to the DOM tree first\n\t\tthis._list.rowsContainer.insertAdjacentElement('afterbegin', this._modifiedWebview.element);\n\t\tawait this._modifiedWebview.createWebview();\n\t\tthis._modifiedWebview.element.style.width = `calc(50% - 16px)`;\n\t\tthis._modifiedWebview.element.style.left = `calc(50%)`;\n\t}\n\n\tprivate async _createOriginalWebview(id: string, resource: URI): Promise<void> {\n\t\tif (this._originalWebview) {\n\t\t\tthis._originalWebview.dispose();\n\t\t}\n\n\t\tthis._originalWebview = this.instantiationService.createInstance(BackLayerWebView, this, id, resource, this.webviewOptions) as BackLayerWebView<IDiffCellInfo>;\n\t\t// attach the webview container to the DOM tree first\n\t\tthis._list.rowsContainer.insertAdjacentElement('afterbegin', this._originalWebview.element);\n\t\tawait this._originalWebview.createWebview();\n\t\tthis._originalWebview.element.style.width = `calc(50% - 16px)`;\n\t\tthis._originalWebview.element.style.left = `16px`;\n\t}\n\n\tasync updateLayout() {\n\t\tif (!this._model) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst diffResult = await this.notebookEditorWorkerService.computeDiff(this._model.original.resource, this._model.modified.resource);\n\t\tNotebookTextDiffEditor.prettyChanges(this._model, diffResult.cellsDiff);\n\t\tconst { viewModels, firstChangeIndex } = NotebookTextDiffEditor.computeDiff(this.instantiationService, this._model, this._eventDispatcher!, diffResult);\n\n\t\tthis._originalWebview?.removeInsets([...this._originalWebview?.insetMapping.keys()]);\n\t\tthis._modifiedWebview?.removeInsets([...this._modifiedWebview?.insetMapping.keys()]);\n\n\t\tthis._diffElementViewModels = viewModels;\n\t\tthis._list.splice(0, this._list.length, this._diffElementViewModels);\n\n\t\tif (this._revealFirst && firstChangeIndex !== -1) {\n\t\t\tthis._revealFirst = false;\n\t\t\tthis._list.setFocus([firstChangeIndex]);\n\t\t\tthis._list.reveal(firstChangeIndex, 0.3);\n\t\t}\n\t}\n\n\t/**\n\t * making sure that swapping cells are always translated to `insert+delete`.\n\t */\n\tstatic prettyChanges(model: INotebookDiffEditorModel, diffResult: IDiffResult) {\n\t\tconst changes = diffResult.changes;\n\t\tfor (let i = 0; i < diffResult.changes.length - 1; i++) {\n\t\t\t// then we know there is another change after current one\n\t\t\tconst curr = changes[i];\n\t\t\tconst next = changes[i + 1];\n\t\t\tconst x = curr.originalStart;\n\t\t\tconst y = curr.modifiedStart;\n\n\t\t\tif (\n\t\t\t\tcurr.originalLength === 1\n\t\t\t\t&& curr.modifiedLength === 0\n\t\t\t\t&& next.originalStart === x + 2\n\t\t\t\t&& next.originalLength === 0\n\t\t\t\t&& next.modifiedStart === y + 1\n\t\t\t\t&& next.modifiedLength === 1\n\t\t\t\t&& model.original.notebook.cells[x].getHashValue() === model.modified.notebook.cells[y + 1].getHashValue()\n\t\t\t\t&& model.original.notebook.cells[x + 1].getHashValue() === model.modified.notebook.cells[y].getHashValue()\n\t\t\t) {\n\t\t\t\t// this is a swap\n\t\t\t\tcurr.originalStart = x;\n\t\t\t\tcurr.originalLength = 0;\n\t\t\t\tcurr.modifiedStart = y;\n\t\t\t\tcurr.modifiedLength = 1;\n\n\t\t\t\tnext.originalStart = x + 1;\n\t\t\t\tnext.originalLength = 1;\n\t\t\t\tnext.modifiedStart = y + 2;\n\t\t\t\tnext.modifiedLength = 0;\n\n\t\t\t\ti++;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic computeDiff(instantiationService: IInstantiationService, model: INotebookDiffEditorModel, eventDispatcher: NotebookDiffEditorEventDispatcher, diffResult: INotebookDiffResult) {\n\t\tconst cellChanges = diffResult.cellsDiff.changes;\n\t\tconst diffElementViewModels: DiffElementViewModelBase[] = [];\n\t\tconst originalModel = model.original.notebook;\n\t\tconst modifiedModel = model.modified.notebook;\n\t\tlet originalCellIndex = 0;\n\t\tlet modifiedCellIndex = 0;\n\n\t\tlet firstChangeIndex = -1;\n\n\t\tfor (let i = 0; i < cellChanges.length; i++) {\n\t\t\tconst change = cellChanges[i];\n\t\t\t// common cells\n\n\t\t\tfor (let j = 0; j < change.originalStart - originalCellIndex; j++) {\n\t\t\t\tconst originalCell = originalModel.cells[originalCellIndex + j];\n\t\t\t\tconst modifiedCell = modifiedModel.cells[modifiedCellIndex + j];\n\t\t\t\tif (originalCell.getHashValue() === modifiedCell.getHashValue()) {\n\t\t\t\t\tdiffElementViewModels.push(new SideBySideDiffElementViewModel(\n\t\t\t\t\t\tmodel.modified.notebook,\n\t\t\t\t\t\tmodel.original.notebook,\n\t\t\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, originalCell),\n\t\t\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, modifiedCell),\n\t\t\t\t\t\t'unchanged',\n\t\t\t\t\t\teventDispatcher\n\t\t\t\t\t));\n\t\t\t\t} else {\n\t\t\t\t\tif (firstChangeIndex === -1) {\n\t\t\t\t\t\tfirstChangeIndex = diffElementViewModels.length;\n\t\t\t\t\t}\n\n\t\t\t\t\tdiffElementViewModels.push(new SideBySideDiffElementViewModel(\n\t\t\t\t\t\tmodel.modified.notebook,\n\t\t\t\t\t\tmodel.original.notebook,\n\t\t\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, originalCell),\n\t\t\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, modifiedCell),\n\t\t\t\t\t\t'modified',\n\t\t\t\t\t\teventDispatcher!\n\t\t\t\t\t));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst modifiedLCS = NotebookTextDiffEditor.computeModifiedLCS(instantiationService, change, originalModel, modifiedModel, eventDispatcher);\n\t\t\tif (modifiedLCS.length && firstChangeIndex === -1) {\n\t\t\t\tfirstChangeIndex = diffElementViewModels.length;\n\t\t\t}\n\n\t\t\tdiffElementViewModels.push(...modifiedLCS);\n\t\t\toriginalCellIndex = change.originalStart + change.originalLength;\n\t\t\tmodifiedCellIndex = change.modifiedStart + change.modifiedLength;\n\t\t}\n\n\t\tfor (let i = originalCellIndex; i < originalModel.cells.length; i++) {\n\t\t\tdiffElementViewModels.push(new SideBySideDiffElementViewModel(\n\t\t\t\tmodel.modified.notebook,\n\t\t\t\tmodel.original.notebook,\n\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, originalModel.cells[i]),\n\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, modifiedModel.cells[i - originalCellIndex + modifiedCellIndex]),\n\t\t\t\t'unchanged',\n\t\t\t\teventDispatcher\n\t\t\t));\n\t\t}\n\n\t\treturn {\n\t\t\tviewModels: diffElementViewModels,\n\t\t\tfirstChangeIndex\n\t\t};\n\t}\n\n\tstatic computeModifiedLCS(instantiationService: IInstantiationService, change: IDiffChange, originalModel: NotebookTextModel, modifiedModel: NotebookTextModel, eventDispatcher: NotebookDiffEditorEventDispatcher) {\n\t\tconst result: DiffElementViewModelBase[] = [];\n\t\t// modified cells\n\t\tconst modifiedLen = Math.min(change.originalLength, change.modifiedLength);\n\n\t\tfor (let j = 0; j < modifiedLen; j++) {\n\t\t\tconst isTheSame = originalModel.cells[change.originalStart + j].getHashValue() === modifiedModel.cells[change.modifiedStart + j].getHashValue();\n\t\t\tresult.push(new SideBySideDiffElementViewModel(\n\t\t\t\tmodifiedModel,\n\t\t\t\toriginalModel,\n\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, originalModel.cells[change.originalStart + j]),\n\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, modifiedModel.cells[change.modifiedStart + j]),\n\t\t\t\tisTheSame ? 'unchanged' : 'modified',\n\t\t\t\teventDispatcher\n\t\t\t));\n\t\t}\n\n\t\tfor (let j = modifiedLen; j < change.originalLength; j++) {\n\t\t\t// deletion\n\t\t\tresult.push(new SingleSideDiffElementViewModel(\n\t\t\t\toriginalModel,\n\t\t\t\tmodifiedModel,\n\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, originalModel.cells[change.originalStart + j]),\n\t\t\t\tundefined,\n\t\t\t\t'delete',\n\t\t\t\teventDispatcher\n\t\t\t));\n\t\t}\n\n\t\tfor (let j = modifiedLen; j < change.modifiedLength; j++) {\n\t\t\t// insertion\n\t\t\tresult.push(new SingleSideDiffElementViewModel(\n\t\t\t\tmodifiedModel,\n\t\t\t\toriginalModel,\n\t\t\t\tundefined,\n\t\t\t\tinstantiationService.createInstance(DiffNestedCellViewModel, modifiedModel.cells[change.modifiedStart + j]),\n\t\t\t\t'insert',\n\t\t\t\teventDispatcher\n\t\t\t));\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tscheduleOutputHeightAck(cellInfo: IDiffCellInfo, outputId: string, height: number) {\n\t\tconst diffElement = cellInfo.diffElement;\n\t\t// const activeWebview = diffSide === DiffSide.Modified ? this._modifiedWebview : this._originalWebview;\n\t\tlet diffSide = DiffSide.Original;\n\n\t\tif (diffElement instanceof SideBySideDiffElementViewModel) {\n\t\t\tconst info = CellUri.parse(cellInfo.cellUri);\n\t\t\tif (!info) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tdiffSide = info.notebook.toString() === this._model?.original.resource.toString() ? DiffSide.Original : DiffSide.Modified;\n\t\t} else {\n\t\t\tdiffSide = diffElement.type === 'insert' ? DiffSide.Modified : DiffSide.Original;\n\t\t}\n\n\t\tconst webview = diffSide === DiffSide.Modified ? this._modifiedWebview : this._originalWebview;\n\n\t\tDOM.scheduleAtNextAnimationFrame(() => {\n\t\t\twebview?.ackHeight(cellInfo.cellId, outputId, height);\n\t\t}, 10);\n\t}\n\n\tprivate pendingLayouts = new WeakMap<DiffElementViewModelBase, IDisposable>();\n\n\n\tlayoutNotebookCell(cell: DiffElementViewModelBase, height: number) {\n\t\tconst relayout = (cell: DiffElementViewModelBase, height: number) => {\n\t\t\tthis._list.updateElementHeight2(cell, height);\n\t\t};\n\n\t\tif (this.pendingLayouts.has(cell)) {\n\t\t\tthis.pendingLayouts.get(cell)!.dispose();\n\t\t}\n\n\t\tlet r: () => void;\n\t\tconst layoutDisposable = DOM.scheduleAtNextAnimationFrame(() => {\n\t\t\tthis.pendingLayouts.delete(cell);\n\n\t\t\trelayout(cell, height);\n\t\t\tr();\n\t\t});\n\n\t\tthis.pendingLayouts.set(cell, toDisposable(() => {\n\t\t\tlayoutDisposable.dispose();\n\t\t\tr();\n\t\t}));\n\n\t\treturn new Promise<void>(resolve => { r = resolve; });\n\t}\n\n\ttriggerScroll(event: IMouseWheelEvent) {\n\t\tthis._list.triggerScrollFromMouseWheelEvent(event);\n\t}\n\n\tcreateOutput(cellDiffViewModel: DiffElementViewModelBase, cellViewModel: DiffNestedCellViewModel, output: IInsetRenderOutput, getOffset: () => number, diffSide: DiffSide): void {\n\t\tthis._insetModifyQueueByOutputId.queue(output.source.model.outputId + (diffSide === DiffSide.Modified ? '-right' : 'left'), async () => {\n\t\t\tconst activeWebview = diffSide === DiffSide.Modified ? this._modifiedWebview : this._originalWebview;\n\t\t\tif (!activeWebview) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!activeWebview.insetMapping.has(output.source)) {\n\t\t\t\tconst cellTop = this._list.getAbsoluteTopOfElement(cellDiffViewModel);\n\t\t\t\tawait activeWebview.createOutput({ diffElement: cellDiffViewModel, cellHandle: cellViewModel.handle, cellId: cellViewModel.id, cellUri: cellViewModel.uri }, output, cellTop, getOffset());\n\t\t\t} else {\n\t\t\t\tconst cellTop = this._list.getAbsoluteTopOfElement(cellDiffViewModel);\n\t\t\t\tconst outputIndex = cellViewModel.outputsViewModels.indexOf(output.source);\n\t\t\t\tconst outputOffset = cellDiffViewModel.getOutputOffsetInCell(diffSide, outputIndex);\n\t\t\t\tactiveWebview.updateScrollTops([{\n\t\t\t\t\tcell: cellViewModel,\n\t\t\t\t\toutput: output.source,\n\t\t\t\t\tcellTop,\n\t\t\t\t\toutputOffset,\n\t\t\t\t\tforceDisplay: true\n\t\t\t\t}], []);\n\t\t\t}\n\t\t});\n\t}\n\n\tupdateMarkdownCellHeight() {\n\t\t// TODO\n\t}\n\n\tgetCellByInfo(cellInfo: IDiffCellInfo): IGenericCellViewModel {\n\t\treturn cellInfo.diffElement.getCellByUri(cellInfo.cellUri);\n\t}\n\n\tgetCellById(cellId: string): IGenericCellViewModel | undefined {\n\t\tthrow new Error('Not implemented');\n\t}\n\n\tremoveInset(cellDiffViewModel: DiffElementViewModelBase, cellViewModel: DiffNestedCellViewModel, displayOutput: ICellOutputViewModel, diffSide: DiffSide) {\n\t\tthis._insetModifyQueueByOutputId.queue(displayOutput.model.outputId + (diffSide === DiffSide.Modified ? '-right' : 'left'), async () => {\n\t\t\tconst activeWebview = diffSide === DiffSide.Modified ? this._modifiedWebview : this._originalWebview;\n\t\t\tif (!activeWebview) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!activeWebview.insetMapping.has(displayOutput)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tactiveWebview.removeInsets([displayOutput]);\n\t\t});\n\t}\n\n\tshowInset(cellDiffViewModel: DiffElementViewModelBase, cellViewModel: DiffNestedCellViewModel, displayOutput: ICellOutputViewModel, diffSide: DiffSide) {\n\t\tthis._insetModifyQueueByOutputId.queue(displayOutput.model.outputId + (diffSide === DiffSide.Modified ? '-right' : 'left'), async () => {\n\t\t\tconst activeWebview = diffSide === DiffSide.Modified ? this._modifiedWebview : this._originalWebview;\n\t\t\tif (!activeWebview) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (!activeWebview.insetMapping.has(displayOutput)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst cellTop = this._list.getAbsoluteTopOfElement(cellDiffViewModel);\n\t\t\tconst outputIndex = cellViewModel.outputsViewModels.indexOf(displayOutput);\n\t\t\tconst outputOffset = cellDiffViewModel.getOutputOffsetInCell(diffSide, outputIndex);\n\t\t\tactiveWebview.updateScrollTops([{\n\t\t\t\tcell: cellViewModel,\n\t\t\t\toutput: displayOutput,\n\t\t\t\tcellTop,\n\t\t\t\toutputOffset,\n\t\t\t\tforceDisplay: true,\n\t\t\t}], []);\n\t\t});\n\t}\n\n\thideInset(cellDiffViewModel: DiffElementViewModelBase, cellViewModel: DiffNestedCellViewModel, output: ICellOutputViewModel) {\n\t\tthis._modifiedWebview?.hideInset(output);\n\t\tthis._originalWebview?.hideInset(output);\n\t}\n\n\t// private async _resolveWebview(rightEditor: boolean): Promise<BackLayerWebView | null> {\n\t// \tif (rightEditor) {\n\n\t// \t}\n\t// }\n\n\tgetDomNode() {\n\t\treturn this._rootElement;\n\t}\n\n\tgetOverflowContainerDomNode(): HTMLElement {\n\t\treturn this._overflowContainer;\n\t}\n\n\toverride getControl(): NotebookEditorWidget | undefined {\n\t\treturn undefined;\n\t}\n\n\toverride setEditorVisible(visible: boolean, group: IEditorGroup | undefined): void {\n\t\tsuper.setEditorVisible(visible, group);\n\t}\n\n\toverride focus() {\n\t\tsuper.focus();\n\t}\n\n\toverride clearInput(): void {\n\t\tsuper.clearInput();\n\n\t\tthis._modifiedResourceDisposableStore.clear();\n\t\tthis._list?.splice(0, this._list?.length || 0);\n\t}\n\n\tgetOutputRenderer(): OutputRenderer {\n\t\treturn this._outputRenderer;\n\t}\n\n\tdeltaCellOutputContainerClassNames(diffSide: DiffSide, cellId: string, added: string[], removed: string[]) {\n\t\tif (diffSide === DiffSide.Original) {\n\t\t\tthis._originalWebview?.deltaCellOutputContainerClassNames(cellId, added, removed);\n\t\t} else {\n\t\t\tthis._modifiedWebview?.deltaCellOutputContainerClassNames(cellId, added, removed);\n\t\t}\n\t}\n\n\tgetLayoutInfo(): NotebookLayoutInfo {\n\t\tif (!this._list) {\n\t\t\tthrow new Error('Editor is not initalized successfully');\n\t\t}\n\n\t\treturn {\n\t\t\twidth: this._dimension!.width,\n\t\t\theight: this._dimension!.height,\n\t\t\tfontInfo: this._fontInfo!\n\t\t};\n\t}\n\n\tgetCellOutputLayoutInfo(nestedCell: DiffNestedCellViewModel) {\n\t\tif (!this._model) {\n\t\t\tthrow new Error('Editor is not attached to model yet');\n\t\t}\n\t\tconst documentModel = CellUri.parse(nestedCell.uri);\n\t\tif (!documentModel) {\n\t\t\tthrow new Error('Nested cell in the diff editor has wrong Uri');\n\t\t}\n\n\t\tconst belongToOriginalDocument = this._model.original.notebook.uri.toString() === documentModel.notebook.toString();\n\t\tconst viewModel = this._diffElementViewModels.find(element => {\n\t\t\tconst textModel = belongToOriginalDocument ? element.original : element.modified;\n\t\t\tif (!textModel) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tif (textModel.uri.toString() === nestedCell.uri.toString()) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t});\n\n\t\tif (!viewModel) {\n\t\t\tthrow new Error('Nested cell in the diff editor does not match any diff element');\n\t\t}\n\n\t\tif (viewModel.type === 'unchanged') {\n\t\t\treturn this.getLayoutInfo();\n\t\t}\n\n\t\tif (viewModel.type === 'insert' || viewModel.type === 'delete') {\n\t\t\treturn {\n\t\t\t\twidth: this._dimension!.width / 2,\n\t\t\t\theight: this._dimension!.height / 2,\n\t\t\t\tfontInfo: this._fontInfo!\n\t\t\t};\n\t\t}\n\n\t\tif (viewModel.checkIfOutputsModified()) {\n\t\t\treturn {\n\t\t\t\twidth: this._dimension!.width / 2,\n\t\t\t\theight: this._dimension!.height / 2,\n\t\t\t\tfontInfo: this._fontInfo!\n\t\t\t};\n\t\t} else {\n\t\t\treturn this.getLayoutInfo();\n\t\t}\n\t}\n\n\tlayout(dimension: DOM.Dimension): void {\n\t\tthis._rootElement.classList.toggle('mid-width', dimension.width < 1000 && dimension.width >= 600);\n\t\tthis._rootElement.classList.toggle('narrow-width', dimension.width < 600);\n\t\tthis._dimension = dimension;\n\t\tthis._rootElement.style.height = `${dimension.height}px`;\n\n\t\tthis._list?.layout(this._dimension.height, this._dimension.width);\n\n\n\t\tif (this._modifiedWebview) {\n\t\t\tthis._modifiedWebview.element.style.width = `calc(50% - 16px)`;\n\t\t\tthis._modifiedWebview.element.style.left = `calc(50%)`;\n\t\t}\n\n\t\tif (this._originalWebview) {\n\t\t\tthis._originalWebview.element.style.width = `calc(50% - 16px)`;\n\t\t\tthis._originalWebview.element.style.left = `16px`;\n\t\t}\n\n\t\tif (this._webviewTransparentCover) {\n\t\t\tthis._webviewTransparentCover.style.height = `${dimension.height}px`;\n\t\t\tthis._webviewTransparentCover.style.width = `${dimension.width}px`;\n\t\t}\n\n\t\tthis._eventDispatcher?.emit([new NotebookDiffLayoutChangedEvent({ width: true, fontInfo: true }, this.getLayoutInfo())]);\n\t}\n\n\toverride dispose() {\n\t\tthis._isDisposed = true;\n\t\tsuper.dispose();\n\t}\n}\n\nregisterThemingParticipant((theme, collector) => {\n\tconst cellBorderColor = theme.getColor(notebookCellBorder);\n\tif (cellBorderColor) {\n\t\tcollector.addRule(`.notebook-text-diff-editor .cell-body .border-container .top-border { border-top: 1px solid ${cellBorderColor};}`);\n\t\tcollector.addRule(`.notebook-text-diff-editor .cell-body .border-container .bottom-border { border-top: 1px solid ${cellBorderColor};}`);\n\t\tcollector.addRule(`.notebook-text-diff-editor .cell-body .border-container .left-border { border-left: 1px solid ${cellBorderColor};}`);\n\t\tcollector.addRule(`.notebook-text-diff-editor .cell-body .border-container .right-border { border-right: 1px solid ${cellBorderColor};}`);\n\t\tcollector.addRule(`.notebook-text-diff-editor .cell-diff-editor-container .output-header-container,\n\t\t.notebook-text-diff-editor .cell-diff-editor-container .metadata-header-container {\n\t\t\tborder-top: 1px solid ${cellBorderColor};\n\t\t}`);\n\t}\n\n\tconst diffDiagonalFillColor = theme.getColor(diffDiagonalFill);\n\tcollector.addRule(`\n\t.notebook-text-diff-editor .diagonal-fill {\n\t\tbackground-image: linear-gradient(\n\t\t\t-45deg,\n\t\t\t${diffDiagonalFillColor} 12.5%,\n\t\t\t#0000 12.5%, #0000 50%,\n\t\t\t${diffDiagonalFillColor} 50%, ${diffDiagonalFillColor} 62.5%,\n\t\t\t#0000 62.5%, #0000 100%\n\t\t);\n\t\tbackground-size: 8px 8px;\n\t}\n\t`);\n\n\tconst added = theme.getColor(diffInserted);\n\tif (added) {\n\t\tcollector.addRule(\n\t\t\t`\n\t\t\t.monaco-workbench .notebook-text-diff-editor .cell-body.full .output-info-container.modified .output-view-container .output-view-container-right div.foreground { background-color: ${added}; }\n\t\t\t.monaco-workbench .notebook-text-diff-editor .cell-body.right .output-info-container .output-view-container div.foreground { background-color: ${added}; }\n\t\t\t.monaco-workbench .notebook-text-diff-editor .cell-body.right .output-info-container .output-view-container div.output-empty-view { background-color: ${added}; }\n\t\t\t`\n\t\t);\n\t\tcollector.addRule(`\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.inserted .source-container { background-color: ${added}; }\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.inserted .source-container .monaco-editor .margin,\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.inserted .source-container .monaco-editor .monaco-editor-background {\n\t\t\t\t\tbackground-color: ${added};\n\t\t\t}\n\t\t`\n\t\t);\n\t\tcollector.addRule(`\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.inserted .metadata-editor-container { background-color: ${added}; }\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.inserted .metadata-editor-container .monaco-editor .margin,\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.inserted .metadata-editor-container .monaco-editor .monaco-editor-background {\n\t\t\t\t\tbackground-color: ${added};\n\t\t\t}\n\t\t`\n\t\t);\n\t\tcollector.addRule(`\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.inserted .output-editor-container { background-color: ${added}; }\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.inserted .output-editor-container .monaco-editor .margin,\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.inserted .output-editor-container .monaco-editor .monaco-editor-background {\n\t\t\t\t\tbackground-color: ${added};\n\t\t\t}\n\t\t`\n\t\t);\n\t\tcollector.addRule(`\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.inserted .metadata-header-container { background-color: ${added}; }\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.inserted .output-header-container { background-color: ${added}; }\n\t\t`\n\t\t);\n\t}\n\tconst removed = theme.getColor(diffRemoved);\n\tif (removed) {\n\t\tcollector.addRule(\n\t\t\t`\n\t\t\t.monaco-workbench .notebook-text-diff-editor .cell-body.full .output-info-container.modified .output-view-container .output-view-container-left div.foreground { background-color: ${removed}; }\n\t\t\t.monaco-workbench .notebook-text-diff-editor .cell-body.left .output-info-container .output-view-container div.foreground { background-color: ${removed}; }\n\t\t\t.monaco-workbench .notebook-text-diff-editor .cell-body.left .output-info-container .output-view-container div.output-empty-view { background-color: ${removed}; }\n\n\t\t\t`\n\t\t);\n\t\tcollector.addRule(`\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.removed .source-container { background-color: ${removed}; }\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.removed .source-container .monaco-editor .margin,\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.removed .source-container .monaco-editor .monaco-editor-background {\n\t\t\t\t\tbackground-color: ${removed};\n\t\t\t}\n\t\t`\n\t\t);\n\t\tcollector.addRule(`\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.removed .metadata-editor-container { background-color: ${removed}; }\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.removed .metadata-editor-container .monaco-editor .margin,\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.removed .metadata-editor-container .monaco-editor .monaco-editor-background {\n\t\t\t\t\tbackground-color: ${removed};\n\t\t\t}\n\t\t`\n\t\t);\n\t\tcollector.addRule(`\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.removed .output-editor-container { background-color: ${removed}; }\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.removed .output-editor-container .monaco-editor .margin,\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.removed .output-editor-container .monaco-editor .monaco-editor-background {\n\t\t\t\t\tbackground-color: ${removed};\n\t\t\t}\n\t\t`\n\t\t);\n\t\tcollector.addRule(`\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.removed .metadata-header-container { background-color: ${removed}; }\n\t\t\t.notebook-text-diff-editor .cell-body .cell-diff-editor-container.removed .output-header-container { background-color: ${removed}; }\n\t\t`\n\t\t);\n\t}\n\n\t// const changed = theme.getColor(editorGutterModifiedBackground);\n\n\t// if (changed) {\n\t// \tcollector.addRule(`\n\t// \t\t.notebook-text-diff-editor .cell-diff-editor-container .metadata-header-container.modified {\n\t// \t\t\tbackground-color: ${changed};\n\t// \t\t}\n\t// \t`);\n\t// }\n\n\tcollector.addRule(`.notebook-text-diff-editor .cell-body { margin: ${DIFF_CELL_MARGIN}px; }`);\n});\n"]}