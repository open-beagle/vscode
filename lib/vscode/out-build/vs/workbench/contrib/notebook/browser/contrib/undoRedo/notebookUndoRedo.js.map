{"version":3,"file":"notebookUndoRedo.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/contrib/notebook/browser/contrib/undoRedo/notebookUndoRedo.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { LifecyclePhase } from 'vs/workbench/services/lifecycle/common/lifecycle';\nimport { Registry } from 'vs/platform/registry/common/platform';\nimport { Extensions as WorkbenchExtensions, IWorkbenchContributionsRegistry } from 'vs/workbench/common/contributions';\nimport { CellKind } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\nimport { CellEditState, getNotebookEditorFromEditorPane, NotebookEditorOptions } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport { RedoCommand, UndoCommand } from 'vs/editor/browser/editorExtensions';\n\nclass NotebookUndoRedoContribution extends Disposable {\n\n\tconstructor(@IEditorService private readonly _editorService: IEditorService) {\n\t\tsuper();\n\n\t\tconst PRIORITY = 105;\n\t\tthis._register(UndoCommand.addImplementation(PRIORITY, 'notebook-undo-redo', () => {\n\t\t\tconst editor = getNotebookEditorFromEditorPane(this._editorService.activeEditorPane);\n\t\t\tif (editor?.viewModel) {\n\t\t\t\treturn editor.viewModel.undo().then(cellResources => {\n\t\t\t\t\tif (cellResources?.length) {\n\t\t\t\t\t\teditor?.viewModel?.viewCells.forEach(cell => {\n\t\t\t\t\t\t\tif (cell.cellKind === CellKind.Markdown && cellResources.find(resource => resource.fragment === cell.model.uri.fragment)) {\n\t\t\t\t\t\t\t\tcell.updateEditState(CellEditState.Editing, 'undo');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\teditor?.setOptions(new NotebookEditorOptions({ cellOptions: { resource: cellResources[0] }, preserveFocus: true }));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}));\n\n\t\tthis._register(RedoCommand.addImplementation(PRIORITY, 'notebook-undo-redo', () => {\n\t\t\tconst editor = getNotebookEditorFromEditorPane(this._editorService.activeEditorPane);\n\t\t\tif (editor?.viewModel) {\n\t\t\t\treturn editor.viewModel.redo().then(cellResources => {\n\t\t\t\t\tif (cellResources?.length) {\n\t\t\t\t\t\teditor?.viewModel?.viewCells.forEach(cell => {\n\t\t\t\t\t\t\tif (cell.cellKind === CellKind.Markdown && cellResources.find(resource => resource.fragment === cell.model.uri.fragment)) {\n\t\t\t\t\t\t\t\tcell.updateEditState(CellEditState.Editing, 'redo');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\teditor?.setOptions(new NotebookEditorOptions({ cellOptions: { resource: cellResources[0] }, preserveFocus: true }));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}));\n\t}\n}\n\nconst workbenchContributionsRegistry = Registry.as<IWorkbenchContributionsRegistry>(WorkbenchExtensions.Workbench);\nworkbenchContributionsRegistry.registerWorkbenchContribution(NotebookUndoRedoContribution, LifecyclePhase.Ready);\n"]}