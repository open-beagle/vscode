{"version":3,"sources":["vs/workbench/contrib/notebook/browser/contrib/cellOperations/cellOperations.ts"],"names":[],"mappings":"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","file":"cellOperations.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { KeyChord, KeyCode, KeyMod } from 'vs/base/common/keyCodes';\nimport { localize } from 'vs/nls';\nimport { MenuId, registerAction2 } from 'vs/platform/actions/common/actions';\nimport { ContextKeyExpr } from 'vs/platform/contextkey/common/contextkey';\nimport { InputFocusedContext } from 'vs/platform/contextkey/common/contextkeys';\nimport { KeybindingWeight } from 'vs/platform/keybinding/common/keybindingsRegistry';\nimport { Range } from 'vs/editor/common/core/range';\nimport { CellOverflowToolbarGroups, CellToolbarOrder, CELL_TITLE_CELL_GROUP_ID, INotebookCellActionContext, NotebookCellAction } from 'vs/workbench/contrib/notebook/browser/contrib/coreActions';\nimport { CellEditState, expandCellRangesWithHiddenCells, ICellViewModel, NOTEBOOK_CELL_EDITABLE, NOTEBOOK_EDITOR_EDITABLE, NOTEBOOK_EDITOR_FOCUSED } from 'vs/workbench/contrib/notebook/browser/notebookBrowser';\nimport * as icons from 'vs/workbench/contrib/notebook/browser/notebookIcons';\nimport { ServicesAccessor } from 'vs/platform/instantiation/common/instantiation';\nimport { CellEditType, CellKind, SelectionStateType } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { cellRangeContains, cellRangesToIndexes, ICellRange } from 'vs/workbench/contrib/notebook/common/notebookRange';\nimport { cloneNotebookCellTextModel } from 'vs/workbench/contrib/notebook/common/model/notebookCellTextModel';\nimport { CellViewModel, NotebookViewModel } from 'vs/workbench/contrib/notebook/browser/viewModel/notebookViewModel';\nimport { IBulkEditService, ResourceEdit, ResourceTextEdit } from 'vs/editor/browser/services/bulkEditService';\nimport { ResourceNotebookCellEdit } from 'vs/workbench/contrib/bulkEdit/browser/bulkCellEdits';\n\nconst MOVE_CELL_UP_COMMAND_ID = 'notebook.cell.moveUp';\nconst MOVE_CELL_DOWN_COMMAND_ID = 'notebook.cell.moveDown';\nconst COPY_CELL_UP_COMMAND_ID = 'notebook.cell.copyUp';\nconst COPY_CELL_DOWN_COMMAND_ID = 'notebook.cell.copyDown';\nconst SPLIT_CELL_COMMAND_ID = 'notebook.cell.split';\nconst JOIN_CELL_ABOVE_COMMAND_ID = 'notebook.cell.joinAbove';\nconst JOIN_CELL_BELOW_COMMAND_ID = 'notebook.cell.joinBelow';\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: MOVE_CELL_UP_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.moveCellUp', \"Move Cell Up\"),\n\t\t\t\ticon: icons.moveUpIcon,\n\t\t\t\tkeybinding: {\n\t\t\t\t\tprimary: KeyMod.Alt | KeyCode.UpArrow,\n\t\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_EDITOR_FOCUSED, InputFocusedContext.toNegated()),\n\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext) {\n\t\treturn moveCellRange(context, 'up');\n\t}\n});\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: MOVE_CELL_DOWN_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.moveCellDown', \"Move Cell Down\"),\n\t\t\t\ticon: icons.moveDownIcon,\n\t\t\t\tkeybinding: {\n\t\t\t\t\tprimary: KeyMod.Alt | KeyCode.DownArrow,\n\t\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_EDITOR_FOCUSED, InputFocusedContext.toNegated()),\n\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext) {\n\t\treturn moveCellRange(context, 'down');\n\t}\n});\n\nexport async function moveCellRange(context: INotebookCellActionContext, direction: 'up' | 'down'): Promise<void> {\n\tconst viewModel = context.notebookEditor.viewModel;\n\tif (!viewModel) {\n\t\treturn;\n\t}\n\n\tif (viewModel.options.isReadOnly) {\n\t\treturn;\n\t}\n\n\tconst selections = context.notebookEditor.getSelections();\n\tconst modelRanges = expandCellRangesWithHiddenCells(context.notebookEditor, context.notebookEditor.viewModel!, selections);\n\tconst range = modelRanges[0];\n\tif (!range || range.start === range.end) {\n\t\treturn;\n\t}\n\n\tif (direction === 'up') {\n\t\tif (range.start === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst indexAbove = range.start - 1;\n\t\tconst finalSelection = { start: range.start - 1, end: range.end - 1 };\n\t\tconst focus = context.notebookEditor.getFocus();\n\t\tconst newFocus = cellRangeContains(range, focus) ? { start: focus.start - 1, end: focus.end - 1 } : { start: range.start - 1, end: range.start };\n\t\tviewModel.notebookDocument.applyEdits([\n\t\t\t{\n\t\t\t\teditType: CellEditType.Move,\n\t\t\t\tindex: indexAbove,\n\t\t\t\tlength: 1,\n\t\t\t\tnewIdx: range.end - 1\n\t\t\t}],\n\t\t\ttrue,\n\t\t\t{\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: viewModel.getFocus(),\n\t\t\t\tselections: viewModel.getSelections()\n\t\t\t},\n\t\t\t() => ({ kind: SelectionStateType.Index, focus: newFocus, selections: [finalSelection] }),\n\t\t\tundefined\n\t\t);\n\t\tconst focusRange = viewModel.getSelections()[0] ?? viewModel.getFocus();\n\t\tcontext.notebookEditor.revealCellRangeInView(focusRange);\n\t} else {\n\t\tif (range.end >= viewModel.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst indexBelow = range.end;\n\t\tconst finalSelection = { start: range.start + 1, end: range.end + 1 };\n\t\tconst focus = context.notebookEditor.getFocus();\n\t\tconst newFocus = cellRangeContains(range, focus) ? { start: focus.start + 1, end: focus.end + 1 } : { start: range.start + 1, end: range.start + 2 };\n\n\t\tviewModel.notebookDocument.applyEdits([\n\t\t\t{\n\t\t\t\teditType: CellEditType.Move,\n\t\t\t\tindex: indexBelow,\n\t\t\t\tlength: 1,\n\t\t\t\tnewIdx: range.start\n\t\t\t}],\n\t\t\ttrue,\n\t\t\t{\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: viewModel.getFocus(),\n\t\t\t\tselections: viewModel.getSelections()\n\t\t\t},\n\t\t\t() => ({ kind: SelectionStateType.Index, focus: newFocus, selections: [finalSelection] }),\n\t\t\tundefined\n\t\t);\n\n\t\tconst focusRange = viewModel.getSelections()[0] ?? viewModel.getFocus();\n\t\tcontext.notebookEditor.revealCellRangeInView(focusRange);\n\t}\n}\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: COPY_CELL_UP_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.copyCellUp', \"Copy Cell Up\"),\n\t\t\t\tkeybinding: {\n\t\t\t\t\tprimary: KeyMod.Alt | KeyMod.Shift | KeyCode.UpArrow,\n\t\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_EDITOR_FOCUSED, InputFocusedContext.toNegated()),\n\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext) {\n\t\treturn copyCellRange(context, 'up');\n\t}\n});\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: COPY_CELL_DOWN_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.copyCellDown', \"Copy Cell Down\"),\n\t\t\t\tkeybinding: {\n\t\t\t\t\tprimary: KeyMod.Alt | KeyMod.Shift | KeyCode.DownArrow,\n\t\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_EDITOR_FOCUSED, InputFocusedContext.toNegated()),\n\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t\t},\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_EDITOR_FOCUSED, NOTEBOOK_EDITOR_EDITABLE, NOTEBOOK_CELL_EDITABLE),\n\t\t\t\t\tgroup: CellOverflowToolbarGroups.Edit,\n\t\t\t\t\torder: 12\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext) {\n\t\treturn copyCellRange(context, 'down');\n\t}\n});\n\nexport async function copyCellRange(context: INotebookCellActionContext, direction: 'up' | 'down'): Promise<void> {\n\tconst viewModel = context.notebookEditor.viewModel;\n\tif (!viewModel) {\n\t\treturn;\n\t}\n\n\tif (viewModel.options.isReadOnly) {\n\t\treturn;\n\t}\n\n\tlet range: ICellRange | undefined = undefined;\n\n\tif (context.ui) {\n\t\tlet targetCell = context.cell;\n\t\tconst targetCellIndex = viewModel.getCellIndex(targetCell);\n\t\trange = { start: targetCellIndex, end: targetCellIndex + 1 };\n\t} else {\n\t\tconst selections = context.notebookEditor.getSelections();\n\t\tconst modelRanges = expandCellRangesWithHiddenCells(context.notebookEditor, context.notebookEditor.viewModel!, selections);\n\t\trange = modelRanges[0];\n\t}\n\n\tif (!range || range.start === range.end) {\n\t\treturn;\n\t}\n\n\tif (direction === 'up') {\n\t\t// insert up, without changing focus and selections\n\t\tconst focus = viewModel.getFocus();\n\t\tconst selections = viewModel.getSelections();\n\t\tviewModel.notebookDocument.applyEdits([\n\t\t\t{\n\t\t\t\teditType: CellEditType.Replace,\n\t\t\t\tindex: range.end,\n\t\t\t\tcount: 0,\n\t\t\t\tcells: cellRangesToIndexes([range]).map(index => cloneNotebookCellTextModel(viewModel.cellAt(index)!.model))\n\t\t\t}],\n\t\t\ttrue,\n\t\t\t{\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: focus,\n\t\t\t\tselections: selections\n\t\t\t},\n\t\t\t() => ({ kind: SelectionStateType.Index, focus: focus, selections: selections }),\n\t\t\tundefined\n\t\t);\n\t} else {\n\t\t// insert down, move selections\n\t\tconst focus = viewModel.getFocus();\n\t\tconst selections = viewModel.getSelections();\n\t\tconst newCells = cellRangesToIndexes([range]).map(index => cloneNotebookCellTextModel(viewModel.cellAt(index)!.model));\n\t\tconst countDelta = newCells.length;\n\t\tconst newFocus = context.ui ? focus : { start: focus.start + countDelta, end: focus.end + countDelta };\n\t\tconst newSelections = context.ui ? selections : [{ start: range.start + countDelta, end: range.end + countDelta }];\n\t\tviewModel.notebookDocument.applyEdits([\n\t\t\t{\n\t\t\t\teditType: CellEditType.Replace,\n\t\t\t\tindex: range.end,\n\t\t\t\tcount: 0,\n\t\t\t\tcells: cellRangesToIndexes([range]).map(index => cloneNotebookCellTextModel(viewModel.cellAt(index)!.model))\n\t\t\t}],\n\t\t\ttrue,\n\t\t\t{\n\t\t\t\tkind: SelectionStateType.Index,\n\t\t\t\tfocus: focus,\n\t\t\t\tselections: selections\n\t\t\t},\n\t\t\t() => ({ kind: SelectionStateType.Index, focus: newFocus, selections: newSelections }),\n\t\t\tundefined\n\t\t);\n\n\t\tconst focusRange = viewModel.getSelections()[0] ?? viewModel.getFocus();\n\t\tcontext.notebookEditor.revealCellRangeInView(focusRange);\n\t}\n}\n\nexport async function splitCell(context: INotebookCellActionContext): Promise<void> {\n\tconst newCells = await context.notebookEditor.splitNotebookCell(context.cell);\n\tif (newCells) {\n\t\tcontext.notebookEditor.focusNotebookCell(newCells[newCells.length - 1], 'editor');\n\t}\n}\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: SPLIT_CELL_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.splitCell', \"Split Cell\"),\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_EDITOR_FOCUSED, NOTEBOOK_EDITOR_EDITABLE, NOTEBOOK_CELL_EDITABLE),\n\t\t\t\t\torder: CellToolbarOrder.SplitCell,\n\t\t\t\t\tgroup: CELL_TITLE_CELL_GROUP_ID\n\t\t\t\t},\n\t\t\t\ticon: icons.splitCellIcon,\n\t\t\t\tkeybinding: {\n\t\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_EDITOR_FOCUSED, NOTEBOOK_EDITOR_EDITABLE, NOTEBOOK_CELL_EDITABLE),\n\t\t\t\t\tprimary: KeyChord(KeyMod.CtrlCmd | KeyCode.KEY_K, KeyMod.CtrlCmd | KeyMod.Shift | KeyCode.US_BACKSLASH),\n\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t\t},\n\t\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext) {\n\t\treturn splitCell(context);\n\t}\n});\n\nexport async function joinNotebookCells(viewModel: NotebookViewModel, range: ICellRange, direction: 'above' | 'below', constraint?: CellKind): Promise<{ edits: ResourceEdit[], cell: ICellViewModel, endFocus: ICellRange, endSelections: ICellRange[] } | null> {\n\tif (!viewModel || viewModel.options.isReadOnly) {\n\t\treturn null;\n\t}\n\n\tconst cells = viewModel.getCells(range);\n\n\tif (!cells.length) {\n\t\treturn null;\n\t}\n\n\tif (range.start === 0 && direction === 'above') {\n\t\treturn null;\n\t}\n\n\tif (range.end === viewModel.length && direction === 'below') {\n\t\treturn null;\n\t}\n\n\tfor (let i = 0; i < cells.length; i++) {\n\t\tconst cell = cells[i];\n\n\t\tif (constraint && cell.cellKind !== constraint) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tif (direction === 'above') {\n\t\tconst above = viewModel.cellAt(range.start - 1) as CellViewModel;\n\t\tif (constraint && above.cellKind !== constraint) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst insertContent = cells.map(cell => (cell.textBuffer.getEOL() ?? '') + cell.getText()).join('');\n\t\tconst aboveCellLineCount = above.textBuffer.getLineCount();\n\t\tconst aboveCellLastLineEndColumn = above.textBuffer.getLineLength(aboveCellLineCount);\n\n\t\treturn {\n\t\t\tedits: [\n\t\t\t\tnew ResourceTextEdit(above.uri, { range: new Range(aboveCellLineCount, aboveCellLastLineEndColumn + 1, aboveCellLineCount, aboveCellLastLineEndColumn + 1), text: insertContent }),\n\t\t\t\tnew ResourceNotebookCellEdit(viewModel.notebookDocument.uri,\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.Replace,\n\t\t\t\t\t\tindex: range.start,\n\t\t\t\t\t\tcount: range.end - range.start,\n\t\t\t\t\t\tcells: []\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t],\n\t\t\tcell: above,\n\t\t\tendFocus: { start: range.start - 1, end: range.start },\n\t\t\tendSelections: [{ start: range.start - 1, end: range.start }]\n\t\t};\n\t} else {\n\t\tconst below = viewModel.cellAt(range.end) as CellViewModel;\n\t\tif (constraint && below.cellKind !== constraint) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst cell = cells[0];\n\t\tconst restCells = [...cells.slice(1), below];\n\t\tconst insertContent = restCells.map(cl => (cl.textBuffer.getEOL() ?? '') + cl.getText()).join('');\n\n\t\tconst cellLineCount = cell.textBuffer.getLineCount();\n\t\tconst cellLastLineEndColumn = cell.textBuffer.getLineLength(cellLineCount);\n\n\t\treturn {\n\t\t\tedits: [\n\t\t\t\tnew ResourceTextEdit(cell.uri, { range: new Range(cellLineCount, cellLastLineEndColumn + 1, cellLineCount, cellLastLineEndColumn + 1), text: insertContent }),\n\t\t\t\tnew ResourceNotebookCellEdit(viewModel.notebookDocument.uri,\n\t\t\t\t\t{\n\t\t\t\t\t\teditType: CellEditType.Replace,\n\t\t\t\t\t\tindex: range.start + 1,\n\t\t\t\t\t\tcount: range.end - range.start,\n\t\t\t\t\t\tcells: []\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t],\n\t\t\tcell,\n\t\t\tendFocus: { start: range.start, end: range.start + 1 },\n\t\t\tendSelections: [{ start: range.start, end: range.start + 1 }]\n\t\t};\n\t}\n}\n\nexport async function joinCellsWithSurrounds(bulkEditService: IBulkEditService, context: INotebookCellActionContext, direction: 'above' | 'below'): Promise<void> {\n\tconst viewModel = context.notebookEditor.viewModel;\n\tlet ret: {\n\t\tedits: ResourceEdit[];\n\t\tcell: ICellViewModel;\n\t\tendFocus: ICellRange;\n\t\tendSelections: ICellRange[];\n\t} | null = null;\n\n\tif (context.ui) {\n\t\tconst cellIndex = viewModel.getCellIndex(context.cell);\n\t\tret = await joinNotebookCells(viewModel, { start: cellIndex, end: cellIndex + 1 }, direction);\n\t\tif (!ret) {\n\t\t\treturn;\n\t\t}\n\n\t\tawait bulkEditService.apply(\n\t\t\tret?.edits,\n\t\t\t{ quotableLabel: 'Join Notebook Cells' }\n\t\t);\n\t\tviewModel.updateSelectionsState({ kind: SelectionStateType.Index, focus: ret.endFocus, selections: ret.endSelections });\n\t\tret.cell.updateEditState(CellEditState.Editing, 'joinCellsWithSurrounds');\n\t\tcontext.notebookEditor.revealCellRangeInView(viewModel.getFocus());\n\t} else {\n\t\tconst selections = viewModel.getSelections();\n\t\tif (!selections.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst focus = viewModel.getFocus();\n\t\tlet edits: ResourceEdit[] = [];\n\t\tlet cell: ICellViewModel | null = null;\n\t\tlet cells: ICellViewModel[] = [];\n\n\t\tfor (let i = selections.length - 1; i >= 0; i--) {\n\t\t\tconst selection = selections[i];\n\t\t\tconst containFocus = cellRangeContains(selection, focus);\n\n\t\t\tif (\n\t\t\t\tselection.end >= viewModel.length && direction === 'below'\n\t\t\t\t|| selection.start === 0 && direction === 'above'\n\t\t\t) {\n\t\t\t\tif (containFocus) {\n\t\t\t\t\tcell = viewModel.cellAt(focus.start)!;\n\t\t\t\t}\n\n\t\t\t\tcells.push(...viewModel.getCells(selection));\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tconst singleRet = await joinNotebookCells(viewModel, selection, direction);\n\n\t\t\tif (!singleRet) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tedits.push(...singleRet.edits);\n\t\t\tcells.push(singleRet.cell);\n\n\t\t\tif (containFocus) {\n\t\t\t\tcell = singleRet.cell;\n\t\t\t}\n\t\t}\n\n\t\tif (!edits.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!cell || !cells.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tawait bulkEditService.apply(\n\t\t\tedits,\n\t\t\t{ quotableLabel: 'Join Notebook Cells' }\n\t\t);\n\n\t\tcells.forEach(cell => {\n\t\t\tcell.updateEditState(CellEditState.Editing, 'joinCellsWithSurrounds');\n\t\t});\n\n\t\tviewModel.updateSelectionsState({ kind: SelectionStateType.Handle, primary: cell.handle, selections: cells.map(cell => cell.handle) });\n\t\tcontext.notebookEditor.revealCellRangeInView(viewModel.getFocus());\n\t}\n}\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: JOIN_CELL_ABOVE_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.joinCellAbove', \"Join With Previous Cell\"),\n\t\t\t\tkeybinding: {\n\t\t\t\t\twhen: NOTEBOOK_EDITOR_FOCUSED,\n\t\t\t\t\tprimary: KeyMod.WinCtrl | KeyMod.Alt | KeyMod.Shift | KeyCode.KEY_J,\n\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t\t},\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_EDITOR_FOCUSED, NOTEBOOK_EDITOR_EDITABLE),\n\t\t\t\t\tgroup: CellOverflowToolbarGroups.Edit,\n\t\t\t\t\torder: 10\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext) {\n\t\tconst bulkEditService = accessor.get(IBulkEditService);\n\t\treturn joinCellsWithSurrounds(bulkEditService, context, 'above');\n\t}\n});\n\nregisterAction2(class extends NotebookCellAction {\n\tconstructor() {\n\t\tsuper(\n\t\t\t{\n\t\t\t\tid: JOIN_CELL_BELOW_COMMAND_ID,\n\t\t\t\ttitle: localize('notebookActions.joinCellBelow', \"Join With Next Cell\"),\n\t\t\t\tkeybinding: {\n\t\t\t\t\twhen: NOTEBOOK_EDITOR_FOCUSED,\n\t\t\t\t\tprimary: KeyMod.WinCtrl | KeyMod.Alt | KeyCode.KEY_J,\n\t\t\t\t\tweight: KeybindingWeight.WorkbenchContrib\n\t\t\t\t},\n\t\t\t\tmenu: {\n\t\t\t\t\tid: MenuId.NotebookCellTitle,\n\t\t\t\t\twhen: ContextKeyExpr.and(NOTEBOOK_EDITOR_FOCUSED, NOTEBOOK_EDITOR_EDITABLE),\n\t\t\t\t\tgroup: CellOverflowToolbarGroups.Edit,\n\t\t\t\t\torder: 11\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tasync runWithContext(accessor: ServicesAccessor, context: INotebookCellActionContext) {\n\t\tconst bulkEditService = accessor.get(IBulkEditService);\n\t\treturn joinCellsWithSurrounds(bulkEditService, context, 'below');\n\t}\n});\n"]}