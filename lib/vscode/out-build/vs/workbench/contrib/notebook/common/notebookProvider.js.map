{"version":3,"file":"notebookProvider.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/contrib/notebook/common/notebookProvider.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as glob from 'vs/base/common/glob';\nimport { URI } from 'vs/base/common/uri';\nimport { basename } from 'vs/base/common/path';\nimport { INotebookExclusiveDocumentFilter, isDocumentExcludePattern, TransientOptions } from 'vs/workbench/contrib/notebook/common/notebookCommon';\nimport { ContributedEditorPriority } from 'vs/workbench/services/editor/common/editorOverrideService';\n\ntype NotebookSelector = string | glob.IRelativePattern | INotebookExclusiveDocumentFilter;\n\nexport interface NotebookEditorDescriptor {\n\treadonly id: string;\n\treadonly displayName: string;\n\treadonly selectors: readonly { filenamePattern?: string; excludeFileNamePattern?: string; }[];\n\treadonly priority: ContributedEditorPriority;\n\treadonly providerExtensionId?: string;\n\treadonly providerDescription?: string;\n\treadonly providerDisplayName: string;\n\treadonly providerExtensionLocation: URI;\n\treadonly dynamicContribution: boolean;\n\treadonly exclusive: boolean;\n}\n\nexport class NotebookProviderInfo {\n\n\treadonly id: string;\n\treadonly displayName: string;\n\n\treadonly priority: ContributedEditorPriority;\n\t// it's optional as the memento might not have it\n\treadonly providerExtensionId?: string;\n\treadonly providerDescription?: string;\n\treadonly providerDisplayName: string;\n\treadonly providerExtensionLocation: URI;\n\treadonly dynamicContribution: boolean;\n\treadonly exclusive: boolean;\n\tprivate _selectors: NotebookSelector[];\n\tget selectors() {\n\t\treturn this._selectors;\n\t}\n\tprivate _options: TransientOptions;\n\tget options() {\n\t\treturn this._options;\n\t}\n\n\tconstructor(descriptor: NotebookEditorDescriptor) {\n\t\tthis.id = descriptor.id;\n\t\tthis.displayName = descriptor.displayName;\n\t\tthis._selectors = descriptor.selectors?.map(selector => ({\n\t\t\tinclude: selector.filenamePattern,\n\t\t\texclude: selector.excludeFileNamePattern || ''\n\t\t})) || [];\n\t\tthis.priority = descriptor.priority;\n\t\tthis.providerExtensionId = descriptor.providerExtensionId;\n\t\tthis.providerDescription = descriptor.providerDescription;\n\t\tthis.providerDisplayName = descriptor.providerDisplayName;\n\t\tthis.providerExtensionLocation = descriptor.providerExtensionLocation;\n\t\tthis.dynamicContribution = descriptor.dynamicContribution;\n\t\tthis.exclusive = descriptor.exclusive;\n\t\tthis._options = {\n\t\t\ttransientCellMetadata: {},\n\t\t\ttransientDocumentMetadata: {},\n\t\t\ttransientOutputs: false\n\t\t};\n\t}\n\n\tupdate(args: { selectors?: NotebookSelector[]; options?: TransientOptions }) {\n\t\tif (args.selectors) {\n\t\t\tthis._selectors = args.selectors;\n\t\t}\n\n\t\tif (args.options) {\n\t\t\tthis._options = args.options;\n\t\t}\n\t}\n\n\tmatches(resource: URI): boolean {\n\t\treturn this.selectors?.some(selector => NotebookProviderInfo.selectorMatches(selector, resource));\n\t}\n\n\tstatic selectorMatches(selector: NotebookSelector, resource: URI): boolean {\n\t\tif (typeof selector === 'string') {\n\t\t\t// filenamePattern\n\t\t\tif (glob.match(selector.toLowerCase(), basename(resource.fsPath).toLowerCase())) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tif (glob.isRelativePattern(selector)) {\n\t\t\tif (glob.match(selector, basename(resource.fsPath).toLowerCase())) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tif (!isDocumentExcludePattern(selector)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet filenamePattern = selector.include;\n\t\tlet excludeFilenamePattern = selector.exclude;\n\n\t\tif (glob.match(filenamePattern, basename(resource.fsPath).toLowerCase())) {\n\t\t\tif (excludeFilenamePattern) {\n\t\t\t\tif (glob.match(excludeFilenamePattern, basename(resource.fsPath).toLowerCase())) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n"]}