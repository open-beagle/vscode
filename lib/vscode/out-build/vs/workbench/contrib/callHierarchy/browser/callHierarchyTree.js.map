{"version":3,"sources":["vs/workbench/contrib/callHierarchy/browser/callHierarchyTree.ts"],"names":[],"mappings":"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","file":"callHierarchyTree.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IAsyncDataSource, ITreeRenderer, ITreeNode, ITreeSorter } from 'vs/base/browser/ui/tree/tree';\nimport { CallHierarchyItem, CallHierarchyDirection, CallHierarchyModel, } from 'vs/workbench/contrib/callHierarchy/common/callHierarchy';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { IIdentityProvider, IListVirtualDelegate } from 'vs/base/browser/ui/list/list';\nimport { FuzzyScore, createMatches } from 'vs/base/common/filters';\nimport { IconLabel } from 'vs/base/browser/ui/iconLabel/iconLabel';\nimport { SymbolKinds, Location, SymbolTag } from 'vs/editor/common/modes';\nimport { compare } from 'vs/base/common/strings';\nimport { Range } from 'vs/editor/common/core/range';\nimport { IListAccessibilityProvider } from 'vs/base/browser/ui/list/listWidget';\nimport { localize } from 'vs/nls';\n\nexport class Call {\n\tconstructor(\n\t\treadonly item: CallHierarchyItem,\n\t\treadonly locations: Location[] | undefined,\n\t\treadonly model: CallHierarchyModel,\n\t\treadonly parent: Call | undefined\n\t) { }\n\n\tstatic compare(a: Call, b: Call): number {\n\t\tlet res = compare(a.item.uri.toString(), b.item.uri.toString());\n\t\tif (res === 0) {\n\t\t\tres = Range.compareRangesUsingStarts(a.item.range, b.item.range);\n\t\t}\n\t\treturn res;\n\t}\n}\n\nexport class DataSource implements IAsyncDataSource<CallHierarchyModel, Call> {\n\n\tconstructor(\n\t\tpublic getDirection: () => CallHierarchyDirection,\n\t) { }\n\n\thasChildren(): boolean {\n\t\treturn true;\n\t}\n\n\tasync getChildren(element: CallHierarchyModel | Call): Promise<Call[]> {\n\t\tif (element instanceof CallHierarchyModel) {\n\t\t\treturn element.roots.map(root => new Call(root, undefined, element, undefined));\n\t\t}\n\n\t\tconst { model, item } = element;\n\n\t\tif (this.getDirection() === CallHierarchyDirection.CallsFrom) {\n\t\t\treturn (await model.resolveOutgoingCalls(item, CancellationToken.None)).map(call => {\n\t\t\t\treturn new Call(\n\t\t\t\t\tcall.to,\n\t\t\t\t\tcall.fromRanges.map(range => ({ range, uri: item.uri })),\n\t\t\t\t\tmodel,\n\t\t\t\t\telement\n\t\t\t\t);\n\t\t\t});\n\n\t\t} else {\n\t\t\treturn (await model.resolveIncomingCalls(item, CancellationToken.None)).map(call => {\n\t\t\t\treturn new Call(\n\t\t\t\t\tcall.from,\n\t\t\t\t\tcall.fromRanges.map(range => ({ range, uri: call.from.uri })),\n\t\t\t\t\tmodel,\n\t\t\t\t\telement\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport class Sorter implements ITreeSorter<Call> {\n\n\tcompare(element: Call, otherElement: Call): number {\n\t\treturn Call.compare(element, otherElement);\n\t}\n}\n\nexport class IdentityProvider implements IIdentityProvider<Call> {\n\n\tconstructor(\n\t\tpublic getDirection: () => CallHierarchyDirection\n\t) { }\n\n\tgetId(element: Call): { toString(): string; } {\n\t\tlet res = this.getDirection() + JSON.stringify(element.item.uri) + JSON.stringify(element.item.range);\n\t\tif (element.parent) {\n\t\t\tres += this.getId(element.parent);\n\t\t}\n\t\treturn res;\n\t}\n}\n\nclass CallRenderingTemplate {\n\tconstructor(\n\t\treadonly icon: HTMLDivElement,\n\t\treadonly label: IconLabel\n\t) { }\n}\n\nexport class CallRenderer implements ITreeRenderer<Call, FuzzyScore, CallRenderingTemplate> {\n\n\tstatic readonly id = 'CallRenderer';\n\n\ttemplateId: string = CallRenderer.id;\n\n\trenderTemplate(container: HTMLElement): CallRenderingTemplate {\n\t\tcontainer.classList.add('callhierarchy-element');\n\t\tlet icon = document.createElement('div');\n\t\tcontainer.appendChild(icon);\n\t\tconst label = new IconLabel(container, { supportHighlights: true });\n\t\treturn new CallRenderingTemplate(icon, label);\n\t}\n\n\trenderElement(node: ITreeNode<Call, FuzzyScore>, _index: number, template: CallRenderingTemplate): void {\n\t\tconst { element, filterData } = node;\n\t\tconst deprecated = element.item.tags?.includes(SymbolTag.Deprecated);\n\t\ttemplate.icon.className = SymbolKinds.toCssClassName(element.item.kind, true);\n\t\ttemplate.label.setLabel(\n\t\t\telement.item.name,\n\t\t\telement.item.detail,\n\t\t\t{ labelEscapeNewLines: true, matches: createMatches(filterData), strikethrough: deprecated }\n\t\t);\n\t}\n\tdisposeTemplate(template: CallRenderingTemplate): void {\n\t\ttemplate.label.dispose();\n\t}\n}\n\nexport class VirtualDelegate implements IListVirtualDelegate<Call> {\n\n\tgetHeight(_element: Call): number {\n\t\treturn 22;\n\t}\n\n\tgetTemplateId(_element: Call): string {\n\t\treturn CallRenderer.id;\n\t}\n}\n\nexport class AccessibilityProvider implements IListAccessibilityProvider<Call> {\n\n\tconstructor(\n\t\tpublic getDirection: () => CallHierarchyDirection\n\t) { }\n\n\tgetWidgetAriaLabel(): string {\n\t\treturn localize('tree.aria', \"Call Hierarchy\");\n\t}\n\n\tgetAriaLabel(element: Call): string | null {\n\t\tif (this.getDirection() === CallHierarchyDirection.CallsFrom) {\n\t\t\treturn localize('from', \"calls from {0}\", element.item.name);\n\t\t} else {\n\t\t\treturn localize('to', \"callers of {0}\", element.item.name);\n\t\t}\n\t}\n}\n"]}