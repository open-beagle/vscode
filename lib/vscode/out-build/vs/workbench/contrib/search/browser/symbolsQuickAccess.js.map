{"version":3,"sources":["vs/workbench/contrib/search/browser/symbolsQuickAccess.ts"],"names":[],"mappings":"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","file":"symbolsQuickAccess.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport { IPickerQuickAccessItem, PickerQuickAccessProvider, TriggerAction } from 'vs/platform/quickinput/browser/pickerQuickAccess';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { ThrottledDelayer } from 'vs/base/common/async';\nimport { getWorkspaceSymbols, IWorkspaceSymbol, IWorkspaceSymbolProvider } from 'vs/workbench/contrib/search/common/search';\nimport { SymbolKinds, SymbolTag, SymbolKind } from 'vs/editor/common/modes';\nimport { ILabelService } from 'vs/platform/label/common/label';\nimport { Schemas } from 'vs/base/common/network';\nimport { IOpenerService } from 'vs/platform/opener/common/opener';\nimport { IEditorService, SIDE_GROUP, ACTIVE_GROUP } from 'vs/workbench/services/editor/common/editorService';\nimport { Range } from 'vs/editor/common/core/range';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IWorkbenchEditorConfiguration } from 'vs/workbench/common/editor';\nimport { IKeyMods, IQuickPickItemWithResource } from 'vs/platform/quickinput/common/quickInput';\nimport { ICodeEditorService } from 'vs/editor/browser/services/codeEditorService';\nimport { getSelectionSearchString } from 'vs/editor/contrib/find/findController';\nimport { withNullAsUndefined } from 'vs/base/common/types';\nimport { prepareQuery, IPreparedQuery, scoreFuzzy2, pieceToQuery } from 'vs/base/common/fuzzyScorer';\nimport { IMatch } from 'vs/base/common/filters';\nimport { Codicon } from 'vs/base/common/codicons';\n\ninterface ISymbolQuickPickItem extends IPickerQuickAccessItem, IQuickPickItemWithResource {\n\tscore?: number;\n\tsymbol?: IWorkspaceSymbol;\n}\n\nexport class SymbolsQuickAccessProvider extends PickerQuickAccessProvider<ISymbolQuickPickItem> {\n\n\tstatic PREFIX = '#';\n\n\tprivate static readonly TYPING_SEARCH_DELAY = 200; // this delay accommodates for the user typing a word and then stops typing to start searching\n\n\tprivate static TREAT_AS_GLOBAL_SYMBOL_TYPES = new Set<SymbolKind>([\n\t\tSymbolKind.Class,\n\t\tSymbolKind.Enum,\n\t\tSymbolKind.File,\n\t\tSymbolKind.Interface,\n\t\tSymbolKind.Namespace,\n\t\tSymbolKind.Package,\n\t\tSymbolKind.Module\n\t]);\n\n\tprivate delayer = this._register(new ThrottledDelayer<ISymbolQuickPickItem[]>(SymbolsQuickAccessProvider.TYPING_SEARCH_DELAY));\n\n\tget defaultFilterValue(): string | undefined {\n\n\t\t// Prefer the word under the cursor in the active editor as default filter\n\t\tconst editor = this.codeEditorService.getFocusedCodeEditor();\n\t\tif (editor) {\n\t\t\treturn withNullAsUndefined(getSelectionSearchString(editor));\n\t\t}\n\n\t\treturn undefined;\n\t}\n\n\tconstructor(\n\t\t@ILabelService private readonly labelService: ILabelService,\n\t\t@IOpenerService private readonly openerService: IOpenerService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ICodeEditorService private readonly codeEditorService: ICodeEditorService\n\t) {\n\t\tsuper(SymbolsQuickAccessProvider.PREFIX, {\n\t\t\tcanAcceptInBackground: true,\n\t\t\tnoResultsPick: {\n\t\t\t\tlabel: localize('noSymbolResults', \"No matching workspace symbols\")\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate get configuration() {\n\t\tconst editorConfig = this.configurationService.getValue<IWorkbenchEditorConfiguration>().workbench?.editor;\n\n\t\treturn {\n\t\t\topenEditorPinned: !editorConfig?.enablePreviewFromQuickOpen || !editorConfig?.enablePreview,\n\t\t\topenSideBySideDirection: editorConfig?.openSideBySideDirection\n\t\t};\n\t}\n\n\tprotected getPicks(filter: string, disposables: DisposableStore, token: CancellationToken): Promise<Array<ISymbolQuickPickItem>> {\n\t\treturn this.getSymbolPicks(filter, undefined, token);\n\t}\n\n\tasync getSymbolPicks(filter: string, options: { skipLocal?: boolean, skipSorting?: boolean, delay?: number } | undefined, token: CancellationToken): Promise<Array<ISymbolQuickPickItem>> {\n\t\treturn this.delayer.trigger(async () => {\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn this.doGetSymbolPicks(prepareQuery(filter), options, token);\n\t\t}, options?.delay);\n\t}\n\n\tprivate async doGetSymbolPicks(query: IPreparedQuery, options: { skipLocal?: boolean, skipSorting?: boolean } | undefined, token: CancellationToken): Promise<Array<ISymbolQuickPickItem>> {\n\n\t\t// Split between symbol and container query\n\t\tlet symbolQuery: IPreparedQuery;\n\t\tlet containerQuery: IPreparedQuery | undefined;\n\t\tif (query.values && query.values.length > 1) {\n\t\t\tsymbolQuery = pieceToQuery(query.values[0]); \t\t  // symbol: only match on first part\n\t\t\tcontainerQuery = pieceToQuery(query.values.slice(1)); // container: match on all but first parts\n\t\t} else {\n\t\t\tsymbolQuery = query;\n\t\t}\n\n\t\t// Run the workspace symbol query\n\t\tconst workspaceSymbols = await getWorkspaceSymbols(symbolQuery.original, token);\n\t\tif (token.isCancellationRequested) {\n\t\t\treturn [];\n\t\t}\n\n\t\tconst symbolPicks: Array<ISymbolQuickPickItem> = [];\n\n\t\t// Convert to symbol picks and apply filtering\n\t\tconst openSideBySideDirection = this.configuration.openSideBySideDirection;\n\t\tfor (const [provider, symbols] of workspaceSymbols) {\n\t\t\tfor (const symbol of symbols) {\n\n\t\t\t\t// Depending on the workspace symbols filter setting, skip over symbols that:\n\t\t\t\t// - do not have a container\n\t\t\t\t// - and are not treated explicitly as global symbols (e.g. classes)\n\t\t\t\tif (options?.skipLocal && !SymbolsQuickAccessProvider.TREAT_AS_GLOBAL_SYMBOL_TYPES.has(symbol.kind) && !!symbol.containerName) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\n\t\t\t\tconst symbolLabel = symbol.name;\n\t\t\t\tconst symbolLabelWithIcon = `$(symbol-${SymbolKinds.toString(symbol.kind) || 'property'}) ${symbolLabel}`;\n\t\t\t\tconst symbolLabelIconOffset = symbolLabelWithIcon.length - symbolLabel.length;\n\n\t\t\t\t// Score by symbol label if searching\n\t\t\t\tlet symbolScore: number | undefined = undefined;\n\t\t\t\tlet symbolMatches: IMatch[] | undefined = undefined;\n\t\t\t\tlet skipContainerQuery = false;\n\t\t\t\tif (symbolQuery.original.length > 0) {\n\n\t\t\t\t\t// First: try to score on the entire query, it is possible that\n\t\t\t\t\t// the symbol matches perfectly (e.g. searching for \"change log\"\n\t\t\t\t\t// can be a match on a markdown symbol \"change log\"). In that\n\t\t\t\t\t// case we want to skip the container query altogether.\n\t\t\t\t\tif (symbolQuery !== query) {\n\t\t\t\t\t\t[symbolScore, symbolMatches] = scoreFuzzy2(symbolLabelWithIcon, { ...query, values: undefined /* disable multi-query support */ }, 0, symbolLabelIconOffset);\n\t\t\t\t\t\tif (typeof symbolScore === 'number') {\n\t\t\t\t\t\t\tskipContainerQuery = true; // since we consumed the query, skip any container matching\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Otherwise: score on the symbol query and match on the container later\n\t\t\t\t\tif (typeof symbolScore !== 'number') {\n\t\t\t\t\t\t[symbolScore, symbolMatches] = scoreFuzzy2(symbolLabelWithIcon, symbolQuery, 0, symbolLabelIconOffset);\n\t\t\t\t\t\tif (typeof symbolScore !== 'number') {\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst symbolUri = symbol.location.uri;\n\t\t\t\tlet containerLabel: string | undefined = undefined;\n\t\t\t\tif (symbolUri) {\n\t\t\t\t\tconst containerPath = this.labelService.getUriLabel(symbolUri, { relative: true });\n\t\t\t\t\tif (symbol.containerName) {\n\t\t\t\t\t\tcontainerLabel = `${symbol.containerName} • ${containerPath}`;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontainerLabel = containerPath;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Score by container if specified and searching\n\t\t\t\tlet containerScore: number | undefined = undefined;\n\t\t\t\tlet containerMatches: IMatch[] | undefined = undefined;\n\t\t\t\tif (!skipContainerQuery && containerQuery && containerQuery.original.length > 0) {\n\t\t\t\t\tif (containerLabel) {\n\t\t\t\t\t\t[containerScore, containerMatches] = scoreFuzzy2(containerLabel, containerQuery);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof containerScore !== 'number') {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (typeof symbolScore === 'number') {\n\t\t\t\t\t\tsymbolScore += containerScore; // boost symbolScore by containerScore\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconst deprecated = symbol.tags ? symbol.tags.indexOf(SymbolTag.Deprecated) >= 0 : false;\n\n\t\t\t\tsymbolPicks.push({\n\t\t\t\t\tsymbol,\n\t\t\t\t\tresource: symbolUri,\n\t\t\t\t\tscore: symbolScore,\n\t\t\t\t\tlabel: symbolLabelWithIcon,\n\t\t\t\t\tariaLabel: symbolLabel,\n\t\t\t\t\thighlights: deprecated ? undefined : {\n\t\t\t\t\t\tlabel: symbolMatches,\n\t\t\t\t\t\tdescription: containerMatches\n\t\t\t\t\t},\n\t\t\t\t\tdescription: containerLabel,\n\t\t\t\t\tstrikethrough: deprecated,\n\t\t\t\t\tbuttons: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ticonClass: openSideBySideDirection === 'right' ? Codicon.splitHorizontal.classNames : Codicon.splitVertical.classNames,\n\t\t\t\t\t\t\ttooltip: openSideBySideDirection === 'right' ? localize('openToSide', \"Open to the Side\") : localize('openToBottom', \"Open to the Bottom\")\n\t\t\t\t\t\t}\n\t\t\t\t\t],\n\t\t\t\t\ttrigger: (buttonIndex, keyMods) => {\n\t\t\t\t\t\tthis.openSymbol(provider, symbol, token, { keyMods, forceOpenSideBySide: true });\n\n\t\t\t\t\t\treturn TriggerAction.CLOSE_PICKER;\n\t\t\t\t\t},\n\t\t\t\t\taccept: async (keyMods, event) => this.openSymbol(provider, symbol, token, { keyMods, preserveFocus: event.inBackground, forcePinned: event.inBackground }),\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// Sort picks (unless disabled)\n\t\tif (!options?.skipSorting) {\n\t\t\tsymbolPicks.sort((symbolA, symbolB) => this.compareSymbols(symbolA, symbolB));\n\t\t}\n\n\t\treturn symbolPicks;\n\t}\n\n\tprivate async openSymbol(provider: IWorkspaceSymbolProvider, symbol: IWorkspaceSymbol, token: CancellationToken, options: { keyMods: IKeyMods, forceOpenSideBySide?: boolean, preserveFocus?: boolean, forcePinned?: boolean }): Promise<void> {\n\n\t\t// Resolve actual symbol to open for providers that can resolve\n\t\tlet symbolToOpen = symbol;\n\t\tif (typeof provider.resolveWorkspaceSymbol === 'function' && !symbol.location.range) {\n\t\t\tsymbolToOpen = await provider.resolveWorkspaceSymbol(symbol, token) || symbol;\n\n\t\t\tif (token.isCancellationRequested) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\t// Open HTTP(s) links with opener service\n\t\tif (symbolToOpen.location.uri.scheme === Schemas.http || symbolToOpen.location.uri.scheme === Schemas.https) {\n\t\t\tawait this.openerService.open(symbolToOpen.location.uri, { fromUserGesture: true, allowContributedOpeners: true });\n\t\t}\n\n\t\t// Otherwise open as editor\n\t\telse {\n\t\t\tawait this.editorService.openEditor({\n\t\t\t\tresource: symbolToOpen.location.uri,\n\t\t\t\toptions: {\n\t\t\t\t\tpreserveFocus: options?.preserveFocus,\n\t\t\t\t\tpinned: options.keyMods.ctrlCmd || options.forcePinned || this.configuration.openEditorPinned,\n\t\t\t\t\tselection: symbolToOpen.location.range ? Range.collapseToStart(symbolToOpen.location.range) : undefined\n\t\t\t\t}\n\t\t\t}, options.keyMods.alt || (this.configuration.openEditorPinned && options.keyMods.ctrlCmd) || options?.forceOpenSideBySide ? SIDE_GROUP : ACTIVE_GROUP);\n\t\t}\n\t}\n\n\tprivate compareSymbols(symbolA: ISymbolQuickPickItem, symbolB: ISymbolQuickPickItem): number {\n\n\t\t// By score\n\t\tif (typeof symbolA.score === 'number' && typeof symbolB.score === 'number') {\n\t\t\tif (symbolA.score > symbolB.score) {\n\t\t\t\treturn -1;\n\t\t\t}\n\n\t\t\tif (symbolA.score < symbolB.score) {\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t}\n\n\t\t// By name\n\t\tif (symbolA.symbol && symbolB.symbol) {\n\t\t\tconst symbolAName = symbolA.symbol.name.toLowerCase();\n\t\t\tconst symbolBName = symbolB.symbol.name.toLowerCase();\n\t\t\tconst res = symbolAName.localeCompare(symbolBName);\n\t\t\tif (res !== 0) {\n\t\t\t\treturn res;\n\t\t\t}\n\t\t}\n\n\t\t// By kind\n\t\tif (symbolA.symbol && symbolB.symbol) {\n\t\t\tconst symbolAKind = SymbolKinds.toCssClassName(symbolA.symbol.kind);\n\t\t\tconst symbolBKind = SymbolKinds.toCssClassName(symbolB.symbol.kind);\n\t\t\treturn symbolAKind.localeCompare(symbolBKind);\n\t\t}\n\n\t\treturn 0;\n\t}\n}\n"]}