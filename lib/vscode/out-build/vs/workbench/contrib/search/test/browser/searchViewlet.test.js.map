{"version":3,"file":"searchViewlet.test.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/contrib/search/test/browser/searchViewlet.test.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as assert from 'assert';\nimport { URI as uri } from 'vs/base/common/uri';\nimport { IModelService } from 'vs/editor/common/services/modelService';\nimport { ModelServiceImpl } from 'vs/editor/common/services/modelServiceImpl';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { TestConfigurationService } from 'vs/platform/configuration/test/common/testConfigurationService';\nimport { TestInstantiationService } from 'vs/platform/instantiation/test/common/instantiationServiceMock';\nimport { IFileMatch, ITextSearchMatch, OneLineRange, QueryType, SearchSortOrder } from 'vs/workbench/services/search/common/search';\nimport { IWorkspaceContextService } from 'vs/platform/workspace/common/workspace';\nimport { TestWorkspace } from 'vs/platform/workspace/test/common/testWorkspace';\nimport { FileMatch, Match, searchMatchComparer, SearchResult } from 'vs/workbench/contrib/search/common/searchModel';\nimport { isWindows } from 'vs/base/common/platform';\nimport { TestContextService } from 'vs/workbench/test/common/workbenchTestServices';\nimport { IThemeService } from 'vs/platform/theme/common/themeService';\nimport { TestThemeService } from 'vs/platform/theme/test/common/testThemeService';\nimport { FileService } from 'vs/platform/files/common/fileService';\nimport { NullLogService } from 'vs/platform/log/common/log';\nimport { IUriIdentityService } from 'vs/workbench/services/uriIdentity/common/uriIdentity';\nimport { UriIdentityService } from 'vs/workbench/services/uriIdentity/common/uriIdentityService';\n\nsuite('Search - Viewlet', () => {\n\tlet instantiation: TestInstantiationService;\n\n\tsetup(() => {\n\t\tinstantiation = new TestInstantiationService();\n\t\tinstantiation.stub(IModelService, stubModelService(instantiation));\n\t\tinstantiation.set(IWorkspaceContextService, new TestContextService(TestWorkspace));\n\t\tinstantiation.stub(IUriIdentityService, new UriIdentityService(new FileService(new NullLogService())));\n\t});\n\n\ttest('Data Source', function () {\n\t\tconst result: SearchResult = instantiation.createInstance(SearchResult, null);\n\t\tresult.query = {\n\t\t\ttype: QueryType.Text,\n\t\t\tcontentPattern: { pattern: 'foo' },\n\t\t\tfolderQueries: [{\n\t\t\t\tfolder: uri.parse('file://c:/')\n\t\t\t}]\n\t\t};\n\n\t\tresult.add([{\n\t\t\tresource: uri.parse('file:///c:/foo'),\n\t\t\tresults: [{\n\t\t\t\tpreview: {\n\t\t\t\t\ttext: 'bar',\n\t\t\t\t\tmatches: {\n\t\t\t\t\t\tstartLineNumber: 0,\n\t\t\t\t\t\tstartColumn: 0,\n\t\t\t\t\t\tendLineNumber: 0,\n\t\t\t\t\t\tendColumn: 1\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tranges: {\n\t\t\t\t\tstartLineNumber: 1,\n\t\t\t\t\tstartColumn: 0,\n\t\t\t\t\tendLineNumber: 1,\n\t\t\t\t\tendColumn: 1\n\t\t\t\t}\n\t\t\t}]\n\t\t}]);\n\n\t\tconst fileMatch = result.matches()[0];\n\t\tconst lineMatch = fileMatch.matches()[0];\n\n\t\tassert.strictEqual(fileMatch.id(), 'file:///c%3A/foo');\n\t\tassert.strictEqual(lineMatch.id(), 'file:///c%3A/foo>[2,1 -> 2,2]b');\n\t});\n\n\ttest('Comparer', () => {\n\t\tconst fileMatch1 = aFileMatch(isWindows ? 'C:\\\\foo' : '/c/foo');\n\t\tconst fileMatch2 = aFileMatch(isWindows ? 'C:\\\\with\\\\path' : '/c/with/path');\n\t\tconst fileMatch3 = aFileMatch(isWindows ? 'C:\\\\with\\\\path\\\\foo' : '/c/with/path/foo');\n\t\tconst lineMatch1 = new Match(fileMatch1, ['bar'], new OneLineRange(0, 1, 1), new OneLineRange(0, 1, 1));\n\t\tconst lineMatch2 = new Match(fileMatch1, ['bar'], new OneLineRange(0, 1, 1), new OneLineRange(2, 1, 1));\n\t\tconst lineMatch3 = new Match(fileMatch1, ['bar'], new OneLineRange(0, 1, 1), new OneLineRange(2, 1, 1));\n\n\t\tassert(searchMatchComparer(fileMatch1, fileMatch2) < 0);\n\t\tassert(searchMatchComparer(fileMatch2, fileMatch1) > 0);\n\t\tassert(searchMatchComparer(fileMatch1, fileMatch1) === 0);\n\t\tassert(searchMatchComparer(fileMatch2, fileMatch3) < 0);\n\n\t\tassert(searchMatchComparer(lineMatch1, lineMatch2) < 0);\n\t\tassert(searchMatchComparer(lineMatch2, lineMatch1) > 0);\n\t\tassert(searchMatchComparer(lineMatch2, lineMatch3) === 0);\n\t});\n\n\ttest('Advanced Comparer', () => {\n\t\tconst fileMatch1 = aFileMatch(isWindows ? 'C:\\\\with\\\\path\\\\foo10' : '/c/with/path/foo10');\n\t\tconst fileMatch2 = aFileMatch(isWindows ? 'C:\\\\with\\\\path2\\\\foo1' : '/c/with/path2/foo1');\n\t\tconst fileMatch3 = aFileMatch(isWindows ? 'C:\\\\with\\\\path2\\\\bar.a' : '/c/with/path2/bar.a');\n\t\tconst fileMatch4 = aFileMatch(isWindows ? 'C:\\\\with\\\\path2\\\\bar.b' : '/c/with/path2/bar.b');\n\n\t\t// By default, path < path2\n\t\tassert(searchMatchComparer(fileMatch1, fileMatch2) < 0);\n\t\t// By filenames, foo10 > foo1\n\t\tassert(searchMatchComparer(fileMatch1, fileMatch2, SearchSortOrder.FileNames) > 0);\n\t\t// By type, bar.a < bar.b\n\t\tassert(searchMatchComparer(fileMatch3, fileMatch4, SearchSortOrder.Type) < 0);\n\t});\n\n\tfunction aFileMatch(path: string, searchResult?: SearchResult, ...lineMatches: ITextSearchMatch[]): FileMatch {\n\t\tconst rawMatch: IFileMatch = {\n\t\t\tresource: uri.file(path),\n\t\t\tresults: lineMatches\n\t\t};\n\t\treturn instantiation.createInstance(FileMatch, null, null, null, searchResult, rawMatch);\n\t}\n\n\tfunction stubModelService(instantiationService: TestInstantiationService): IModelService {\n\t\tinstantiationService.stub(IConfigurationService, new TestConfigurationService());\n\t\tinstantiationService.stub(IThemeService, new TestThemeService());\n\t\treturn instantiationService.createInstance(ModelServiceImpl);\n\t}\n});\n"]}