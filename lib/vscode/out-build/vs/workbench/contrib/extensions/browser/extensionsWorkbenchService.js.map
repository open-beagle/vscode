{"version":3,"sources":["vs/workbench/contrib/extensions/browser/extensionsWorkbenchService.ts"],"names":[],"mappings":"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","file":"extensionsWorkbenchService.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport * as semver from 'vs/base/common/semver/semver';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { index, distinct } from 'vs/base/common/arrays';\nimport { Promises, ThrottledDelayer } from 'vs/base/common/async';\nimport { canceled, isPromiseCanceledError } from 'vs/base/common/errors';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { IPager, mapPager, singlePagePager } from 'vs/base/common/paging';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport {\n\tIExtensionGalleryService, ILocalExtension, IGalleryExtension, IQueryOptions,\n\tInstallExtensionEvent, DidInstallExtensionEvent, DidUninstallExtensionEvent, IExtensionIdentifier, InstallOperation, DefaultIconPath, InstallOptions\n} from 'vs/platform/extensionManagement/common/extensionManagement';\nimport { IWorkbenchExtensionEnablementService, EnablementState, IExtensionManagementServerService, IExtensionManagementServer, IWorkbenchExtensionManagementService } from 'vs/workbench/services/extensionManagement/common/extensionManagement';\nimport { getGalleryExtensionTelemetryData, getLocalExtensionTelemetryData, areSameExtensions, getMaliciousExtensionsSet, groupByExtension, ExtensionIdentifierWithVersion, getGalleryExtensionId } from 'vs/platform/extensionManagement/common/extensionManagementUtil';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IHostService } from 'vs/workbench/services/host/browser/host';\nimport { URI } from 'vs/base/common/uri';\nimport { IExtension, ExtensionState, IExtensionsWorkbenchService, AutoUpdateConfigurationKey, AutoCheckUpdatesConfigurationKey, HasOutdatedExtensionsContext } from 'vs/workbench/contrib/extensions/common/extensions';\nimport { IEditorService, SIDE_GROUP, ACTIVE_GROUP } from 'vs/workbench/services/editor/common/editorService';\nimport { IURLService, IURLHandler, IOpenURLOptions } from 'vs/platform/url/common/url';\nimport { ExtensionsInput } from 'vs/workbench/contrib/extensions/common/extensionsInput';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { IProgressService, ProgressLocation } from 'vs/platform/progress/common/progress';\nimport { INotificationService, Severity } from 'vs/platform/notification/common/notification';\nimport * as resources from 'vs/base/common/resources';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { IStorageService, StorageScope, StorageTarget } from 'vs/platform/storage/common/storage';\nimport { IFileService } from 'vs/platform/files/common/files';\nimport { IExtensionManifest, ExtensionType, IExtension as IPlatformExtension } from 'vs/platform/extensions/common/extensions';\nimport { IModeService } from 'vs/editor/common/services/modeService';\nimport { IProductService } from 'vs/platform/product/common/productService';\nimport { FileAccess } from 'vs/base/common/network';\nimport { IIgnoredExtensionsManagementService } from 'vs/platform/userDataSync/common/ignoredExtensions';\nimport { IUserDataAutoSyncService } from 'vs/platform/userDataSync/common/userDataSync';\nimport { IContextKey, IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { isBoolean } from 'vs/base/common/types';\nimport { IExtensionManifestPropertiesService } from 'vs/workbench/services/extensions/common/extensionManifestPropertiesService';\n\ninterface IExtensionStateProvider<T> {\n\t(extension: Extension): T;\n}\n\nclass Extension implements IExtension {\n\n\tpublic enablementState: EnablementState = EnablementState.EnabledGlobally;\n\n\tconstructor(\n\t\tprivate stateProvider: IExtensionStateProvider<ExtensionState>,\n\t\tpublic readonly server: IExtensionManagementServer | undefined,\n\t\tpublic local: ILocalExtension | undefined,\n\t\tpublic gallery: IGalleryExtension | undefined,\n\t\t@IExtensionGalleryService private readonly galleryService: IExtensionGalleryService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@ILogService private readonly logService: ILogService,\n\t\t@IFileService private readonly fileService: IFileService,\n\t\t@IProductService private readonly productService: IProductService\n\t) { }\n\n\tget type(): ExtensionType {\n\t\treturn this.local ? this.local.type : ExtensionType.User;\n\t}\n\n\tget isBuiltin(): boolean {\n\t\treturn this.local ? this.local.isBuiltin : false;\n\t}\n\n\tget name(): string {\n\t\treturn this.gallery ? this.gallery.name : this.local!.manifest.name;\n\t}\n\n\tget displayName(): string {\n\t\tif (this.gallery) {\n\t\t\treturn this.gallery.displayName || this.gallery.name;\n\t\t}\n\n\t\treturn this.local!.manifest.displayName || this.local!.manifest.name;\n\t}\n\n\tget identifier(): IExtensionIdentifier {\n\t\tif (this.gallery) {\n\t\t\treturn this.gallery.identifier;\n\t\t}\n\t\treturn this.local!.identifier;\n\t}\n\n\tget uuid(): string | undefined {\n\t\treturn this.gallery ? this.gallery.identifier.uuid : this.local!.identifier.uuid;\n\t}\n\n\tget publisher(): string {\n\t\treturn this.gallery ? this.gallery.publisher : this.local!.manifest.publisher;\n\t}\n\n\tget publisherDisplayName(): string {\n\t\tif (this.gallery) {\n\t\t\treturn this.gallery.publisherDisplayName || this.gallery.publisher;\n\t\t}\n\n\t\tif (this.local?.publisherDisplayName) {\n\t\t\treturn this.local.publisherDisplayName;\n\t\t}\n\n\t\treturn this.local!.manifest.publisher;\n\t}\n\n\tget version(): string {\n\t\treturn this.local ? this.local.manifest.version : this.latestVersion;\n\t}\n\n\tget latestVersion(): string {\n\t\treturn this.gallery ? this.gallery.version : this.local!.manifest.version;\n\t}\n\n\tget description(): string {\n\t\treturn this.gallery ? this.gallery.description : this.local!.manifest.description || '';\n\t}\n\n\tget url(): string | undefined {\n\t\tif (!this.productService.extensionsGallery || !this.gallery) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\treturn `${this.productService.extensionsGallery.itemUrl}?itemName=${this.publisher}.${this.name}`;\n\t}\n\n\tget iconUrl(): string {\n\t\treturn this.galleryIconUrl || this.localIconUrl || this.defaultIconUrl;\n\t}\n\n\tget iconUrlFallback(): string {\n\t\treturn this.galleryIconUrlFallback || this.localIconUrl || this.defaultIconUrl;\n\t}\n\n\tprivate get localIconUrl(): string | null {\n\t\tif (this.local && this.local.manifest.icon) {\n\t\t\treturn FileAccess.asBrowserUri(resources.joinPath(this.local.location, this.local.manifest.icon)).toString(true);\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate get galleryIconUrl(): string | null {\n\t\treturn this.gallery ? this.gallery.assets.icon.uri : null;\n\t}\n\n\tprivate get galleryIconUrlFallback(): string | null {\n\t\treturn this.gallery ? this.gallery.assets.icon.fallbackUri : null;\n\t}\n\n\tprivate get defaultIconUrl(): string {\n\t\tif (this.type === ExtensionType.System && this.local) {\n\t\t\tif (this.local.manifest && this.local.manifest.contributes) {\n\t\t\t\tif (Array.isArray(this.local.manifest.contributes.themes) && this.local.manifest.contributes.themes.length) {\n\t\t\t\t\treturn FileAccess.asBrowserUri('./media/theme-icon.png', require).toString(true);\n\t\t\t\t}\n\t\t\t\tif (Array.isArray(this.local.manifest.contributes.grammars) && this.local.manifest.contributes.grammars.length) {\n\t\t\t\t\treturn FileAccess.asBrowserUri('./media/language-icon.svg', require).toString(true);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn DefaultIconPath;\n\t}\n\n\tget repository(): string | undefined {\n\t\treturn this.gallery && this.gallery.assets.repository ? this.gallery.assets.repository.uri : undefined;\n\t}\n\n\tget licenseUrl(): string | undefined {\n\t\treturn this.gallery && this.gallery.assets.license ? this.gallery.assets.license.uri : undefined;\n\t}\n\n\tget state(): ExtensionState {\n\t\treturn this.stateProvider(this);\n\t}\n\n\tpublic isMalicious: boolean = false;\n\n\tget installCount(): number | undefined {\n\t\treturn this.gallery ? this.gallery.installCount : undefined;\n\t}\n\n\tget rating(): number | undefined {\n\t\treturn this.gallery ? this.gallery.rating : undefined;\n\t}\n\n\tget ratingCount(): number | undefined {\n\t\treturn this.gallery ? this.gallery.ratingCount : undefined;\n\t}\n\n\tget outdated(): boolean {\n\t\treturn !!this.gallery && this.type === ExtensionType.User && semver.gt(this.latestVersion, this.version);\n\t}\n\n\tget telemetryData(): any {\n\t\tconst { local, gallery } = this;\n\n\t\tif (gallery) {\n\t\t\treturn getGalleryExtensionTelemetryData(gallery);\n\t\t} else {\n\t\t\treturn getLocalExtensionTelemetryData(local!);\n\t\t}\n\t}\n\n\tget preview(): boolean {\n\t\treturn this.gallery ? this.gallery.preview : false;\n\t}\n\n\tgetManifest(token: CancellationToken): Promise<IExtensionManifest | null> {\n\t\tif (this.local && !this.outdated) {\n\t\t\treturn Promise.resolve(this.local.manifest);\n\t\t}\n\n\t\tif (this.gallery) {\n\t\t\tif (this.gallery.assets.manifest) {\n\t\t\t\treturn this.galleryService.getManifest(this.gallery, token);\n\t\t\t}\n\t\t\tthis.logService.error(nls.localize('Manifest is not found', \"Manifest is not found\"), this.identifier.id);\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\treturn Promise.resolve(null);\n\t}\n\n\thasReadme(): boolean {\n\t\tif (this.local && this.local.readmeUrl) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.gallery && this.gallery.assets.readme) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn this.type === ExtensionType.System;\n\t}\n\n\tgetReadme(token: CancellationToken): Promise<string> {\n\t\tif (this.local && this.local.readmeUrl && !this.outdated) {\n\t\t\treturn this.fileService.readFile(this.local.readmeUrl).then(content => content.value.toString());\n\t\t}\n\n\t\tif (this.gallery) {\n\t\t\tif (this.gallery.assets.readme) {\n\t\t\t\treturn this.galleryService.getReadme(this.gallery, token);\n\t\t\t}\n\t\t\tthis.telemetryService.publicLog('extensions:NotFoundReadMe', this.telemetryData);\n\t\t}\n\n\t\tif (this.type === ExtensionType.System) {\n\t\t\treturn Promise.resolve(`# ${this.displayName || this.name}\n**Notice:** This extension is bundled with Visual Studio Code. It can be disabled but not uninstalled.\n## Features\n${this.description}\n`);\n\t\t}\n\n\t\treturn Promise.reject(new Error('not available'));\n\t}\n\n\thasChangelog(): boolean {\n\t\tif (this.local && this.local.changelogUrl) {\n\t\t\treturn true;\n\t\t}\n\n\t\tif (this.gallery && this.gallery.assets.changelog) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn this.type === ExtensionType.System;\n\t}\n\n\tgetChangelog(token: CancellationToken): Promise<string> {\n\n\t\tif (this.local && this.local.changelogUrl && !this.outdated) {\n\t\t\treturn this.fileService.readFile(this.local.changelogUrl).then(content => content.value.toString());\n\t\t}\n\n\t\tif (this.gallery && this.gallery.assets.changelog) {\n\t\t\treturn this.galleryService.getChangelog(this.gallery, token);\n\t\t}\n\n\t\tif (this.type === ExtensionType.System) {\n\t\t\treturn Promise.resolve('Please check the [VS Code Release Notes](command:update.showCurrentReleaseNotes) for changes to the built-in extensions.');\n\t\t}\n\n\t\treturn Promise.reject(new Error('not available'));\n\t}\n\n\tget dependencies(): string[] {\n\t\tconst { local, gallery } = this;\n\t\tif (local && local.manifest.extensionDependencies && !this.outdated) {\n\t\t\treturn local.manifest.extensionDependencies;\n\t\t}\n\t\tif (gallery) {\n\t\t\treturn gallery.properties.dependencies || [];\n\t\t}\n\t\treturn [];\n\t}\n\n\tget extensionPack(): string[] {\n\t\tconst { local, gallery } = this;\n\t\tif (local && local.manifest.extensionPack && !this.outdated) {\n\t\t\treturn local.manifest.extensionPack;\n\t\t}\n\t\tif (gallery) {\n\t\t\treturn gallery.properties.extensionPack || [];\n\t\t}\n\t\treturn [];\n\t}\n}\n\nclass Extensions extends Disposable {\n\n\tprivate readonly _onChange: Emitter<{ extension: Extension, operation?: InstallOperation } | undefined> = this._register(new Emitter<{ extension: Extension, operation?: InstallOperation } | undefined>());\n\tget onChange(): Event<{ extension: Extension, operation?: InstallOperation } | undefined> { return this._onChange.event; }\n\n\tprivate installing: Extension[] = [];\n\tprivate uninstalling: Extension[] = [];\n\tprivate installed: Extension[] = [];\n\n\tconstructor(\n\t\tprivate readonly server: IExtensionManagementServer,\n\t\tprivate readonly stateProvider: IExtensionStateProvider<ExtensionState>,\n\t\t@IExtensionGalleryService private readonly galleryService: IExtensionGalleryService,\n\t\t@IWorkbenchExtensionEnablementService private readonly extensionEnablementService: IWorkbenchExtensionEnablementService,\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService\n\t) {\n\t\tsuper();\n\t\tthis._register(server.extensionManagementService.onInstallExtension(e => this.onInstallExtension(e)));\n\t\tthis._register(server.extensionManagementService.onDidInstallExtension(e => this.onDidInstallExtension(e)));\n\t\tthis._register(server.extensionManagementService.onUninstallExtension(e => this.onUninstallExtension(e)));\n\t\tthis._register(server.extensionManagementService.onDidUninstallExtension(e => this.onDidUninstallExtension(e)));\n\t\tthis._register(extensionEnablementService.onEnablementChanged(e => this.onEnablementChanged(e)));\n\t}\n\n\tget local(): IExtension[] {\n\t\tconst installing = this.installing\n\t\t\t.filter(e => !this.installed.some(installed => areSameExtensions(installed.identifier, e.identifier)))\n\t\t\t.map(e => e);\n\n\t\treturn [...this.installed, ...installing];\n\t}\n\n\tasync queryInstalled(): Promise<IExtension[]> {\n\t\tconst all = await this.server.extensionManagementService.getInstalled();\n\n\t\t// dedup user and system extensions by giving priority to user extensions.\n\t\tconst installed = groupByExtension(all, r => r.identifier).reduce((result, extensions) => {\n\t\t\tconst extension = extensions.length === 1 ? extensions[0]\n\t\t\t\t: extensions.find(e => e.type === ExtensionType.User) || extensions.find(e => e.type === ExtensionType.System);\n\t\t\tresult.push(extension!);\n\t\t\treturn result;\n\t\t}, []);\n\n\t\tconst byId = index(this.installed, e => e.local ? e.local.identifier.id : e.identifier.id);\n\t\tthis.installed = installed.map(local => {\n\t\t\tconst extension = byId[local.identifier.id] || this.instantiationService.createInstance(Extension, this.stateProvider, this.server, local, undefined);\n\t\t\textension.local = local;\n\t\t\textension.enablementState = this.extensionEnablementService.getEnablementState(local);\n\t\t\treturn extension;\n\t\t});\n\t\tthis._onChange.fire(undefined);\n\t\treturn this.local;\n\t}\n\n\tasync syncLocalWithGalleryExtension(gallery: IGalleryExtension, maliciousExtensionSet: Set<string>): Promise<boolean> {\n\t\tconst extension = this.getInstalledExtensionMatchingGallery(gallery);\n\t\tif (!extension) {\n\t\t\treturn false;\n\t\t}\n\t\tif (maliciousExtensionSet.has(extension.identifier.id)) {\n\t\t\textension.isMalicious = true;\n\t\t}\n\t\t// Loading the compatible version only there is an engine property\n\t\t// Otherwise falling back to old way so that we will not make many roundtrips\n\t\tconst compatible = gallery.properties.engine ? await this.galleryService.getCompatibleExtension(gallery) : gallery;\n\t\tif (!compatible) {\n\t\t\treturn false;\n\t\t}\n\t\t// Sync the local extension with gallery extension if local extension doesnot has metadata\n\t\tif (extension.local) {\n\t\t\tconst local = extension.local.identifier.uuid ? extension.local : await this.server.extensionManagementService.updateMetadata(extension.local, { id: compatible.identifier.uuid, publisherDisplayName: compatible.publisherDisplayName, publisherId: compatible.publisherId });\n\t\t\textension.local = local;\n\t\t\textension.gallery = compatible;\n\t\t\tthis._onChange.fire({ extension });\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate async syncInstalledExtensionWithGallery(extension: Extension): Promise<void> {\n\t\tconst compatible = await this.galleryService.getCompatibleExtension(extension.identifier);\n\t\tif (compatible) {\n\t\t\textension.gallery = compatible;\n\t\t\tthis._onChange.fire({ extension });\n\t\t}\n\t}\n\n\tprivate getInstalledExtensionMatchingGallery(gallery: IGalleryExtension): Extension | null {\n\t\tfor (const installed of this.installed) {\n\t\t\tif (installed.uuid) { // Installed from Gallery\n\t\t\t\tif (installed.uuid === gallery.identifier.uuid) {\n\t\t\t\t\treturn installed;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (areSameExtensions(installed.identifier, gallery.identifier)) { // Installed from other sources\n\t\t\t\t\treturn installed;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate onInstallExtension(event: InstallExtensionEvent): void {\n\t\tconst { gallery } = event;\n\t\tif (gallery) {\n\t\t\tconst extension = this.installed.filter(e => areSameExtensions(e.identifier, gallery.identifier))[0]\n\t\t\t\t|| this.instantiationService.createInstance(Extension, this.stateProvider, this.server, undefined, gallery);\n\t\t\tthis.installing.push(extension);\n\t\t\tthis._onChange.fire({ extension });\n\t\t}\n\t}\n\n\tprivate onDidInstallExtension(event: DidInstallExtensionEvent): void {\n\t\tconst { local, zipPath, error, gallery } = event;\n\t\tconst installingExtension = gallery ? this.installing.filter(e => areSameExtensions(e.identifier, gallery.identifier))[0] : null;\n\t\tthis.installing = installingExtension ? this.installing.filter(e => e !== installingExtension) : this.installing;\n\n\t\tlet extension: Extension | undefined = installingExtension ? installingExtension\n\t\t\t: (zipPath || local) ? this.instantiationService.createInstance(Extension, this.stateProvider, this.server, local, undefined)\n\t\t\t\t: undefined;\n\t\tif (extension) {\n\t\t\tif (local) {\n\t\t\t\tconst installed = this.installed.filter(e => areSameExtensions(e.identifier, extension!.identifier))[0];\n\t\t\t\tif (installed) {\n\t\t\t\t\textension = installed;\n\t\t\t\t} else {\n\t\t\t\t\tthis.installed.push(extension);\n\t\t\t\t}\n\t\t\t\textension.local = local;\n\t\t\t\tif (!extension.gallery) {\n\t\t\t\t\textension.gallery = gallery;\n\t\t\t\t}\n\t\t\t\textension.enablementState = this.extensionEnablementService.getEnablementState(local);\n\t\t\t}\n\t\t}\n\t\tthis._onChange.fire(error || !extension ? undefined : { extension, operation: event.operation });\n\t\tif (extension && !extension.gallery) {\n\t\t\tthis.syncInstalledExtensionWithGallery(extension);\n\t\t}\n\t}\n\n\tprivate onUninstallExtension(identifier: IExtensionIdentifier): void {\n\t\tconst extension = this.installed.filter(e => areSameExtensions(e.identifier, identifier))[0];\n\t\tif (extension) {\n\t\t\tconst uninstalling = this.uninstalling.filter(e => areSameExtensions(e.identifier, identifier))[0] || extension;\n\t\t\tthis.uninstalling = [uninstalling, ...this.uninstalling.filter(e => !areSameExtensions(e.identifier, identifier))];\n\t\t\tthis._onChange.fire(uninstalling ? { extension: uninstalling } : undefined);\n\t\t}\n\t}\n\n\tprivate onDidUninstallExtension({ identifier, error }: DidUninstallExtensionEvent): void {\n\t\tconst uninstalled = this.uninstalling.find(e => areSameExtensions(e.identifier, identifier)) || this.installed.find(e => areSameExtensions(e.identifier, identifier));\n\t\tthis.uninstalling = this.uninstalling.filter(e => !areSameExtensions(e.identifier, identifier));\n\t\tif (!error) {\n\t\t\tthis.installed = this.installed.filter(e => !areSameExtensions(e.identifier, identifier));\n\t\t}\n\t\tif (uninstalled) {\n\t\t\tthis._onChange.fire({ extension: uninstalled });\n\t\t}\n\t}\n\n\tprivate onEnablementChanged(platformExtensions: readonly IPlatformExtension[]) {\n\t\tconst extensions = this.local.filter(e => platformExtensions.some(p => areSameExtensions(e.identifier, p.identifier)));\n\t\tfor (const extension of extensions) {\n\t\t\tif (extension.local) {\n\t\t\t\tconst enablementState = this.extensionEnablementService.getEnablementState(extension.local);\n\t\t\t\tif (enablementState !== extension.enablementState) {\n\t\t\t\t\t(extension as Extension).enablementState = enablementState;\n\t\t\t\t\tthis._onChange.fire({ extension: extension as Extension });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetExtensionState(extension: Extension): ExtensionState {\n\t\tif (extension.gallery && this.installing.some(e => !!e.gallery && areSameExtensions(e.gallery.identifier, extension.gallery!.identifier))) {\n\t\t\treturn ExtensionState.Installing;\n\t\t}\n\t\tif (this.uninstalling.some(e => areSameExtensions(e.identifier, extension.identifier))) {\n\t\t\treturn ExtensionState.Uninstalling;\n\t\t}\n\t\tconst local = this.installed.filter(e => e === extension || (e.gallery && extension.gallery && areSameExtensions(e.gallery.identifier, extension.gallery.identifier)))[0];\n\t\treturn local ? ExtensionState.Installed : ExtensionState.Uninstalled;\n\t}\n}\n\nexport class ExtensionsWorkbenchService extends Disposable implements IExtensionsWorkbenchService, IURLHandler {\n\n\tprivate static readonly SyncPeriod = 1000 * 60 * 60 * 12; // 12 hours\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate hasOutdatedExtensionsContextKey: IContextKey<boolean>;\n\n\tprivate readonly localExtensions: Extensions | null = null;\n\tprivate readonly remoteExtensions: Extensions | null = null;\n\tprivate readonly webExtensions: Extensions | null = null;\n\tprivate syncDelayer: ThrottledDelayer<void>;\n\tprivate autoUpdateDelayer: ThrottledDelayer<void>;\n\n\tprivate readonly _onChange: Emitter<IExtension | undefined> = new Emitter<IExtension | undefined>();\n\tget onChange(): Event<IExtension | undefined> { return this._onChange.event; }\n\n\tprivate installing: IExtension[] = [];\n\n\tconstructor(\n\t\t@IInstantiationService private readonly instantiationService: IInstantiationService,\n\t\t@IEditorService private readonly editorService: IEditorService,\n\t\t@IWorkbenchExtensionManagementService private readonly extensionManagementService: IWorkbenchExtensionManagementService,\n\t\t@IExtensionGalleryService private readonly galleryService: IExtensionGalleryService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@ITelemetryService private readonly telemetryService: ITelemetryService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@IURLService urlService: IURLService,\n\t\t@IWorkbenchExtensionEnablementService private readonly extensionEnablementService: IWorkbenchExtensionEnablementService,\n\t\t@IHostService private readonly hostService: IHostService,\n\t\t@IProgressService private readonly progressService: IProgressService,\n\t\t@IExtensionManagementServerService private readonly extensionManagementServerService: IExtensionManagementServerService,\n\t\t@IStorageService private readonly storageService: IStorageService,\n\t\t@IModeService private readonly modeService: IModeService,\n\t\t@IIgnoredExtensionsManagementService private readonly extensionsSyncManagementService: IIgnoredExtensionsManagementService,\n\t\t@IUserDataAutoSyncService private readonly userDataAutoSyncService: IUserDataAutoSyncService,\n\t\t@IProductService private readonly productService: IProductService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t\t@IExtensionManifestPropertiesService private readonly extensionManifestPropertiesService: IExtensionManifestPropertiesService,\n\t) {\n\t\tsuper();\n\t\tthis.hasOutdatedExtensionsContextKey = HasOutdatedExtensionsContext.bindTo(contextKeyService);\n\t\tif (extensionManagementServerService.localExtensionManagementServer) {\n\t\t\tthis.localExtensions = this._register(instantiationService.createInstance(Extensions, extensionManagementServerService.localExtensionManagementServer, ext => this.getExtensionState(ext)));\n\t\t\tthis._register(this.localExtensions.onChange(e => this._onChange.fire(e ? e.extension : undefined)));\n\t\t}\n\t\tif (extensionManagementServerService.remoteExtensionManagementServer) {\n\t\t\tthis.remoteExtensions = this._register(instantiationService.createInstance(Extensions, extensionManagementServerService.remoteExtensionManagementServer, ext => this.getExtensionState(ext)));\n\t\t\tthis._register(this.remoteExtensions.onChange(e => this._onChange.fire(e ? e.extension : undefined)));\n\t\t}\n\t\tif (extensionManagementServerService.webExtensionManagementServer) {\n\t\t\tthis.webExtensions = this._register(instantiationService.createInstance(Extensions, extensionManagementServerService.webExtensionManagementServer, ext => this.getExtensionState(ext)));\n\t\t\tthis._register(this.webExtensions.onChange(e => this._onChange.fire(e ? e.extension : undefined)));\n\t\t}\n\n\t\tthis.syncDelayer = new ThrottledDelayer<void>(ExtensionsWorkbenchService.SyncPeriod);\n\t\tthis.autoUpdateDelayer = new ThrottledDelayer<void>(1000);\n\n\t\turlService.registerHandler(this);\n\n\t\tthis._register(this.configurationService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration(AutoUpdateConfigurationKey)) {\n\t\t\t\tif (this.isAutoUpdateEnabled()) {\n\t\t\t\t\tthis.checkForUpdates();\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (e.affectsConfiguration(AutoCheckUpdatesConfigurationKey)) {\n\t\t\t\tif (this.isAutoCheckUpdatesEnabled()) {\n\t\t\t\t\tthis.checkForUpdates();\n\t\t\t\t}\n\t\t\t}\n\t\t}, this));\n\n\t\tthis._register(extensionEnablementService.onEnablementChanged(platformExtensions => {\n\t\t\tif (this.getAutoUpdateValue() === 'onlyEnabledExtensions' && platformExtensions.some(e => this.extensionEnablementService.isEnabled(e))) {\n\t\t\t\tthis.checkForUpdates();\n\t\t\t}\n\t\t}, this));\n\n\t\tthis.queryLocal().then(() => {\n\t\t\tthis.resetIgnoreAutoUpdateExtensions();\n\t\t\tthis.eventuallySyncWithGallery(true);\n\t\t});\n\n\t\tthis._register(this.onChange(() => {\n\t\t\tthis.updateContexts();\n\t\t\tthis.updateActivity();\n\t\t}));\n\t}\n\n\tget local(): IExtension[] {\n\t\tconst byId = groupByExtension(this.installed, r => r.identifier);\n\t\treturn byId.reduce((result, extensions) => { result.push(this.getPrimaryExtension(extensions)); return result; }, []);\n\t}\n\n\tget installed(): IExtension[] {\n\t\tconst result = [];\n\t\tif (this.localExtensions) {\n\t\t\tresult.push(...this.localExtensions.local);\n\t\t}\n\t\tif (this.remoteExtensions) {\n\t\t\tresult.push(...this.remoteExtensions.local);\n\t\t}\n\t\tif (this.webExtensions) {\n\t\t\tresult.push(...this.webExtensions.local);\n\t\t}\n\t\treturn result;\n\t}\n\n\tget outdated(): IExtension[] {\n\t\tconst allLocal = [];\n\t\tif (this.localExtensions) {\n\t\t\tallLocal.push(...this.localExtensions.local);\n\t\t}\n\t\tif (this.remoteExtensions) {\n\t\t\tallLocal.push(...this.remoteExtensions.local);\n\t\t}\n\t\tif (this.webExtensions) {\n\t\t\tallLocal.push(...this.webExtensions.local);\n\t\t}\n\t\treturn allLocal.filter(e => e.outdated && e.local && e.state === ExtensionState.Installed);\n\t}\n\n\tasync queryLocal(server?: IExtensionManagementServer): Promise<IExtension[]> {\n\t\tif (server) {\n\t\t\tif (this.localExtensions && this.extensionManagementServerService.localExtensionManagementServer === server) {\n\t\t\t\treturn this.localExtensions.queryInstalled();\n\t\t\t}\n\t\t\tif (this.remoteExtensions && this.extensionManagementServerService.remoteExtensionManagementServer === server) {\n\t\t\t\treturn this.remoteExtensions.queryInstalled();\n\t\t\t}\n\t\t\tif (this.webExtensions && this.extensionManagementServerService.webExtensionManagementServer === server) {\n\t\t\t\treturn this.webExtensions.queryInstalled();\n\t\t\t}\n\t\t}\n\n\t\tif (this.localExtensions) {\n\t\t\tawait this.localExtensions.queryInstalled();\n\t\t}\n\t\tif (this.remoteExtensions) {\n\t\t\tawait this.remoteExtensions.queryInstalled();\n\t\t}\n\t\tif (this.webExtensions) {\n\t\t\tawait this.webExtensions.queryInstalled();\n\t\t}\n\t\treturn this.local;\n\t}\n\n\tqueryGallery(token: CancellationToken): Promise<IPager<IExtension>>;\n\tqueryGallery(options: IQueryOptions, token: CancellationToken): Promise<IPager<IExtension>>;\n\tqueryGallery(arg1: any, arg2?: any): Promise<IPager<IExtension>> {\n\t\tconst options: IQueryOptions = CancellationToken.isCancellationToken(arg1) ? {} : arg1;\n\t\tconst token: CancellationToken = CancellationToken.isCancellationToken(arg1) ? arg1 : arg2;\n\t\toptions.text = options.text ? this.resolveQueryText(options.text) : options.text;\n\t\treturn this.extensionManagementService.getExtensionsReport()\n\t\t\t.then(report => {\n\t\t\t\tconst maliciousSet = getMaliciousExtensionsSet(report);\n\n\t\t\t\treturn this.galleryService.query(options, token)\n\t\t\t\t\t.then(result => mapPager(result, gallery => this.fromGallery(gallery, maliciousSet)))\n\t\t\t\t\t.then(undefined, err => {\n\t\t\t\t\t\tif (/No extension gallery service configured/.test(err.message)) {\n\t\t\t\t\t\t\treturn Promise.resolve(singlePagePager([]));\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn Promise.reject<IPager<IExtension>>(err);\n\t\t\t\t\t});\n\t\t\t});\n\t}\n\n\tprivate resolveQueryText(text: string): string {\n\t\tconst extensionRegex = /\\bext:([^\\s]+)\\b/g;\n\t\tif (extensionRegex.test(text)) {\n\t\t\ttext = text.replace(extensionRegex, (m, ext) => {\n\n\t\t\t\t// Get curated keywords\n\t\t\t\tconst lookup = this.productService.extensionKeywords || {};\n\t\t\t\tconst keywords = lookup[ext] || [];\n\n\t\t\t\t// Get mode name\n\t\t\t\tconst modeId = this.modeService.getModeIdByFilepathOrFirstLine(URI.file(`.${ext}`));\n\t\t\t\tconst languageName = modeId && this.modeService.getLanguageName(modeId);\n\t\t\t\tconst languageTag = languageName ? ` tag:\"${languageName}\"` : '';\n\n\t\t\t\t// Construct a rich query\n\t\t\t\treturn `tag:\"__ext_${ext}\" tag:\"__ext_.${ext}\" ${keywords.map(tag => `tag:\"${tag}\"`).join(' ')}${languageTag} tag:\"${ext}\"`;\n\t\t\t});\n\t\t}\n\t\treturn text.substr(0, 350);\n\t}\n\n\topen(extension: IExtension, { sideByside, preserveFocus, pinned }: { sideByside?: boolean, preserveFocus?: boolean, pinned?: boolean } = { sideByside: false, preserveFocus: false, pinned: false }): Promise<any> {\n\t\treturn Promise.resolve(this.editorService.openEditor(this.instantiationService.createInstance(ExtensionsInput, extension), { preserveFocus, pinned }, sideByside ? SIDE_GROUP : ACTIVE_GROUP));\n\t}\n\n\tprivate getPrimaryExtension(extensions: IExtension[]): IExtension {\n\t\tif (extensions.length === 1) {\n\t\t\treturn extensions[0];\n\t\t}\n\n\t\tconst enabledExtensions = extensions.filter(e => e.local && this.extensionEnablementService.isEnabled(e.local));\n\t\tif (enabledExtensions.length === 1) {\n\t\t\treturn enabledExtensions[0];\n\t\t}\n\n\t\tconst extensionsToChoose = enabledExtensions.length ? enabledExtensions : extensions;\n\t\tconst manifest = extensionsToChoose.find(e => e.local && e.local.manifest)?.local?.manifest;\n\n\t\t// Manifest is not found which should not happen.\n\t\t// In which case return the first extension.\n\t\tif (!manifest) {\n\t\t\treturn extensionsToChoose[0];\n\t\t}\n\n\t\tconst extensionKinds = this.extensionManifestPropertiesService.getExtensionKind(manifest);\n\n\t\tlet extension = extensionsToChoose.find(extension => {\n\t\t\tfor (const extensionKind of extensionKinds) {\n\t\t\t\tswitch (extensionKind) {\n\t\t\t\t\tcase 'ui':\n\t\t\t\t\t\t/* UI extension is chosen only if it is installed locally */\n\t\t\t\t\t\tif (extension.server === this.extensionManagementServerService.localExtensionManagementServer) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tcase 'workspace':\n\t\t\t\t\t\t/* Choose remote workspace extension if exists */\n\t\t\t\t\t\tif (extension.server === this.extensionManagementServerService.remoteExtensionManagementServer) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t\tcase 'web':\n\t\t\t\t\t\t/* Choose web extension if exists */\n\t\t\t\t\t\tif (extension.server === this.extensionManagementServerService.webExtensionManagementServer) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\n\t\tif (!extension && this.extensionManagementServerService.localExtensionManagementServer) {\n\t\t\textension = extensionsToChoose.find(extension => {\n\t\t\t\tfor (const extensionKind of extensionKinds) {\n\t\t\t\t\tswitch (extensionKind) {\n\t\t\t\t\t\tcase 'workspace':\n\t\t\t\t\t\t\t/* Choose local workspace extension if exists */\n\t\t\t\t\t\t\tif (extension.server === this.extensionManagementServerService.localExtensionManagementServer) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\tcase 'web':\n\t\t\t\t\t\t\t/* Choose local web extension if exists */\n\t\t\t\t\t\t\tif (extension.server === this.extensionManagementServerService.localExtensionManagementServer) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\n\t\tif (!extension && this.extensionManagementServerService.remoteExtensionManagementServer) {\n\t\t\textension = extensionsToChoose.find(extension => {\n\t\t\t\tfor (const extensionKind of extensionKinds) {\n\t\t\t\t\tswitch (extensionKind) {\n\t\t\t\t\t\tcase 'web':\n\t\t\t\t\t\t\t/* Choose remote web extension if exists */\n\t\t\t\t\t\t\tif (extension.server === this.extensionManagementServerService.remoteExtensionManagementServer) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t\t}\n\n\t\treturn extension || extensions[0];\n\t}\n\n\tprivate fromGallery(gallery: IGalleryExtension, maliciousExtensionSet: Set<string>): IExtension {\n\t\tPromise.all([\n\t\t\tthis.localExtensions ? this.localExtensions.syncLocalWithGalleryExtension(gallery, maliciousExtensionSet) : Promise.resolve(false),\n\t\t\tthis.remoteExtensions ? this.remoteExtensions.syncLocalWithGalleryExtension(gallery, maliciousExtensionSet) : Promise.resolve(false),\n\t\t\tthis.webExtensions ? this.webExtensions.syncLocalWithGalleryExtension(gallery, maliciousExtensionSet) : Promise.resolve(false)\n\t\t])\n\t\t\t.then(result => {\n\t\t\t\tif (result[0] || result[1]) {\n\t\t\t\t\tthis.eventuallyAutoUpdateExtensions();\n\t\t\t\t}\n\t\t\t});\n\n\t\tconst installed = this.getInstalledExtensionMatchingGallery(gallery);\n\t\tif (installed) {\n\t\t\treturn installed;\n\t\t}\n\t\tconst extension = this.instantiationService.createInstance(Extension, ext => this.getExtensionState(ext), undefined, undefined, gallery);\n\t\tif (maliciousExtensionSet.has(extension.identifier.id)) {\n\t\t\textension.isMalicious = true;\n\t\t}\n\t\treturn extension;\n\t}\n\n\tprivate getInstalledExtensionMatchingGallery(gallery: IGalleryExtension): IExtension | null {\n\t\tfor (const installed of this.local) {\n\t\t\tif (installed.identifier.uuid) { // Installed from Gallery\n\t\t\t\tif (installed.identifier.uuid === gallery.identifier.uuid) {\n\t\t\t\t\treturn installed;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (areSameExtensions(installed.identifier, gallery.identifier)) { // Installed from other sources\n\t\t\t\t\treturn installed;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprivate getExtensionState(extension: Extension): ExtensionState {\n\t\tconst isInstalling = this.installing.some(i => areSameExtensions(i.identifier, extension.identifier));\n\t\tif (extension.server) {\n\t\t\tconst state = (extension.server === this.extensionManagementServerService.localExtensionManagementServer\n\t\t\t\t? this.localExtensions! : extension.server === this.extensionManagementServerService.remoteExtensionManagementServer ? this.remoteExtensions! : this.webExtensions!).getExtensionState(extension);\n\t\t\treturn state === ExtensionState.Uninstalled && isInstalling ? ExtensionState.Installing : state;\n\t\t} else if (isInstalling) {\n\t\t\treturn ExtensionState.Installing;\n\t\t}\n\t\tif (this.remoteExtensions) {\n\t\t\tconst state = this.remoteExtensions.getExtensionState(extension);\n\t\t\tif (state !== ExtensionState.Uninstalled) {\n\t\t\t\treturn state;\n\t\t\t}\n\t\t}\n\t\tif (this.webExtensions) {\n\t\t\tconst state = this.webExtensions.getExtensionState(extension);\n\t\t\tif (state !== ExtensionState.Uninstalled) {\n\t\t\t\treturn state;\n\t\t\t}\n\t\t}\n\t\tif (this.localExtensions) {\n\t\t\treturn this.localExtensions.getExtensionState(extension);\n\t\t}\n\t\treturn ExtensionState.Uninstalled;\n\t}\n\n\tcheckForUpdates(): Promise<void> {\n\t\treturn Promise.resolve(this.syncDelayer.trigger(() => this.syncWithGallery(), 0));\n\t}\n\n\tprivate getAutoUpdateValue(): boolean | 'onlyEnabledExtensions' {\n\t\tconst autoUpdate = this.configurationService.getValue<boolean | 'onlyEnabledExtensions'>(AutoUpdateConfigurationKey);\n\t\treturn isBoolean(autoUpdate) || autoUpdate === 'onlyEnabledExtensions' ? autoUpdate : true;\n\t}\n\n\tprivate isAutoUpdateEnabled(): boolean {\n\t\treturn this.getAutoUpdateValue() !== false;\n\t}\n\n\tprivate isAutoCheckUpdatesEnabled(): boolean {\n\t\treturn this.configurationService.getValue(AutoCheckUpdatesConfigurationKey);\n\t}\n\n\tprivate eventuallySyncWithGallery(immediate = false): void {\n\t\tconst shouldSync = this.isAutoUpdateEnabled() || this.isAutoCheckUpdatesEnabled();\n\t\tconst loop = () => (shouldSync ? this.syncWithGallery() : Promise.resolve(undefined)).then(() => this.eventuallySyncWithGallery());\n\t\tconst delay = immediate ? 0 : ExtensionsWorkbenchService.SyncPeriod;\n\n\t\tthis.syncDelayer.trigger(loop, delay)\n\t\t\t.then(undefined, err => null);\n\t}\n\n\tprivate syncWithGallery(): Promise<void> {\n\t\tconst ids: string[] = [], names: string[] = [];\n\t\tfor (const installed of this.local) {\n\t\t\tif (installed.type === ExtensionType.User) {\n\t\t\t\tif (installed.identifier.uuid) {\n\t\t\t\t\tids.push(installed.identifier.uuid);\n\t\t\t\t} else {\n\t\t\t\t\tnames.push(installed.identifier.id);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst promises: Promise<IPager<IExtension>>[] = [];\n\t\tif (ids.length) {\n\t\t\tpromises.push(this.queryGallery({ ids, pageSize: ids.length }, CancellationToken.None));\n\t\t}\n\t\tif (names.length) {\n\t\t\tpromises.push(this.queryGallery({ names, pageSize: names.length }, CancellationToken.None));\n\t\t}\n\n\t\treturn Promises.settled(promises).then(() => undefined);\n\t}\n\n\tprivate eventuallyAutoUpdateExtensions(): void {\n\t\tthis.autoUpdateDelayer.trigger(() => this.autoUpdateExtensions())\n\t\t\t.then(undefined, err => null);\n\t}\n\n\tprivate autoUpdateExtensions(): Promise<any> {\n\t\tif (!this.isAutoUpdateEnabled()) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tconst toUpdate = this.outdated.filter(e =>\n\t\t\t!this.isAutoUpdateIgnored(new ExtensionIdentifierWithVersion(e.identifier, e.version)) &&\n\t\t\t(this.getAutoUpdateValue() === true || (e.local && this.extensionEnablementService.isEnabled(e.local)))\n\t\t);\n\n\t\treturn Promises.settled(toUpdate.map(e => this.install(e)));\n\t}\n\n\tcanInstall(extension: IExtension): boolean {\n\t\tif (!(extension instanceof Extension)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (extension.isMalicious) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (!extension.gallery) {\n\t\t\treturn false;\n\t\t}\n\n\t\tif (this.extensionManagementServerService.localExtensionManagementServer\n\t\t\t|| this.extensionManagementServerService.remoteExtensionManagementServer\n\t\t\t|| this.extensionManagementServerService.webExtensionManagementServer) {\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tinstall(extension: URI | IExtension, installOptions?: InstallOptions): Promise<IExtension> {\n\t\tif (extension instanceof URI) {\n\t\t\treturn this.installWithProgress(() => this.installFromVSIX(extension));\n\t\t}\n\n\t\tif (extension.isMalicious) {\n\t\t\treturn Promise.reject(new Error(nls.localize('malicious', \"This extension is reported to be problematic.\")));\n\t\t}\n\n\t\tconst gallery = extension.gallery;\n\n\t\tif (!gallery) {\n\t\t\treturn Promise.reject(new Error('Missing gallery'));\n\t\t}\n\n\t\treturn this.installWithProgress(() => this.installFromGallery(extension, gallery, installOptions), gallery.displayName);\n\t}\n\n\tsetEnablement(extensions: IExtension | IExtension[], enablementState: EnablementState): Promise<void> {\n\t\textensions = Array.isArray(extensions) ? extensions : [extensions];\n\t\treturn this.promptAndSetEnablement(extensions, enablementState);\n\t}\n\n\tuninstall(extension: IExtension): Promise<void> {\n\t\tconst ext = extension.local ? extension : this.local.filter(e => areSameExtensions(e.identifier, extension.identifier))[0];\n\t\tconst toUninstall: ILocalExtension | null = ext && ext.local ? ext.local : null;\n\n\t\tif (!toUninstall) {\n\t\t\treturn Promise.reject(new Error('Missing local'));\n\t\t}\n\t\treturn this.progressService.withProgress({\n\t\t\tlocation: ProgressLocation.Extensions,\n\t\t\ttitle: nls.localize('uninstallingExtension', 'Uninstalling extension....'),\n\t\t\tsource: `${toUninstall.identifier.id}`\n\t\t}, () => this.extensionManagementService.uninstall(toUninstall).then(() => undefined));\n\t}\n\n\tinstallVersion(extension: IExtension, version: string): Promise<IExtension> {\n\t\tif (!(extension instanceof Extension)) {\n\t\t\treturn Promise.resolve(extension);\n\t\t}\n\n\t\tif (!extension.gallery) {\n\t\t\treturn Promise.reject(new Error('Missing gallery'));\n\t\t}\n\n\t\treturn this.galleryService.getCompatibleExtension(extension.gallery.identifier, version)\n\t\t\t.then(gallery => {\n\t\t\t\tif (!gallery) {\n\t\t\t\t\treturn Promise.reject(new Error(nls.localize('incompatible', \"Unable to install extension '{0}' as it is not compatible with VS Code '{1}'.\", extension.gallery!.identifier.id, version)));\n\t\t\t\t}\n\t\t\t\treturn this.installWithProgress(async () => {\n\t\t\t\t\tconst installed = await this.installFromGallery(extension, gallery);\n\t\t\t\t\tif (extension.latestVersion !== version) {\n\t\t\t\t\t\tthis.ignoreAutoUpdate(new ExtensionIdentifierWithVersion(gallery.identifier, version));\n\t\t\t\t\t}\n\t\t\t\t\treturn installed;\n\t\t\t\t}\n\t\t\t\t\t, gallery.displayName);\n\t\t\t});\n\t}\n\n\treinstall(extension: IExtension): Promise<IExtension> {\n\t\tconst ext = extension.local ? extension : this.local.filter(e => areSameExtensions(e.identifier, extension.identifier))[0];\n\t\tconst toReinstall: ILocalExtension | null = ext && ext.local ? ext.local : null;\n\n\t\tif (!toReinstall) {\n\t\t\treturn Promise.reject(new Error('Missing local'));\n\t\t}\n\n\t\treturn this.progressService.withProgress({\n\t\t\tlocation: ProgressLocation.Extensions,\n\t\t\tsource: `${toReinstall.identifier.id}`\n\t\t}, () => this.extensionManagementService.reinstallFromGallery(toReinstall).then(() => this.local.filter(local => areSameExtensions(local.identifier, extension.identifier))[0]));\n\t}\n\n\tisExtensionIgnoredToSync(extension: IExtension): boolean {\n\t\treturn extension.local ? !this.isInstalledExtensionSynced(extension.local)\n\t\t\t: this.extensionsSyncManagementService.hasToNeverSyncExtension(extension.identifier.id);\n\t}\n\n\tasync toggleExtensionIgnoredToSync(extension: IExtension): Promise<void> {\n\t\tconst isIgnored = this.isExtensionIgnoredToSync(extension);\n\t\tif (extension.local && isIgnored) {\n\t\t\t(<Extension>extension).local = await this.updateSynchronizingInstalledExtension(extension.local, true);\n\t\t\tthis._onChange.fire(extension);\n\t\t} else {\n\t\t\tthis.extensionsSyncManagementService.updateIgnoredExtensions(extension.identifier.id, !isIgnored);\n\t\t}\n\t\tawait this.userDataAutoSyncService.triggerSync(['IgnoredExtensionsUpdated'], false, false);\n\t}\n\n\tprivate isInstalledExtensionSynced(extension: ILocalExtension): boolean {\n\t\tif (extension.isMachineScoped) {\n\t\t\treturn false;\n\t\t}\n\t\tif (this.extensionsSyncManagementService.hasToAlwaysSyncExtension(extension.identifier.id)) {\n\t\t\treturn true;\n\t\t}\n\t\treturn !this.extensionsSyncManagementService.hasToNeverSyncExtension(extension.identifier.id);\n\t}\n\n\tasync updateSynchronizingInstalledExtension(extension: ILocalExtension, sync: boolean): Promise<ILocalExtension> {\n\t\tconst isMachineScoped = !sync;\n\t\tif (extension.isMachineScoped !== isMachineScoped) {\n\t\t\textension = await this.extensionManagementService.updateExtensionScope(extension, isMachineScoped);\n\t\t}\n\t\tif (sync) {\n\t\t\tthis.extensionsSyncManagementService.updateIgnoredExtensions(extension.identifier.id, false);\n\t\t}\n\t\treturn extension;\n\t}\n\n\tprivate installWithProgress<T>(installTask: () => Promise<T>, extensionName?: string): Promise<T> {\n\t\tconst title = extensionName ? nls.localize('installing named extension', \"Installing '{0}' extension....\", extensionName) : nls.localize('installing extension', 'Installing extension....');\n\t\treturn this.progressService.withProgress({\n\t\t\tlocation: ProgressLocation.Extensions,\n\t\t\ttitle\n\t\t}, () => installTask());\n\t}\n\n\tprivate async installFromVSIX(vsix: URI): Promise<IExtension> {\n\t\tconst manifest = await this.extensionManagementService.getManifest(vsix);\n\t\tconst existingExtension = this.local.find(local => areSameExtensions(local.identifier, { id: getGalleryExtensionId(manifest.publisher, manifest.name) }));\n\t\tconst { identifier } = await this.extensionManagementService.install(vsix);\n\n\t\tif (existingExtension && existingExtension.latestVersion !== manifest.version) {\n\t\t\tthis.ignoreAutoUpdate(new ExtensionIdentifierWithVersion(identifier, manifest.version));\n\t\t}\n\n\t\treturn this.local.filter(local => areSameExtensions(local.identifier, identifier))[0];\n\t}\n\n\tprivate async installFromGallery(extension: IExtension, gallery: IGalleryExtension, installOptions?: InstallOptions): Promise<IExtension> {\n\t\tthis.installing.push(extension);\n\t\tthis._onChange.fire(extension);\n\t\ttry {\n\t\t\tif (extension.state === ExtensionState.Installed && extension.local) {\n\t\t\t\tawait this.extensionManagementService.updateFromGallery(gallery, extension.local);\n\t\t\t} else {\n\t\t\t\tawait this.extensionManagementService.installFromGallery(gallery, installOptions);\n\t\t\t}\n\t\t\tconst ids: string[] | undefined = extension.identifier.uuid ? [extension.identifier.uuid] : undefined;\n\t\t\tconst names: string[] | undefined = extension.identifier.uuid ? undefined : [extension.identifier.id];\n\t\t\tthis.queryGallery({ names, ids, pageSize: 1 }, CancellationToken.None);\n\t\t\treturn this.local.filter(local => areSameExtensions(local.identifier, gallery.identifier))[0];\n\t\t} finally {\n\t\t\tthis.installing = this.installing.filter(e => e !== extension);\n\t\t\tthis._onChange.fire(this.local.filter(e => areSameExtensions(e.identifier, extension.identifier))[0]);\n\t\t}\n\t}\n\n\tprivate promptAndSetEnablement(extensions: IExtension[], enablementState: EnablementState): Promise<any> {\n\t\tconst enable = enablementState === EnablementState.EnabledGlobally || enablementState === EnablementState.EnabledWorkspace;\n\t\tif (enable) {\n\t\t\tconst allDependenciesAndPackedExtensions = this.getExtensionsRecursively(extensions, this.local, enablementState, { dependencies: true, pack: true });\n\t\t\treturn this.checkAndSetEnablement(extensions, allDependenciesAndPackedExtensions, enablementState);\n\t\t} else {\n\t\t\tconst packedExtensions = this.getExtensionsRecursively(extensions, this.local, enablementState, { dependencies: false, pack: true });\n\t\t\tif (packedExtensions.length) {\n\t\t\t\treturn this.checkAndSetEnablement(extensions, packedExtensions, enablementState);\n\t\t\t}\n\t\t\treturn this.checkAndSetEnablement(extensions, [], enablementState);\n\t\t}\n\t}\n\n\tprivate checkAndSetEnablement(extensions: IExtension[], otherExtensions: IExtension[], enablementState: EnablementState): Promise<any> {\n\t\tconst allExtensions = [...extensions, ...otherExtensions];\n\t\tconst enable = enablementState === EnablementState.EnabledGlobally || enablementState === EnablementState.EnabledWorkspace;\n\t\tif (!enable) {\n\t\t\tfor (const extension of extensions) {\n\t\t\t\tlet dependents = this.getDependentsAfterDisablement(extension, allExtensions, this.local);\n\t\t\t\tif (dependents.length) {\n\t\t\t\t\treturn new Promise<void>((resolve, reject) => {\n\t\t\t\t\t\tthis.notificationService.prompt(Severity.Error, this.getDependentsErrorMessage(extension, allExtensions, dependents), [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tlabel: nls.localize('disable all', 'Disable All'),\n\t\t\t\t\t\t\t\trun: async () => {\n\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\tawait this.checkAndSetEnablement(dependents, [extension], enablementState);\n\t\t\t\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\t\t\treject(error);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t], {\n\t\t\t\t\t\t\tonCancel: () => reject(canceled())\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this.doSetEnablement(allExtensions, enablementState);\n\t}\n\n\tprivate getExtensionsRecursively(extensions: IExtension[], installed: IExtension[], enablementState: EnablementState, options: { dependencies: boolean, pack: boolean }, checked: IExtension[] = []): IExtension[] {\n\t\tconst toCheck = extensions.filter(e => checked.indexOf(e) === -1);\n\t\tif (toCheck.length) {\n\t\t\tfor (const extension of toCheck) {\n\t\t\t\tchecked.push(extension);\n\t\t\t}\n\t\t\tconst extensionsToDisable = installed.filter(i => {\n\t\t\t\tif (checked.indexOf(i) !== -1) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (i.enablementState === enablementState) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tconst enable = enablementState === EnablementState.EnabledGlobally || enablementState === EnablementState.EnabledWorkspace;\n\t\t\t\treturn (enable || !i.isBuiltin) // Include all Extensions for enablement and only non builtin extensions for disablement\n\t\t\t\t\t&& (options.dependencies || options.pack)\n\t\t\t\t\t&& extensions.some(extension =>\n\t\t\t\t\t\t(options.dependencies && extension.dependencies.some(id => areSameExtensions({ id }, i.identifier)))\n\t\t\t\t\t\t|| (options.pack && extension.extensionPack.some(id => areSameExtensions({ id }, i.identifier)))\n\t\t\t\t\t);\n\t\t\t});\n\t\t\tif (extensionsToDisable.length) {\n\t\t\t\textensionsToDisable.push(...this.getExtensionsRecursively(extensionsToDisable, installed, enablementState, options, checked));\n\t\t\t}\n\t\t\treturn extensionsToDisable;\n\t\t}\n\t\treturn [];\n\t}\n\n\tprivate getDependentsAfterDisablement(extension: IExtension, extensionsToDisable: IExtension[], installed: IExtension[]): IExtension[] {\n\t\treturn installed.filter(i => {\n\t\t\tif (i.dependencies.length === 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (i === extension) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (!(i.enablementState === EnablementState.EnabledWorkspace || i.enablementState === EnablementState.EnabledGlobally)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (extensionsToDisable.indexOf(i) !== -1) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn i.dependencies.some(dep => [extension, ...extensionsToDisable].some(d => areSameExtensions(d.identifier, { id: dep })));\n\t\t});\n\t}\n\n\tprivate getDependentsErrorMessage(extension: IExtension, allDisabledExtensions: IExtension[], dependents: IExtension[]): string {\n\t\tfor (const e of [extension, ...allDisabledExtensions]) {\n\t\t\tlet dependentsOfTheExtension = dependents.filter(d => d.dependencies.some(id => areSameExtensions({ id }, e.identifier)));\n\t\t\tif (dependentsOfTheExtension.length) {\n\t\t\t\treturn this.getErrorMessageForDisablingAnExtensionWithDependents(e, dependentsOfTheExtension);\n\t\t\t}\n\t\t}\n\t\treturn '';\n\t}\n\n\tprivate getErrorMessageForDisablingAnExtensionWithDependents(extension: IExtension, dependents: IExtension[]): string {\n\t\tif (dependents.length === 1) {\n\t\t\treturn nls.localize('singleDependentError', \"Cannot disable '{0}' extension alone. '{1}' extension depends on this. Do you want to disable all these extensions?\", extension.displayName, dependents[0].displayName);\n\t\t}\n\t\tif (dependents.length === 2) {\n\t\t\treturn nls.localize('twoDependentsError', \"Cannot disable '{0}' extension alone. '{1}' and '{2}' extensions depend on this. Do you want to disable all these extensions?\",\n\t\t\t\textension.displayName, dependents[0].displayName, dependents[1].displayName);\n\t\t}\n\t\treturn nls.localize('multipleDependentsError', \"Cannot disable '{0}' extension alone. '{1}', '{2}' and other extensions depend on this. Do you want to disable all these extensions?\",\n\t\t\textension.displayName, dependents[0].displayName, dependents[1].displayName);\n\t}\n\n\tprivate async doSetEnablement(extensions: IExtension[], enablementState: EnablementState): Promise<boolean[]> {\n\t\tconst changed = await this.extensionEnablementService.setEnablement(extensions.map(e => e.local!), enablementState);\n\t\tfor (let i = 0; i < changed.length; i++) {\n\t\t\tif (changed[i]) {\n\t\t\t\t/* __GDPR__\n\t\t\t\t\"extension:enable\" : {\n\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\"${GalleryExtensionTelemetryData}\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\t/* __GDPR__\n\t\t\t\t\"extension:disable\" : {\n\t\t\t\t\t\"${include}\": [\n\t\t\t\t\t\t\"${GalleryExtensionTelemetryData}\"\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t\t*/\n\t\t\t\tthis.telemetryService.publicLog(enablementState === EnablementState.EnabledGlobally || enablementState === EnablementState.EnabledWorkspace ? 'extension:enable' : 'extension:disable', extensions[i].telemetryData);\n\t\t\t}\n\t\t}\n\t\treturn changed;\n\t}\n\n\tprivate updateContexts(extension?: Extension): void {\n\t\tif (extension && extension.outdated) {\n\t\t\tthis.hasOutdatedExtensionsContextKey.set(true);\n\t\t} else {\n\t\t\tthis.hasOutdatedExtensionsContextKey.set(this.outdated.length > 0);\n\t\t}\n\t}\n\n\tprivate _activityCallBack: ((value: void) => void) | null = null;\n\tprivate updateActivity(): void {\n\t\tif ((this.localExtensions && this.localExtensions.local.some(e => e.state === ExtensionState.Installing || e.state === ExtensionState.Uninstalling))\n\t\t\t|| (this.remoteExtensions && this.remoteExtensions.local.some(e => e.state === ExtensionState.Installing || e.state === ExtensionState.Uninstalling))\n\t\t\t|| (this.webExtensions && this.webExtensions.local.some(e => e.state === ExtensionState.Installing || e.state === ExtensionState.Uninstalling))) {\n\t\t\tif (!this._activityCallBack) {\n\t\t\t\tthis.progressService.withProgress({ location: ProgressLocation.Extensions }, () => new Promise(resolve => this._activityCallBack = resolve));\n\t\t\t}\n\t\t} else {\n\t\t\tif (this._activityCallBack) {\n\t\t\t\tthis._activityCallBack();\n\t\t\t}\n\t\t\tthis._activityCallBack = null;\n\t\t}\n\t}\n\n\tprivate onError(err: any): void {\n\t\tif (isPromiseCanceledError(err)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst message = err && err.message || '';\n\n\t\tif (/getaddrinfo ENOTFOUND|getaddrinfo ENOENT|connect EACCES|connect ECONNREFUSED/.test(message)) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.notificationService.error(err);\n\t}\n\n\thandleURL(uri: URI, options?: IOpenURLOptions): Promise<boolean> {\n\t\tif (!/^extension/.test(uri.path)) {\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\n\t\tthis.onOpenExtensionUrl(uri);\n\t\treturn Promise.resolve(true);\n\t}\n\n\tprivate onOpenExtensionUrl(uri: URI): void {\n\t\tconst match = /^extension\\/([^/]+)$/.exec(uri.path);\n\n\t\tif (!match) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst extensionId = match[1];\n\n\t\tthis.queryLocal().then(local => {\n\t\t\tconst extension = local.filter(local => areSameExtensions(local.identifier, { id: extensionId }))[0];\n\n\t\t\tif (extension) {\n\t\t\t\treturn this.hostService.focus()\n\t\t\t\t\t.then(() => this.open(extension));\n\t\t\t}\n\t\t\treturn this.queryGallery({ names: [extensionId], source: 'uri' }, CancellationToken.None).then(result => {\n\t\t\t\tif (result.total < 1) {\n\t\t\t\t\treturn Promise.resolve(null);\n\t\t\t\t}\n\n\t\t\t\tconst extension = result.firstPage[0];\n\n\t\t\t\treturn this.hostService.focus().then(() => {\n\t\t\t\t\treturn this.open(extension);\n\t\t\t\t});\n\t\t\t});\n\t\t}).then(undefined, error => this.onError(error));\n\t}\n\n\n\tprivate _ignoredAutoUpdateExtensions: string[] | undefined;\n\tprivate get ignoredAutoUpdateExtensions(): string[] {\n\t\tif (!this._ignoredAutoUpdateExtensions) {\n\t\t\tthis._ignoredAutoUpdateExtensions = JSON.parse(this.storageService.get('extensions.ignoredAutoUpdateExtension', StorageScope.GLOBAL, '[]') || '[]');\n\t\t}\n\t\treturn this._ignoredAutoUpdateExtensions!;\n\t}\n\n\tprivate set ignoredAutoUpdateExtensions(extensionIds: string[]) {\n\t\tthis._ignoredAutoUpdateExtensions = distinct(extensionIds.map(id => id.toLowerCase()));\n\t\tthis.storageService.store('extensions.ignoredAutoUpdateExtension', JSON.stringify(this._ignoredAutoUpdateExtensions), StorageScope.GLOBAL, StorageTarget.MACHINE);\n\t}\n\n\tprivate ignoreAutoUpdate(identifierWithVersion: ExtensionIdentifierWithVersion): void {\n\t\tif (!this.isAutoUpdateIgnored(identifierWithVersion)) {\n\t\t\tthis.ignoredAutoUpdateExtensions = [...this.ignoredAutoUpdateExtensions, identifierWithVersion.key()];\n\t\t}\n\t}\n\n\tprivate isAutoUpdateIgnored(identifierWithVersion: ExtensionIdentifierWithVersion): boolean {\n\t\treturn this.ignoredAutoUpdateExtensions.indexOf(identifierWithVersion.key()) !== -1;\n\t}\n\n\tprivate resetIgnoreAutoUpdateExtensions(): void {\n\t\tthis.ignoredAutoUpdateExtensions = this.ignoredAutoUpdateExtensions.filter(extensionId => this.local.some(local => !!local.local && new ExtensionIdentifierWithVersion(local.identifier, local.version).key() === extensionId));\n\t}\n\n\toverride dispose(): void {\n\t\tsuper.dispose();\n\t\tthis.syncDelayer.cancel();\n\t}\n}\n"]}