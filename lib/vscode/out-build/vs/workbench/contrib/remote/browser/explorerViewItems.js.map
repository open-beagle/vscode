{"version":3,"sources":["vs/workbench/contrib/remote/browser/explorerViewItems.ts"],"names":[],"mappings":"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","file":"explorerViewItems.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport { IAction } from 'vs/base/common/actions';\nimport { IThemeService } from 'vs/platform/theme/common/themeService';\nimport { attachSelectBoxStyler } from 'vs/platform/theme/common/styler';\nimport { IContextViewService } from 'vs/platform/contextview/browser/contextView';\nimport { IRemoteExplorerService, REMOTE_EXPLORER_TYPE_KEY } from 'vs/workbench/services/remote/common/remoteExplorerService';\nimport { ISelectOptionItem } from 'vs/base/browser/ui/selectBox/selectBox';\nimport { IViewDescriptor } from 'vs/workbench/common/views';\nimport { isStringArray } from 'vs/base/common/types';\nimport { IWorkbenchEnvironmentService } from 'vs/workbench/services/environment/common/environmentService';\nimport { IStorageService, StorageScope } from 'vs/platform/storage/common/storage';\nimport { ContextKeyEqualsExpr, IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { SelectActionViewItem } from 'vs/base/browser/ui/actionbar/actionViewItems';\nimport { Action2, MenuId } from 'vs/platform/actions/common/actions';\nimport { ServicesAccessor } from 'vs/platform/instantiation/common/instantiation';\nimport { VIEWLET_ID } from 'vs/workbench/contrib/remote/browser/remoteExplorer';\n\nexport interface IRemoteSelectItem extends ISelectOptionItem {\n\tauthority: string[];\n}\n\nexport class SwitchRemoteViewItem extends SelectActionViewItem {\n\n\tconstructor(\n\t\taction: IAction,\n\t\tprivate readonly optionsItems: IRemoteSelectItem[],\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IContextViewService contextViewService: IContextViewService,\n\t\t@IRemoteExplorerService private remoteExplorerService: IRemoteExplorerService,\n\t\t@IWorkbenchEnvironmentService private environmentService: IWorkbenchEnvironmentService,\n\t\t@IStorageService private readonly storageService: IStorageService\n\t) {\n\t\tsuper(null, action, optionsItems, 0, contextViewService, { ariaLabel: nls.localize('remotes', 'Switch Remote') });\n\t\tthis._register(attachSelectBoxStyler(this.selectBox, themeService));\n\t}\n\n\tpublic setSelectionForConnection(): boolean {\n\t\tlet isSetForConnection = false;\n\t\tif (this.optionsItems.length > 0) {\n\t\t\tlet index = 0;\n\t\t\tconst remoteAuthority = this.environmentService.remoteAuthority;\n\t\t\tisSetForConnection = true;\n\t\t\tconst explorerType: string[] | undefined = remoteAuthority ? [remoteAuthority.split('+')[0]] :\n\t\t\t\tthis.storageService.get(REMOTE_EXPLORER_TYPE_KEY, StorageScope.WORKSPACE)?.split(',') ?? this.storageService.get(REMOTE_EXPLORER_TYPE_KEY, StorageScope.GLOBAL)?.split(',');\n\t\t\tif (explorerType !== undefined) {\n\t\t\t\tindex = this.getOptionIndexForExplorerType(explorerType);\n\t\t\t}\n\t\t\tthis.select(index);\n\t\t\tthis.remoteExplorerService.targetType = this.optionsItems[index].authority;\n\t\t}\n\t\treturn isSetForConnection;\n\t}\n\n\tpublic setSelection() {\n\t\tconst index = this.getOptionIndexForExplorerType(this.remoteExplorerService.targetType);\n\t\tthis.select(index);\n\t}\n\n\tprivate getOptionIndexForExplorerType(explorerType: string[]): number {\n\t\tlet index = 0;\n\t\tfor (let optionIterator = 0; (optionIterator < this.optionsItems.length) && (index === 0); optionIterator++) {\n\t\t\tfor (let authorityIterator = 0; authorityIterator < this.optionsItems[optionIterator].authority.length; authorityIterator++) {\n\t\t\t\tfor (let i = 0; i < explorerType.length; i++) {\n\t\t\t\t\tif (this.optionsItems[optionIterator].authority[authorityIterator] === explorerType[i]) {\n\t\t\t\t\t\tindex = optionIterator;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn index;\n\t}\n\n\toverride render(container: HTMLElement) {\n\t\tif (this.optionsItems.length > 1) {\n\t\t\tsuper.render(container);\n\t\t\tcontainer.classList.add('switch-remote');\n\t\t}\n\t}\n\n\tprotected override getActionContext(_: string, index: number): any {\n\t\treturn this.optionsItems[index];\n\t}\n\n\tstatic createOptionItems(views: IViewDescriptor[], contextKeyService: IContextKeyService): IRemoteSelectItem[] {\n\t\tlet options: IRemoteSelectItem[] = [];\n\t\tviews.forEach(view => {\n\t\t\tif (view.group && view.group.startsWith('targets') && view.remoteAuthority && (!view.when || contextKeyService.contextMatchesRules(view.when))) {\n\t\t\t\toptions.push({ text: view.name, authority: isStringArray(view.remoteAuthority) ? view.remoteAuthority : [view.remoteAuthority] });\n\t\t\t}\n\t\t});\n\t\treturn options;\n\t}\n}\n\nexport class SwitchRemoteAction extends Action2 {\n\n\tpublic static readonly ID = 'remote.explorer.switch';\n\tpublic static readonly LABEL = nls.localize('remote.explorer.switch', \"Switch Remote\");\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: SwitchRemoteAction.ID,\n\t\t\ttitle: SwitchRemoteAction.LABEL,\n\t\t\tmenu: [{\n\t\t\t\tid: MenuId.ViewContainerTitle,\n\t\t\t\twhen: ContextKeyEqualsExpr.create('viewContainer', VIEWLET_ID),\n\t\t\t\tgroup: 'navigation',\n\t\t\t\torder: 1\n\t\t\t}],\n\t\t});\n\t}\n\n\tpublic async run(accessor: ServicesAccessor, args: IRemoteSelectItem): Promise<any> {\n\t\taccessor.get(IRemoteExplorerService).targetType = args.authority;\n\t}\n}\n"]}