{"version":3,"file":"partsSplash.contribution.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/contrib/splash/electron-browser/partsSplash.contribution.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { ipcRenderer } from 'vs/base/parts/sandbox/electron-sandbox/globals';\nimport { join } from 'vs/base/common/path';\nimport { onDidChangeFullscreen, isFullscreen } from 'vs/base/browser/browser';\nimport { getTotalHeight, getTotalWidth } from 'vs/base/browser/dom';\nimport { Color } from 'vs/base/common/color';\nimport { Event } from 'vs/base/common/event';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { ILifecycleService, LifecyclePhase } from 'vs/workbench/services/lifecycle/common/lifecycle';\nimport { Registry } from 'vs/platform/registry/common/platform';\nimport { ColorIdentifier, editorBackground, foreground } from 'vs/platform/theme/common/colorRegistry';\nimport { getThemeTypeSelector, IThemeService } from 'vs/platform/theme/common/themeService';\nimport { DEFAULT_EDITOR_MIN_DIMENSIONS } from 'vs/workbench/browser/parts/editor/editor';\nimport { Extensions, IWorkbenchContributionsRegistry } from 'vs/workbench/common/contributions';\nimport * as themes from 'vs/workbench/common/theme';\nimport { IWorkbenchLayoutService, Parts, Position } from 'vs/workbench/services/layout/browser/layoutService';\nimport { INativeWorkbenchEnvironmentService } from 'vs/workbench/services/environment/electron-sandbox/environmentService';\nimport { ITextFileService } from 'vs/workbench/services/textfile/common/textfiles';\nimport { URI } from 'vs/base/common/uri';\nimport { IEditorGroupsService } from 'vs/workbench/services/editor/common/editorGroupsService';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport * as perf from 'vs/base/common/performance';\nimport { assertIsDefined } from 'vs/base/common/types';\nimport { INativeHostService } from 'vs/platform/native/electron-sandbox/native';\n\nclass PartsSplash {\n\n\tprivate static readonly _splashElementId = 'monaco-parts-splash';\n\n\tprivate readonly _disposables = new DisposableStore();\n\n\tprivate _didChangeTitleBarStyle?: boolean;\n\tprivate _lastBaseTheme?: string;\n\tprivate _lastBackground?: string;\n\n\tconstructor(\n\t\t@IThemeService private readonly _themeService: IThemeService,\n\t\t@IWorkbenchLayoutService private readonly _layoutService: IWorkbenchLayoutService,\n\t\t@ITextFileService private readonly _textFileService: ITextFileService,\n\t\t@INativeWorkbenchEnvironmentService private readonly _environmentService: INativeWorkbenchEnvironmentService,\n\t\t@ILifecycleService lifecycleService: ILifecycleService,\n\t\t@IEditorGroupsService editorGroupsService: IEditorGroupsService,\n\t\t@IConfigurationService configService: IConfigurationService,\n\t\t@INativeHostService private readonly _nativeHostService: INativeHostService\n\t) {\n\t\tlifecycleService.when(LifecyclePhase.Restored).then(_ => {\n\t\t\tthis._removePartsSplash();\n\t\t\tperf.mark('code/didRemovePartsSplash');\n\t\t});\n\t\tEvent.debounce(Event.any<any>(\n\t\t\tonDidChangeFullscreen,\n\t\t\teditorGroupsService.onDidLayout\n\t\t), () => { }, 800)(this._savePartsSplash, this, this._disposables);\n\n\t\tconfigService.onDidChangeConfiguration(e => {\n\t\t\tif (e.affectsConfiguration('window.titleBarStyle')) {\n\t\t\t\tthis._didChangeTitleBarStyle = true;\n\t\t\t\tthis._savePartsSplash();\n\t\t\t}\n\t\t}, this, this._disposables);\n\n\t\t_themeService.onDidColorThemeChange(_ => {\n\t\t\tthis._savePartsSplash();\n\t\t}, this, this._disposables);\n\t}\n\n\tdispose(): void {\n\t\tthis._disposables.dispose();\n\t}\n\n\tprivate _savePartsSplash() {\n\t\tconst baseTheme = getThemeTypeSelector(this._themeService.getColorTheme().type);\n\t\tconst colorInfo = {\n\t\t\tforeground: this._getThemeColor(foreground),\n\t\t\teditorBackground: this._getThemeColor(editorBackground),\n\t\t\ttitleBarBackground: this._getThemeColor(themes.TITLE_BAR_ACTIVE_BACKGROUND),\n\t\t\tactivityBarBackground: this._getThemeColor(themes.ACTIVITY_BAR_BACKGROUND),\n\t\t\tsideBarBackground: this._getThemeColor(themes.SIDE_BAR_BACKGROUND),\n\t\t\tstatusBarBackground: this._getThemeColor(themes.STATUS_BAR_BACKGROUND),\n\t\t\tstatusBarNoFolderBackground: this._getThemeColor(themes.STATUS_BAR_NO_FOLDER_BACKGROUND),\n\t\t\twindowBorder: this._getThemeColor(themes.WINDOW_ACTIVE_BORDER) ?? this._getThemeColor(themes.WINDOW_INACTIVE_BORDER)\n\t\t};\n\t\tconst layoutInfo = !this._shouldSaveLayoutInfo() ? undefined : {\n\t\t\tsideBarSide: this._layoutService.getSideBarPosition() === Position.RIGHT ? 'right' : 'left',\n\t\t\teditorPartMinWidth: DEFAULT_EDITOR_MIN_DIMENSIONS.width,\n\t\t\ttitleBarHeight: this._layoutService.isVisible(Parts.TITLEBAR_PART) ? getTotalHeight(assertIsDefined(this._layoutService.getContainer(Parts.TITLEBAR_PART))) : 0,\n\t\t\tactivityBarWidth: this._layoutService.isVisible(Parts.ACTIVITYBAR_PART) ? getTotalWidth(assertIsDefined(this._layoutService.getContainer(Parts.ACTIVITYBAR_PART))) : 0,\n\t\t\tsideBarWidth: this._layoutService.isVisible(Parts.SIDEBAR_PART) ? getTotalWidth(assertIsDefined(this._layoutService.getContainer(Parts.SIDEBAR_PART))) : 0,\n\t\t\tstatusBarHeight: this._layoutService.isVisible(Parts.STATUSBAR_PART) ? getTotalHeight(assertIsDefined(this._layoutService.getContainer(Parts.STATUSBAR_PART))) : 0,\n\t\t\twindowBorder: this._layoutService.hasWindowBorder(),\n\t\t\twindowBorderRadius: this._layoutService.getWindowBorderRadius()\n\t\t};\n\t\tthis._textFileService.write(\n\t\t\tURI.file(join(this._environmentService.userDataPath, 'rapid_render.json')),\n\t\t\tJSON.stringify({\n\t\t\t\tid: PartsSplash._splashElementId,\n\t\t\t\tcolorInfo,\n\t\t\t\tlayoutInfo,\n\t\t\t\tbaseTheme\n\t\t\t}),\n\t\t\t{ encoding: 'utf8' }\n\t\t);\n\n\t\tif (baseTheme !== this._lastBaseTheme || colorInfo.editorBackground !== this._lastBackground) {\n\t\t\t// notify the main window on background color changes: the main window sets the background color to new windows\n\t\t\tthis._lastBaseTheme = baseTheme;\n\t\t\tthis._lastBackground = colorInfo.editorBackground;\n\n\t\t\t// the color needs to be in hex\n\t\t\tconst backgroundColor = this._themeService.getColorTheme().getColor(editorBackground) || themes.WORKBENCH_BACKGROUND(this._themeService.getColorTheme());\n\t\t\tconst payload = JSON.stringify({ baseTheme, background: Color.Format.CSS.formatHex(backgroundColor) });\n\t\t\tipcRenderer.send('vscode:changeColorTheme', this._nativeHostService.windowId, payload);\n\t\t}\n\t}\n\n\tprivate _getThemeColor(id: ColorIdentifier): string | undefined {\n\t\tconst theme = this._themeService.getColorTheme();\n\t\tconst color = theme.getColor(id);\n\t\treturn color ? color.toString() : undefined;\n\t}\n\n\tprivate _shouldSaveLayoutInfo(): boolean {\n\t\treturn !isFullscreen() && !this._environmentService.isExtensionDevelopment && !this._didChangeTitleBarStyle;\n\t}\n\n\tprivate _removePartsSplash(): void {\n\t\tlet element = document.getElementById(PartsSplash._splashElementId);\n\t\tif (element) {\n\t\t\telement.style.display = 'none';\n\t\t}\n\t\t// remove initial colors\n\t\tlet defaultStyles = document.head.getElementsByClassName('initialShellColors');\n\t\tif (defaultStyles.length) {\n\t\t\tdocument.head.removeChild(defaultStyles[0]);\n\t\t}\n\t}\n}\n\nRegistry.as<IWorkbenchContributionsRegistry>(Extensions.Workbench).registerWorkbenchContribution(PartsSplash, LifecyclePhase.Starting);\n"]}