{"version":3,"sources":["vs/workbench/contrib/webview/browser/baseWebviewElement.ts"],"names":[],"mappings":"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","file":"baseWebviewElement.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IMouseWheelEvent } from 'vs/base/browser/mouseEvent';\nimport { ThrottledDelayer } from 'vs/base/common/async';\nimport { streamToBuffer } from 'vs/base/common/buffer';\nimport { CancellationTokenSource } from 'vs/base/common/cancellation';\nimport { Emitter } from 'vs/base/common/event';\nimport { Disposable, IDisposable } from 'vs/base/common/lifecycle';\nimport { URI } from 'vs/base/common/uri';\nimport { localize } from 'vs/nls';\nimport { ExtensionIdentifier } from 'vs/platform/extensions/common/extensions';\nimport { IFileService } from 'vs/platform/files/common/files';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { INotificationService } from 'vs/platform/notification/common/notification';\nimport { IRemoteAuthorityResolverService } from 'vs/platform/remote/common/remoteAuthorityResolver';\nimport { ITunnelService } from 'vs/platform/remote/common/tunnel';\nimport { IRequestService } from 'vs/platform/request/common/request';\nimport { ITelemetryService } from 'vs/platform/telemetry/common/telemetry';\nimport { WebviewPortMappingManager } from 'vs/platform/webview/common/webviewPortMapping';\nimport { loadLocalResource, WebviewResourceResponse } from 'vs/workbench/contrib/webview/browser/resourceLoading';\nimport { WebviewThemeDataProvider } from 'vs/workbench/contrib/webview/browser/themeing';\nimport { areWebviewContentOptionsEqual, WebviewContentOptions, WebviewExtensionDescription, WebviewMessageReceivedEvent, WebviewOptions } from 'vs/workbench/contrib/webview/browser/webview';\nimport { IWorkbenchEnvironmentService } from 'vs/workbench/services/environment/common/environmentService';\n\nexport const enum WebviewMessageChannels {\n\tonmessage = 'onmessage',\n\tdidClickLink = 'did-click-link',\n\tdidScroll = 'did-scroll',\n\tdidFocus = 'did-focus',\n\tdidBlur = 'did-blur',\n\tdidLoad = 'did-load',\n\tdoUpdateState = 'do-update-state',\n\tdoReload = 'do-reload',\n\tsetConfirmBeforeClose = 'set-confirm-before-close',\n\tloadResource = 'load-resource',\n\tloadLocalhost = 'load-localhost',\n\twebviewReady = 'webview-ready',\n\twheel = 'did-scroll-wheel',\n\tfatalError = 'fatal-error',\n}\n\ninterface IKeydownEvent {\n\tkey: string;\n\tkeyCode: number;\n\tcode: string;\n\tshiftKey: boolean;\n\taltKey: boolean;\n\tctrlKey: boolean;\n\tmetaKey: boolean;\n\trepeat: boolean;\n}\n\ninterface WebviewContent {\n\treadonly html: string;\n\treadonly options: WebviewContentOptions;\n\treadonly state: string | undefined;\n}\n\nnamespace WebviewState {\n\texport const enum Type { Initializing, Ready }\n\n\texport class Initializing {\n\t\treadonly type = Type.Initializing;\n\n\t\tconstructor(\n\t\t\tpublic readonly pendingMessages: Array<{ readonly channel: string, readonly data?: any }>\n\t\t) { }\n\t}\n\n\texport const Ready = { type: Type.Ready } as const;\n\n\texport type State = typeof Ready | Initializing;\n}\n\nexport abstract class BaseWebview<T extends HTMLElement> extends Disposable {\n\n\tprivate _element: T | undefined;\n\tprotected get element(): T | undefined { return this._element; }\n\n\tprivate _focused: boolean | undefined;\n\tpublic get isFocused(): boolean { return !!this._focused; }\n\n\tprivate _state: WebviewState.State = new WebviewState.Initializing([]);\n\n\tprotected content: WebviewContent;\n\n\tprivate readonly _portMappingManager: WebviewPortMappingManager;\n\n\tprivate readonly _resourceLoadingCts = this._register(new CancellationTokenSource());\n\n\tprivate readonly _fileService: IFileService;\n\tprivate readonly _logService: ILogService;\n\tprivate readonly _remoteAuthorityResolverService: IRemoteAuthorityResolverService;\n\tprivate readonly _requestService: IRequestService;\n\tprivate readonly _telemetryService: ITelemetryService;\n\tprivate readonly _tunnelService: ITunnelService;\n\tprotected readonly _environmentService: IWorkbenchEnvironmentService;\n\n\tprivate readonly _focusDelayer = this._register(new ThrottledDelayer(10));\n\n\tconstructor(\n\t\tpublic readonly id: string,\n\t\tprivate readonly options: WebviewOptions,\n\t\tcontentOptions: WebviewContentOptions,\n\t\tpublic extension: WebviewExtensionDescription | undefined,\n\t\tprivate readonly webviewThemeDataProvider: WebviewThemeDataProvider,\n\t\tservices: {\n\t\t\tenvironmentService: IWorkbenchEnvironmentService,\n\t\t\tfileService: IFileService,\n\t\t\tlogService: ILogService,\n\t\t\tnotificationService: INotificationService,\n\t\t\tremoteAuthorityResolverService: IRemoteAuthorityResolverService,\n\t\t\trequestService: IRequestService,\n\t\t\ttelemetryService: ITelemetryService,\n\t\t\ttunnelService: ITunnelService,\n\t\t}\n\t) {\n\t\tsuper();\n\n\t\tthis._environmentService = services.environmentService;\n\t\tthis._fileService = services.fileService;\n\t\tthis._logService = services.logService;\n\t\tthis._remoteAuthorityResolverService = services.remoteAuthorityResolverService;\n\t\tthis._requestService = services.requestService;\n\t\tthis._telemetryService = services.telemetryService;\n\t\tthis._tunnelService = services.tunnelService;\n\n\t\tthis.content = {\n\t\t\thtml: '',\n\t\t\toptions: contentOptions,\n\t\t\tstate: undefined\n\t\t};\n\n\t\tthis._portMappingManager = this._register(new WebviewPortMappingManager(\n\t\t\t() => this.extension?.location,\n\t\t\t() => this.content.options.portMapping || [],\n\t\t\tthis._tunnelService\n\t\t));\n\n\t\tthis._element = this.createElement(options, contentOptions);\n\n\t\tconst subscription = this._register(this.on(WebviewMessageChannels.webviewReady, () => {\n\t\t\tthis._logService.debug(`Webview(${this.id}): webview ready`);\n\n\t\t\tthis.element?.classList.add('ready');\n\n\t\t\tif (this._state.type === WebviewState.Type.Initializing) {\n\t\t\t\tthis._state.pendingMessages.forEach(({ channel, data }) => this.doPostMessage(channel, data));\n\t\t\t}\n\t\t\tthis._state = WebviewState.Ready;\n\n\t\t\tsubscription.dispose();\n\t\t}));\n\n\t\tthis._register(this.on('no-csp-found', () => {\n\t\t\tthis.handleNoCspFound();\n\t\t}));\n\n\t\tthis._register(this.on(WebviewMessageChannels.didClickLink, (uri: string) => {\n\t\t\tthis._onDidClickLink.fire(uri);\n\t\t}));\n\n\t\tthis._register(this.on(WebviewMessageChannels.onmessage, (data: { message: any, transfer?: ArrayBuffer[] }) => {\n\t\t\tthis._onMessage.fire({\n\t\t\t\tmessage: data.message,\n\t\t\t\ttransfer: data.transfer,\n\t\t\t});\n\t\t}));\n\n\t\tthis._register(this.on(WebviewMessageChannels.didScroll, (scrollYPercentage: number) => {\n\t\t\tthis._onDidScroll.fire({ scrollYPercentage: scrollYPercentage });\n\t\t}));\n\n\t\tthis._register(this.on(WebviewMessageChannels.doReload, () => {\n\t\t\tthis.reload();\n\t\t}));\n\n\t\tthis._register(this.on(WebviewMessageChannels.doUpdateState, (state: any) => {\n\t\t\tthis.state = state;\n\t\t\tthis._onDidUpdateState.fire(state);\n\t\t}));\n\n\t\tthis._register(this.on(WebviewMessageChannels.didFocus, () => {\n\t\t\tthis.handleFocusChange(true);\n\t\t}));\n\n\t\tthis._register(this.on(WebviewMessageChannels.wheel, (event: IMouseWheelEvent) => {\n\t\t\tthis._onDidWheel.fire(event);\n\t\t}));\n\n\t\tthis._register(this.on(WebviewMessageChannels.didBlur, () => {\n\t\t\tthis.handleFocusChange(false);\n\t\t}));\n\n\t\tthis._register(this.on<{ message: string }>(WebviewMessageChannels.fatalError, (e) => {\n\t\t\tservices.notificationService.error(localize('fatalErrorMessage', \"Error loading webview: {0}\", e.message));\n\t\t}));\n\n\t\tthis._register(this.on('did-keydown', (data: KeyboardEvent) => {\n\t\t\t// Electron: workaround for https://github.com/electron/electron/issues/14258\n\t\t\t// We have to detect keyboard events in the <webview> and dispatch them to our\n\t\t\t// keybinding service because these events do not bubble to the parent window anymore.\n\t\t\tthis.handleKeyEvent('keydown', data);\n\t\t}));\n\n\t\tthis._register(this.on('did-keyup', (data: KeyboardEvent) => {\n\t\t\tthis.handleKeyEvent('keyup', data);\n\t\t}));\n\n\t\tthis._register(this.on(WebviewMessageChannels.loadResource, (entry: { id: number, path: string, query: string, ifNoneMatch?: string }) => {\n\t\t\tconst rawPath = entry.path;\n\t\t\tconst uri = URI.parse(rawPath.replace(/^\\/([\\w\\-]+)(\\/{1,2})/, (_: string, scheme: string, sep: string) => {\n\t\t\t\tif (sep.length === 1) {\n\t\t\t\t\treturn `${scheme}:///`; // Add empty authority.\n\t\t\t\t} else {\n\t\t\t\t\treturn `${scheme}://`; // Url has own authority.\n\t\t\t\t}\n\t\t\t})).with({\n\t\t\t\tquery: decodeURIComponent(entry.query),\n\t\t\t});\n\n\t\t\tthis.loadResource(entry.id, rawPath, uri, entry.ifNoneMatch);\n\t\t}));\n\n\t\tthis._register(this.on(WebviewMessageChannels.loadLocalhost, (entry: any) => {\n\t\t\tthis.localLocalhost(entry.id, entry.origin);\n\t\t}));\n\n\t\tthis.style();\n\t\tthis._register(webviewThemeDataProvider.onThemeDataChanged(this.style, this));\n\t}\n\n\toverride dispose(): void {\n\t\tif (this.element) {\n\t\t\tthis.element.remove();\n\t\t}\n\t\tthis._element = undefined;\n\n\t\tthis._onDidDispose.fire();\n\n\t\tthis._resourceLoadingCts.dispose(true);\n\n\t\tsuper.dispose();\n\t}\n\n\tprivate readonly _onMissingCsp = this._register(new Emitter<ExtensionIdentifier>());\n\tpublic readonly onMissingCsp = this._onMissingCsp.event;\n\n\tprivate readonly _onDidClickLink = this._register(new Emitter<string>());\n\tpublic readonly onDidClickLink = this._onDidClickLink.event;\n\n\tprivate readonly _onDidReload = this._register(new Emitter<void>());\n\tpublic readonly onDidReload = this._onDidReload.event;\n\n\tprivate readonly _onMessage = this._register(new Emitter<WebviewMessageReceivedEvent>());\n\tpublic readonly onMessage = this._onMessage.event;\n\n\tprivate readonly _onDidScroll = this._register(new Emitter<{ readonly scrollYPercentage: number; }>());\n\tpublic readonly onDidScroll = this._onDidScroll.event;\n\n\tprivate readonly _onDidWheel = this._register(new Emitter<IMouseWheelEvent>());\n\tpublic readonly onDidWheel = this._onDidWheel.event;\n\n\tprivate readonly _onDidUpdateState = this._register(new Emitter<string | undefined>());\n\tpublic readonly onDidUpdateState = this._onDidUpdateState.event;\n\n\tprivate readonly _onDidFocus = this._register(new Emitter<void>());\n\tpublic readonly onDidFocus = this._onDidFocus.event;\n\n\tprivate readonly _onDidBlur = this._register(new Emitter<void>());\n\tpublic readonly onDidBlur = this._onDidBlur.event;\n\n\tprivate readonly _onDidDispose = this._register(new Emitter<void>());\n\tpublic readonly onDidDispose = this._onDidDispose.event;\n\n\tpublic postMessage(message: any, transfer?: ArrayBuffer[]): void {\n\t\tthis._send('message', { message, transfer });\n\t}\n\n\tprotected _send(channel: string, data?: any): void {\n\t\tif (this._state.type === WebviewState.Type.Initializing) {\n\t\t\tthis._state.pendingMessages.push({ channel, data });\n\t\t} else {\n\t\t\tthis.doPostMessage(channel, data);\n\t\t}\n\t}\n\n\tprotected abstract readonly extraContentOptions: { readonly [key: string]: string };\n\n\tprotected abstract createElement(options: WebviewOptions, contentOptions: WebviewContentOptions): T;\n\n\tprotected abstract on<T = unknown>(channel: string, handler: (data: T) => void): IDisposable;\n\n\tprotected abstract doPostMessage(channel: string, data?: any): void;\n\n\tprivate _hasAlertedAboutMissingCsp = false;\n\tprivate handleNoCspFound(): void {\n\t\tif (this._hasAlertedAboutMissingCsp) {\n\t\t\treturn;\n\t\t}\n\t\tthis._hasAlertedAboutMissingCsp = true;\n\n\t\tif (this.extension && this.extension.id) {\n\t\t\tif (this._environmentService.isExtensionDevelopment) {\n\t\t\t\tthis._onMissingCsp.fire(this.extension.id);\n\t\t\t}\n\n\t\t\ttype TelemetryClassification = {\n\t\t\t\textension?: { classification: 'SystemMetaData', purpose: 'FeatureInsight'; };\n\t\t\t};\n\t\t\ttype TelemetryData = {\n\t\t\t\textension?: string,\n\t\t\t};\n\n\t\t\tthis._telemetryService.publicLog2<TelemetryData, TelemetryClassification>('webviewMissingCsp', {\n\t\t\t\textension: this.extension.id.value\n\t\t\t});\n\t\t}\n\t}\n\n\tpublic reload(): void {\n\t\tthis.doUpdateContent(this.content);\n\n\t\tconst subscription = this._register(this.on(WebviewMessageChannels.didLoad, () => {\n\t\t\tthis._onDidReload.fire();\n\t\t\tsubscription.dispose();\n\t\t}));\n\t}\n\n\tpublic set html(value: string) {\n\t\tconst rewrittenHtml = this.rewriteVsCodeResourceUrls(value);\n\t\tthis.doUpdateContent({\n\t\t\thtml: rewrittenHtml,\n\t\t\toptions: this.content.options,\n\t\t\tstate: this.content.state,\n\t\t});\n\t}\n\n\tprotected abstract get webviewResourceEndpoint(): string;\n\n\tprivate rewriteVsCodeResourceUrls(value: string): string {\n\t\treturn value\n\t\t\t.replace(/([\"'])(?:vscode-resource):(\\/\\/([^\\s\\/'\"]+?)(?=\\/))?([^\\s'\"]+?)([\"'])/gi, (match, startQuote, _1, scheme, path, endQuote) => {\n\t\t\t\tif (scheme) {\n\t\t\t\t\treturn `${startQuote}${this.webviewResourceEndpoint}/vscode-resource/${scheme}${path}${endQuote}`;\n\t\t\t\t}\n\t\t\t\treturn `${startQuote}${this.webviewResourceEndpoint}/vscode-resource/file${path}${endQuote}`;\n\t\t\t})\n\t\t\t.replace(/([\"'])(?:vscode-webview-resource):(\\/\\/[^\\s\\/'\"]+\\/([^\\s\\/'\"]+?)(?=\\/))?([^\\s'\"]+?)([\"'])/gi, (match, startQuote, _1, scheme, path, endQuote) => {\n\t\t\t\tif (scheme) {\n\t\t\t\t\treturn `${startQuote}${this.webviewResourceEndpoint}/vscode-resource/${scheme}${path}${endQuote}`;\n\t\t\t\t}\n\t\t\t\treturn `${startQuote}${this.webviewResourceEndpoint}/vscode-resource/file${path}${endQuote}`;\n\t\t\t});\n\t}\n\n\tpublic set contentOptions(options: WebviewContentOptions) {\n\t\tthis._logService.debug(`Webview(${this.id}): will update content options`);\n\n\t\tif (areWebviewContentOptionsEqual(options, this.content.options)) {\n\t\t\tthis._logService.debug(`Webview(${this.id}): skipping content options update`);\n\t\t\treturn;\n\t\t}\n\n\t\tthis.doUpdateContent({\n\t\t\thtml: this.content.html,\n\t\t\toptions: options,\n\t\t\tstate: this.content.state,\n\t\t});\n\t}\n\n\tpublic set localResourcesRoot(resources: readonly URI[]) {\n\t\tthis.content = {\n\t\t\t...this.content,\n\t\t\toptions: { ...this.content.options, localResourceRoots: resources }\n\t\t};\n\t}\n\n\tpublic set state(state: string | undefined) {\n\t\tthis.content = {\n\t\t\thtml: this.content.html,\n\t\t\toptions: this.content.options,\n\t\t\tstate,\n\t\t};\n\t}\n\n\tpublic set initialScrollProgress(value: number) {\n\t\tthis._send('initial-scroll-position', value);\n\t}\n\n\tprivate doUpdateContent(newContent: WebviewContent) {\n\t\tthis._logService.debug(`Webview(${this.id}): will update content`);\n\n\t\tthis.content = newContent;\n\n\t\tthis._send('content', {\n\t\t\tcontents: this.content.html,\n\t\t\toptions: this.content.options,\n\t\t\tstate: this.content.state,\n\t\t\tresourceEndpoint: this.webviewResourceEndpoint,\n\t\t\t...this.extraContentOptions\n\t\t});\n\t}\n\n\tprotected style(): void {\n\t\tlet { styles, activeTheme, themeLabel } = this.webviewThemeDataProvider.getWebviewThemeData();\n\t\tif (this.options.transformCssVariables) {\n\t\t\tstyles = this.options.transformCssVariables(styles);\n\t\t}\n\n\t\tthis._send('styles', { styles, activeTheme, themeName: themeLabel });\n\t}\n\n\tprotected handleFocusChange(isFocused: boolean): void {\n\t\tthis._focused = isFocused;\n\t\tif (isFocused) {\n\t\t\tthis._onDidFocus.fire();\n\t\t} else {\n\t\t\tthis._onDidBlur.fire();\n\t\t}\n\t}\n\n\tprivate handleKeyEvent(type: 'keydown' | 'keyup', event: IKeydownEvent) {\n\t\t// Create a fake KeyboardEvent from the data provided\n\t\tconst emulatedKeyboardEvent = new KeyboardEvent(type, event);\n\t\t// Force override the target\n\t\tObject.defineProperty(emulatedKeyboardEvent, 'target', {\n\t\t\tget: () => this.element,\n\t\t});\n\t\t// And re-dispatch\n\t\twindow.dispatchEvent(emulatedKeyboardEvent);\n\t}\n\n\twindowDidDragStart(): void {\n\t\t// Webview break drag and droping around the main window (no events are generated when you are over them)\n\t\t// Work around this by disabling pointer events during the drag.\n\t\t// https://github.com/electron/electron/issues/18226\n\t\tif (this.element) {\n\t\t\tthis.element.style.pointerEvents = 'none';\n\t\t}\n\t}\n\n\twindowDidDragEnd(): void {\n\t\tif (this.element) {\n\t\t\tthis.element.style.pointerEvents = '';\n\t\t}\n\t}\n\n\tpublic selectAll() {\n\t\tthis.execCommand('selectAll');\n\t}\n\n\tpublic copy() {\n\t\tthis.execCommand('copy');\n\t}\n\n\tpublic paste() {\n\t\tthis.execCommand('paste');\n\t}\n\n\tpublic cut() {\n\t\tthis.execCommand('cut');\n\t}\n\n\tpublic undo() {\n\t\tthis.execCommand('undo');\n\t}\n\n\tpublic redo() {\n\t\tthis.execCommand('redo');\n\t}\n\n\tprivate execCommand(command: string) {\n\t\tif (this.element) {\n\t\t\tthis._send('execCommand', command);\n\t\t}\n\t}\n\n\tprivate async loadResource(id: number, requestPath: string, uri: URI, ifNoneMatch: string | undefined) {\n\t\ttry {\n\t\t\tconst remoteAuthority = this._environmentService.remoteAuthority;\n\t\t\tconst remoteConnectionData = remoteAuthority ? this._remoteAuthorityResolverService.getConnectionData(remoteAuthority) : null;\n\n\t\t\tconst result = await loadLocalResource(uri, ifNoneMatch, {\n\t\t\t\textensionLocation: this.extension?.location,\n\t\t\t\troots: this.content.options.localResourceRoots || [],\n\t\t\t\tremoteConnectionData,\n\t\t\t\tuseRootAuthority: this.content.options.useRootAuthority\n\t\t\t}, this._fileService, this._requestService, this._logService, this._resourceLoadingCts.token);\n\n\t\t\tswitch (result.type) {\n\t\t\t\tcase WebviewResourceResponse.Type.Success:\n\t\t\t\t\t{\n\t\t\t\t\t\tconst { buffer } = await streamToBuffer(result.stream);\n\t\t\t\t\t\treturn this._send('did-load-resource', {\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tstatus: 200,\n\t\t\t\t\t\t\tpath: requestPath,\n\t\t\t\t\t\t\tmime: result.mimeType,\n\t\t\t\t\t\t\tdata: buffer,\n\t\t\t\t\t\t\tetag: result.etag,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\tcase WebviewResourceResponse.Type.NotModified:\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this._send('did-load-resource', {\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tstatus: 304, // not modified\n\t\t\t\t\t\t\tpath: requestPath,\n\t\t\t\t\t\t\tmime: result.mimeType,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\tcase WebviewResourceResponse.Type.AccessDenied:\n\t\t\t\t\t{\n\t\t\t\t\t\treturn this._send('did-load-resource', {\n\t\t\t\t\t\t\tid,\n\t\t\t\t\t\t\tstatus: 401, // unauthorized\n\t\t\t\t\t\t\tpath: requestPath,\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t}\n\t\t} catch {\n\t\t\t// noop\n\t\t}\n\n\t\treturn this._send('did-load-resource', {\n\t\t\tid,\n\t\t\tstatus: 404,\n\t\t\tpath: requestPath\n\t\t});\n\t}\n\n\tprivate async localLocalhost(id: string, origin: string) {\n\t\tconst authority = this._environmentService.remoteAuthority;\n\t\tconst resolveAuthority = authority ? await this._remoteAuthorityResolverService.resolveAuthority(authority) : undefined;\n\t\tconst redirect = resolveAuthority ? await this._portMappingManager.getRedirect(resolveAuthority.authority, origin) : undefined;\n\t\treturn this._send('did-load-localhost', {\n\t\t\tid,\n\t\t\torigin,\n\t\t\tlocation: redirect\n\t\t});\n\t}\n\n\tpublic focus(): void {\n\t\tthis.doFocus();\n\n\t\t// Handle focus change programmatically (do not rely on event from <webview>)\n\t\tthis.handleFocusChange(true);\n\t}\n\n\tprotected doFocus() {\n\t\tif (!this.element) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Clear the existing focus first if not already on the webview.\n\t\t// This is required because the next part where we set the focus is async.\n\t\tif (document.activeElement && document.activeElement instanceof HTMLElement && document.activeElement !== this.element) {\n\t\t\t// Don't blur if on the webview because this will also happen async and may unset the focus\n\t\t\t// after the focus trigger fires below.\n\t\t\tdocument.activeElement.blur();\n\t\t}\n\n\t\t// Workaround for https://github.com/microsoft/vscode/issues/75209\n\t\t// Electron's webview.focus is async so for a sequence of actions such as:\n\t\t//\n\t\t// 1. Open webview\n\t\t// 1. Show quick pick from command palette\n\t\t//\n\t\t// We end up focusing the webview after showing the quick pick, which causes\n\t\t// the quick pick to instantly dismiss.\n\t\t//\n\t\t// Workaround this by debouncing the focus and making sure we are not focused on an input\n\t\t// when we try to re-focus.\n\t\tthis._focusDelayer.trigger(async () => {\n\t\t\tif (!this.isFocused || !this.element) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (document.activeElement && document.activeElement?.tagName !== 'BODY') {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tthis.elementFocusImpl();\n\t\t\t} catch {\n\t\t\t\t// noop\n\t\t\t}\n\t\t\tthis._send('focus');\n\t\t});\n\t}\n\n\tprotected abstract elementFocusImpl(): void;\n}\n"]}