{"version":3,"file":"mainThreadDocuments.test.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/test/browser/api/mainThreadDocuments.test.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;IAShG,KAAK,CAAC,+BAA+B,EAAE,GAAG,EAAE;QAE3C,IAAI,GAAG,GAAG,IAAI,mDAA6B,CAAC,kBAAM,EAAE,EAAE,EAAE,EAAE,CAAC,CAAC;QAE5D,QAAQ,CAAC,GAAG,EAAE;YACb,GAAG,CAAC,OAAO,EAAE,CAAC;QACf,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,SAAS,EAAE,KAAK,IAAI,EAAE;YAE1B,IAAI,UAAU,GAAG,KAAK,CAAC;YAEvB,GAAG,CAAC,GAAG,CACN,SAAG,CAAC,KAAK,CAAC,eAAe,CAAC,EAC1B;gBACC,MAAM,EAAO,EAAE,eAAe,EAAE,CAAA,GAAA,iCAAe,CAAA,CAAC,QAAQ,CAAC,EAAE;gBAC3D,OAAO;oBACN,UAAU,GAAG,IAAI,CAAC;gBACnB,CAAC;aACD,CAAC,CAAC;YAEJ,MAAM,CAAA,GAAA,eAAO,CAAA,CAAC,EAAE,CAAC,CAAC;YAClB,MAAM,CAAC,WAAW,CAAC,UAAU,EAAE,IAAI,CAAC,CAAC;QACtC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,UAAU,EAAE,GAAG,EAAE;YAErB,IAAI,QAAQ,GAAa,EAAE,CAAC;YAE5B,GAAG,CAAC,GAAG,CACN,SAAG,CAAC,KAAK,CAAC,eAAe,CAAC,EAC1B;gBACC,MAAM,EAAO,EAAE,eAAe,EAAE,CAAA,GAAA,iCAAe,CAAA,CAAC,QAAQ,CAAC,EAAE;gBAC3D,OAAO;oBACN,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBAClB,CAAC;aACD,EAAE,CAAC,CAAC,CAAC;YAEP,GAAG,CAAC,GAAG,CACN,SAAG,CAAC,KAAK,CAAC,eAAe,CAAC,EAC1B;gBACC,MAAM,EAAO,EAAE,eAAe,EAAE,CAAA,GAAA,iCAAe,CAAA,CAAC,QAAQ,CAAC,EAAE;gBAC3D,OAAO;oBACN,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBAClB,CAAC;aACD,EAAE,CAAC,CAAC,CAAC;YAEP,GAAG,CAAC,GAAG,CACN,SAAG,CAAC,KAAK,CAAC,gBAAgB,CAAC,EAC3B;gBACC,MAAM,EAAO,EAAE,eAAe,EAAE,CAAA,GAAA,iCAAe,CAAA,CAAC,IAAI,KAAK,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE;gBAC1E,OAAO;oBACN,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBAClB,CAAC;aACD,EAAE,EAAE,CAAC,CAAC;YAER,MAAM,CAAC,eAAe,CAAC,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAC1C,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,aAAa,EAAE,GAAG,EAAE;YAExB,IAAI,QAAQ,GAAa,EAAE,CAAC;YAE5B,GAAG,CAAC,GAAG,CACN,SAAG,CAAC,KAAK,CAAC,gBAAgB,CAAC,EAC3B;gBACC,MAAM,EAAO,EAAE,eAAe,EAAE,CAAA,GAAA,iCAAe,CAAA,CAAC,QAAQ,CAAC,EAAE;gBAC3D,OAAO;oBACN,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBAClB,CAAC;aACD,CAAC,CAAC;YAEJ,GAAG,CAAC,GAAG,CACN,SAAG,CAAC,KAAK,CAAC,gBAAgB,CAAC,EAC3B;gBACC,MAAM,EAAO,EAAE,eAAe,EAAE,CAAA,GAAA,iCAAe,CAAA,CAAC,QAAQ,CAAC,EAAE;gBAC3D,OAAO;oBACN,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBAClB,CAAC;aACD,CAAC,CAAC;YAEJ,GAAG,CAAC,GAAG,CACN,SAAG,CAAC,KAAK,CAAC,kBAAkB,CAAC,EAC7B;gBACC,MAAM,EAAO,EAAE,eAAe,EAAE,CAAA,GAAA,iCAAe,CAAA,CAAC,UAAU,CAAC,EAAE;gBAC7D,OAAO;oBACN,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBAClB,CAAC;aACD,CAAC,CAAC;YAEJ,GAAG,CAAC,GAAG,CACN,SAAG,CAAC,KAAK,CAAC,kBAAkB,CAAC,EAC7B;gBACC,MAAM,EAAO,EAAE,eAAe,EAAE,CAAA,GAAA,iCAAe,CAAA,CAAC,UAAU,CAAC,EAAE;gBAC7D,OAAO;oBACN,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBAClB,CAAC;aACD,CAAC,CAAC;YAEJ,GAAG,CAAC,GAAG,CACN,SAAG,CAAC,KAAK,CAAC,kBAAkB,CAAC,EAC7B;gBACC,MAAM,EAAO,EAAE,eAAe,EAAE,CAAA,GAAA,iCAAe,CAAA,CAAC,UAAU,CAAC,EAAE;gBAC7D,OAAO;oBACN,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;gBAClB,CAAC;aACD,CAAC,CAAC;YAEJ,GAAG,CAAC,MAAM,CAAC,SAAG,CAAC,KAAK,CAAC,iBAAiB,CAAC,CAAC,CAAC;YACzC,MAAM,CAAC,WAAW,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;YAEvC,GAAG,CAAC,MAAM,CAAC,SAAG,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAC,CAAC;YACxC,MAAM,CAAC,eAAe,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;YAEtC,QAAQ,GAAG,EAAE,CAAC;YAEd,GAAG,CAAC,MAAM,CAAC,SAAG,CAAC,KAAK,CAAC,aAAa,CAAC,CAAC,CAAC;YACrC,MAAM,CAAC,eAAe,CAAC,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;QAC1C,CAAC,CAAC,CAAC;IAEJ,CAAC,CAAC,CAAC","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { BoundModelReferenceCollection } from 'vs/workbench/api/browser/mainThreadDocuments';\nimport { createTextModel } from 'vs/editor/test/common/editorTestUtils';\nimport { timeout } from 'vs/base/common/async';\nimport { URI } from 'vs/base/common/uri';\nimport { extUri } from 'vs/base/common/resources';\n\nsuite('BoundModelReferenceCollection', () => {\n\n\tlet col = new BoundModelReferenceCollection(extUri, 15, 75);\n\n\tteardown(() => {\n\t\tcol.dispose();\n\t});\n\n\ttest('max age', async () => {\n\n\t\tlet didDispose = false;\n\n\t\tcol.add(\n\t\t\tURI.parse('test://farboo'),\n\t\t\t{\n\t\t\t\tobject: <any>{ textEditorModel: createTextModel('farboo') },\n\t\t\t\tdispose() {\n\t\t\t\t\tdidDispose = true;\n\t\t\t\t}\n\t\t\t});\n\n\t\tawait timeout(30);\n\t\tassert.strictEqual(didDispose, true);\n\t});\n\n\ttest('max size', () => {\n\n\t\tlet disposed: number[] = [];\n\n\t\tcol.add(\n\t\t\tURI.parse('test://farboo'),\n\t\t\t{\n\t\t\t\tobject: <any>{ textEditorModel: createTextModel('farboo') },\n\t\t\t\tdispose() {\n\t\t\t\t\tdisposed.push(0);\n\t\t\t\t}\n\t\t\t}, 6);\n\n\t\tcol.add(\n\t\t\tURI.parse('test://boofar'),\n\t\t\t{\n\t\t\t\tobject: <any>{ textEditorModel: createTextModel('boofar') },\n\t\t\t\tdispose() {\n\t\t\t\t\tdisposed.push(1);\n\t\t\t\t}\n\t\t\t}, 6);\n\n\t\tcol.add(\n\t\t\tURI.parse('test://xxxxxxx'),\n\t\t\t{\n\t\t\t\tobject: <any>{ textEditorModel: createTextModel(new Array(71).join('x')) },\n\t\t\t\tdispose() {\n\t\t\t\t\tdisposed.push(2);\n\t\t\t\t}\n\t\t\t}, 70);\n\n\t\tassert.deepStrictEqual(disposed, [0, 1]);\n\t});\n\n\ttest('dispose uri', () => {\n\n\t\tlet disposed: number[] = [];\n\n\t\tcol.add(\n\t\t\tURI.parse('test:///farboo'),\n\t\t\t{\n\t\t\t\tobject: <any>{ textEditorModel: createTextModel('farboo') },\n\t\t\t\tdispose() {\n\t\t\t\t\tdisposed.push(0);\n\t\t\t\t}\n\t\t\t});\n\n\t\tcol.add(\n\t\t\tURI.parse('test:///boofar'),\n\t\t\t{\n\t\t\t\tobject: <any>{ textEditorModel: createTextModel('boofar') },\n\t\t\t\tdispose() {\n\t\t\t\t\tdisposed.push(1);\n\t\t\t\t}\n\t\t\t});\n\n\t\tcol.add(\n\t\t\tURI.parse('test:///boo/far1'),\n\t\t\t{\n\t\t\t\tobject: <any>{ textEditorModel: createTextModel('boo/far1') },\n\t\t\t\tdispose() {\n\t\t\t\t\tdisposed.push(2);\n\t\t\t\t}\n\t\t\t});\n\n\t\tcol.add(\n\t\t\tURI.parse('test:///boo/far2'),\n\t\t\t{\n\t\t\t\tobject: <any>{ textEditorModel: createTextModel('boo/far2') },\n\t\t\t\tdispose() {\n\t\t\t\t\tdisposed.push(3);\n\t\t\t\t}\n\t\t\t});\n\n\t\tcol.add(\n\t\t\tURI.parse('test:///boo1/far'),\n\t\t\t{\n\t\t\t\tobject: <any>{ textEditorModel: createTextModel('boo1/far') },\n\t\t\t\tdispose() {\n\t\t\t\t\tdisposed.push(4);\n\t\t\t\t}\n\t\t\t});\n\n\t\tcol.remove(URI.parse('test:///unknown'));\n\t\tassert.strictEqual(disposed.length, 0);\n\n\t\tcol.remove(URI.parse('test:///farboo'));\n\t\tassert.deepStrictEqual(disposed, [0]);\n\n\t\tdisposed = [];\n\n\t\tcol.remove(URI.parse('test:///boo'));\n\t\tassert.deepStrictEqual(disposed, [2, 3]);\n\t});\n\n});\n"]}