{"version":3,"sources":["vs/workbench/services/configurationResolver/browser/configurationResolverService.ts"],"names":[],"mappings":"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","file":"configurationResolverService.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI as uri } from 'vs/base/common/uri';\nimport * as nls from 'vs/nls';\nimport * as Types from 'vs/base/common/types';\nimport { Schemas } from 'vs/base/common/network';\nimport { SideBySideEditor, EditorResourceAccessor } from 'vs/workbench/common/editor';\nimport { IStringDictionary, forEach, fromMap } from 'vs/base/common/collections';\nimport { IConfigurationService, IConfigurationOverrides, ConfigurationTarget } from 'vs/platform/configuration/common/configuration';\nimport { ICommandService } from 'vs/platform/commands/common/commands';\nimport { IWorkspaceFolder, IWorkspaceContextService, WorkbenchState } from 'vs/platform/workspace/common/workspace';\nimport { IEditorService } from 'vs/workbench/services/editor/common/editorService';\nimport { AbstractVariableResolverService } from 'vs/workbench/services/configurationResolver/common/variableResolver';\nimport { isCodeEditor } from 'vs/editor/browser/editorBrowser';\nimport { IQuickInputService, IInputOptions, IQuickPickItem, IPickOptions } from 'vs/platform/quickinput/common/quickInput';\nimport { ConfiguredInput } from 'vs/workbench/services/configurationResolver/common/configurationResolver';\nimport { IProcessEnvironment } from 'vs/base/common/platform';\nimport { ILabelService } from 'vs/platform/label/common/label';\n\nexport abstract class BaseConfigurationResolverService extends AbstractVariableResolverService {\n\n\tstatic readonly INPUT_OR_COMMAND_VARIABLES_PATTERN = /\\${((input|command):(.*?))}/g;\n\n\tconstructor(\n\t\tcontext: {\n\t\t\tgetAppRoot: () => string | undefined,\n\t\t\tgetExecPath: () => string | undefined\n\t\t},\n\t\tenvVariablesPromise: Promise<IProcessEnvironment>,\n\t\teditorService: IEditorService,\n\t\tprivate readonly configurationService: IConfigurationService,\n\t\tprivate readonly commandService: ICommandService,\n\t\tprivate readonly workspaceContextService: IWorkspaceContextService,\n\t\tprivate readonly quickInputService: IQuickInputService,\n\t\tprivate readonly labelService: ILabelService\n\t) {\n\t\tsuper({\n\t\t\tgetFolderUri: (folderName: string): uri | undefined => {\n\t\t\t\tconst folder = workspaceContextService.getWorkspace().folders.filter(f => f.name === folderName).pop();\n\t\t\t\treturn folder ? folder.uri : undefined;\n\t\t\t},\n\t\t\tgetWorkspaceFolderCount: (): number => {\n\t\t\t\treturn workspaceContextService.getWorkspace().folders.length;\n\t\t\t},\n\t\t\tgetConfigurationValue: (folderUri: uri | undefined, suffix: string): string | undefined => {\n\t\t\t\treturn configurationService.getValue<string>(suffix, folderUri ? { resource: folderUri } : {});\n\t\t\t},\n\t\t\tgetAppRoot: (): string | undefined => {\n\t\t\t\treturn context.getAppRoot();\n\t\t\t},\n\t\t\tgetExecPath: (): string | undefined => {\n\t\t\t\treturn context.getExecPath();\n\t\t\t},\n\t\t\tgetFilePath: (): string | undefined => {\n\t\t\t\tconst fileResource = EditorResourceAccessor.getOriginalUri(editorService.activeEditor, {\n\t\t\t\t\tsupportSideBySide: SideBySideEditor.PRIMARY,\n\t\t\t\t\tfilterByScheme: [Schemas.file, Schemas.userData, Schemas.vscodeRemote]\n\t\t\t\t});\n\t\t\t\tif (!fileResource) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\treturn this.labelService.getUriLabel(fileResource, { noPrefix: true });\n\t\t\t},\n\t\t\tgetWorkspaceFolderPathForFile: (): string | undefined => {\n\t\t\t\tconst fileResource = EditorResourceAccessor.getOriginalUri(editorService.activeEditor, {\n\t\t\t\t\tsupportSideBySide: SideBySideEditor.PRIMARY,\n\t\t\t\t\tfilterByScheme: [Schemas.file, Schemas.userData, Schemas.vscodeRemote]\n\t\t\t\t});\n\t\t\t\tif (!fileResource) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\tconst wsFolder = workspaceContextService.getWorkspaceFolder(fileResource);\n\t\t\t\tif (!wsFolder) {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t\treturn this.labelService.getUriLabel(wsFolder.uri, { noPrefix: true });\n\t\t\t},\n\t\t\tgetSelectedText: (): string | undefined => {\n\t\t\t\tconst activeTextEditorControl = editorService.activeTextEditorControl;\n\t\t\t\tif (isCodeEditor(activeTextEditorControl)) {\n\t\t\t\t\tconst editorModel = activeTextEditorControl.getModel();\n\t\t\t\t\tconst editorSelection = activeTextEditorControl.getSelection();\n\t\t\t\t\tif (editorModel && editorSelection) {\n\t\t\t\t\t\treturn editorModel.getValueInRange(editorSelection);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t},\n\t\t\tgetLineNumber: (): string | undefined => {\n\t\t\t\tconst activeTextEditorControl = editorService.activeTextEditorControl;\n\t\t\t\tif (isCodeEditor(activeTextEditorControl)) {\n\t\t\t\t\tconst selection = activeTextEditorControl.getSelection();\n\t\t\t\t\tif (selection) {\n\t\t\t\t\t\tconst lineNumber = selection.positionLineNumber;\n\t\t\t\t\t\treturn String(lineNumber);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}, labelService, envVariablesPromise);\n\t}\n\n\tpublic override async resolveWithInteractionReplace(folder: IWorkspaceFolder | undefined, config: any, section?: string, variables?: IStringDictionary<string>, target?: ConfigurationTarget): Promise<any> {\n\t\t// resolve any non-interactive variables and any contributed variables\n\t\tconfig = await this.resolveAnyAsync(folder, config);\n\n\t\t// resolve input variables in the order in which they are encountered\n\t\treturn this.resolveWithInteraction(folder, config, section, variables, target).then(mapping => {\n\t\t\t// finally substitute evaluated command variables (if there are any)\n\t\t\tif (!mapping) {\n\t\t\t\treturn null;\n\t\t\t} else if (mapping.size > 0) {\n\t\t\t\treturn this.resolveAnyAsync(folder, config, fromMap(mapping));\n\t\t\t} else {\n\t\t\t\treturn config;\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic override async resolveWithInteraction(folder: IWorkspaceFolder | undefined, config: any, section?: string, variables?: IStringDictionary<string>, target?: ConfigurationTarget): Promise<Map<string, string> | undefined> {\n\t\t// resolve any non-interactive variables and any contributed variables\n\t\tconst resolved = await this.resolveAnyMap(folder, config);\n\t\tconfig = resolved.newConfig;\n\t\tconst allVariableMapping: Map<string, string> = resolved.resolvedVariables;\n\n\t\t// resolve input and command variables in the order in which they are encountered\n\t\treturn this.resolveWithInputAndCommands(folder, config, variables, section, target).then(inputOrCommandMapping => {\n\t\t\tif (this.updateMapping(inputOrCommandMapping, allVariableMapping)) {\n\t\t\t\treturn allVariableMapping;\n\t\t\t}\n\t\t\treturn undefined;\n\t\t});\n\t}\n\n\t/**\n\t * Add all items from newMapping to fullMapping. Returns false if newMapping is undefined.\n\t */\n\tprivate updateMapping(newMapping: IStringDictionary<string> | undefined, fullMapping: Map<string, string>): boolean {\n\t\tif (!newMapping) {\n\t\t\treturn false;\n\t\t}\n\t\tforEach(newMapping, (entry) => {\n\t\t\tfullMapping.set(entry.key, entry.value);\n\t\t});\n\t\treturn true;\n\t}\n\n\t/**\n\t * Finds and executes all input and command variables in the given configuration and returns their values as a dictionary.\n\t * Please note: this method does not substitute the input or command variables (so the configuration is not modified).\n\t * The returned dictionary can be passed to \"resolvePlatform\" for the actual substitution.\n\t * See #6569.\n\t *\n\t * @param variableToCommandMap Aliases for commands\n\t */\n\tprivate async resolveWithInputAndCommands(folder: IWorkspaceFolder | undefined, configuration: any, variableToCommandMap?: IStringDictionary<string>, section?: string, target?: ConfigurationTarget): Promise<IStringDictionary<string> | undefined> {\n\n\t\tif (!configuration) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\t// get all \"inputs\"\n\t\tlet inputs: ConfiguredInput[] = [];\n\t\tif (this.workspaceContextService.getWorkbenchState() !== WorkbenchState.EMPTY && section) {\n\t\t\tconst overrides: IConfigurationOverrides = folder ? { resource: folder.uri } : {};\n\t\t\tlet result = this.configurationService.inspect(section, overrides);\n\t\t\tif (result && (result.userValue || result.workspaceValue || result.workspaceFolderValue)) {\n\t\t\t\tswitch (target) {\n\t\t\t\t\tcase ConfigurationTarget.USER: inputs = (<any>result.userValue)?.inputs; break;\n\t\t\t\t\tcase ConfigurationTarget.WORKSPACE: inputs = (<any>result.workspaceValue)?.inputs; break;\n\t\t\t\t\tdefault: inputs = (<any>result.workspaceFolderValue)?.inputs;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst valueResult = this.configurationService.getValue<any>(section, overrides);\n\t\t\t\tif (valueResult) {\n\t\t\t\t\tinputs = valueResult.inputs;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// extract and dedupe all \"input\" and \"command\" variables and preserve their order in an array\n\t\tconst variables: string[] = [];\n\t\tthis.findVariables(configuration, variables);\n\n\t\tconst variableValues: IStringDictionary<string> = Object.create(null);\n\n\t\tfor (const variable of variables) {\n\n\t\t\tconst [type, name] = variable.split(':', 2);\n\n\t\t\tlet result: string | undefined;\n\n\t\t\tswitch (type) {\n\n\t\t\t\tcase 'input':\n\t\t\t\t\tresult = await this.showUserInput(name, inputs);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'command':\n\t\t\t\t\t// use the name as a command ID #12735\n\t\t\t\t\tconst commandId = (variableToCommandMap ? variableToCommandMap[name] : undefined) || name;\n\t\t\t\t\tresult = await this.commandService.executeCommand(commandId, configuration);\n\t\t\t\t\tif (typeof result !== 'string' && !Types.isUndefinedOrNull(result)) {\n\t\t\t\t\t\tthrow new Error(nls.localize('commandVariable.noStringType', \"Cannot substitute command variable '{0}' because command did not return a result of type string.\", commandId));\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\t// Try to resolve it as a contributed variable\n\t\t\t\t\tif (this._contributedVariables.has(variable)) {\n\t\t\t\t\t\tresult = await this._contributedVariables.get(variable)!();\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (typeof result === 'string') {\n\t\t\t\tvariableValues[variable] = result;\n\t\t\t} else {\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}\n\n\t\treturn variableValues;\n\t}\n\n\t/**\n\t * Recursively finds all command or input variables in object and pushes them into variables.\n\t * @param object object is searched for variables.\n\t * @param variables All found variables are returned in variables.\n\t */\n\tprivate findVariables(object: any, variables: string[]) {\n\t\tif (typeof object === 'string') {\n\t\t\tlet matches;\n\t\t\twhile ((matches = BaseConfigurationResolverService.INPUT_OR_COMMAND_VARIABLES_PATTERN.exec(object)) !== null) {\n\t\t\t\tif (matches.length === 4) {\n\t\t\t\t\tconst command = matches[1];\n\t\t\t\t\tif (variables.indexOf(command) < 0) {\n\t\t\t\t\t\tvariables.push(command);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._contributedVariables.forEach((value, contributed: string) => {\n\t\t\t\tif ((variables.indexOf(contributed) < 0) && (object.indexOf('${' + contributed + '}') >= 0)) {\n\t\t\t\t\tvariables.push(contributed);\n\t\t\t\t}\n\t\t\t});\n\t\t} else if (Types.isArray(object)) {\n\t\t\tobject.forEach(value => {\n\t\t\t\tthis.findVariables(value, variables);\n\t\t\t});\n\t\t} else if (object) {\n\t\t\tObject.keys(object).forEach(key => {\n\t\t\t\tconst value = object[key];\n\t\t\t\tthis.findVariables(value, variables);\n\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Takes the provided input info and shows the quick pick so the user can provide the value for the input\n\t * @param variable Name of the input variable.\n\t * @param inputInfos Information about each possible input variable.\n\t */\n\tprivate showUserInput(variable: string, inputInfos: ConfiguredInput[]): Promise<string | undefined> {\n\n\t\tif (!inputInfos) {\n\t\t\treturn Promise.reject(new Error(nls.localize('inputVariable.noInputSection', \"Variable '{0}' must be defined in an '{1}' section of the debug or task configuration.\", variable, 'input')));\n\t\t}\n\n\t\t// find info for the given input variable\n\t\tconst info = inputInfos.filter(item => item.id === variable).pop();\n\t\tif (info) {\n\n\t\t\tconst missingAttribute = (attrName: string) => {\n\t\t\t\tthrow new Error(nls.localize('inputVariable.missingAttribute', \"Input variable '{0}' is of type '{1}' and must include '{2}'.\", variable, info.type, attrName));\n\t\t\t};\n\n\t\t\tswitch (info.type) {\n\n\t\t\t\tcase 'promptString': {\n\t\t\t\t\tif (!Types.isString(info.description)) {\n\t\t\t\t\t\tmissingAttribute('description');\n\t\t\t\t\t}\n\t\t\t\t\tconst inputOptions: IInputOptions = { prompt: info.description, ignoreFocusLost: true };\n\t\t\t\t\tif (info.default) {\n\t\t\t\t\t\tinputOptions.value = info.default;\n\t\t\t\t\t}\n\t\t\t\t\tif (info.password) {\n\t\t\t\t\t\tinputOptions.password = info.password;\n\t\t\t\t\t}\n\t\t\t\t\treturn this.quickInputService.input(inputOptions).then(resolvedInput => {\n\t\t\t\t\t\treturn resolvedInput;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tcase 'pickString': {\n\t\t\t\t\tif (!Types.isString(info.description)) {\n\t\t\t\t\t\tmissingAttribute('description');\n\t\t\t\t\t}\n\t\t\t\t\tif (Types.isArray(info.options)) {\n\t\t\t\t\t\tinfo.options.forEach(pickOption => {\n\t\t\t\t\t\t\tif (!Types.isString(pickOption) && !Types.isString(pickOption.value)) {\n\t\t\t\t\t\t\t\tmissingAttribute('value');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tmissingAttribute('options');\n\t\t\t\t\t}\n\t\t\t\t\tinterface PickStringItem extends IQuickPickItem {\n\t\t\t\t\t\tvalue: string;\n\t\t\t\t\t}\n\t\t\t\t\tconst picks = new Array<PickStringItem>();\n\t\t\t\t\tinfo.options.forEach(pickOption => {\n\t\t\t\t\t\tconst value = Types.isString(pickOption) ? pickOption : pickOption.value;\n\t\t\t\t\t\tconst label = Types.isString(pickOption) ? undefined : pickOption.label;\n\n\t\t\t\t\t\t// If there is no label defined, use value as label\n\t\t\t\t\t\tconst item: PickStringItem = {\n\t\t\t\t\t\t\tlabel: label ? `${label}: ${value}` : value,\n\t\t\t\t\t\t\tvalue: value\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (value === info.default) {\n\t\t\t\t\t\t\titem.description = nls.localize('inputVariable.defaultInputValue', \"(Default)\");\n\t\t\t\t\t\t\tpicks.unshift(item);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpicks.push(item);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tconst pickOptions: IPickOptions<PickStringItem> = { placeHolder: info.description, matchOnDetail: true, ignoreFocusLost: true };\n\t\t\t\t\treturn this.quickInputService.pick(picks, pickOptions, undefined).then(resolvedInput => {\n\t\t\t\t\t\tif (resolvedInput) {\n\t\t\t\t\t\t\treturn resolvedInput.value;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn undefined;\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tcase 'command': {\n\t\t\t\t\tif (!Types.isString(info.command)) {\n\t\t\t\t\t\tmissingAttribute('command');\n\t\t\t\t\t}\n\t\t\t\t\treturn this.commandService.executeCommand<string>(info.command, info.args).then(result => {\n\t\t\t\t\t\tif (typeof result === 'string' || Types.isUndefinedOrNull(result)) {\n\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthrow new Error(nls.localize('inputVariable.command.noStringType', \"Cannot substitute input variable '{0}' because command '{1}' did not return a result of type string.\", variable, info.command));\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error(nls.localize('inputVariable.unknownType', \"Input variable '{0}' can only be of type 'promptString', 'pickString', or 'command'.\", variable));\n\t\t\t}\n\t\t}\n\t\treturn Promise.reject(new Error(nls.localize('inputVariable.undefinedVariable', \"Undefined input variable '{0}' encountered. Remove or define '{0}' to continue.\", variable)));\n\t}\n}\n\nexport class ConfigurationResolverService extends BaseConfigurationResolverService {\n\n\tconstructor(\n\t\t@IEditorService editorService: IEditorService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@ICommandService commandService: ICommandService,\n\t\t@IWorkspaceContextService workspaceContextService: IWorkspaceContextService,\n\t\t@IQuickInputService quickInputService: IQuickInputService,\n\t\t@ILabelService labelService: ILabelService,\n\t) {\n\t\tsuper({ getAppRoot: () => undefined, getExecPath: () => undefined },\n\t\t\tPromise.resolve(Object.create(null)), editorService, configurationService,\n\t\t\tcommandService, workspaceContextService, quickInputService, labelService);\n\t}\n}\n"]}