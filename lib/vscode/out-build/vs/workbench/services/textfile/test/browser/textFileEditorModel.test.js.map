{"version":3,"file":"textFileEditorModel.test.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/services/textfile/test/browser/textFileEditorModel.test.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { TextFileEditorModel } from 'vs/workbench/services/textfile/common/textFileEditorModel';\nimport { EncodingMode, TextFileEditorModelState, snapshotToString, isTextFileEditorModel } from 'vs/workbench/services/textfile/common/textfiles';\nimport { createFileEditorInput, workbenchInstantiationService, TestServiceAccessor, TestReadonlyTextFileEditorModel, getLastResolvedFileStat } from 'vs/workbench/test/browser/workbenchTestServices';\nimport { toResource } from 'vs/base/test/common/utils';\nimport { TextFileEditorModelManager } from 'vs/workbench/services/textfile/common/textFileEditorModelManager';\nimport { FileOperationResult, FileOperationError } from 'vs/platform/files/common/files';\nimport { timeout } from 'vs/base/common/async';\nimport { ModesRegistry } from 'vs/editor/common/modes/modesRegistry';\nimport { assertIsDefined } from 'vs/base/common/types';\nimport { createTextBufferFactory, createTextBufferFactoryFromStream } from 'vs/editor/common/model/textModel';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { URI } from 'vs/base/common/uri';\nimport { bufferToStream, VSBuffer } from 'vs/base/common/buffer';\n\nsuite('Files - TextFileEditorModel', () => {\n\n\tfunction getLastModifiedTime(model: TextFileEditorModel): number {\n\t\tconst stat = getLastResolvedFileStat(model);\n\n\t\treturn stat ? stat.mtime : -1;\n\t}\n\n\tlet instantiationService: IInstantiationService;\n\tlet accessor: TestServiceAccessor;\n\tlet content: string;\n\n\tsetup(() => {\n\t\tinstantiationService = workbenchInstantiationService();\n\t\taccessor = instantiationService.createInstance(TestServiceAccessor);\n\t\tcontent = accessor.fileService.getContent();\n\t});\n\n\tteardown(() => {\n\t\t(<TextFileEditorModelManager>accessor.textFileService.files).dispose();\n\t\taccessor.fileService.setContent(content);\n\t});\n\n\ttest('basic events', async function () {\n\t\tconst model = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tlet onDidResolveCounter = 0;\n\t\tmodel.onDidResolve(() => onDidResolveCounter++);\n\n\t\tawait model.resolve();\n\n\t\tassert.strictEqual(onDidResolveCounter, 1);\n\n\t\tlet onDidChangeContentCounter = 0;\n\t\tmodel.onDidChangeContent(() => onDidChangeContentCounter++);\n\n\t\tlet onDidChangeDirtyCounter = 0;\n\t\tmodel.onDidChangeDirty(() => onDidChangeDirtyCounter++);\n\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('bar'));\n\n\t\tassert.strictEqual(onDidChangeContentCounter, 1);\n\t\tassert.strictEqual(onDidChangeDirtyCounter, 1);\n\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foo'));\n\n\t\tassert.strictEqual(onDidChangeContentCounter, 2);\n\t\tassert.strictEqual(onDidChangeDirtyCounter, 1);\n\n\t\tawait model.revert();\n\n\t\tassert.strictEqual(onDidChangeDirtyCounter, 2);\n\n\t\tmodel.dispose();\n\t});\n\n\ttest('isTextFileEditorModel', async function () {\n\t\tconst model = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tassert.strictEqual(isTextFileEditorModel(model), true);\n\n\t\tmodel.dispose();\n\t});\n\n\ttest('save', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tawait model.resolve();\n\n\t\tassert.strictEqual(accessor.workingCopyService.dirtyCount, 0);\n\n\t\tlet savedEvent = false;\n\t\tmodel.onDidSave(() => savedEvent = true);\n\n\t\tawait model.save();\n\t\tassert.ok(!savedEvent);\n\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('bar'));\n\t\tassert.ok(getLastModifiedTime(model) <= Date.now());\n\t\tassert.ok(model.hasState(TextFileEditorModelState.DIRTY));\n\n\t\tassert.strictEqual(accessor.workingCopyService.dirtyCount, 1);\n\t\tassert.strictEqual(accessor.workingCopyService.isDirty(model.resource, model.typeId), true);\n\n\t\tlet workingCopyEvent = false;\n\t\taccessor.workingCopyService.onDidChangeDirty(e => {\n\t\t\tif (e.resource.toString() === model.resource.toString()) {\n\t\t\t\tworkingCopyEvent = true;\n\t\t\t}\n\t\t});\n\n\t\tconst pendingSave = model.save();\n\t\tassert.ok(model.hasState(TextFileEditorModelState.PENDING_SAVE));\n\n\t\tawait Promise.all([pendingSave, model.joinState(TextFileEditorModelState.PENDING_SAVE)]);\n\n\t\tassert.ok(model.hasState(TextFileEditorModelState.SAVED));\n\t\tassert.ok(!model.isDirty());\n\t\tassert.ok(savedEvent);\n\t\tassert.ok(workingCopyEvent);\n\n\t\tassert.strictEqual(accessor.workingCopyService.dirtyCount, 0);\n\t\tassert.strictEqual(accessor.workingCopyService.isDirty(model.resource, model.typeId), false);\n\n\t\tsavedEvent = false;\n\n\t\tawait model.save({ force: true });\n\t\tassert.ok(savedEvent);\n\n\t\tmodel.dispose();\n\t\tassert.ok(!accessor.modelService.getModel(model.resource));\n\t});\n\n\ttest('save - touching also emits saved event', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tawait model.resolve();\n\n\t\tlet savedEvent = false;\n\t\tmodel.onDidSave(() => savedEvent = true);\n\n\t\tlet workingCopyEvent = false;\n\t\taccessor.workingCopyService.onDidChangeDirty(e => {\n\t\t\tif (e.resource.toString() === model.resource.toString()) {\n\t\t\t\tworkingCopyEvent = true;\n\t\t\t}\n\t\t});\n\n\t\tawait model.save({ force: true });\n\n\t\tassert.ok(savedEvent);\n\t\tassert.ok(!workingCopyEvent);\n\n\t\tmodel.dispose();\n\t\tassert.ok(!accessor.modelService.getModel(model.resource));\n\t});\n\n\ttest('save - touching with error turns model dirty', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tawait model.resolve();\n\n\t\tlet saveErrorEvent = false;\n\t\tmodel.onDidSaveError(() => saveErrorEvent = true);\n\n\t\tlet savedEvent = false;\n\t\tmodel.onDidSave(() => savedEvent = true);\n\n\t\taccessor.fileService.writeShouldThrowError = new Error('failed to write');\n\t\ttry {\n\t\t\tawait model.save({ force: true });\n\n\t\t\tassert.ok(model.hasState(TextFileEditorModelState.ERROR));\n\t\t\tassert.ok(model.isDirty());\n\t\t\tassert.ok(saveErrorEvent);\n\n\t\t\tassert.strictEqual(accessor.workingCopyService.dirtyCount, 1);\n\t\t\tassert.strictEqual(accessor.workingCopyService.isDirty(model.resource, model.typeId), true);\n\t\t} finally {\n\t\t\taccessor.fileService.writeShouldThrowError = undefined;\n\t\t}\n\n\t\tawait model.save({ force: true });\n\n\t\tassert.ok(savedEvent);\n\t\tassert.strictEqual(model.isDirty(), false);\n\n\t\tmodel.dispose();\n\t\tassert.ok(!accessor.modelService.getModel(model.resource));\n\t});\n\n\ttest('save error (generic)', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tawait model.resolve();\n\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('bar'));\n\n\t\tlet saveErrorEvent = false;\n\t\tmodel.onDidSaveError(() => saveErrorEvent = true);\n\n\t\taccessor.fileService.writeShouldThrowError = new Error('failed to write');\n\t\ttry {\n\t\t\tconst pendingSave = model.save();\n\t\t\tassert.ok(model.hasState(TextFileEditorModelState.PENDING_SAVE));\n\n\t\t\tawait pendingSave;\n\n\t\t\tassert.ok(model.hasState(TextFileEditorModelState.ERROR));\n\t\t\tassert.ok(model.isDirty());\n\t\t\tassert.ok(saveErrorEvent);\n\n\t\t\tassert.strictEqual(accessor.workingCopyService.dirtyCount, 1);\n\t\t\tassert.strictEqual(accessor.workingCopyService.isDirty(model.resource, model.typeId), true);\n\n\t\t\tmodel.dispose();\n\t\t} finally {\n\t\t\taccessor.fileService.writeShouldThrowError = undefined;\n\t\t}\n\t});\n\n\ttest('save error (conflict)', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tawait model.resolve();\n\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('bar'));\n\n\t\tlet saveErrorEvent = false;\n\t\tmodel.onDidSaveError(() => saveErrorEvent = true);\n\n\t\taccessor.fileService.writeShouldThrowError = new FileOperationError('save conflict', FileOperationResult.FILE_MODIFIED_SINCE);\n\t\ttry {\n\t\t\tconst pendingSave = model.save();\n\t\t\tassert.ok(model.hasState(TextFileEditorModelState.PENDING_SAVE));\n\n\t\t\tawait pendingSave;\n\n\t\t\tassert.ok(model.hasState(TextFileEditorModelState.CONFLICT));\n\t\t\tassert.ok(model.isDirty());\n\t\t\tassert.ok(saveErrorEvent);\n\n\t\t\tassert.strictEqual(accessor.workingCopyService.dirtyCount, 1);\n\t\t\tassert.strictEqual(accessor.workingCopyService.isDirty(model.resource, model.typeId), true);\n\n\t\t\tmodel.dispose();\n\t\t} finally {\n\t\t\taccessor.fileService.writeShouldThrowError = undefined;\n\t\t}\n\t});\n\n\ttest('setEncoding - encode', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tlet encodingEvent = false;\n\t\tmodel.onDidChangeEncoding(() => encodingEvent = true);\n\n\t\tawait model.setEncoding('utf8', EncodingMode.Encode); // no-op\n\t\tassert.strictEqual(getLastModifiedTime(model), -1);\n\n\t\tassert.ok(!encodingEvent);\n\n\t\tawait model.setEncoding('utf16', EncodingMode.Encode);\n\n\t\tassert.ok(encodingEvent);\n\n\t\tassert.ok(getLastModifiedTime(model) <= Date.now()); // indicates model was saved due to encoding change\n\n\t\tmodel.dispose();\n\t});\n\n\ttest('setEncoding - decode', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tawait model.setEncoding('utf16', EncodingMode.Decode);\n\n\t\tassert.ok(model.isResolved()); // model got resolved due to decoding\n\t\tmodel.dispose();\n\t});\n\n\ttest('setEncoding - decode dirty file saves first', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\t\tawait model.resolve();\n\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('bar'));\n\t\tassert.strictEqual(model.isDirty(), true);\n\n\t\tawait model.setEncoding('utf16', EncodingMode.Decode);\n\n\t\tassert.strictEqual(model.isDirty(), false);\n\t\tmodel.dispose();\n\t});\n\n\ttest('create with mode', async function () {\n\t\tconst mode = 'text-file-model-test';\n\t\tModesRegistry.registerLanguage({\n\t\t\tid: mode,\n\t\t});\n\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', mode);\n\n\t\tawait model.resolve();\n\n\t\tassert.strictEqual(model.textEditorModel!.getModeId(), mode);\n\n\t\tmodel.dispose();\n\t\tassert.ok(!accessor.modelService.getModel(model.resource));\n\t});\n\n\ttest('disposes when underlying model is destroyed', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tawait model.resolve();\n\n\t\tmodel.textEditorModel!.dispose();\n\t\tassert.ok(model.isDisposed());\n\t});\n\n\ttest('Resolve does not trigger save', async function () {\n\t\tconst model = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index.txt'), 'utf8', undefined);\n\t\tassert.ok(model.hasState(TextFileEditorModelState.SAVED));\n\n\t\tmodel.onDidSave(() => assert.fail());\n\t\tmodel.onDidChangeDirty(() => assert.fail());\n\n\t\tawait model.resolve();\n\t\tassert.ok(model.isResolved());\n\t\tmodel.dispose();\n\t\tassert.ok(!accessor.modelService.getModel(model.resource));\n\t});\n\n\ttest('Resolve returns dirty model as long as model is dirty', async function () {\n\t\tconst model = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tawait model.resolve();\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foo'));\n\t\tassert.ok(model.isDirty());\n\t\tassert.ok(model.hasState(TextFileEditorModelState.DIRTY));\n\n\t\tawait model.resolve();\n\t\tassert.ok(model.isDirty());\n\t\tmodel.dispose();\n\t});\n\n\ttest('Resolve with contents', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tawait model.resolve({ contents: createTextBufferFactory('Hello World') });\n\n\t\tassert.strictEqual(model.textEditorModel?.getValue(), 'Hello World');\n\t\tassert.strictEqual(model.isDirty(), true);\n\n\t\tawait model.resolve({ contents: createTextBufferFactory('Hello Changes') });\n\n\t\tassert.strictEqual(model.textEditorModel?.getValue(), 'Hello Changes');\n\t\tassert.strictEqual(model.isDirty(), true);\n\n\t\t// verify that we do not mark the model as saved when undoing once because\n\t\t// we never really had a saved state\n\t\tawait model.textEditorModel!.undo();\n\t\tassert.ok(model.isDirty());\n\n\t\tmodel.dispose();\n\t\tassert.ok(!accessor.modelService.getModel(model.resource));\n\t});\n\n\ttest('Revert', async function () {\n\t\tlet eventCounter = 0;\n\n\t\tconst model = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tmodel.onDidRevert(() => eventCounter++);\n\n\t\tlet workingCopyEvent = false;\n\t\taccessor.workingCopyService.onDidChangeDirty(e => {\n\t\t\tif (e.resource.toString() === model.resource.toString()) {\n\t\t\t\tworkingCopyEvent = true;\n\t\t\t}\n\t\t});\n\n\t\tawait model.resolve();\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foo'));\n\t\tassert.ok(model.isDirty());\n\n\t\tassert.strictEqual(accessor.workingCopyService.dirtyCount, 1);\n\t\tassert.strictEqual(accessor.workingCopyService.isDirty(model.resource, model.typeId), true);\n\n\t\tawait model.revert();\n\t\tassert.strictEqual(model.isDirty(), false);\n\t\tassert.strictEqual(model.textEditorModel!.getValue(), 'Hello Html');\n\t\tassert.strictEqual(eventCounter, 1);\n\n\t\tassert.ok(workingCopyEvent);\n\t\tassert.strictEqual(accessor.workingCopyService.dirtyCount, 0);\n\t\tassert.strictEqual(accessor.workingCopyService.isDirty(model.resource, model.typeId), false);\n\n\t\tmodel.dispose();\n\t});\n\n\ttest('Revert (soft)', async function () {\n\t\tlet eventCounter = 0;\n\n\t\tconst model = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tmodel.onDidRevert(() => eventCounter++);\n\n\t\tlet workingCopyEvent = false;\n\t\taccessor.workingCopyService.onDidChangeDirty(e => {\n\t\t\tif (e.resource.toString() === model.resource.toString()) {\n\t\t\t\tworkingCopyEvent = true;\n\t\t\t}\n\t\t});\n\n\t\tawait model.resolve();\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foo'));\n\t\tassert.ok(model.isDirty());\n\n\t\tassert.strictEqual(accessor.workingCopyService.dirtyCount, 1);\n\t\tassert.strictEqual(accessor.workingCopyService.isDirty(model.resource, model.typeId), true);\n\n\t\tawait model.revert({ soft: true });\n\t\tassert.strictEqual(model.isDirty(), false);\n\t\tassert.strictEqual(model.textEditorModel!.getValue(), 'foo');\n\t\tassert.strictEqual(eventCounter, 1);\n\n\t\tassert.ok(workingCopyEvent);\n\t\tassert.strictEqual(accessor.workingCopyService.dirtyCount, 0);\n\t\tassert.strictEqual(accessor.workingCopyService.isDirty(model.resource, model.typeId), false);\n\n\t\tmodel.dispose();\n\t});\n\n\ttest('Undo to saved state turns model non-dirty', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\t\tawait model.resolve();\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('Hello Text'));\n\t\tassert.ok(model.isDirty());\n\n\t\tawait model.textEditorModel!.undo();\n\t\tassert.ok(!model.isDirty());\n\t});\n\n\ttest('Resolve and undo turns model dirty', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\t\tawait model.resolve();\n\t\taccessor.fileService.setContent('Hello Change');\n\n\t\tawait model.resolve();\n\t\tawait model.textEditorModel!.undo();\n\t\tassert.ok(model.isDirty());\n\n\t\tassert.strictEqual(accessor.workingCopyService.dirtyCount, 1);\n\t\tassert.strictEqual(accessor.workingCopyService.isDirty(model.resource, model.typeId), true);\n\t});\n\n\ttest('Update Dirty', async function () {\n\t\tlet eventCounter = 0;\n\n\t\tconst model = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tmodel.setDirty(true);\n\t\tassert.ok(!model.isDirty()); // needs to be resolved\n\n\t\tawait model.resolve();\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foo'));\n\t\tassert.ok(model.isDirty());\n\n\t\tawait model.revert({ soft: true });\n\t\tassert.strictEqual(model.isDirty(), false);\n\n\t\tmodel.onDidChangeDirty(() => eventCounter++);\n\n\t\tlet workingCopyEvent = false;\n\t\taccessor.workingCopyService.onDidChangeDirty(e => {\n\t\t\tif (e.resource.toString() === model.resource.toString()) {\n\t\t\t\tworkingCopyEvent = true;\n\t\t\t}\n\t\t});\n\n\t\tmodel.setDirty(true);\n\t\tassert.ok(model.isDirty());\n\t\tassert.strictEqual(eventCounter, 1);\n\t\tassert.ok(workingCopyEvent);\n\n\t\tmodel.setDirty(false);\n\t\tassert.strictEqual(model.isDirty(), false);\n\t\tassert.strictEqual(eventCounter, 2);\n\n\t\tmodel.dispose();\n\t});\n\n\ttest('No Dirty or saving for readonly models', async function () {\n\t\tlet workingCopyEvent = false;\n\t\taccessor.workingCopyService.onDidChangeDirty(e => {\n\t\t\tif (e.resource.toString() === model.resource.toString()) {\n\t\t\t\tworkingCopyEvent = true;\n\t\t\t}\n\t\t});\n\n\t\tconst model = instantiationService.createInstance(TestReadonlyTextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tlet saveEvent = false;\n\t\tmodel.onDidSave(() => {\n\t\t\tsaveEvent = true;\n\t\t});\n\n\t\tawait model.resolve();\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foo'));\n\t\tassert.ok(!model.isDirty());\n\n\t\tawait model.save({ force: true });\n\t\tassert.strictEqual(saveEvent, false);\n\n\t\tawait model.revert({ soft: true });\n\t\tassert.ok(!model.isDirty());\n\n\t\tassert.ok(!workingCopyEvent);\n\n\t\tmodel.dispose();\n\t});\n\n\ttest('File not modified error is handled gracefully', async function () {\n\t\tlet model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tawait model.resolve();\n\n\t\tconst mtime = getLastModifiedTime(model);\n\t\taccessor.textFileService.setReadStreamErrorOnce(new FileOperationError('error', FileOperationResult.FILE_NOT_MODIFIED_SINCE));\n\n\t\tawait model.resolve();\n\n\t\tassert.ok(model);\n\t\tassert.strictEqual(getLastModifiedTime(model), mtime);\n\t\tmodel.dispose();\n\t});\n\n\ttest('Resolve error is handled gracefully if model already exists', async function () {\n\t\tlet model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tawait model.resolve();\n\t\taccessor.textFileService.setReadStreamErrorOnce(new FileOperationError('error', FileOperationResult.FILE_NOT_FOUND));\n\n\t\tawait model.resolve();\n\t\tassert.ok(model);\n\t\tmodel.dispose();\n\t});\n\n\ttest('save() and isDirty() - proper with check for mtimes', async function () {\n\t\tconst input1 = createFileEditorInput(instantiationService, toResource.call(this, '/path/index_async2.txt'));\n\t\tconst input2 = createFileEditorInput(instantiationService, toResource.call(this, '/path/index_async.txt'));\n\n\t\tconst model1 = await input1.resolve() as TextFileEditorModel;\n\t\tconst model2 = await input2.resolve() as TextFileEditorModel;\n\n\t\tmodel1.updateTextEditorModel(createTextBufferFactory('foo'));\n\n\t\tconst m1Mtime = assertIsDefined(getLastResolvedFileStat(model1)).mtime;\n\t\tconst m2Mtime = assertIsDefined(getLastResolvedFileStat(model2)).mtime;\n\t\tassert.ok(m1Mtime > 0);\n\t\tassert.ok(m2Mtime > 0);\n\n\t\tassert.ok(accessor.textFileService.isDirty(toResource.call(this, '/path/index_async2.txt')));\n\t\tassert.ok(!accessor.textFileService.isDirty(toResource.call(this, '/path/index_async.txt')));\n\n\t\tmodel2.updateTextEditorModel(createTextBufferFactory('foo'));\n\t\tassert.ok(accessor.textFileService.isDirty(toResource.call(this, '/path/index_async.txt')));\n\n\t\tawait timeout(10);\n\t\tawait accessor.textFileService.save(toResource.call(this, '/path/index_async.txt'));\n\t\tawait accessor.textFileService.save(toResource.call(this, '/path/index_async2.txt'));\n\t\tassert.ok(!accessor.textFileService.isDirty(toResource.call(this, '/path/index_async.txt')));\n\t\tassert.ok(!accessor.textFileService.isDirty(toResource.call(this, '/path/index_async2.txt')));\n\t\tassert.ok(assertIsDefined(getLastResolvedFileStat(model1)).mtime > m1Mtime);\n\t\tassert.ok(assertIsDefined(getLastResolvedFileStat(model2)).mtime > m2Mtime);\n\n\t\tmodel1.dispose();\n\t\tmodel2.dispose();\n\t});\n\n\ttest('Save Participant', async function () {\n\t\tlet eventCounter = 0;\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tmodel.onDidSave(() => {\n\t\t\tassert.strictEqual(snapshotToString(model.createSnapshot()!), eventCounter === 1 ? 'bar' : 'foobar');\n\t\t\tassert.ok(!model.isDirty());\n\t\t\teventCounter++;\n\t\t});\n\n\t\tconst participant = accessor.textFileService.files.addSaveParticipant({\n\t\t\tparticipate: async model => {\n\t\t\t\tassert.ok(model.isDirty());\n\t\t\t\t(model as TextFileEditorModel).updateTextEditorModel(createTextBufferFactory('bar'));\n\t\t\t\tassert.ok(model.isDirty());\n\t\t\t\teventCounter++;\n\t\t\t}\n\t\t});\n\n\t\tawait model.resolve();\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foo'));\n\t\tassert.ok(model.isDirty());\n\n\t\tawait model.save();\n\t\tassert.strictEqual(eventCounter, 2);\n\n\t\tparticipant.dispose();\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foobar'));\n\t\tassert.ok(model.isDirty());\n\n\t\tawait model.save();\n\t\tassert.strictEqual(eventCounter, 3);\n\n\t\tmodel.dispose();\n\t});\n\n\ttest('Save Participant - skip', async function () {\n\t\tlet eventCounter = 0;\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tconst participant = accessor.textFileService.files.addSaveParticipant({\n\t\t\tparticipate: async () => {\n\t\t\t\teventCounter++;\n\t\t\t}\n\t\t});\n\n\t\tawait model.resolve();\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foo'));\n\n\t\tawait model.save({ skipSaveParticipants: true });\n\t\tassert.strictEqual(eventCounter, 0);\n\n\t\tparticipant.dispose();\n\t\tmodel.dispose();\n\t});\n\n\ttest('Save Participant, async participant', async function () {\n\t\tlet eventCounter = 0;\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tmodel.onDidSave(() => {\n\t\t\tassert.ok(!model.isDirty());\n\t\t\teventCounter++;\n\t\t});\n\n\t\tconst participant = accessor.textFileService.files.addSaveParticipant({\n\t\t\tparticipate: model => {\n\t\t\t\tassert.ok(model.isDirty());\n\t\t\t\t(model as TextFileEditorModel).updateTextEditorModel(createTextBufferFactory('bar'));\n\t\t\t\tassert.ok(model.isDirty());\n\t\t\t\teventCounter++;\n\n\t\t\t\treturn timeout(10);\n\t\t\t}\n\t\t});\n\n\t\tawait model.resolve();\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foo'));\n\n\t\tconst now = Date.now();\n\t\tawait model.save();\n\t\tassert.strictEqual(eventCounter, 2);\n\t\tassert.ok(Date.now() - now >= 10);\n\n\t\tmodel.dispose();\n\t\tparticipant.dispose();\n\t});\n\n\ttest('Save Participant, bad participant', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tconst participant = accessor.textFileService.files.addSaveParticipant({\n\t\t\tparticipate: async () => {\n\t\t\t\tnew Error('boom');\n\t\t\t}\n\t\t});\n\n\t\tawait model.resolve();\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foo'));\n\n\t\tawait model.save();\n\n\t\tmodel.dispose();\n\t\tparticipant.dispose();\n\t});\n\n\ttest('Save Participant, participant cancelled when saved again', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tlet participations: boolean[] = [];\n\n\t\tconst participant = accessor.textFileService.files.addSaveParticipant({\n\t\t\tparticipate: async (model, context, progress, token) => {\n\t\t\t\tawait timeout(10);\n\n\t\t\t\tif (!token.isCancellationRequested) {\n\t\t\t\t\tparticipations.push(true);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tawait model.resolve();\n\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foo'));\n\t\tconst p1 = model.save();\n\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foo 1'));\n\t\tconst p2 = model.save();\n\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foo 2'));\n\t\tconst p3 = model.save();\n\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foo 3'));\n\t\tconst p4 = model.save();\n\n\t\tawait Promise.all([p1, p2, p3, p4]);\n\t\tassert.strictEqual(participations.length, 1);\n\n\t\tmodel.dispose();\n\t\tparticipant.dispose();\n\t});\n\n\ttest('Save Participant, calling save from within is unsupported but does not explode (sync save)', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tawait testSaveFromSaveParticipant(model, false);\n\n\t\tmodel.dispose();\n\t});\n\n\ttest('Save Participant, calling save from within is unsupported but does not explode (async save)', async function () {\n\t\tconst model: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, toResource.call(this, '/path/index_async.txt'), 'utf8', undefined);\n\n\t\tawait testSaveFromSaveParticipant(model, true);\n\n\t\tmodel.dispose();\n\t});\n\n\tasync function testSaveFromSaveParticipant(model: TextFileEditorModel, async: boolean): Promise<void> {\n\t\tlet savePromise: Promise<boolean>;\n\t\tlet breakLoop = false;\n\n\t\tconst participant = accessor.textFileService.files.addSaveParticipant({\n\t\t\tparticipate: async model => {\n\t\t\t\tif (breakLoop) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tbreakLoop = true;\n\n\t\t\t\tif (async) {\n\t\t\t\t\tawait timeout(10);\n\t\t\t\t}\n\t\t\t\tconst newSavePromise = model.save();\n\n\t\t\t\t// assert that this is the same promise as the outer one\n\t\t\t\tassert.strictEqual(savePromise, newSavePromise);\n\t\t\t}\n\t\t});\n\n\t\tawait model.resolve();\n\t\tmodel.updateTextEditorModel(createTextBufferFactory('foo'));\n\n\t\tsavePromise = model.save();\n\t\tawait savePromise;\n\n\t\tparticipant.dispose();\n\t}\n\n\ttest('backup and restore (simple)', async function () {\n\t\treturn testBackupAndRestore(toResource.call(this, '/path/index_async.txt'), toResource.call(this, '/path/index_async2.txt'), 'Some very small file text content.');\n\t});\n\n\ttest('backup and restore (large, #121347)', async function () {\n\t\tconst largeContent = '\\n'.repeat(100000);\n\t\treturn testBackupAndRestore(toResource.call(this, '/path/index_async.txt'), toResource.call(this, '/path/index_async2.txt'), largeContent);\n\t});\n\n\tasync function testBackupAndRestore(resourceA: URI, resourceB: URI, contents: string): Promise<void> {\n\t\tconst originalModel: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, resourceA, 'utf8', undefined);\n\t\tawait originalModel.resolve({\n\t\t\tcontents: await createTextBufferFactoryFromStream(await accessor.textFileService.getDecodedStream(resourceA, bufferToStream(VSBuffer.fromString(contents))))\n\t\t});\n\n\t\tassert.strictEqual(originalModel.textEditorModel?.getValue(), contents);\n\n\t\tconst backup = await originalModel.backup(CancellationToken.None);\n\t\tconst modelRestoredIdentifier = { typeId: originalModel.typeId, resource: resourceB };\n\t\tawait accessor.workingCopyBackupService.backup(modelRestoredIdentifier, backup.content);\n\n\t\tconst modelRestored: TextFileEditorModel = instantiationService.createInstance(TextFileEditorModel, modelRestoredIdentifier.resource, 'utf8', undefined);\n\t\tawait modelRestored.resolve();\n\n\t\tassert.strictEqual(modelRestored.textEditorModel?.getValue(), contents);\n\t\tassert.strictEqual(modelRestored.isDirty(), true);\n\n\t\toriginalModel.dispose();\n\t\tmodelRestored.dispose();\n\t}\n});\n"]}