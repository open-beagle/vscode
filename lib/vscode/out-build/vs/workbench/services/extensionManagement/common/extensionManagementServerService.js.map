{"version":3,"sources":["vs/workbench/services/extensionManagement/common/extensionManagementServerService.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;;;;;;;;;;IAmBhG,IAAa,gCAAgC,GAA7C,MAAa,gCAAgC;QAQ5C,YACsB,kBAAuC,EAC7C,YAA2B,EAChB,cAAwC,EACjD,cAA+B,EACzB,oBAA2C,EAC3C,oBAA2C,EAC7B,kCAAuE;YAXpG,mCAA8B,GAAsC,IAAI,CAAC;YACzE,oCAA+B,GAAsC,IAAI,CAAC;YAC1E,iCAA4B,GAAsC,IAAI,CAAC;YAW/E,MAAM,qBAAqB,GAAG,kBAAkB,CAAC,aAAa,EAAE,CAAC;YACjE,IAAI,qBAAqB,EAAE;gBAC1B,MAAM,0BAA0B,GAAG,IAAI,sEAAmC,CAAC,qBAAqB,CAAC,UAAU,CAAW,YAAY,CAAC,EAAE,cAAc,EAAE,oBAAoB,EAAE,cAAc,EAAE,kCAAkC,CAAC,CAAC;gBAC/N,IAAI,CAAC,+BAA+B,GAAG;oBACtC,EAAE,EAAE,QAAQ;oBACZ,0BAA0B;oBAC1B,IAAI,KAAK,KAAK,OAAO,YAAY,CAAC,YAAY,CAAC,iBAAO,CAAC,YAAY,EAAE,qBAAsB,CAAC,eAAe,CAAC,IAAI,CAAA,GAAA,cAAQ,CAAA,CAAC,CAAQ,EAAE,IAAQ,CAAC,CAAC,CAAC,CAAC;iBAC/I,CAAC;aACF;YACD,IAAI,gBAAK,EAAE;gBACV,MAAM,0BAA0B,GAAG,oBAAoB,CAAC,cAAc,CAAC,6DAA6B,CAAC,CAAC;gBACtG,IAAI,CAAC,4BAA4B,GAAG;oBACnC,EAAE,EAAE,KAAK;oBACT,0BAA0B;oBAC1B,KAAK,EAAE,CAAA,GAAA,cAAQ,CAAA,CAAC,CAAS,EAAE,IAAS,CAAC;iBACrC,CAAC;aACF;QACF,CAAC;QAED,4BAA4B,CAAC,SAAqB;YACjD,IAAI,SAAS,CAAC,QAAQ,CAAC,MAAM,KAAK,iBAAO,CAAC,YAAY,EAAE;gBACvD,OAAO,IAAI,CAAC,+BAAgC,CAAC;aAC7C;YACD,IAAI,IAAI,CAAC,4BAA4B,EAAE;gBACtC,OAAO,IAAI,CAAC,4BAA4B,CAAC;aACzC;YACD,MAAM,IAAI,KAAK,CAAC,qBAAqB,SAAS,CAAC,QAAQ,EAAE,CAAC,CAAC;QAC5D,CAAC;KACD,CAAA;IA7CY,gCAAgC;QAS1C,WAAA,wCAAmB,CAAA;QACnB,WAAA,qBAAa,CAAA;QACb,WAAA,8CAAwB,CAAA;QACxB,WAAA,gCAAe,CAAA;QACf,WAAA,qCAAqB,CAAA;QACrB,WAAA,qCAAqB,CAAA;QACrB,WAAA,wEAAmC,CAAA;OAfzB,gCAAgC,CA6C5C;IA7CY,4EAAgC;IA+C7C,CAAA,GAAA,8BAAiB,CAAA,CAAC,uDAAiC,EAAE,gCAAgC,CAAC,CAAC","file":"extensionManagementServerService.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport { IExtensionManagementServer, IExtensionManagementServerService } from 'vs/workbench/services/extensionManagement/common/extensionManagement';\nimport { IRemoteAgentService } from 'vs/workbench/services/remote/common/remoteAgentService';\nimport { Schemas } from 'vs/base/common/network';\nimport { IChannel } from 'vs/base/parts/ipc/common/ipc';\nimport { registerSingleton } from 'vs/platform/instantiation/common/extensions';\nimport { ILabelService } from 'vs/platform/label/common/label';\nimport { isWeb } from 'vs/base/common/platform';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { WebExtensionManagementService } from 'vs/workbench/services/extensionManagement/common/webExtensionManagementService';\nimport { IExtension } from 'vs/platform/extensions/common/extensions';\nimport { WebRemoteExtensionManagementService } from 'vs/workbench/services/extensionManagement/common/remoteExtensionManagementService';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { IExtensionGalleryService } from 'vs/platform/extensionManagement/common/extensionManagement';\nimport { IProductService } from 'vs/platform/product/common/productService';\nimport { IExtensionManifestPropertiesService } from 'vs/workbench/services/extensions/common/extensionManifestPropertiesService';\n\nexport class ExtensionManagementServerService implements IExtensionManagementServerService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\treadonly localExtensionManagementServer: IExtensionManagementServer | null = null;\n\treadonly remoteExtensionManagementServer: IExtensionManagementServer | null = null;\n\treadonly webExtensionManagementServer: IExtensionManagementServer | null = null;\n\n\tconstructor(\n\t\t@IRemoteAgentService remoteAgentService: IRemoteAgentService,\n\t\t@ILabelService labelService: ILabelService,\n\t\t@IExtensionGalleryService galleryService: IExtensionGalleryService,\n\t\t@IProductService productService: IProductService,\n\t\t@IConfigurationService configurationService: IConfigurationService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t\t@IExtensionManifestPropertiesService extensionManifestPropertiesService: IExtensionManifestPropertiesService,\n\t) {\n\t\tconst remoteAgentConnection = remoteAgentService.getConnection();\n\t\tif (remoteAgentConnection) {\n\t\t\tconst extensionManagementService = new WebRemoteExtensionManagementService(remoteAgentConnection.getChannel<IChannel>('extensions'), galleryService, configurationService, productService, extensionManifestPropertiesService);\n\t\t\tthis.remoteExtensionManagementServer = {\n\t\t\t\tid: 'remote',\n\t\t\t\textensionManagementService,\n\t\t\t\tget label() { return labelService.getHostLabel(Schemas.vscodeRemote, remoteAgentConnection!.remoteAuthority) || localize('remote', \"Remote\"); }\n\t\t\t};\n\t\t}\n\t\tif (isWeb) {\n\t\t\tconst extensionManagementService = instantiationService.createInstance(WebExtensionManagementService);\n\t\t\tthis.webExtensionManagementServer = {\n\t\t\t\tid: 'web',\n\t\t\t\textensionManagementService,\n\t\t\t\tlabel: localize('browser', \"Browser\")\n\t\t\t};\n\t\t}\n\t}\n\n\tgetExtensionManagementServer(extension: IExtension): IExtensionManagementServer {\n\t\tif (extension.location.scheme === Schemas.vscodeRemote) {\n\t\t\treturn this.remoteExtensionManagementServer!;\n\t\t}\n\t\tif (this.webExtensionManagementServer) {\n\t\t\treturn this.webExtensionManagementServer;\n\t\t}\n\t\tthrow new Error(`Invalid Extension ${extension.location}`);\n\t}\n}\n\nregisterSingleton(IExtensionManagementServerService, ExtensionManagementServerService);\n"]}