{"version":3,"sources":["vs/workbench/services/extensionManagement/browser/extensionEnablementService.ts"],"names":[],"mappings":"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","file":"extensionEnablementService.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { localize } from 'vs/nls';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { IExtensionManagementService, DidUninstallExtensionEvent, IExtensionIdentifier, IGlobalExtensionEnablementService, ENABLED_EXTENSIONS_STORAGE_PATH, DISABLED_EXTENSIONS_STORAGE_PATH, DidInstallExtensionEvent } from 'vs/platform/extensionManagement/common/extensionManagement';\nimport { IWorkbenchExtensionEnablementService, EnablementState, IExtensionManagementServerService } from 'vs/workbench/services/extensionManagement/common/extensionManagement';\nimport { areSameExtensions } from 'vs/platform/extensionManagement/common/extensionManagementUtil';\nimport { IWorkspaceContextService, WorkbenchState } from 'vs/platform/workspace/common/workspace';\nimport { IStorageService, StorageScope } from 'vs/platform/storage/common/storage';\nimport { IWorkbenchEnvironmentService } from 'vs/workbench/services/environment/common/environmentService';\nimport { IExtension, isAuthenticaionProviderExtension, isLanguagePackExtension } from 'vs/platform/extensions/common/extensions';\nimport { IConfigurationService } from 'vs/platform/configuration/common/configuration';\nimport { registerSingleton } from 'vs/platform/instantiation/common/extensions';\nimport { StorageManager } from 'vs/platform/extensionManagement/common/extensionEnablementService';\nimport { webWorkerExtHostConfig } from 'vs/workbench/services/extensions/common/extensions';\nimport { IUserDataSyncAccountService } from 'vs/platform/userDataSync/common/userDataSyncAccount';\nimport { IUserDataAutoSyncEnablementService } from 'vs/platform/userDataSync/common/userDataSync';\nimport { ILifecycleService, LifecyclePhase } from 'vs/workbench/services/lifecycle/common/lifecycle';\nimport { INotificationService, Severity } from 'vs/platform/notification/common/notification';\nimport { IHostService } from 'vs/workbench/services/host/browser/host';\nimport { IExtensionBisectService } from 'vs/workbench/services/extensionManagement/browser/extensionBisect';\nimport { IWorkspaceTrustManagementService, IWorkspaceTrustRequestService } from 'vs/platform/workspace/common/workspaceTrust';\nimport { Promises } from 'vs/base/common/async';\nimport { IExtensionManifestPropertiesService } from 'vs/workbench/services/extensions/common/extensionManifestPropertiesService';\nimport { getVirtualWorkspaceScheme } from 'vs/platform/remote/common/remoteHosts';\n\nconst SOURCE = 'IWorkbenchExtensionEnablementService';\n\nexport class ExtensionEnablementService extends Disposable implements IWorkbenchExtensionEnablementService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _onEnablementChanged = new Emitter<readonly IExtension[]>();\n\tpublic readonly onEnablementChanged: Event<readonly IExtension[]> = this._onEnablementChanged.event;\n\n\tprivate readonly storageManger: StorageManager;\n\n\tconstructor(\n\t\t@IStorageService storageService: IStorageService,\n\t\t@IGlobalExtensionEnablementService protected readonly globalExtensionEnablementService: IGlobalExtensionEnablementService,\n\t\t@IWorkspaceContextService private readonly contextService: IWorkspaceContextService,\n\t\t@IWorkbenchEnvironmentService private readonly environmentService: IWorkbenchEnvironmentService,\n\t\t@IExtensionManagementService private readonly extensionManagementService: IExtensionManagementService,\n\t\t@IConfigurationService private readonly configurationService: IConfigurationService,\n\t\t@IExtensionManagementServerService private readonly extensionManagementServerService: IExtensionManagementServerService,\n\t\t@IUserDataAutoSyncEnablementService private readonly userDataAutoSyncEnablementService: IUserDataAutoSyncEnablementService,\n\t\t@IUserDataSyncAccountService private readonly userDataSyncAccountService: IUserDataSyncAccountService,\n\t\t@ILifecycleService private readonly lifecycleService: ILifecycleService,\n\t\t@INotificationService private readonly notificationService: INotificationService,\n\t\t@IHostService readonly hostService: IHostService,\n\t\t@IExtensionBisectService private readonly extensionBisectService: IExtensionBisectService,\n\t\t@IWorkspaceTrustManagementService private readonly workspaceTrustManagementService: IWorkspaceTrustManagementService,\n\t\t@IWorkspaceTrustRequestService private readonly workspaceTrustRequestService: IWorkspaceTrustRequestService,\n\t\t@IExtensionManifestPropertiesService private readonly extensionManifestPropertiesService: IExtensionManifestPropertiesService,\n\t) {\n\t\tsuper();\n\t\tthis.storageManger = this._register(new StorageManager(storageService));\n\t\tthis._register(this.globalExtensionEnablementService.onDidChangeEnablement(({ extensions, source }) => this.onDidChangeExtensions(extensions, source)));\n\t\tthis._register(extensionManagementService.onDidInstallExtension(this._onDidInstallExtension, this));\n\t\tthis._register(extensionManagementService.onDidUninstallExtension(this._onDidUninstallExtension, this));\n\n\t\t// delay notification for extensions disabled until workbench restored\n\t\tif (this.allUserExtensionsDisabled) {\n\t\t\tthis.lifecycleService.when(LifecyclePhase.Eventually).then(() => {\n\t\t\t\tthis.notificationService.prompt(Severity.Info, localize('extensionsDisabled', \"All installed extensions are temporarily disabled.\"), [{\n\t\t\t\t\tlabel: localize('Reload', \"Reload and Enable Extensions\"),\n\t\t\t\t\trun: () => hostService.reload({ disableExtensions: false })\n\t\t\t\t}]);\n\t\t\t});\n\t\t}\n\t}\n\n\tprivate get hasWorkspace(): boolean {\n\t\treturn this.contextService.getWorkbenchState() !== WorkbenchState.EMPTY;\n\t}\n\n\tprivate get allUserExtensionsDisabled(): boolean {\n\t\treturn this.environmentService.disableExtensions === true;\n\t}\n\n\tgetEnablementState(extension: IExtension): EnablementState {\n\t\tif (this.extensionBisectService.isDisabledByBisect(extension)) {\n\t\t\treturn EnablementState.DisabledByEnvironment;\n\t\t}\n\t\tif (this._isDisabledInEnv(extension)) {\n\t\t\treturn EnablementState.DisabledByEnvironment;\n\t\t}\n\t\tif (this._isDisabledByVirtualWorkspace(extension)) {\n\t\t\treturn EnablementState.DisabledByVirtualWorkspace;\n\t\t}\n\t\tif (this._isDisabledByExtensionKind(extension)) {\n\t\t\treturn EnablementState.DisabledByExtensionKind;\n\t\t}\n\t\tif (this._isEnabled(extension) && this._isDisabledByTrustRequirement(extension)) {\n\t\t\treturn EnablementState.DisabledByTrustRequirement;\n\t\t}\n\t\treturn this._getEnablementState(extension.identifier);\n\t}\n\n\tcanChangeEnablement(extension: IExtension): boolean {\n\t\ttry {\n\t\t\tthis.throwErrorIfCannotChangeEnablement(extension);\n\t\t} catch (error) {\n\t\t\treturn false;\n\t\t}\n\t\tconst enablementState = this.getEnablementState(extension);\n\t\tif (enablementState === EnablementState.DisabledByEnvironment\n\t\t\t|| enablementState === EnablementState.DisabledByVirtualWorkspace\n\t\t\t|| enablementState === EnablementState.DisabledByExtensionKind) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate throwErrorIfCannotChangeEnablement(extension: IExtension): void {\n\t\tif (isLanguagePackExtension(extension.manifest)) {\n\t\t\tthrow new Error(localize('cannot disable language pack extension', \"Cannot change enablement of {0} extension because it contributes language packs.\", extension.manifest.displayName || extension.identifier.id));\n\t\t}\n\n\t\tif (this.userDataAutoSyncEnablementService.isEnabled() && this.userDataSyncAccountService.account &&\n\t\t\tisAuthenticaionProviderExtension(extension.manifest) && extension.manifest.contributes!.authentication!.some(a => a.id === this.userDataSyncAccountService.account!.authenticationProviderId)) {\n\t\t\tthrow new Error(localize('cannot disable auth extension', \"Cannot change enablement {0} extension because Settings Sync depends on it.\", extension.manifest.displayName || extension.identifier.id));\n\t\t}\n\t}\n\n\tcanChangeWorkspaceEnablement(extension: IExtension): boolean {\n\t\tif (!this.canChangeEnablement(extension)) {\n\t\t\treturn false;\n\t\t}\n\t\ttry {\n\t\t\tthis.throwErrorIfCannotChangeWorkspaceEnablement(extension);\n\t\t} catch (error) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate throwErrorIfCannotChangeWorkspaceEnablement(extension: IExtension): void {\n\t\tif (!this.hasWorkspace) {\n\t\t\tthrow new Error(localize('noWorkspace', \"No workspace.\"));\n\t\t}\n\t\tif (isAuthenticaionProviderExtension(extension.manifest)) {\n\t\t\tthrow new Error(localize('cannot disable auth extension in workspace', \"Cannot change enablement of {0} extension in workspace because it contributes authentication providers\", extension.manifest.displayName || extension.identifier.id));\n\t\t}\n\t}\n\n\tasync setEnablement(extensions: IExtension[], newState: EnablementState): Promise<boolean[]> {\n\n\t\tconst workspace = newState === EnablementState.DisabledWorkspace || newState === EnablementState.EnabledWorkspace;\n\t\tfor (const extension of extensions) {\n\t\t\tif (workspace) {\n\t\t\t\tthis.throwErrorIfCannotChangeWorkspaceEnablement(extension);\n\t\t\t} else {\n\t\t\t\tthis.throwErrorIfCannotChangeEnablement(extension);\n\t\t\t}\n\t\t}\n\n\t\tconst result = await Promises.settled(extensions.map(e => {\n\t\t\tif (this._isDisabledByTrustRequirement(e)) {\n\t\t\t\treturn this.workspaceTrustRequestService.requestWorkspaceTrust({ modal: true })\n\t\t\t\t\t.then(trustState => {\n\t\t\t\t\t\tif (trustState) {\n\t\t\t\t\t\t\treturn this._setEnablement(e, newState);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn Promise.resolve(false);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn this._setEnablement(e, newState);\n\t\t\t}\n\t\t}));\n\n\t\tconst changedExtensions = extensions.filter((e, index) => result[index]);\n\t\tif (changedExtensions.length) {\n\t\t\tthis._onEnablementChanged.fire(changedExtensions);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _setEnablement(extension: IExtension, newState: EnablementState): Promise<boolean> {\n\n\t\tconst currentState = this._getEnablementState(extension.identifier);\n\n\t\tif (currentState === newState) {\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\n\t\tswitch (newState) {\n\t\t\tcase EnablementState.EnabledGlobally:\n\t\t\t\tthis._enableExtension(extension.identifier);\n\t\t\t\tbreak;\n\t\t\tcase EnablementState.DisabledGlobally:\n\t\t\t\tthis._disableExtension(extension.identifier);\n\t\t\t\tbreak;\n\t\t\tcase EnablementState.EnabledWorkspace:\n\t\t\t\tthis._enableExtensionInWorkspace(extension.identifier);\n\t\t\t\tbreak;\n\t\t\tcase EnablementState.DisabledWorkspace:\n\t\t\t\tthis._disableExtensionInWorkspace(extension.identifier);\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn Promise.resolve(true);\n\t}\n\n\tisEnabled(extension: IExtension): boolean {\n\t\tconst enablementState = this.getEnablementState(extension);\n\t\treturn enablementState === EnablementState.EnabledWorkspace || enablementState === EnablementState.EnabledGlobally;\n\t}\n\n\tprivate _isEnabled(extension: IExtension): boolean {\n\t\tconst enablementState = this._getEnablementState(extension.identifier);\n\t\treturn enablementState === EnablementState.EnabledWorkspace || enablementState === EnablementState.EnabledGlobally;\n\t}\n\n\tisDisabledGlobally(extension: IExtension): boolean {\n\t\treturn this._isDisabledGlobally(extension.identifier);\n\t}\n\n\tprivate _isDisabledInEnv(extension: IExtension): boolean {\n\t\tif (this.allUserExtensionsDisabled) {\n\t\t\treturn !extension.isBuiltin;\n\t\t}\n\t\tconst disabledExtensions = this.environmentService.disableExtensions;\n\t\tif (Array.isArray(disabledExtensions)) {\n\t\t\treturn disabledExtensions.some(id => areSameExtensions({ id }, extension.identifier));\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate _isDisabledByVirtualWorkspace(extension: IExtension): boolean {\n\t\tif (getVirtualWorkspaceScheme(this.contextService.getWorkspace()) !== undefined) {\n\t\t\treturn !this.extensionManifestPropertiesService.canSupportVirtualWorkspace(extension.manifest);\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate _isDisabledByExtensionKind(extension: IExtension): boolean {\n\t\tif (this.extensionManagementServerService.remoteExtensionManagementServer || this.extensionManagementServerService.webExtensionManagementServer) {\n\t\t\tconst server = this.extensionManagementServerService.getExtensionManagementServer(extension);\n\t\t\tfor (const extensionKind of this.extensionManifestPropertiesService.getExtensionKind(extension.manifest)) {\n\t\t\t\tif (extensionKind === 'ui') {\n\t\t\t\t\tif (this.extensionManagementServerService.localExtensionManagementServer && this.extensionManagementServerService.localExtensionManagementServer === server) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (extensionKind === 'workspace') {\n\t\t\t\t\tif (server === this.extensionManagementServerService.remoteExtensionManagementServer) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (extensionKind === 'web') {\n\t\t\t\t\tif (this.extensionManagementServerService.webExtensionManagementServer) {\n\t\t\t\t\t\tif (server === this.extensionManagementServerService.webExtensionManagementServer) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (server === this.extensionManagementServerService.localExtensionManagementServer) {\n\t\t\t\t\t\tconst enableLocalWebWorker = this.configurationService.getValue<boolean>(webWorkerExtHostConfig);\n\t\t\t\t\t\tif (enableLocalWebWorker) {\n\t\t\t\t\t\t\t// Web extensions are enabled on all configurations\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false; // NOTE@coder: Don't disable anything by extensionKind.\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate _isDisabledByTrustRequirement(extension: IExtension): boolean {\n\t\tif (this.workspaceTrustManagementService.isWorkpaceTrusted()) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn this.extensionManifestPropertiesService.getExtensionUntrustedWorkspaceSupportType(extension.manifest) === false;\n\t}\n\n\tprivate _getEnablementState(identifier: IExtensionIdentifier): EnablementState {\n\t\tif (this.hasWorkspace) {\n\t\t\tif (this._getWorkspaceEnabledExtensions().filter(e => areSameExtensions(e, identifier))[0]) {\n\t\t\t\treturn EnablementState.EnabledWorkspace;\n\t\t\t}\n\n\t\t\tif (this._getWorkspaceDisabledExtensions().filter(e => areSameExtensions(e, identifier))[0]) {\n\t\t\t\treturn EnablementState.DisabledWorkspace;\n\t\t\t}\n\t\t}\n\t\tif (this._isDisabledGlobally(identifier)) {\n\t\t\treturn EnablementState.DisabledGlobally;\n\t\t}\n\t\treturn EnablementState.EnabledGlobally;\n\t}\n\n\tprivate _isDisabledGlobally(identifier: IExtensionIdentifier): boolean {\n\t\treturn this.globalExtensionEnablementService.getDisabledExtensions().some(e => areSameExtensions(e, identifier));\n\t}\n\n\tprivate _enableExtension(identifier: IExtensionIdentifier): Promise<boolean> {\n\t\tthis._removeFromWorkspaceDisabledExtensions(identifier);\n\t\tthis._removeFromWorkspaceEnabledExtensions(identifier);\n\t\treturn this.globalExtensionEnablementService.enableExtension(identifier, SOURCE);\n\t}\n\n\tprivate _disableExtension(identifier: IExtensionIdentifier): Promise<boolean> {\n\t\tthis._removeFromWorkspaceDisabledExtensions(identifier);\n\t\tthis._removeFromWorkspaceEnabledExtensions(identifier);\n\t\treturn this.globalExtensionEnablementService.disableExtension(identifier, SOURCE);\n\t}\n\n\tprivate _enableExtensionInWorkspace(identifier: IExtensionIdentifier): void {\n\t\tthis._removeFromWorkspaceDisabledExtensions(identifier);\n\t\tthis._addToWorkspaceEnabledExtensions(identifier);\n\t}\n\n\tprivate _disableExtensionInWorkspace(identifier: IExtensionIdentifier): void {\n\t\tthis._addToWorkspaceDisabledExtensions(identifier);\n\t\tthis._removeFromWorkspaceEnabledExtensions(identifier);\n\t}\n\n\tprivate _addToWorkspaceDisabledExtensions(identifier: IExtensionIdentifier): Promise<boolean> {\n\t\tif (!this.hasWorkspace) {\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\t\tlet disabledExtensions = this._getWorkspaceDisabledExtensions();\n\t\tif (disabledExtensions.every(e => !areSameExtensions(e, identifier))) {\n\t\t\tdisabledExtensions.push(identifier);\n\t\t\tthis._setDisabledExtensions(disabledExtensions);\n\t\t\treturn Promise.resolve(true);\n\t\t}\n\t\treturn Promise.resolve(false);\n\t}\n\n\tprivate async _removeFromWorkspaceDisabledExtensions(identifier: IExtensionIdentifier): Promise<boolean> {\n\t\tif (!this.hasWorkspace) {\n\t\t\treturn false;\n\t\t}\n\t\tlet disabledExtensions = this._getWorkspaceDisabledExtensions();\n\t\tfor (let index = 0; index < disabledExtensions.length; index++) {\n\t\t\tconst disabledExtension = disabledExtensions[index];\n\t\t\tif (areSameExtensions(disabledExtension, identifier)) {\n\t\t\t\tdisabledExtensions.splice(index, 1);\n\t\t\t\tthis._setDisabledExtensions(disabledExtensions);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate _addToWorkspaceEnabledExtensions(identifier: IExtensionIdentifier): boolean {\n\t\tif (!this.hasWorkspace) {\n\t\t\treturn false;\n\t\t}\n\t\tlet enabledExtensions = this._getWorkspaceEnabledExtensions();\n\t\tif (enabledExtensions.every(e => !areSameExtensions(e, identifier))) {\n\t\t\tenabledExtensions.push(identifier);\n\t\t\tthis._setEnabledExtensions(enabledExtensions);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate _removeFromWorkspaceEnabledExtensions(identifier: IExtensionIdentifier): boolean {\n\t\tif (!this.hasWorkspace) {\n\t\t\treturn false;\n\t\t}\n\t\tlet enabledExtensions = this._getWorkspaceEnabledExtensions();\n\t\tfor (let index = 0; index < enabledExtensions.length; index++) {\n\t\t\tconst disabledExtension = enabledExtensions[index];\n\t\t\tif (areSameExtensions(disabledExtension, identifier)) {\n\t\t\t\tenabledExtensions.splice(index, 1);\n\t\t\t\tthis._setEnabledExtensions(enabledExtensions);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected _getWorkspaceEnabledExtensions(): IExtensionIdentifier[] {\n\t\treturn this._getExtensions(ENABLED_EXTENSIONS_STORAGE_PATH);\n\t}\n\n\tprivate _setEnabledExtensions(enabledExtensions: IExtensionIdentifier[]): void {\n\t\tthis._setExtensions(ENABLED_EXTENSIONS_STORAGE_PATH, enabledExtensions);\n\t}\n\n\tprotected _getWorkspaceDisabledExtensions(): IExtensionIdentifier[] {\n\t\treturn this._getExtensions(DISABLED_EXTENSIONS_STORAGE_PATH);\n\t}\n\n\tprivate _setDisabledExtensions(disabledExtensions: IExtensionIdentifier[]): void {\n\t\tthis._setExtensions(DISABLED_EXTENSIONS_STORAGE_PATH, disabledExtensions);\n\t}\n\n\tprivate _getExtensions(storageId: string): IExtensionIdentifier[] {\n\t\tif (!this.hasWorkspace) {\n\t\t\treturn [];\n\t\t}\n\t\treturn this.storageManger.get(storageId, StorageScope.WORKSPACE);\n\t}\n\n\tprivate _setExtensions(storageId: string, extensions: IExtensionIdentifier[]): void {\n\t\tthis.storageManger.set(storageId, extensions, StorageScope.WORKSPACE);\n\t}\n\n\tprivate async onDidChangeExtensions(extensionIdentifiers: ReadonlyArray<IExtensionIdentifier>, source?: string): Promise<void> {\n\t\tif (source !== SOURCE) {\n\t\t\tconst installedExtensions = await this.extensionManagementService.getInstalled();\n\t\t\tconst extensions = installedExtensions.filter(installedExtension => extensionIdentifiers.some(identifier => areSameExtensions(identifier, installedExtension.identifier)));\n\t\t\tthis._onEnablementChanged.fire(extensions);\n\t\t}\n\t}\n\n\tprivate _onDidInstallExtension({ local, error }: DidInstallExtensionEvent): void {\n\t\tif (local && !error && this._isDisabledByTrustRequirement(local)) {\n\t\t\tthis._onEnablementChanged.fire([local]);\n\t\t}\n\t}\n\n\tprivate _onDidUninstallExtension({ identifier, error }: DidUninstallExtensionEvent): void {\n\t\tif (!error) {\n\t\t\tthis._reset(identifier);\n\t\t}\n\t}\n\n\tprivate async _getExtensionsByWorkspaceTrustRequirement(): Promise<IExtension[]> {\n\t\tconst extensions = await this.extensionManagementService.getInstalled();\n\t\treturn extensions.filter(e => this.extensionManifestPropertiesService.getExtensionUntrustedWorkspaceSupportType(e.manifest) === false);\n\t}\n\n\tpublic async updateEnablementByWorkspaceTrustRequirement(): Promise<void> {\n\t\tconst extensions = await this._getExtensionsByWorkspaceTrustRequirement();\n\t\tif (extensions.length) {\n\t\t\tthis._onEnablementChanged.fire(extensions);\n\t\t}\n\t}\n\n\tprivate _reset(extension: IExtensionIdentifier) {\n\t\tthis._removeFromWorkspaceDisabledExtensions(extension);\n\t\tthis._removeFromWorkspaceEnabledExtensions(extension);\n\t\tthis.globalExtensionEnablementService.enableExtension(extension);\n\t}\n}\n\nregisterSingleton(IWorkbenchExtensionEnablementService, ExtensionEnablementService);\n"]}