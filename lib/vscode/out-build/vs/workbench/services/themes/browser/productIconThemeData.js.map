{"version":3,"sources":["vs/workbench/services/themes/browser/productIconThemeData.ts"],"names":[],"mappings":"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","file":"productIconThemeData.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from 'vs/base/common/uri';\nimport * as nls from 'vs/nls';\nimport * as Paths from 'vs/base/common/path';\nimport * as resources from 'vs/base/common/resources';\nimport * as Json from 'vs/base/common/json';\nimport { ExtensionData, IThemeExtensionPoint, IWorkbenchProductIconTheme } from 'vs/workbench/services/themes/common/workbenchThemeService';\nimport { IFileService } from 'vs/platform/files/common/files';\nimport { getParseErrorMessage } from 'vs/base/common/jsonErrorMessages';\nimport { asCSSUrl } from 'vs/base/browser/dom';\nimport { IStorageService, StorageScope, StorageTarget } from 'vs/platform/storage/common/storage';\nimport { DEFAULT_PRODUCT_ICON_THEME_SETTING_VALUE } from 'vs/workbench/services/themes/common/themeConfiguration';\nimport { fontIdRegex, fontWeightRegex, fontStyleRegex } from 'vs/workbench/services/themes/common/productIconThemeSchema';\nimport { isString } from 'vs/base/common/types';\nimport { ILogService } from 'vs/platform/log/common/log';\nimport { getIconRegistry } from 'vs/platform/theme/common/iconRegistry';\nimport { ThemeIcon } from 'vs/platform/theme/common/themeService';\n\nexport const DEFAULT_PRODUCT_ICON_THEME_ID = ''; // TODO\n\nexport class ProductIconThemeData implements IWorkbenchProductIconTheme {\n\n\tstatic readonly STORAGE_KEY = 'productIconThemeData';\n\n\tid: string;\n\tlabel: string;\n\tsettingsId: string;\n\tdescription?: string;\n\tisLoaded: boolean;\n\tlocation?: URI;\n\textensionData?: ExtensionData;\n\twatch?: boolean;\n\n\tstyleSheetContent?: string;\n\n\tprivate constructor(id: string, label: string, settingsId: string) {\n\t\tthis.id = id;\n\t\tthis.label = label;\n\t\tthis.settingsId = settingsId;\n\t\tthis.isLoaded = false;\n\t}\n\n\tpublic ensureLoaded(fileService: IFileService, logService: ILogService): Promise<string | undefined> {\n\t\treturn !this.isLoaded ? this.load(fileService, logService) : Promise.resolve(this.styleSheetContent);\n\t}\n\n\tpublic reload(fileService: IFileService, logService: ILogService): Promise<string | undefined> {\n\t\treturn this.load(fileService, logService);\n\t}\n\n\tprivate load(fileService: IFileService, logService: ILogService): Promise<string | undefined> {\n\t\tconst location = this.location;\n\t\tif (!location) {\n\t\t\treturn Promise.resolve(this.styleSheetContent);\n\t\t}\n\t\treturn _loadProductIconThemeDocument(fileService, location).then(iconThemeDocument => {\n\t\t\tconst result = _processIconThemeDocument(this.id, location, iconThemeDocument);\n\t\t\tthis.styleSheetContent = result.content;\n\t\t\tthis.isLoaded = true;\n\t\t\tif (result.warnings.length) {\n\t\t\t\tlogService.error(nls.localize('error.parseicondefs', \"Problems processing product icons definitions in {0}:\\n{1}\", location.toString(), result.warnings.join('\\n')));\n\t\t\t}\n\t\t\treturn this.styleSheetContent;\n\t\t});\n\t}\n\n\tstatic fromExtensionTheme(iconTheme: IThemeExtensionPoint, iconThemeLocation: URI, extensionData: ExtensionData): ProductIconThemeData {\n\t\tconst id = extensionData.extensionId + '-' + iconTheme.id;\n\t\tconst label = iconTheme.label || Paths.basename(iconTheme.path);\n\t\tconst settingsId = iconTheme.id;\n\n\t\tconst themeData = new ProductIconThemeData(id, label, settingsId);\n\n\t\tthemeData.description = iconTheme.description;\n\t\tthemeData.location = iconThemeLocation;\n\t\tthemeData.extensionData = extensionData;\n\t\tthemeData.watch = iconTheme._watch;\n\t\tthemeData.isLoaded = false;\n\t\treturn themeData;\n\t}\n\n\tstatic createUnloadedTheme(id: string): ProductIconThemeData {\n\t\tconst themeData = new ProductIconThemeData(id, '', '__' + id);\n\t\tthemeData.isLoaded = false;\n\t\tthemeData.extensionData = undefined;\n\t\tthemeData.watch = false;\n\t\treturn themeData;\n\t}\n\n\tprivate static _defaultProductIconTheme: ProductIconThemeData | null = null;\n\n\tstatic get defaultTheme(): ProductIconThemeData {\n\t\tlet themeData = ProductIconThemeData._defaultProductIconTheme;\n\t\tif (!themeData) {\n\t\t\tthemeData = ProductIconThemeData._defaultProductIconTheme = new ProductIconThemeData(DEFAULT_PRODUCT_ICON_THEME_ID, nls.localize('defaultTheme', 'Default'), DEFAULT_PRODUCT_ICON_THEME_SETTING_VALUE);\n\t\t\tthemeData.isLoaded = true;\n\t\t\tthemeData.extensionData = undefined;\n\t\t\tthemeData.watch = false;\n\t\t}\n\t\treturn themeData;\n\t}\n\n\tstatic fromStorageData(storageService: IStorageService): ProductIconThemeData | undefined {\n\t\tconst input = storageService.get(ProductIconThemeData.STORAGE_KEY, StorageScope.GLOBAL);\n\t\tif (!input) {\n\t\t\treturn undefined;\n\t\t}\n\t\ttry {\n\t\t\tlet data = JSON.parse(input);\n\t\t\tconst theme = new ProductIconThemeData('', '', '');\n\t\t\tfor (let key in data) {\n\t\t\t\tswitch (key) {\n\t\t\t\t\tcase 'id':\n\t\t\t\t\tcase 'label':\n\t\t\t\t\tcase 'description':\n\t\t\t\t\tcase 'settingsId':\n\t\t\t\t\tcase 'styleSheetContent':\n\t\t\t\t\tcase 'watch':\n\t\t\t\t\t\t(theme as any)[key] = data[key];\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'location':\n\t\t\t\t\t\t// ignore, no longer restore\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'extensionData':\n\t\t\t\t\t\ttheme.extensionData = ExtensionData.fromJSONObject(data.extensionData);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn theme;\n\t\t} catch (e) {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\ttoStorage(storageService: IStorageService) {\n\t\tconst data = JSON.stringify({\n\t\t\tid: this.id,\n\t\t\tlabel: this.label,\n\t\t\tdescription: this.description,\n\t\t\tsettingsId: this.settingsId,\n\t\t\tstyleSheetContent: this.styleSheetContent,\n\t\t\twatch: this.watch,\n\t\t\textensionData: ExtensionData.toJSONObject(this.extensionData),\n\t\t});\n\t\tstorageService.store(ProductIconThemeData.STORAGE_KEY, data, StorageScope.GLOBAL, StorageTarget.MACHINE);\n\t}\n}\n\ninterface IconDefinition {\n\tfontCharacter: string;\n\tfontId: string;\n}\n\ninterface FontDefinition {\n\tid: string;\n\tweight: string;\n\tstyle: string;\n\tsize: string;\n\tsrc: { path: string; format: string; }[];\n}\n\ninterface ProductIconThemeDocument {\n\ticonDefinitions: { [key: string]: IconDefinition };\n\tfonts: FontDefinition[];\n}\n\nfunction _loadProductIconThemeDocument(fileService: IFileService, location: URI): Promise<ProductIconThemeDocument> {\n\treturn fileService.readFile(location).then((content) => {\n\t\tlet errors: Json.ParseError[] = [];\n\t\tlet contentValue = Json.parse(content.value.toString(), errors);\n\t\tif (errors.length > 0) {\n\t\t\treturn Promise.reject(new Error(nls.localize('error.cannotparseicontheme', \"Problems parsing product icons file: {0}\", errors.map(e => getParseErrorMessage(e.error)).join(', '))));\n\t\t} else if (Json.getNodeType(contentValue) !== 'object') {\n\t\t\treturn Promise.reject(new Error(nls.localize('error.invalidformat', \"Invalid format for product icons theme file: Object expected.\")));\n\t\t} else if (!contentValue.iconDefinitions || !Array.isArray(contentValue.fonts) || !contentValue.fonts.length) {\n\t\t\treturn Promise.reject(new Error(nls.localize('error.missingProperties', \"Invalid format for product icons theme file: Must contain iconDefinitions and fonts.\")));\n\t\t}\n\t\treturn Promise.resolve(contentValue);\n\t});\n}\n\nfunction _processIconThemeDocument(id: string, iconThemeDocumentLocation: URI, iconThemeDocument: ProductIconThemeDocument): { content: string; warnings: string[] } {\n\n\tconst warnings: string[] = [];\n\tconst result = { content: '', warnings };\n\n\tif (!iconThemeDocument.iconDefinitions || !Array.isArray(iconThemeDocument.fonts) || !iconThemeDocument.fonts.length) {\n\t\treturn result;\n\t}\n\n\tconst iconThemeDocumentLocationDirname = resources.dirname(iconThemeDocumentLocation);\n\tfunction resolvePath(path: string) {\n\t\treturn resources.joinPath(iconThemeDocumentLocationDirname, path);\n\t}\n\n\tconst cssRules: string[] = [];\n\n\tconst fonts = iconThemeDocument.fonts;\n\tconst fontIdMapping: { [id: string]: string } = {};\n\tfor (const font of fonts) {\n\t\tconst src = font.src.map(l => `${asCSSUrl(resolvePath(l.path))} format('${l.format}')`).join(', ');\n\t\tif (isString(font.id) && font.id.match(fontIdRegex)) {\n\t\t\tconst fontId = `pi-` + font.id;\n\t\t\tfontIdMapping[font.id] = fontId;\n\n\t\t\tlet fontWeight = '';\n\t\t\tif (isString(font.weight) && font.weight.match(fontWeightRegex)) {\n\t\t\t\tfontWeight = `font-weight: ${font.weight};`;\n\t\t\t} else {\n\t\t\t\twarnings.push(nls.localize('error.fontWeight', 'Invalid font weight in font \\'{0}\\'. Ignoring setting.', font.id));\n\t\t\t}\n\n\t\t\tlet fontStyle = '';\n\t\t\tif (isString(font.style) && font.style.match(fontStyleRegex)) {\n\t\t\t\tfontStyle = `font-style: ${font.style};`;\n\t\t\t} else {\n\t\t\t\twarnings.push(nls.localize('error.fontStyle', 'Invalid font style in font \\'{0}\\'. Ignoring setting.', font.id));\n\t\t\t}\n\n\t\t\tcssRules.push(`@font-face { src: ${src}; font-family: '${fontId}';${fontWeight}${fontStyle} }`);\n\t\t} else {\n\t\t\twarnings.push(nls.localize('error.fontId', 'Missing or invalid font id \\'{0}\\'. Skipping font definition.', font.id));\n\t\t}\n\t}\n\n\tconst primaryFontId = fonts.length > 0 ? fontIdMapping[fonts[0].id] : '';\n\n\tconst iconDefinitions = iconThemeDocument.iconDefinitions;\n\tconst iconRegistry = getIconRegistry();\n\n\n\tfor (let iconContribution of iconRegistry.getIcons()) {\n\t\tconst iconId = iconContribution.id;\n\n\t\tlet definition = iconDefinitions[iconId];\n\n\t\t// look if an inherited icon has a definition\n\t\twhile (!definition && ThemeIcon.isThemeIcon(iconContribution.defaults)) {\n\t\t\tconst ic = iconRegistry.getIcon(iconContribution.defaults.id);\n\t\t\tif (ic) {\n\t\t\t\tdefinition = iconDefinitions[ic.id];\n\t\t\t\ticonContribution = ic;\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif (definition) {\n\t\t\tif (isString(definition.fontCharacter)) {\n\t\t\t\tconst fontId = definition.fontId !== undefined ? fontIdMapping[definition.fontId] : primaryFontId;\n\t\t\t\tif (fontId) {\n\t\t\t\t\tcssRules.push(`.codicon-${iconId}:before { content: '${definition.fontCharacter}' !important; font-family: ${fontId} !important; }`);\n\t\t\t\t} else {\n\t\t\t\t\twarnings.push(nls.localize('error.icon.fontId', 'Skipping icon definition \\'{0}\\'. Unknown font.', iconId));\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\twarnings.push(nls.localize('error.icon.fontCharacter', 'Skipping icon definition \\'{0}\\'. Unknown fontCharacter.', iconId));\n\t\t\t}\n\t\t}\n\t}\n\tresult.content = cssRules.join('\\n');\n\treturn result;\n}\n\n"]}