{"version":3,"sources":["vs/workbench/services/decorations/browser/decorationsService.ts"],"names":[],"mappings":"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","file":"decorationsService.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { URI } from 'vs/base/common/uri';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { IDecorationsService, IDecoration, IResourceDecorationChangeEvent, IDecorationsProvider, IDecorationData } from './decorations';\nimport { TernarySearchTree } from 'vs/base/common/map';\nimport { IDisposable, toDisposable, DisposableStore } from 'vs/base/common/lifecycle';\nimport { isThenable } from 'vs/base/common/async';\nimport { LinkedList } from 'vs/base/common/linkedList';\nimport { createStyleSheet, createCSSRule, removeCSSRulesContainingSelector } from 'vs/base/browser/dom';\nimport { IThemeService, IColorTheme, ThemeIcon } from 'vs/platform/theme/common/themeService';\nimport { isFalsyOrWhitespace } from 'vs/base/common/strings';\nimport { localize } from 'vs/nls';\nimport { isPromiseCanceledError } from 'vs/base/common/errors';\nimport { CancellationTokenSource } from 'vs/base/common/cancellation';\nimport { registerSingleton } from 'vs/platform/instantiation/common/extensions';\nimport { hash } from 'vs/base/common/hash';\nimport { IUriIdentityService } from 'vs/workbench/services/uriIdentity/common/uriIdentity';\nimport { iconRegistry } from 'vs/base/common/codicons';\n\nclass DecorationRule {\n\n\tstatic keyOf(data: IDecorationData | IDecorationData[]): string {\n\t\tif (Array.isArray(data)) {\n\t\t\treturn data.map(DecorationRule.keyOf).join(',');\n\t\t} else {\n\t\t\tconst { color, letter } = data;\n\t\t\tif (ThemeIcon.isThemeIcon(letter)) {\n\t\t\t\treturn `${color}+${letter.id}`;\n\t\t\t} else {\n\t\t\t\treturn `${color}/${letter}`;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate static readonly _classNamesPrefix = 'monaco-decoration';\n\n\treadonly data: IDecorationData | IDecorationData[];\n\treadonly itemColorClassName: string;\n\treadonly itemBadgeClassName: string;\n\treadonly iconBadgeClassName: string;\n\treadonly bubbleBadgeClassName: string;\n\n\tprivate _refCounter: number = 0;\n\n\tconstructor(data: IDecorationData | IDecorationData[], key: string) {\n\t\tthis.data = data;\n\t\tconst suffix = hash(key).toString(36);\n\t\tthis.itemColorClassName = `${DecorationRule._classNamesPrefix}-itemColor-${suffix}`;\n\t\tthis.itemBadgeClassName = `${DecorationRule._classNamesPrefix}-itemBadge-${suffix}`;\n\t\tthis.bubbleBadgeClassName = `${DecorationRule._classNamesPrefix}-bubbleBadge-${suffix}`;\n\t\tthis.iconBadgeClassName = `${DecorationRule._classNamesPrefix}-iconBadge-${suffix}`;\n\t}\n\n\tacquire(): void {\n\t\tthis._refCounter += 1;\n\t}\n\n\trelease(): boolean {\n\t\treturn --this._refCounter === 0;\n\t}\n\n\tappendCSSRules(element: HTMLStyleElement, theme: IColorTheme): void {\n\t\tif (!Array.isArray(this.data)) {\n\t\t\tthis._appendForOne(this.data, element, theme);\n\t\t} else {\n\t\t\tthis._appendForMany(this.data, element, theme);\n\t\t}\n\t}\n\n\tprivate _appendForOne(data: IDecorationData, element: HTMLStyleElement, theme: IColorTheme): void {\n\t\tconst { color, letter } = data;\n\t\t// label\n\t\tcreateCSSRule(`.${this.itemColorClassName}`, `color: ${getColor(theme, color)};`, element);\n\t\t// icon\n\t\tif (ThemeIcon.isThemeIcon(letter)) {\n\t\t\tthis._createIconCSSRule(letter, color, element, theme);\n\t\t}\n\t\t// letter\n\t\telse if (letter) {\n\t\t\tcreateCSSRule(`.${this.itemBadgeClassName}::after`, `content: \"${letter}\"; color: ${getColor(theme, color)};`, element);\n\t\t}\n\t}\n\n\tprivate _appendForMany(data: IDecorationData[], element: HTMLStyleElement, theme: IColorTheme): void {\n\t\t// label\n\t\tconst { color } = data[0];\n\t\tcreateCSSRule(`.${this.itemColorClassName}`, `color: ${getColor(theme, color)};`, element);\n\n\t\t// icon (only show first)\n\t\tconst icon = data.find(d => ThemeIcon.isThemeIcon(d.letter))?.letter as ThemeIcon | undefined;\n\t\tif (icon) {\n\t\t\tthis._createIconCSSRule(icon, color, element, theme);\n\t\t} else {\n\t\t\t// badge\n\t\t\tconst letters = data.filter(d => !isFalsyOrWhitespace(d.letter as string | undefined)).map(d => d.letter);\n\t\t\tif (letters.length) {\n\t\t\t\tcreateCSSRule(`.${this.itemBadgeClassName}::after`, `content: \"${letters.join(', ')}\"; color: ${getColor(theme, color)};`, element);\n\t\t\t}\n\n\t\t\t// bubble badge\n\t\t\t// TODO @misolori update bubble badge to adopt letter: ThemeIcon instead of unicode\n\t\t\tcreateCSSRule(\n\t\t\t\t`.${this.bubbleBadgeClassName}::after`,\n\t\t\t\t`content: \"\\uea71\"; color: ${getColor(theme, color)}; font-family: codicon; font-size: 14px; padding-right: 14px; opacity: 0.4;`,\n\t\t\t\telement\n\t\t\t);\n\t\t}\n\t}\n\n\tprivate _createIconCSSRule(icon: ThemeIcon, color: string | undefined, element: HTMLStyleElement, theme: IColorTheme) {\n\t\tconst codicon = iconRegistry.get(icon.id);\n\t\tif (!codicon || !('fontCharacter' in codicon.definition)) {\n\t\t\treturn;\n\t\t}\n\t\tconst charCode = parseInt(codicon.definition.fontCharacter.substr(1), 16);\n\t\tcreateCSSRule(\n\t\t\t`.${this.iconBadgeClassName}::after`,\n\t\t\t`content: \"${String.fromCharCode(charCode)}\"; color: ${getColor(theme, color)}; font-family: codicon; font-size: 16px; padding-right: 14px; font-weight: normal`,\n\t\t\telement\n\t\t);\n\t}\n\n\tremoveCSSRules(element: HTMLStyleElement): void {\n\t\tremoveCSSRulesContainingSelector(this.itemColorClassName, element);\n\t\tremoveCSSRulesContainingSelector(this.itemBadgeClassName, element);\n\t\tremoveCSSRulesContainingSelector(this.bubbleBadgeClassName, element);\n\t\tremoveCSSRulesContainingSelector(this.iconBadgeClassName, element);\n\t}\n}\n\nclass DecorationStyles {\n\n\tprivate readonly _styleElement = createStyleSheet();\n\tprivate readonly _decorationRules = new Map<string, DecorationRule>();\n\tprivate readonly _dispoables = new DisposableStore();\n\n\tconstructor(private readonly _themeService: IThemeService) {\n\t\tthis._themeService.onDidColorThemeChange(this._onThemeChange, this, this._dispoables);\n\t}\n\n\tdispose(): void {\n\t\tthis._dispoables.dispose();\n\t\tthis._styleElement.remove();\n\t}\n\n\tasDecoration(data: IDecorationData[], onlyChildren: boolean): IDecoration {\n\n\t\t// sort by weight\n\t\tdata.sort((a, b) => (b.weight || 0) - (a.weight || 0));\n\n\t\tlet key = DecorationRule.keyOf(data);\n\t\tlet rule = this._decorationRules.get(key);\n\n\t\tif (!rule) {\n\t\t\t// new css rule\n\t\t\trule = new DecorationRule(data, key);\n\t\t\tthis._decorationRules.set(key, rule);\n\t\t\trule.appendCSSRules(this._styleElement, this._themeService.getColorTheme());\n\t\t}\n\n\t\trule.acquire();\n\n\t\tlet labelClassName = rule.itemColorClassName;\n\t\tlet badgeClassName = rule.itemBadgeClassName;\n\t\tlet iconClassName = rule.iconBadgeClassName;\n\t\tlet tooltip = data.filter(d => !isFalsyOrWhitespace(d.tooltip)).map(d => d.tooltip).join(' â€¢ ');\n\n\t\tif (onlyChildren) {\n\t\t\t// show items from its children only\n\t\t\tbadgeClassName = rule.bubbleBadgeClassName;\n\t\t\ttooltip = localize('bubbleTitle', \"Contains emphasized items\");\n\t\t}\n\n\t\treturn {\n\t\t\tlabelClassName,\n\t\t\tbadgeClassName,\n\t\t\ticonClassName,\n\t\t\ttooltip,\n\t\t\tdispose: () => {\n\t\t\t\tif (rule?.release()) {\n\t\t\t\t\tthis._decorationRules.delete(key);\n\t\t\t\t\trule.removeCSSRules(this._styleElement);\n\t\t\t\t\trule = undefined;\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tprivate _onThemeChange(): void {\n\t\tthis._decorationRules.forEach(rule => {\n\t\t\trule.removeCSSRules(this._styleElement);\n\t\t\trule.appendCSSRules(this._styleElement, this._themeService.getColorTheme());\n\t\t});\n\t}\n}\n\nclass FileDecorationChangeEvent implements IResourceDecorationChangeEvent {\n\n\tprivate readonly _data = TernarySearchTree.forUris<true>(_uri => true); // events ignore all path casings\n\n\taffectsResource(uri: URI): boolean {\n\t\treturn this._data.get(uri) ?? this._data.findSuperstr(uri) !== undefined;\n\t}\n\n\tstatic debouncer(last: FileDecorationChangeEvent | undefined, current: URI | URI[]): FileDecorationChangeEvent {\n\t\tif (!last) {\n\t\t\tlast = new FileDecorationChangeEvent();\n\t\t}\n\t\tif (Array.isArray(current)) {\n\t\t\t// many\n\t\t\tfor (const uri of current) {\n\t\t\t\tlast._data.set(uri, true);\n\t\t\t}\n\t\t} else {\n\t\t\t// one\n\t\t\tlast._data.set(current, true);\n\t\t}\n\n\t\treturn last;\n\t}\n}\n\nclass DecorationDataRequest {\n\tconstructor(\n\t\treadonly source: CancellationTokenSource,\n\t\treadonly thenable: Promise<void>,\n\t) { }\n}\n\nclass DecorationProviderWrapper {\n\n\treadonly data: TernarySearchTree<URI, DecorationDataRequest | IDecorationData | null>;\n\tprivate readonly _dispoable: IDisposable;\n\n\tconstructor(\n\t\treadonly provider: IDecorationsProvider,\n\t\turiIdentityService: IUriIdentityService,\n\t\tprivate readonly _uriEmitter: Emitter<URI | URI[]>,\n\t\tprivate readonly _flushEmitter: Emitter<IResourceDecorationChangeEvent>\n\t) {\n\n\t\tthis.data = TernarySearchTree.forUris(uri => uriIdentityService.extUri.ignorePathCasing(uri));\n\n\t\tthis._dispoable = this.provider.onDidChange(uris => {\n\t\t\tif (!uris) {\n\t\t\t\t// flush event -> drop all data, can affect everything\n\t\t\t\tthis.data.clear();\n\t\t\t\tthis._flushEmitter.fire({ affectsResource() { return true; } });\n\n\t\t\t} else {\n\t\t\t\t// selective changes -> drop for resource, fetch again, send event\n\t\t\t\t// perf: the map stores thenables, decorations, or `null`-markers.\n\t\t\t\t// we make us of that and ignore all uris in which we have never\n\t\t\t\t// been interested.\n\t\t\t\tfor (const uri of uris) {\n\t\t\t\t\tthis._fetchData(uri);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tdispose(): void {\n\t\tthis._dispoable.dispose();\n\t\tthis.data.clear();\n\t}\n\n\tknowsAbout(uri: URI): boolean {\n\t\treturn this.data.has(uri) || Boolean(this.data.findSuperstr(uri));\n\t}\n\n\tgetOrRetrieve(uri: URI, includeChildren: boolean, callback: (data: IDecorationData, isChild: boolean) => void): void {\n\n\t\tlet item = this.data.get(uri);\n\n\t\tif (item === undefined) {\n\t\t\t// unknown -> trigger request\n\t\t\titem = this._fetchData(uri);\n\t\t}\n\n\t\tif (item && !(item instanceof DecorationDataRequest)) {\n\t\t\t// found something (which isn't pending anymore)\n\t\t\tcallback(item, false);\n\t\t}\n\n\t\tif (includeChildren) {\n\t\t\t// (resolved) children\n\t\t\tconst iter = this.data.findSuperstr(uri);\n\t\t\tif (iter) {\n\t\t\t\tfor (const [, value] of iter) {\n\t\t\t\t\tif (value && !(value instanceof DecorationDataRequest)) {\n\t\t\t\t\t\tcallback(value, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _fetchData(uri: URI): IDecorationData | null {\n\n\t\t// check for pending request and cancel it\n\t\tconst pendingRequest = this.data.get(uri);\n\t\tif (pendingRequest instanceof DecorationDataRequest) {\n\t\t\tpendingRequest.source.cancel();\n\t\t\tthis.data.delete(uri);\n\t\t}\n\n\t\tconst source = new CancellationTokenSource();\n\t\tconst dataOrThenable = this.provider.provideDecorations(uri, source.token);\n\t\tif (!isThenable<IDecorationData | Promise<IDecorationData | undefined> | undefined>(dataOrThenable)) {\n\t\t\t// sync -> we have a result now\n\t\t\treturn this._keepItem(uri, dataOrThenable);\n\n\t\t} else {\n\t\t\t// async -> we have a result soon\n\t\t\tconst request = new DecorationDataRequest(source, Promise.resolve(dataOrThenable).then(data => {\n\t\t\t\tif (this.data.get(uri) === request) {\n\t\t\t\t\tthis._keepItem(uri, data);\n\t\t\t\t}\n\t\t\t}).catch(err => {\n\t\t\t\tif (!isPromiseCanceledError(err) && this.data.get(uri) === request) {\n\t\t\t\t\tthis.data.delete(uri);\n\t\t\t\t}\n\t\t\t}));\n\n\t\t\tthis.data.set(uri, request);\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tprivate _keepItem(uri: URI, data: IDecorationData | undefined): IDecorationData | null {\n\t\tconst deco = data ? data : null;\n\t\tconst old = this.data.set(uri, deco);\n\t\tif (deco || old) {\n\t\t\t// only fire event when something changed\n\t\t\tthis._uriEmitter.fire(uri);\n\t\t}\n\t\treturn deco;\n\t}\n}\n\nexport class DecorationsService implements IDecorationsService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _data = new LinkedList<DecorationProviderWrapper>();\n\tprivate readonly _onDidChangeDecorationsDelayed = new Emitter<URI | URI[]>();\n\tprivate readonly _onDidChangeDecorations = new Emitter<IResourceDecorationChangeEvent>();\n\tprivate readonly _decorationStyles: DecorationStyles;\n\n\treadonly onDidChangeDecorations: Event<IResourceDecorationChangeEvent> = Event.any(\n\t\tthis._onDidChangeDecorations.event,\n\t\tEvent.debounce<URI | URI[], FileDecorationChangeEvent>(\n\t\t\tthis._onDidChangeDecorationsDelayed.event,\n\t\t\tFileDecorationChangeEvent.debouncer,\n\t\t\tundefined, undefined, 500\n\t\t)\n\t);\n\n\tconstructor(\n\t\t@IThemeService themeService: IThemeService,\n\t\t@IUriIdentityService private readonly _uriIdentityService: IUriIdentityService,\n\t) {\n\t\tthis._decorationStyles = new DecorationStyles(themeService);\n\t}\n\n\tdispose(): void {\n\t\tthis._decorationStyles.dispose();\n\t\tthis._onDidChangeDecorations.dispose();\n\t\tthis._onDidChangeDecorationsDelayed.dispose();\n\t}\n\n\tregisterDecorationsProvider(provider: IDecorationsProvider): IDisposable {\n\n\t\tconst wrapper = new DecorationProviderWrapper(\n\t\t\tprovider,\n\t\t\tthis._uriIdentityService,\n\t\t\tthis._onDidChangeDecorationsDelayed,\n\t\t\tthis._onDidChangeDecorations\n\t\t);\n\t\tconst remove = this._data.push(wrapper);\n\n\t\tthis._onDidChangeDecorations.fire({\n\t\t\t// everything might have changed\n\t\t\taffectsResource() { return true; }\n\t\t});\n\n\t\treturn toDisposable(() => {\n\t\t\t// fire event that says 'yes' for any resource\n\t\t\t// known to this provider. then dispose and remove it.\n\t\t\tremove();\n\t\t\tthis._onDidChangeDecorations.fire({ affectsResource: uri => wrapper.knowsAbout(uri) });\n\t\t\twrapper.dispose();\n\t\t});\n\t}\n\n\tgetDecoration(uri: URI, includeChildren: boolean): IDecoration | undefined {\n\t\tlet data: IDecorationData[] = [];\n\t\tlet containsChildren: boolean = false;\n\t\tfor (let wrapper of this._data) {\n\t\t\twrapper.getOrRetrieve(uri, includeChildren, (deco, isChild) => {\n\t\t\t\tif (!isChild || deco.bubble) {\n\t\t\t\t\tdata.push(deco);\n\t\t\t\t\tcontainsChildren = isChild || containsChildren;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn data.length === 0\n\t\t\t? undefined\n\t\t\t: this._decorationStyles.asDecoration(data, containsChildren);\n\t}\n}\nfunction getColor(theme: IColorTheme, color: string | undefined) {\n\tif (color) {\n\t\tconst foundColor = theme.getColor(color);\n\t\tif (foundColor) {\n\t\t\treturn foundColor;\n\t\t}\n\t}\n\treturn 'inherit';\n}\n\nregisterSingleton(IDecorationsService, DecorationsService, true);\n"]}