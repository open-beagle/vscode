{"version":3,"file":"nativeHostService.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/workbench/services/host/electron-sandbox/nativeHostService.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { Event } from 'vs/base/common/event';\nimport { IHostService } from 'vs/workbench/services/host/browser/host';\nimport { INativeHostService } from 'vs/platform/native/electron-sandbox/native';\nimport { registerSingleton } from 'vs/platform/instantiation/common/extensions';\nimport { ILabelService } from 'vs/platform/label/common/label';\nimport { IWorkbenchEnvironmentService } from 'vs/workbench/services/environment/common/environmentService';\nimport { IWindowOpenable, IOpenWindowOptions, isFolderToOpen, isWorkspaceToOpen, IOpenEmptyWindowOptions } from 'vs/platform/windows/common/windows';\nimport { Disposable } from 'vs/base/common/lifecycle';\n\nexport class NativeHostService extends Disposable implements IHostService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tconstructor(\n\t\t@INativeHostService private readonly nativeHostService: INativeHostService,\n\t\t@ILabelService private readonly labelService: ILabelService,\n\t\t@IWorkbenchEnvironmentService private readonly environmentService: IWorkbenchEnvironmentService\n\t) {\n\t\tsuper();\n\t}\n\n\t//#region Focus\n\n\tget onDidChangeFocus(): Event<boolean> { return this._onDidChangeFocus; }\n\tprivate _onDidChangeFocus: Event<boolean> = Event.latch(Event.any(\n\t\tEvent.map(Event.filter(this.nativeHostService.onDidFocusWindow, id => id === this.nativeHostService.windowId), () => this.hasFocus),\n\t\tEvent.map(Event.filter(this.nativeHostService.onDidBlurWindow, id => id === this.nativeHostService.windowId), () => this.hasFocus)\n\t));\n\n\tget hasFocus(): boolean {\n\t\treturn document.hasFocus();\n\t}\n\n\tasync hadLastFocus(): Promise<boolean> {\n\t\tconst activeWindowId = await this.nativeHostService.getActiveWindowId();\n\n\t\tif (typeof activeWindowId === 'undefined') {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn activeWindowId === this.nativeHostService.windowId;\n\t}\n\n\t//#endregion\n\n\n\t//#region Window\n\n\topenWindow(options?: IOpenEmptyWindowOptions): Promise<void>;\n\topenWindow(toOpen: IWindowOpenable[], options?: IOpenWindowOptions): Promise<void>;\n\topenWindow(arg1?: IOpenEmptyWindowOptions | IWindowOpenable[], arg2?: IOpenWindowOptions): Promise<void> {\n\t\tif (Array.isArray(arg1)) {\n\t\t\treturn this.doOpenWindow(arg1, arg2);\n\t\t}\n\n\t\treturn this.doOpenEmptyWindow(arg1);\n\t}\n\n\tprivate doOpenWindow(toOpen: IWindowOpenable[], options?: IOpenWindowOptions): Promise<void> {\n\t\tconst remoteAuthority = this.environmentService.remoteAuthority;\n\t\tif (!!remoteAuthority) {\n\t\t\ttoOpen.forEach(openable => openable.label = openable.label || this.getRecentLabel(openable));\n\n\t\t\tif (options?.remoteAuthority === undefined) {\n\t\t\t\t// set the remoteAuthority of the window the request came from.\n\t\t\t\t// It will be used when the input is neither file nor vscode-remote.\n\t\t\t\toptions = options ? { ...options, remoteAuthority } : { remoteAuthority };\n\t\t\t}\n\t\t}\n\n\t\treturn this.nativeHostService.openWindow(toOpen, options);\n\t}\n\n\tprivate getRecentLabel(openable: IWindowOpenable): string {\n\t\tif (isFolderToOpen(openable)) {\n\t\t\treturn this.labelService.getWorkspaceLabel(openable.folderUri, { verbose: true });\n\t\t}\n\n\t\tif (isWorkspaceToOpen(openable)) {\n\t\t\treturn this.labelService.getWorkspaceLabel({ id: '', configPath: openable.workspaceUri }, { verbose: true });\n\t\t}\n\n\t\treturn this.labelService.getUriLabel(openable.fileUri);\n\t}\n\n\tprivate doOpenEmptyWindow(options?: IOpenEmptyWindowOptions): Promise<void> {\n\t\treturn this.nativeHostService.openWindow(options);\n\t}\n\n\ttoggleFullScreen(): Promise<void> {\n\t\treturn this.nativeHostService.toggleFullScreen();\n\t}\n\n\t//#endregion\n\n\n\t//#region Lifecycle\n\n\tfocus(options?: { force: boolean }): Promise<void> {\n\t\treturn this.nativeHostService.focusWindow(options);\n\t}\n\n\trestart(): Promise<void> {\n\t\treturn this.nativeHostService.relaunch();\n\t}\n\n\treload(options?: { disableExtensions?: boolean }): Promise<void> {\n\t\treturn this.nativeHostService.reload(options);\n\t}\n\n\tclose(): Promise<void> {\n\t\treturn this.nativeHostService.closeWindow();\n\t}\n\n\t//#endregion\n}\n\nregisterSingleton(IHostService, NativeHostService, true);\n"]}