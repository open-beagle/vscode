{"version":3,"sources":["vs/workbench/services/dialogs/browser/fileDialogService.ts"],"names":[],"mappings":"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","file":"fileDialogService.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IPickAndOpenOptions, ISaveDialogOptions, IOpenDialogOptions, IFileDialogService } from 'vs/platform/dialogs/common/dialogs';\nimport { URI } from 'vs/base/common/uri';\nimport { registerSingleton } from 'vs/platform/instantiation/common/extensions';\nimport { AbstractFileDialogService } from 'vs/workbench/services/dialogs/browser/abstractFileDialogService';\nimport { Schemas } from 'vs/base/common/network';\nimport { memoize } from 'vs/base/common/decorators';\nimport { HTMLFileSystemProvider } from 'vs/platform/files/browser/htmlFileSystemProvider';\nimport { generateUuid } from 'vs/base/common/uuid';\nimport { localize } from 'vs/nls';\n\nexport class FileDialogService extends AbstractFileDialogService implements IFileDialogService {\n\n\t@memoize\n\tprivate get fileSystemProvider(): HTMLFileSystemProvider {\n\t\treturn this.fileService.getProvider(Schemas.file) as HTMLFileSystemProvider;\n\t}\n\n\tasync pickFileFolderAndOpen(options: IPickAndOpenOptions): Promise<any> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (!options.defaultUri) {\n\t\t\toptions.defaultUri = await this.defaultFilePath(schema);\n\t\t}\n\n\t\tif (this.shouldUseSimplified(schema)) {\n\t\t\treturn this.pickFileFolderAndOpenSimplified(schema, options, false);\n\t\t}\n\n\t\tthrow new Error(localize('pickFolderAndOpen', \"Can't open folders, try adding a folder to the workspace instead.\"));\n\t}\n\n\tasync pickFileAndOpen(options: IPickAndOpenOptions): Promise<any> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (!options.defaultUri) {\n\t\t\toptions.defaultUri = await this.defaultFilePath(schema);\n\t\t}\n\n\t\tif (this.shouldUseSimplified(schema)) {\n\t\t\treturn this.pickFileAndOpenSimplified(schema, options, false);\n\t\t}\n\n\t\tconst [handle] = await window.showOpenFilePicker({ multiple: false });\n\t\tconst uuid = generateUuid();\n\t\tconst uri = URI.from({ scheme: Schemas.file, path: `/${uuid}/${handle.name}` });\n\n\t\tthis.fileSystemProvider.registerFileHandle(uuid, handle);\n\n\t\tawait this.openerService.open(uri, { fromUserGesture: true, editorOptions: { pinned: true } });\n\t}\n\n\tasync pickFolderAndOpen(options: IPickAndOpenOptions): Promise<any> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (!options.defaultUri) {\n\t\t\toptions.defaultUri = await this.defaultFolderPath(schema);\n\t\t}\n\n\t\tif (this.shouldUseSimplified(schema)) {\n\t\t\treturn this.pickFolderAndOpenSimplified(schema, options);\n\t\t}\n\n\t\tthrow new Error(localize('pickFolderAndOpen', \"Can't open folders, try adding a folder to the workspace instead.\"));\n\t}\n\n\tasync pickWorkspaceAndOpen(options: IPickAndOpenOptions): Promise<void> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (!options.defaultUri) {\n\t\t\toptions.defaultUri = await this.defaultWorkspacePath(schema);\n\t\t}\n\n\t\tif (this.shouldUseSimplified(schema)) {\n\t\t\treturn this.pickWorkspaceAndOpenSimplified(schema, options);\n\t\t}\n\n\t\tthrow new Error(localize('pickWorkspaceAndOpen', \"Can't open workspaces, try adding a folder to the workspace instead.\"));\n\t}\n\n\tasync pickFileToSave(defaultUri: URI, availableFileSystems?: string[]): Promise<URI | undefined> {\n\t\tconst schema = this.getFileSystemSchema({ defaultUri, availableFileSystems });\n\n\t\tif (this.shouldUseSimplified(schema)) {\n\t\t\treturn this.pickFileToSaveSimplified(schema, this.getPickFileToSaveDialogOptions(defaultUri, availableFileSystems));\n\t\t}\n\n\t\tconst handle = await window.showSaveFilePicker();\n\t\tconst uuid = generateUuid();\n\t\tconst uri = URI.from({ scheme: Schemas.file, path: `/${uuid}/${handle.name}` });\n\n\t\tthis.fileSystemProvider.registerFileHandle(uuid, handle);\n\n\t\treturn uri;\n\t}\n\n\tasync showSaveDialog(options: ISaveDialogOptions): Promise<URI | undefined> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (this.shouldUseSimplified(schema)) {\n\t\t\treturn this.showSaveDialogSimplified(schema, options);\n\t\t}\n\n\t\tconst handle = await window.showSaveFilePicker();\n\t\tconst uuid = generateUuid();\n\t\tconst uri = URI.from({ scheme: Schemas.file, path: `/${uuid}/${handle.name}` });\n\n\t\tthis.fileSystemProvider.registerFileHandle(uuid, handle);\n\n\t\treturn uri;\n\t}\n\n\tasync showOpenDialog(options: IOpenDialogOptions): Promise<URI[] | undefined> {\n\t\tconst schema = this.getFileSystemSchema(options);\n\n\t\tif (this.shouldUseSimplified(schema)) {\n\t\t\treturn this.showOpenDialogSimplified(schema, options);\n\t\t}\n\n\t\tconst handle = await window.showDirectoryPicker();\n\t\tconst uuid = generateUuid();\n\t\tconst uri = URI.from({ scheme: Schemas.file, path: `/${uuid}/${handle.name}` });\n\n\t\tthis.fileSystemProvider.registerDirectoryHandle(uuid, handle);\n\n\t\treturn [uri];\n\t}\n\n\tprotected addFileSchemaIfNeeded(schema: string): string[] {\n\t\treturn schema === Schemas.untitled ? [Schemas.file] : [schema];\n\t}\n\n\tprivate shouldUseSimplified(scheme: string): boolean {\n\t\treturn ![Schemas.file, Schemas.userData, Schemas.tmp].includes(scheme);\n\t}\n}\n\nregisterSingleton(IFileDialogService, FileDialogService, true);\n"]}