{"version":3,"file":"menuService.test.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/platform/actions/test/common/menuService.test.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { MenuRegistry, MenuId, isIMenuItem } from 'vs/platform/actions/common/actions';\nimport { MenuService } from 'vs/platform/actions/common/menuService';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { NullCommandService } from 'vs/platform/commands/common/commands';\nimport { MockContextKeyService } from 'vs/platform/keybinding/test/common/mockKeybindingService';\n\n// --- service instances\n\nconst contextKeyService = new class extends MockContextKeyService {\n\toverride contextMatchesRules() {\n\t\treturn true;\n\t}\n};\n\n// --- tests\n\nsuite('MenuService', function () {\n\n\tlet menuService: MenuService;\n\tconst disposables = new DisposableStore();\n\tlet testMenuId: MenuId;\n\n\tsetup(function () {\n\t\tmenuService = new MenuService(NullCommandService);\n\t\ttestMenuId = new MenuId('testo');\n\t\tdisposables.clear();\n\t});\n\n\tteardown(function () {\n\t\tdisposables.clear();\n\t});\n\n\ttest('group sorting', function () {\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(testMenuId, {\n\t\t\tcommand: { id: 'one', title: 'FOO' },\n\t\t\tgroup: '0_hello'\n\t\t}));\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(testMenuId, {\n\t\t\tcommand: { id: 'two', title: 'FOO' },\n\t\t\tgroup: 'hello'\n\t\t}));\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(testMenuId, {\n\t\t\tcommand: { id: 'three', title: 'FOO' },\n\t\t\tgroup: 'Hello'\n\t\t}));\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(testMenuId, {\n\t\t\tcommand: { id: 'four', title: 'FOO' },\n\t\t\tgroup: ''\n\t\t}));\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(testMenuId, {\n\t\t\tcommand: { id: 'five', title: 'FOO' },\n\t\t\tgroup: 'navigation'\n\t\t}));\n\n\t\tconst groups = menuService.createMenu(testMenuId, contextKeyService).getActions();\n\n\t\tassert.strictEqual(groups.length, 5);\n\t\tconst [one, two, three, four, five] = groups;\n\n\t\tassert.strictEqual(one[0], 'navigation');\n\t\tassert.strictEqual(two[0], '0_hello');\n\t\tassert.strictEqual(three[0], 'hello');\n\t\tassert.strictEqual(four[0], 'Hello');\n\t\tassert.strictEqual(five[0], '');\n\t});\n\n\ttest('in group sorting, by title', function () {\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(testMenuId, {\n\t\t\tcommand: { id: 'a', title: 'aaa' },\n\t\t\tgroup: 'Hello'\n\t\t}));\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(testMenuId, {\n\t\t\tcommand: { id: 'b', title: 'fff' },\n\t\t\tgroup: 'Hello'\n\t\t}));\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(testMenuId, {\n\t\t\tcommand: { id: 'c', title: 'zzz' },\n\t\t\tgroup: 'Hello'\n\t\t}));\n\n\t\tconst groups = menuService.createMenu(testMenuId, contextKeyService).getActions();\n\n\t\tassert.strictEqual(groups.length, 1);\n\t\tconst [, actions] = groups[0];\n\n\t\tassert.strictEqual(actions.length, 3);\n\t\tconst [one, two, three] = actions;\n\t\tassert.strictEqual(one.id, 'a');\n\t\tassert.strictEqual(two.id, 'b');\n\t\tassert.strictEqual(three.id, 'c');\n\t});\n\n\ttest('in group sorting, by title and order', function () {\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(testMenuId, {\n\t\t\tcommand: { id: 'a', title: 'aaa' },\n\t\t\tgroup: 'Hello',\n\t\t\torder: 10\n\t\t}));\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(testMenuId, {\n\t\t\tcommand: { id: 'b', title: 'fff' },\n\t\t\tgroup: 'Hello'\n\t\t}));\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(testMenuId, {\n\t\t\tcommand: { id: 'c', title: 'zzz' },\n\t\t\tgroup: 'Hello',\n\t\t\torder: -1\n\t\t}));\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(testMenuId, {\n\t\t\tcommand: { id: 'd', title: 'yyy' },\n\t\t\tgroup: 'Hello',\n\t\t\torder: -1\n\t\t}));\n\n\t\tconst groups = menuService.createMenu(testMenuId, contextKeyService).getActions();\n\n\t\tassert.strictEqual(groups.length, 1);\n\t\tconst [, actions] = groups[0];\n\n\t\tassert.strictEqual(actions.length, 4);\n\t\tconst [one, two, three, four] = actions;\n\t\tassert.strictEqual(one.id, 'd');\n\t\tassert.strictEqual(two.id, 'c');\n\t\tassert.strictEqual(three.id, 'b');\n\t\tassert.strictEqual(four.id, 'a');\n\t});\n\n\n\ttest('in group sorting, special: navigation', function () {\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(testMenuId, {\n\t\t\tcommand: { id: 'a', title: 'aaa' },\n\t\t\tgroup: 'navigation',\n\t\t\torder: 1.3\n\t\t}));\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(testMenuId, {\n\t\t\tcommand: { id: 'b', title: 'fff' },\n\t\t\tgroup: 'navigation',\n\t\t\torder: 1.2\n\t\t}));\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(testMenuId, {\n\t\t\tcommand: { id: 'c', title: 'zzz' },\n\t\t\tgroup: 'navigation',\n\t\t\torder: 1.1\n\t\t}));\n\n\t\tconst groups = menuService.createMenu(testMenuId, contextKeyService).getActions();\n\n\t\tassert.strictEqual(groups.length, 1);\n\t\tconst [[, actions]] = groups;\n\n\t\tassert.strictEqual(actions.length, 3);\n\t\tconst [one, two, three] = actions;\n\t\tassert.strictEqual(one.id, 'c');\n\t\tassert.strictEqual(two.id, 'b');\n\t\tassert.strictEqual(three.id, 'a');\n\t});\n\n\ttest('special MenuId palette', function () {\n\n\t\tdisposables.add(MenuRegistry.appendMenuItem(MenuId.CommandPalette, {\n\t\t\tcommand: { id: 'a', title: 'Explicit' }\n\t\t}));\n\n\t\tMenuRegistry.addCommand({ id: 'b', title: 'Implicit' });\n\n\t\tlet foundA = false;\n\t\tlet foundB = false;\n\t\tfor (const item of MenuRegistry.getMenuItems(MenuId.CommandPalette)) {\n\t\t\tif (isIMenuItem(item)) {\n\t\t\t\tif (item.command.id === 'a') {\n\t\t\t\t\tassert.strictEqual(item.command.title, 'Explicit');\n\t\t\t\t\tfoundA = true;\n\t\t\t\t}\n\t\t\t\tif (item.command.id === 'b') {\n\t\t\t\t\tassert.strictEqual(item.command.title, 'Implicit');\n\t\t\t\t\tfoundB = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tassert.strictEqual(foundA, true);\n\t\tassert.strictEqual(foundB, true);\n\t});\n});\n"]}