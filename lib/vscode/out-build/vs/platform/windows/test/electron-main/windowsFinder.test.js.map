{"version":3,"file":"windowsFinder.test.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/platform/windows/test/electron-main/windowsFinder.test.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { join } from 'vs/base/common/path';\nimport { findWindowOnFile } from 'vs/platform/windows/electron-main/windowsFinder';\nimport { ICodeWindow, ILoadEvent, IWindowState } from 'vs/platform/windows/electron-main/windows';\nimport { IWorkspaceIdentifier, toWorkspaceFolders } from 'vs/platform/workspaces/common/workspaces';\nimport { URI } from 'vs/base/common/uri';\nimport { getPathFromAmdModule } from 'vs/base/test/node/testUtils';\nimport { extUriBiasedIgnorePathCase } from 'vs/base/common/resources';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { Event } from 'vs/base/common/event';\nimport { UriDto } from 'vs/base/common/types';\nimport { ICommandAction } from 'vs/platform/actions/common/actions';\nimport { NativeParsedArgs } from 'vs/platform/environment/common/argv';\nimport { INativeWindowConfiguration } from 'vs/platform/windows/common/windows';\n\nsuite('WindowsFinder', () => {\n\n\tconst fixturesFolder = getPathFromAmdModule(require, './fixtures');\n\n\tconst testWorkspace: IWorkspaceIdentifier = {\n\t\tid: Date.now().toString(),\n\t\tconfigPath: URI.file(join(fixturesFolder, 'workspaces.json'))\n\t};\n\n\tconst testWorkspaceFolders = toWorkspaceFolders([{ path: join(fixturesFolder, 'vscode_workspace_1_folder') }, { path: join(fixturesFolder, 'vscode_workspace_2_folder') }], testWorkspace.configPath, extUriBiasedIgnorePathCase);\n\tconst localWorkspaceResolver = (workspace: any) => { return workspace === testWorkspace ? { id: testWorkspace.id, configPath: workspace.configPath, folders: testWorkspaceFolders } : null; };\n\n\tfunction createTestCodeWindow(options: { lastFocusTime: number, openedFolderUri?: URI, openedWorkspace?: IWorkspaceIdentifier }): ICodeWindow {\n\t\treturn new class implements ICodeWindow {\n\t\t\tonWillLoad: Event<ILoadEvent> = Event.None;\n\t\t\tonDidSignalReady: Event<void> = Event.None;\n\t\t\tonDidClose: Event<void> = Event.None;\n\t\t\tonDidDestroy: Event<void> = Event.None;\n\t\t\twhenClosedOrLoaded: Promise<void> = Promise.resolve();\n\t\t\tid: number = -1;\n\t\t\twin: Electron.BrowserWindow = null!;\n\t\t\tconfig: INativeWindowConfiguration | undefined;\n\t\t\topenedWorkspace = options.openedFolderUri ? { id: '', uri: options.openedFolderUri } : options.openedWorkspace;\n\t\t\tbackupPath?: string | undefined;\n\t\t\tremoteAuthority?: string | undefined;\n\t\t\tisExtensionDevelopmentHost = false;\n\t\t\tisExtensionTestHost = false;\n\t\t\tlastFocusTime = options.lastFocusTime;\n\t\t\tisFullScreen = false;\n\t\t\tisReady = true;\n\t\t\thasHiddenTitleBarStyle = false;\n\n\t\t\tready(): Promise<ICodeWindow> { throw new Error('Method not implemented.'); }\n\t\t\tsetReady(): void { throw new Error('Method not implemented.'); }\n\t\t\taddTabbedWindow(window: ICodeWindow): void { throw new Error('Method not implemented.'); }\n\t\t\tload(config: INativeWindowConfiguration, options: { isReload?: boolean }): void { throw new Error('Method not implemented.'); }\n\t\t\treload(cli?: NativeParsedArgs): void { throw new Error('Method not implemented.'); }\n\t\t\tfocus(options?: { force: boolean; }): void { throw new Error('Method not implemented.'); }\n\t\t\tclose(): void { throw new Error('Method not implemented.'); }\n\t\t\tgetBounds(): Electron.Rectangle { throw new Error('Method not implemented.'); }\n\t\t\tsend(channel: string, ...args: any[]): void { throw new Error('Method not implemented.'); }\n\t\t\tsendWhenReady(channel: string, token: CancellationToken, ...args: any[]): void { throw new Error('Method not implemented.'); }\n\t\t\ttoggleFullScreen(): void { throw new Error('Method not implemented.'); }\n\t\t\tisMinimized(): boolean { throw new Error('Method not implemented.'); }\n\t\t\tsetRepresentedFilename(name: string): void { throw new Error('Method not implemented.'); }\n\t\t\tgetRepresentedFilename(): string | undefined { throw new Error('Method not implemented.'); }\n\t\t\tsetDocumentEdited(edited: boolean): void { throw new Error('Method not implemented.'); }\n\t\t\tisDocumentEdited(): boolean { throw new Error('Method not implemented.'); }\n\t\t\thandleTitleDoubleClick(): void { throw new Error('Method not implemented.'); }\n\t\t\tupdateTouchBar(items: UriDto<ICommandAction>[][]): void { throw new Error('Method not implemented.'); }\n\t\t\tserializeWindowState(): IWindowState { throw new Error('Method not implemented'); }\n\t\t\tdispose(): void { }\n\t\t};\n\t}\n\n\tconst vscodeFolderWindow: ICodeWindow = createTestCodeWindow({ lastFocusTime: 1, openedFolderUri: URI.file(join(fixturesFolder, 'vscode_folder')) });\n\tconst lastActiveWindow: ICodeWindow = createTestCodeWindow({ lastFocusTime: 3, openedFolderUri: undefined });\n\tconst noVscodeFolderWindow: ICodeWindow = createTestCodeWindow({ lastFocusTime: 2, openedFolderUri: URI.file(join(fixturesFolder, 'no_vscode_folder')) });\n\tconst windows: ICodeWindow[] = [\n\t\tvscodeFolderWindow,\n\t\tlastActiveWindow,\n\t\tnoVscodeFolderWindow,\n\t];\n\n\ttest('New window without folder when no windows exist', () => {\n\t\tassert.strictEqual(findWindowOnFile([], URI.file('nonexisting'), localWorkspaceResolver), undefined);\n\t\tassert.strictEqual(findWindowOnFile([], URI.file(join(fixturesFolder, 'no_vscode_folder', 'file.txt')), localWorkspaceResolver), undefined);\n\t});\n\n\ttest('Existing window with folder', () => {\n\t\tassert.strictEqual(findWindowOnFile(windows, URI.file(join(fixturesFolder, 'no_vscode_folder', 'file.txt')), localWorkspaceResolver), noVscodeFolderWindow);\n\n\t\tassert.strictEqual(findWindowOnFile(windows, URI.file(join(fixturesFolder, 'vscode_folder', 'file.txt')), localWorkspaceResolver), vscodeFolderWindow);\n\n\t\tconst window: ICodeWindow = createTestCodeWindow({ lastFocusTime: 1, openedFolderUri: URI.file(join(fixturesFolder, 'vscode_folder', 'nested_folder')) });\n\t\tassert.strictEqual(findWindowOnFile([window], URI.file(join(fixturesFolder, 'vscode_folder', 'nested_folder', 'subfolder', 'file.txt')), localWorkspaceResolver), window);\n\t});\n\n\ttest('More specific existing window wins', () => {\n\t\tconst window: ICodeWindow = createTestCodeWindow({ lastFocusTime: 2, openedFolderUri: URI.file(join(fixturesFolder, 'no_vscode_folder')) });\n\t\tconst nestedFolderWindow: ICodeWindow = createTestCodeWindow({ lastFocusTime: 1, openedFolderUri: URI.file(join(fixturesFolder, 'no_vscode_folder', 'nested_folder')) });\n\t\tassert.strictEqual(findWindowOnFile([window, nestedFolderWindow], URI.file(join(fixturesFolder, 'no_vscode_folder', 'nested_folder', 'subfolder', 'file.txt')), localWorkspaceResolver), nestedFolderWindow);\n\t});\n\n\ttest('Workspace folder wins', () => {\n\t\tconst window: ICodeWindow = createTestCodeWindow({ lastFocusTime: 1, openedWorkspace: testWorkspace });\n\t\tassert.strictEqual(findWindowOnFile([window], URI.file(join(fixturesFolder, 'vscode_workspace_2_folder', 'nested_vscode_folder', 'subfolder', 'file.txt')), localWorkspaceResolver), window);\n\t});\n});\n"]}