{"version":3,"file":"monarch.test.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/editor/standalone/test/monarch/monarch.test.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { ModeServiceImpl } from 'vs/editor/common/services/modeServiceImpl';\nimport { IModeService } from 'vs/editor/common/services/modeService';\nimport { MonarchTokenizer } from 'vs/editor/standalone/common/monarch/monarchLexer';\nimport { compile } from 'vs/editor/standalone/common/monarch/monarchCompile';\nimport { Token } from 'vs/editor/common/core/token';\nimport { TokenizationRegistry } from 'vs/editor/common/modes';\nimport { IMonarchLanguage } from 'vs/editor/standalone/common/monarch/monarchTypes';\nimport { ModesRegistry } from 'vs/editor/common/modes/modesRegistry';\n\nsuite('Monarch', () => {\n\n\tfunction createMonarchTokenizer(modeService: IModeService, languageId: string, language: IMonarchLanguage): MonarchTokenizer {\n\t\treturn new MonarchTokenizer(modeService, null!, languageId, compile(languageId, language));\n\t}\n\n\tfunction getTokens(tokenizer: MonarchTokenizer, lines: string[]): Token[][] {\n\t\tconst actualTokens: Token[][] = [];\n\t\tlet state = tokenizer.getInitialState();\n\t\tfor (const line of lines) {\n\t\t\tconst result = tokenizer.tokenize(line, true, state, 0);\n\t\t\tactualTokens.push(result.tokens);\n\t\t\tstate = result.endState;\n\t\t}\n\t\treturn actualTokens;\n\t}\n\n\ttest('Ensure @rematch and nextEmbedded can be used together in Monarch grammar', () => {\n\t\tconst modeService = new ModeServiceImpl();\n\t\tconst innerModeRegistration = ModesRegistry.registerLanguage({\n\t\t\tid: 'sql'\n\t\t});\n\t\tconst innerModeTokenizationRegistration = TokenizationRegistry.register('sql', createMonarchTokenizer(modeService, 'sql', {\n\t\t\ttokenizer: {\n\t\t\t\troot: [\n\t\t\t\t\t[/./, 'token']\n\t\t\t\t]\n\t\t\t}\n\t\t}));\n\t\tconst SQL_QUERY_START = '(SELECT|INSERT|UPDATE|DELETE|CREATE|REPLACE|ALTER|WITH)';\n\t\tconst tokenizer = createMonarchTokenizer(modeService, 'test1', {\n\t\t\ttokenizer: {\n\t\t\t\troot: [\n\t\t\t\t\t[`(\\\"\\\"\\\")${SQL_QUERY_START}`, [{ 'token': 'string.quote', }, { token: '@rematch', next: '@endStringWithSQL', nextEmbedded: 'sql', },]],\n\t\t\t\t\t[/(\"\"\")$/, [{ token: 'string.quote', next: '@maybeStringIsSQL', },]],\n\t\t\t\t],\n\t\t\t\tmaybeStringIsSQL: [\n\t\t\t\t\t[/(.*)/, {\n\t\t\t\t\t\tcases: {\n\t\t\t\t\t\t\t[`${SQL_QUERY_START}\\\\b.*`]: { token: '@rematch', next: '@endStringWithSQL', nextEmbedded: 'sql', },\n\t\t\t\t\t\t\t'@default': { token: '@rematch', switchTo: '@endDblDocString', },\n\t\t\t\t\t\t}\n\t\t\t\t\t}],\n\t\t\t\t],\n\t\t\t\tendDblDocString: [\n\t\t\t\t\t['[^\\']+', 'string'],\n\t\t\t\t\t['\\\\\\\\\\'', 'string'],\n\t\t\t\t\t['\\'\\'\\'', 'string', '@popall'],\n\t\t\t\t\t['\\'', 'string']\n\t\t\t\t],\n\t\t\t\tendStringWithSQL: [[/\"\"\"/, { token: 'string.quote', next: '@popall', nextEmbedded: '@pop', },]],\n\t\t\t}\n\t\t});\n\n\t\tconst lines = [\n\t\t\t`mysql_query(\"\"\"SELECT * FROM table_name WHERE ds = '<DATEID>'\"\"\")`,\n\t\t\t`mysql_query(\"\"\"`,\n\t\t\t`SELECT *`,\n\t\t\t`FROM table_name`,\n\t\t\t`WHERE ds = '<DATEID>'`,\n\t\t\t`\"\"\")`,\n\t\t];\n\n\t\tconst actualTokens = getTokens(tokenizer, lines);\n\n\t\tassert.deepStrictEqual(actualTokens, [\n\t\t\t[\n\t\t\t\tnew Token(0, 'source.test1', 'test1'),\n\t\t\t\tnew Token(12, 'string.quote.test1', 'test1'),\n\t\t\t\tnew Token(15, 'token.sql', 'sql'),\n\t\t\t\tnew Token(61, 'string.quote.test1', 'test1'),\n\t\t\t\tnew Token(64, 'source.test1', 'test1')\n\t\t\t],\n\t\t\t[\n\t\t\t\tnew Token(0, 'source.test1', 'test1'),\n\t\t\t\tnew Token(12, 'string.quote.test1', 'test1')\n\t\t\t],\n\t\t\t[\n\t\t\t\tnew Token(0, 'token.sql', 'sql')\n\t\t\t],\n\t\t\t[\n\t\t\t\tnew Token(0, 'token.sql', 'sql')\n\t\t\t],\n\t\t\t[\n\t\t\t\tnew Token(0, 'token.sql', 'sql')\n\t\t\t],\n\t\t\t[\n\t\t\t\tnew Token(0, 'string.quote.test1', 'test1'),\n\t\t\t\tnew Token(3, 'source.test1', 'test1')\n\t\t\t]\n\t\t]);\n\t\tinnerModeTokenizationRegistration.dispose();\n\t\tinnerModeRegistration.dispose();\n\t});\n\n\ttest('microsoft/monaco-editor#1235: Empty Line Handling', () => {\n\t\tconst modeService = new ModeServiceImpl();\n\t\tconst tokenizer = createMonarchTokenizer(modeService, 'test', {\n\t\t\ttokenizer: {\n\t\t\t\troot: [\n\t\t\t\t\t{ include: '@comments' },\n\t\t\t\t],\n\n\t\t\t\tcomments: [\n\t\t\t\t\t[/\\/\\/$/, 'comment'], // empty single-line comment\n\t\t\t\t\t[/\\/\\//, 'comment', '@comment_cpp'],\n\t\t\t\t],\n\n\t\t\t\tcomment_cpp: [\n\t\t\t\t\t[/(?:[^\\\\]|(?:\\\\.))+$/, 'comment', '@pop'],\n\t\t\t\t\t[/.+$/, 'comment'],\n\t\t\t\t\t[/$/, 'comment', '@pop']\n\t\t\t\t\t// No possible rule to detect an empty line and @pop?\n\t\t\t\t],\n\t\t\t},\n\t\t});\n\n\t\tconst lines = [\n\t\t\t`// This comment \\\\`,\n\t\t\t`   continues on the following line`,\n\t\t\t``,\n\t\t\t`// This comment does NOT continue \\\\\\\\`,\n\t\t\t`   because the escape char was itself escaped`,\n\t\t\t``,\n\t\t\t`// This comment DOES continue because \\\\\\\\\\\\`,\n\t\t\t`   the 1st '\\\\' escapes the 2nd; the 3rd escapes EOL`,\n\t\t\t``,\n\t\t\t`// This comment continues to the following line \\\\`,\n\t\t\t``,\n\t\t\t`But the line was empty. This line should not be commented.`,\n\t\t];\n\n\t\tconst actualTokens = getTokens(tokenizer, lines);\n\n\t\tassert.deepStrictEqual(actualTokens, [\n\t\t\t[new Token(0, 'comment.test', 'test')],\n\t\t\t[new Token(0, 'comment.test', 'test')],\n\t\t\t[],\n\t\t\t[new Token(0, 'comment.test', 'test')],\n\t\t\t[new Token(0, 'source.test', 'test')],\n\t\t\t[],\n\t\t\t[new Token(0, 'comment.test', 'test')],\n\t\t\t[new Token(0, 'comment.test', 'test')],\n\t\t\t[],\n\t\t\t[new Token(0, 'comment.test', 'test')],\n\t\t\t[],\n\t\t\t[new Token(0, 'source.test', 'test')]\n\t\t]);\n\n\t});\n\n\ttest('microsoft/monaco-editor#2265: Exit a state at end of line', () => {\n\t\tconst modeService = new ModeServiceImpl();\n\t\tconst tokenizer = createMonarchTokenizer(modeService, 'test', {\n\t\t\tincludeLF: true,\n\t\t\ttokenizer: {\n\t\t\t\troot: [\n\t\t\t\t\t[/^\\*/, '', '@inner'],\n\t\t\t\t\t[/\\:\\*/, '', '@inner'],\n\t\t\t\t\t[/[^*:]+/, 'string'],\n\t\t\t\t\t[/[*:]/, 'string']\n\t\t\t\t],\n\t\t\t\tinner: [\n\t\t\t\t\t[/\\n/, '', '@pop'],\n\t\t\t\t\t[/\\d+/, 'number'],\n\t\t\t\t\t[/[^\\d]+/, '']\n\t\t\t\t]\n\t\t\t}\n\t\t});\n\n\t\tconst lines = [\n\t\t\t`PRINT 10 * 20`,\n\t\t\t`*FX200, 3`,\n\t\t\t`PRINT 2*3:*FX200, 3`\n\t\t];\n\n\t\tconst actualTokens = getTokens(tokenizer, lines);\n\n\t\tassert.deepStrictEqual(actualTokens, [\n\t\t\t[\n\t\t\t\tnew Token(0, 'string.test', 'test'),\n\t\t\t],\n\t\t\t[\n\t\t\t\tnew Token(0, '', 'test'),\n\t\t\t\tnew Token(3, 'number.test', 'test'),\n\t\t\t\tnew Token(6, '', 'test'),\n\t\t\t\tnew Token(8, 'number.test', 'test'),\n\t\t\t],\n\t\t\t[\n\t\t\t\tnew Token(0, 'string.test', 'test'),\n\t\t\t\tnew Token(9, '', 'test'),\n\t\t\t\tnew Token(13, 'number.test', 'test'),\n\t\t\t\tnew Token(16, '', 'test'),\n\t\t\t\tnew Token(18, 'number.test', 'test'),\n\t\t\t]\n\t\t]);\n\t});\n\n\ttest('issue #115662: monarchCompile function need an extra option which can control replacement', () => {\n\t\tconst modeService = new ModeServiceImpl();\n\n\t\tconst tokenizer1 = createMonarchTokenizer(modeService, 'test', {\n\t\t\tignoreCase: false,\n\t\t\tuselessReplaceKey1: '@uselessReplaceKey2',\n\t\t\tuselessReplaceKey2: '@uselessReplaceKey3',\n\t\t\tuselessReplaceKey3: '@uselessReplaceKey4',\n\t\t\tuselessReplaceKey4: '@uselessReplaceKey5',\n\t\t\tuselessReplaceKey5: '@ham' || '',\n\t\t\ttokenizer: {\n\t\t\t\troot: [\n\t\t\t\t\t{\n\t\t\t\t\t\tregex: /@\\w+/.test('@ham')\n\t\t\t\t\t\t\t? new RegExp(`^${'@uselessReplaceKey1'}$`)\n\t\t\t\t\t\t\t: new RegExp(`^${'@ham'}$`),\n\t\t\t\t\t\taction: { token: 'ham' }\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t});\n\n\t\tconst tokenizer2 = createMonarchTokenizer(modeService, 'test', {\n\t\t\tignoreCase: false,\n\t\t\ttokenizer: {\n\t\t\t\troot: [\n\t\t\t\t\t{\n\t\t\t\t\t\tregex: /@@ham/,\n\t\t\t\t\t\taction: { token: 'ham' }\n\t\t\t\t\t},\n\t\t\t\t],\n\t\t\t},\n\t\t});\n\n\t\tconst lines = [\n\t\t\t`@ham`\n\t\t];\n\n\t\tconst actualTokens1 = getTokens(tokenizer1, lines);\n\t\tassert.deepStrictEqual(actualTokens1, [\n\t\t\t[\n\t\t\t\tnew Token(0, 'ham.test', 'test'),\n\t\t\t]\n\t\t]);\n\n\t\tconst actualTokens2 = getTokens(tokenizer2, lines);\n\t\tassert.deepStrictEqual(actualTokens2, [\n\t\t\t[\n\t\t\t\tnew Token(0, 'ham.test', 'test'),\n\t\t\t]\n\t\t]);\n\t});\n\n});\n"]}