{"version":3,"file":"inspectTokens.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/editor/standalone/browser/inspectTokens/inspectTokens.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./inspectTokens';\nimport { $, append, reset } from 'vs/base/browser/dom';\nimport { CharCode } from 'vs/base/common/charCode';\nimport { Color } from 'vs/base/common/color';\nimport { KeyCode } from 'vs/base/common/keyCodes';\nimport { Disposable } from 'vs/base/common/lifecycle';\nimport { ContentWidgetPositionPreference, IActiveCodeEditor, ICodeEditor, IContentWidget, IContentWidgetPosition } from 'vs/editor/browser/editorBrowser';\nimport { EditorAction, ServicesAccessor, registerEditorAction, registerEditorContribution } from 'vs/editor/browser/editorExtensions';\nimport { Position } from 'vs/editor/common/core/position';\nimport { Token } from 'vs/editor/common/core/token';\nimport { IEditorContribution } from 'vs/editor/common/editorCommon';\nimport { ITextModel } from 'vs/editor/common/model';\nimport { FontStyle, IState, ITokenizationSupport, LanguageIdentifier, StandardTokenType, TokenMetadata, TokenizationRegistry } from 'vs/editor/common/modes';\nimport { NULL_STATE, nullTokenize, nullTokenize2 } from 'vs/editor/common/modes/nullMode';\nimport { IModeService } from 'vs/editor/common/services/modeService';\nimport { IStandaloneThemeService } from 'vs/editor/standalone/common/standaloneThemeService';\nimport { editorHoverBackground, editorHoverBorder, editorHoverForeground } from 'vs/platform/theme/common/colorRegistry';\nimport { registerThemingParticipant } from 'vs/platform/theme/common/themeService';\nimport { InspectTokensNLS } from 'vs/editor/common/standaloneStrings';\nimport { ColorScheme } from 'vs/platform/theme/common/theme';\n\n\nclass InspectTokensController extends Disposable implements IEditorContribution {\n\n\tpublic static readonly ID = 'editor.contrib.inspectTokens';\n\n\tpublic static get(editor: ICodeEditor): InspectTokensController {\n\t\treturn editor.getContribution<InspectTokensController>(InspectTokensController.ID);\n\t}\n\n\tprivate readonly _editor: ICodeEditor;\n\tprivate readonly _modeService: IModeService;\n\tprivate _widget: InspectTokensWidget | null;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\t@IStandaloneThemeService standaloneColorService: IStandaloneThemeService,\n\t\t@IModeService modeService: IModeService\n\t) {\n\t\tsuper();\n\t\tthis._editor = editor;\n\t\tthis._modeService = modeService;\n\t\tthis._widget = null;\n\n\t\tthis._register(this._editor.onDidChangeModel((e) => this.stop()));\n\t\tthis._register(this._editor.onDidChangeModelLanguage((e) => this.stop()));\n\t\tthis._register(TokenizationRegistry.onDidChange((e) => this.stop()));\n\t\tthis._register(this._editor.onKeyUp((e) => e.keyCode === KeyCode.Escape && this.stop()));\n\t}\n\n\tpublic override dispose(): void {\n\t\tthis.stop();\n\t\tsuper.dispose();\n\t}\n\n\tpublic launch(): void {\n\t\tif (this._widget) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\t\tthis._widget = new InspectTokensWidget(this._editor, this._modeService);\n\t}\n\n\tpublic stop(): void {\n\t\tif (this._widget) {\n\t\t\tthis._widget.dispose();\n\t\t\tthis._widget = null;\n\t\t}\n\t}\n}\n\nclass InspectTokens extends EditorAction {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.inspectTokens',\n\t\t\tlabel: InspectTokensNLS.inspectTokensAction,\n\t\t\talias: 'Developer: Inspect Tokens',\n\t\t\tprecondition: undefined\n\t\t});\n\t}\n\n\tpublic run(accessor: ServicesAccessor, editor: ICodeEditor): void {\n\t\tlet controller = InspectTokensController.get(editor);\n\t\tif (controller) {\n\t\t\tcontroller.launch();\n\t\t}\n\t}\n}\n\ninterface ICompleteLineTokenization {\n\tstartState: IState;\n\ttokens1: Token[];\n\ttokens2: Uint32Array;\n\tendState: IState;\n}\n\ninterface IDecodedMetadata {\n\tlanguageIdentifier: LanguageIdentifier;\n\ttokenType: StandardTokenType;\n\tfontStyle: FontStyle;\n\tforeground: Color;\n\tbackground: Color;\n}\n\nfunction renderTokenText(tokenText: string): string {\n\tlet result: string = '';\n\tfor (let charIndex = 0, len = tokenText.length; charIndex < len; charIndex++) {\n\t\tlet charCode = tokenText.charCodeAt(charIndex);\n\t\tswitch (charCode) {\n\t\t\tcase CharCode.Tab:\n\t\t\t\tresult += '\\u2192'; // &rarr;\n\t\t\t\tbreak;\n\n\t\t\tcase CharCode.Space:\n\t\t\t\tresult += '\\u00B7'; // &middot;\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tresult += String.fromCharCode(charCode);\n\t\t}\n\t}\n\treturn result;\n}\n\nfunction getSafeTokenizationSupport(languageIdentifier: LanguageIdentifier): ITokenizationSupport {\n\tlet tokenizationSupport = TokenizationRegistry.get(languageIdentifier.language);\n\tif (tokenizationSupport) {\n\t\treturn tokenizationSupport;\n\t}\n\treturn {\n\t\tgetInitialState: () => NULL_STATE,\n\t\ttokenize: (line: string, hasEOL: boolean, state: IState, deltaOffset: number) => nullTokenize(languageIdentifier.language, line, state, deltaOffset),\n\t\ttokenize2: (line: string, hasEOL: boolean, state: IState, deltaOffset: number) => nullTokenize2(languageIdentifier.id, line, state, deltaOffset)\n\t};\n}\n\nclass InspectTokensWidget extends Disposable implements IContentWidget {\n\n\tprivate static readonly _ID = 'editor.contrib.inspectTokensWidget';\n\n\t// Editor.IContentWidget.allowEditorOverflow\n\tpublic allowEditorOverflow = true;\n\n\tprivate readonly _editor: IActiveCodeEditor;\n\tprivate readonly _modeService: IModeService;\n\tprivate readonly _tokenizationSupport: ITokenizationSupport;\n\tprivate readonly _model: ITextModel;\n\tprivate readonly _domNode: HTMLElement;\n\n\tconstructor(\n\t\teditor: IActiveCodeEditor,\n\t\tmodeService: IModeService\n\t) {\n\t\tsuper();\n\t\tthis._editor = editor;\n\t\tthis._modeService = modeService;\n\t\tthis._model = this._editor.getModel();\n\t\tthis._domNode = document.createElement('div');\n\t\tthis._domNode.className = 'tokens-inspect-widget';\n\t\tthis._tokenizationSupport = getSafeTokenizationSupport(this._model.getLanguageIdentifier());\n\t\tthis._compute(this._editor.getPosition());\n\t\tthis._register(this._editor.onDidChangeCursorPosition((e) => this._compute(this._editor.getPosition())));\n\t\tthis._editor.addContentWidget(this);\n\t}\n\n\tpublic override dispose(): void {\n\t\tthis._editor.removeContentWidget(this);\n\t\tsuper.dispose();\n\t}\n\n\tpublic getId(): string {\n\t\treturn InspectTokensWidget._ID;\n\t}\n\n\tprivate _compute(position: Position): void {\n\t\tlet data = this._getTokensAtLine(position.lineNumber);\n\n\t\tlet token1Index = 0;\n\t\tfor (let i = data.tokens1.length - 1; i >= 0; i--) {\n\t\t\tlet t = data.tokens1[i];\n\t\t\tif (position.column - 1 >= t.offset) {\n\t\t\t\ttoken1Index = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tlet token2Index = 0;\n\t\tfor (let i = (data.tokens2.length >>> 1); i >= 0; i--) {\n\t\t\tif (position.column - 1 >= data.tokens2[(i << 1)]) {\n\t\t\t\ttoken2Index = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tlet lineContent = this._model.getLineContent(position.lineNumber);\n\t\tlet tokenText = '';\n\t\tif (token1Index < data.tokens1.length) {\n\t\t\tlet tokenStartIndex = data.tokens1[token1Index].offset;\n\t\t\tlet tokenEndIndex = token1Index + 1 < data.tokens1.length ? data.tokens1[token1Index + 1].offset : lineContent.length;\n\t\t\ttokenText = lineContent.substring(tokenStartIndex, tokenEndIndex);\n\t\t}\n\t\treset(this._domNode,\n\t\t\t$('h2.tm-token', undefined, renderTokenText(tokenText),\n\t\t\t\t$('span.tm-token-length', undefined, `${tokenText.length} ${tokenText.length === 1 ? 'char' : 'chars'}`)));\n\n\t\tappend(this._domNode, $('hr.tokens-inspect-separator', { 'style': 'clear:both' }));\n\n\t\tconst metadata = (token2Index << 1) + 1 < data.tokens2.length ? this._decodeMetadata(data.tokens2[(token2Index << 1) + 1]) : null;\n\t\tappend(this._domNode, $('table.tm-metadata-table', undefined,\n\t\t\t$('tbody', undefined,\n\t\t\t\t$('tr', undefined,\n\t\t\t\t\t$('td.tm-metadata-key', undefined, 'language'),\n\t\t\t\t\t$('td.tm-metadata-value', undefined, `${metadata ? metadata.languageIdentifier.language : '-?-'}`)\n\t\t\t\t),\n\t\t\t\t$('tr', undefined,\n\t\t\t\t\t$('td.tm-metadata-key', undefined, 'token type' as string),\n\t\t\t\t\t$('td.tm-metadata-value', undefined, `${metadata ? this._tokenTypeToString(metadata.tokenType) : '-?-'}`)\n\t\t\t\t),\n\t\t\t\t$('tr', undefined,\n\t\t\t\t\t$('td.tm-metadata-key', undefined, 'font style' as string),\n\t\t\t\t\t$('td.tm-metadata-value', undefined, `${metadata ? this._fontStyleToString(metadata.fontStyle) : '-?-'}`)\n\t\t\t\t),\n\t\t\t\t$('tr', undefined,\n\t\t\t\t\t$('td.tm-metadata-key', undefined, 'foreground'),\n\t\t\t\t\t$('td.tm-metadata-value', undefined, `${metadata ? Color.Format.CSS.formatHex(metadata.foreground) : '-?-'}`)\n\t\t\t\t),\n\t\t\t\t$('tr', undefined,\n\t\t\t\t\t$('td.tm-metadata-key', undefined, 'background'),\n\t\t\t\t\t$('td.tm-metadata-value', undefined, `${metadata ? Color.Format.CSS.formatHex(metadata.background) : '-?-'}`)\n\t\t\t\t)\n\t\t\t)\n\t\t));\n\t\tappend(this._domNode, $('hr.tokens-inspect-separator'));\n\n\t\tif (token1Index < data.tokens1.length) {\n\t\t\tappend(this._domNode, $('span.tm-token-type', undefined, data.tokens1[token1Index].type));\n\t\t}\n\n\t\tthis._editor.layoutContentWidget(this);\n\t}\n\n\tprivate _decodeMetadata(metadata: number): IDecodedMetadata {\n\t\tlet colorMap = TokenizationRegistry.getColorMap()!;\n\t\tlet languageId = TokenMetadata.getLanguageId(metadata);\n\t\tlet tokenType = TokenMetadata.getTokenType(metadata);\n\t\tlet fontStyle = TokenMetadata.getFontStyle(metadata);\n\t\tlet foreground = TokenMetadata.getForeground(metadata);\n\t\tlet background = TokenMetadata.getBackground(metadata);\n\t\treturn {\n\t\t\tlanguageIdentifier: this._modeService.getLanguageIdentifier(languageId)!,\n\t\t\ttokenType: tokenType,\n\t\t\tfontStyle: fontStyle,\n\t\t\tforeground: colorMap[foreground],\n\t\t\tbackground: colorMap[background]\n\t\t};\n\t}\n\n\tprivate _tokenTypeToString(tokenType: StandardTokenType): string {\n\t\tswitch (tokenType) {\n\t\t\tcase StandardTokenType.Other: return 'Other';\n\t\t\tcase StandardTokenType.Comment: return 'Comment';\n\t\t\tcase StandardTokenType.String: return 'String';\n\t\t\tcase StandardTokenType.RegEx: return 'RegEx';\n\t\t\tdefault: return '??';\n\t\t}\n\t}\n\n\tprivate _fontStyleToString(fontStyle: FontStyle): string {\n\t\tlet r = '';\n\t\tif (fontStyle & FontStyle.Italic) {\n\t\t\tr += 'italic ';\n\t\t}\n\t\tif (fontStyle & FontStyle.Bold) {\n\t\t\tr += 'bold ';\n\t\t}\n\t\tif (fontStyle & FontStyle.Underline) {\n\t\t\tr += 'underline ';\n\t\t}\n\t\tif (r.length === 0) {\n\t\t\tr = '---';\n\t\t}\n\t\treturn r;\n\t}\n\n\tprivate _getTokensAtLine(lineNumber: number): ICompleteLineTokenization {\n\t\tlet stateBeforeLine = this._getStateBeforeLine(lineNumber);\n\n\t\tlet tokenizationResult1 = this._tokenizationSupport.tokenize(this._model.getLineContent(lineNumber), true, stateBeforeLine, 0);\n\t\tlet tokenizationResult2 = this._tokenizationSupport.tokenize2(this._model.getLineContent(lineNumber), true, stateBeforeLine, 0);\n\n\t\treturn {\n\t\t\tstartState: stateBeforeLine,\n\t\t\ttokens1: tokenizationResult1.tokens,\n\t\t\ttokens2: tokenizationResult2.tokens,\n\t\t\tendState: tokenizationResult1.endState\n\t\t};\n\t}\n\n\tprivate _getStateBeforeLine(lineNumber: number): IState {\n\t\tlet state: IState = this._tokenizationSupport.getInitialState();\n\n\t\tfor (let i = 1; i < lineNumber; i++) {\n\t\t\tlet tokenizationResult = this._tokenizationSupport.tokenize(this._model.getLineContent(i), true, state, 0);\n\t\t\tstate = tokenizationResult.endState;\n\t\t}\n\n\t\treturn state;\n\t}\n\n\tpublic getDomNode(): HTMLElement {\n\t\treturn this._domNode;\n\t}\n\n\tpublic getPosition(): IContentWidgetPosition {\n\t\treturn {\n\t\t\tposition: this._editor.getPosition(),\n\t\t\tpreference: [ContentWidgetPositionPreference.BELOW, ContentWidgetPositionPreference.ABOVE]\n\t\t};\n\t}\n}\n\nregisterEditorContribution(InspectTokensController.ID, InspectTokensController);\nregisterEditorAction(InspectTokens);\n\nregisterThemingParticipant((theme, collector) => {\n\tconst border = theme.getColor(editorHoverBorder);\n\tif (border) {\n\t\tlet borderWidth = theme.type === ColorScheme.HIGH_CONTRAST ? 2 : 1;\n\t\tcollector.addRule(`.monaco-editor .tokens-inspect-widget { border: ${borderWidth}px solid ${border}; }`);\n\t\tcollector.addRule(`.monaco-editor .tokens-inspect-widget .tokens-inspect-separator { background-color: ${border}; }`);\n\t}\n\tconst background = theme.getColor(editorHoverBackground);\n\tif (background) {\n\t\tcollector.addRule(`.monaco-editor .tokens-inspect-widget { background-color: ${background}; }`);\n\t}\n\tconst foreground = theme.getColor(editorHoverForeground);\n\tif (foreground) {\n\t\tcollector.addRule(`.monaco-editor .tokens-inspect-widget { color: ${foreground}; }`);\n\t}\n});\n"]}