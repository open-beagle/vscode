{"version":3,"file":"modelService.test.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/editor/test/common/services/modelService.test.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as assert from 'assert';\nimport { CharCode } from 'vs/base/common/charCode';\nimport * as platform from 'vs/base/common/platform';\nimport { URI } from 'vs/base/common/uri';\nimport { EditOperation } from 'vs/editor/common/core/editOperation';\nimport { Range } from 'vs/editor/common/core/range';\nimport { Selection } from 'vs/editor/common/core/selection';\nimport { createStringBuilder } from 'vs/editor/common/core/stringBuilder';\nimport { DefaultEndOfLine, ITextModel } from 'vs/editor/common/model';\nimport { createTextBuffer } from 'vs/editor/common/model/textModel';\nimport { ModelSemanticColoring, ModelServiceImpl } from 'vs/editor/common/services/modelServiceImpl';\nimport { TestConfigurationService } from 'vs/platform/configuration/test/common/testConfigurationService';\nimport { TestColorTheme, TestThemeService } from 'vs/platform/theme/test/common/testThemeService';\nimport { NullLogService } from 'vs/platform/log/common/log';\nimport { UndoRedoService } from 'vs/platform/undoRedo/common/undoRedoService';\nimport { TestDialogService } from 'vs/platform/dialogs/test/common/testDialogService';\nimport { TestNotificationService } from 'vs/platform/notification/test/common/testNotificationService';\nimport { createTextModel } from 'vs/editor/test/common/editorTestUtils';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { DocumentSemanticTokensProvider, DocumentSemanticTokensProviderRegistry, SemanticTokens, SemanticTokensEdits, SemanticTokensLegend } from 'vs/editor/common/modes';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { Barrier, timeout } from 'vs/base/common/async';\nimport { ModeServiceImpl } from 'vs/editor/common/services/modeServiceImpl';\nimport { ColorScheme } from 'vs/platform/theme/common/theme';\nimport { ModesRegistry } from 'vs/editor/common/modes/modesRegistry';\nimport { IModelService } from 'vs/editor/common/services/modelService';\nimport { IModeService } from 'vs/editor/common/services/modeService';\nimport { TestTextResourcePropertiesService } from 'vs/editor/test/common/services/testTextResourcePropertiesService';\n\nconst GENERATE_TESTS = false;\n\nsuite('ModelService', () => {\n\tlet modelService: ModelServiceImpl;\n\n\tsetup(() => {\n\t\tconst configService = new TestConfigurationService();\n\t\tconfigService.setUserConfiguration('files', { 'eol': '\\n' });\n\t\tconfigService.setUserConfiguration('files', { 'eol': '\\r\\n' }, URI.file(platform.isWindows ? 'c:\\\\myroot' : '/myroot'));\n\n\t\tconst dialogService = new TestDialogService();\n\t\tmodelService = new ModelServiceImpl(configService, new TestTextResourcePropertiesService(configService), new TestThemeService(), new NullLogService(), new UndoRedoService(dialogService, new TestNotificationService()));\n\t});\n\n\tteardown(() => {\n\t\tmodelService.dispose();\n\t});\n\n\ttest('EOL setting respected depending on root', () => {\n\t\tconst model1 = modelService.createModel('farboo', null);\n\t\tconst model2 = modelService.createModel('farboo', null, URI.file(platform.isWindows ? 'c:\\\\myroot\\\\myfile.txt' : '/myroot/myfile.txt'));\n\t\tconst model3 = modelService.createModel('farboo', null, URI.file(platform.isWindows ? 'c:\\\\other\\\\myfile.txt' : '/other/myfile.txt'));\n\n\t\tassert.strictEqual(model1.getOptions().defaultEOL, DefaultEndOfLine.LF);\n\t\tassert.strictEqual(model2.getOptions().defaultEOL, DefaultEndOfLine.CRLF);\n\t\tassert.strictEqual(model3.getOptions().defaultEOL, DefaultEndOfLine.LF);\n\t});\n\n\ttest('_computeEdits no change', function () {\n\n\t\tconst model = createTextModel(\n\t\t\t[\n\t\t\t\t'This is line one', //16\n\t\t\t\t'and this is line number two', //27\n\t\t\t\t'it is followed by #3', //20\n\t\t\t\t'and finished with the fourth.', //29\n\t\t\t].join('\\n')\n\t\t);\n\n\t\tconst textBuffer = createTextBuffer(\n\t\t\t[\n\t\t\t\t'This is line one', //16\n\t\t\t\t'and this is line number two', //27\n\t\t\t\t'it is followed by #3', //20\n\t\t\t\t'and finished with the fourth.', //29\n\t\t\t].join('\\n'),\n\t\t\tDefaultEndOfLine.LF\n\t\t).textBuffer;\n\n\t\tconst actual = ModelServiceImpl._computeEdits(model, textBuffer);\n\n\t\tassert.deepStrictEqual(actual, []);\n\t});\n\n\ttest('_computeEdits first line changed', function () {\n\n\t\tconst model = createTextModel(\n\t\t\t[\n\t\t\t\t'This is line one', //16\n\t\t\t\t'and this is line number two', //27\n\t\t\t\t'it is followed by #3', //20\n\t\t\t\t'and finished with the fourth.', //29\n\t\t\t].join('\\n')\n\t\t);\n\n\t\tconst textBuffer = createTextBuffer(\n\t\t\t[\n\t\t\t\t'This is line One', //16\n\t\t\t\t'and this is line number two', //27\n\t\t\t\t'it is followed by #3', //20\n\t\t\t\t'and finished with the fourth.', //29\n\t\t\t].join('\\n'),\n\t\t\tDefaultEndOfLine.LF\n\t\t).textBuffer;\n\n\t\tconst actual = ModelServiceImpl._computeEdits(model, textBuffer);\n\n\t\tassert.deepStrictEqual(actual, [\n\t\t\tEditOperation.replaceMove(new Range(1, 1, 2, 1), 'This is line One\\n')\n\t\t]);\n\t});\n\n\ttest('_computeEdits EOL changed', function () {\n\n\t\tconst model = createTextModel(\n\t\t\t[\n\t\t\t\t'This is line one', //16\n\t\t\t\t'and this is line number two', //27\n\t\t\t\t'it is followed by #3', //20\n\t\t\t\t'and finished with the fourth.', //29\n\t\t\t].join('\\n')\n\t\t);\n\n\t\tconst textBuffer = createTextBuffer(\n\t\t\t[\n\t\t\t\t'This is line one', //16\n\t\t\t\t'and this is line number two', //27\n\t\t\t\t'it is followed by #3', //20\n\t\t\t\t'and finished with the fourth.', //29\n\t\t\t].join('\\r\\n'),\n\t\t\tDefaultEndOfLine.LF\n\t\t).textBuffer;\n\n\t\tconst actual = ModelServiceImpl._computeEdits(model, textBuffer);\n\n\t\tassert.deepStrictEqual(actual, []);\n\t});\n\n\ttest('_computeEdits EOL and other change 1', function () {\n\n\t\tconst model = createTextModel(\n\t\t\t[\n\t\t\t\t'This is line one', //16\n\t\t\t\t'and this is line number two', //27\n\t\t\t\t'it is followed by #3', //20\n\t\t\t\t'and finished with the fourth.', //29\n\t\t\t].join('\\n')\n\t\t);\n\n\t\tconst textBuffer = createTextBuffer(\n\t\t\t[\n\t\t\t\t'This is line One', //16\n\t\t\t\t'and this is line number two', //27\n\t\t\t\t'It is followed by #3', //20\n\t\t\t\t'and finished with the fourth.', //29\n\t\t\t].join('\\r\\n'),\n\t\t\tDefaultEndOfLine.LF\n\t\t).textBuffer;\n\n\t\tconst actual = ModelServiceImpl._computeEdits(model, textBuffer);\n\n\t\tassert.deepStrictEqual(actual, [\n\t\t\tEditOperation.replaceMove(\n\t\t\t\tnew Range(1, 1, 4, 1),\n\t\t\t\t[\n\t\t\t\t\t'This is line One',\n\t\t\t\t\t'and this is line number two',\n\t\t\t\t\t'It is followed by #3',\n\t\t\t\t\t''\n\t\t\t\t].join('\\r\\n')\n\t\t\t)\n\t\t]);\n\t});\n\n\ttest('_computeEdits EOL and other change 2', function () {\n\n\t\tconst model = createTextModel(\n\t\t\t[\n\t\t\t\t'package main',\t// 1\n\t\t\t\t'func foo() {',\t// 2\n\t\t\t\t'}'\t\t\t\t// 3\n\t\t\t].join('\\n')\n\t\t);\n\n\t\tconst textBuffer = createTextBuffer(\n\t\t\t[\n\t\t\t\t'package main',\t// 1\n\t\t\t\t'func foo() {',\t// 2\n\t\t\t\t'}',\t\t\t// 3\n\t\t\t\t''\n\t\t\t].join('\\r\\n'),\n\t\t\tDefaultEndOfLine.LF\n\t\t).textBuffer;\n\n\t\tconst actual = ModelServiceImpl._computeEdits(model, textBuffer);\n\n\t\tassert.deepStrictEqual(actual, [\n\t\t\tEditOperation.replaceMove(new Range(3, 2, 3, 2), '\\r\\n')\n\t\t]);\n\t});\n\n\ttest('generated1', () => {\n\t\tconst file1 = ['pram', 'okctibad', 'pjuwtemued', 'knnnm', 'u', ''];\n\t\tconst file2 = ['tcnr', 'rxwlicro', 'vnzy', '', '', 'pjzcogzur', 'ptmxyp', 'dfyshia', 'pee', 'ygg'];\n\t\tassertComputeEdits(file1, file2);\n\t});\n\n\ttest('generated2', () => {\n\t\tconst file1 = ['', 'itls', 'hrilyhesv', ''];\n\t\tconst file2 = ['vdl', '', 'tchgz', 'bhx', 'nyl'];\n\t\tassertComputeEdits(file1, file2);\n\t});\n\n\ttest('generated3', () => {\n\t\tconst file1 = ['ubrbrcv', 'wv', 'xodspybszt', 's', 'wednjxm', 'fklajt', 'fyfc', 'lvejgge', 'rtpjlodmmk', 'arivtgmjdm'];\n\t\tconst file2 = ['s', 'qj', 'tu', 'ur', 'qerhjjhyvx', 't'];\n\t\tassertComputeEdits(file1, file2);\n\t});\n\n\ttest('generated4', () => {\n\t\tconst file1 = ['ig', 'kh', 'hxegci', 'smvker', 'pkdmjjdqnv', 'vgkkqqx', '', 'jrzeb'];\n\t\tconst file2 = ['yk', ''];\n\t\tassertComputeEdits(file1, file2);\n\t});\n\n\ttest('does insertions in the middle of the document', () => {\n\t\tconst file1 = [\n\t\t\t'line 1',\n\t\t\t'line 2',\n\t\t\t'line 3'\n\t\t];\n\t\tconst file2 = [\n\t\t\t'line 1',\n\t\t\t'line 2',\n\t\t\t'line 5',\n\t\t\t'line 3'\n\t\t];\n\t\tassertComputeEdits(file1, file2);\n\t});\n\n\ttest('does insertions at the end of the document', () => {\n\t\tconst file1 = [\n\t\t\t'line 1',\n\t\t\t'line 2',\n\t\t\t'line 3'\n\t\t];\n\t\tconst file2 = [\n\t\t\t'line 1',\n\t\t\t'line 2',\n\t\t\t'line 3',\n\t\t\t'line 4'\n\t\t];\n\t\tassertComputeEdits(file1, file2);\n\t});\n\n\ttest('does insertions at the beginning of the document', () => {\n\t\tconst file1 = [\n\t\t\t'line 1',\n\t\t\t'line 2',\n\t\t\t'line 3'\n\t\t];\n\t\tconst file2 = [\n\t\t\t'line 0',\n\t\t\t'line 1',\n\t\t\t'line 2',\n\t\t\t'line 3'\n\t\t];\n\t\tassertComputeEdits(file1, file2);\n\t});\n\n\ttest('does replacements', () => {\n\t\tconst file1 = [\n\t\t\t'line 1',\n\t\t\t'line 2',\n\t\t\t'line 3'\n\t\t];\n\t\tconst file2 = [\n\t\t\t'line 1',\n\t\t\t'line 7',\n\t\t\t'line 3'\n\t\t];\n\t\tassertComputeEdits(file1, file2);\n\t});\n\n\ttest('does deletions', () => {\n\t\tconst file1 = [\n\t\t\t'line 1',\n\t\t\t'line 2',\n\t\t\t'line 3'\n\t\t];\n\t\tconst file2 = [\n\t\t\t'line 1',\n\t\t\t'line 3'\n\t\t];\n\t\tassertComputeEdits(file1, file2);\n\t});\n\n\ttest('does insert, replace, and delete', () => {\n\t\tconst file1 = [\n\t\t\t'line 1',\n\t\t\t'line 2',\n\t\t\t'line 3',\n\t\t\t'line 4',\n\t\t\t'line 5',\n\t\t];\n\t\tconst file2 = [\n\t\t\t'line 0', // insert line 0\n\t\t\t'line 1',\n\t\t\t'replace line 2', // replace line 2\n\t\t\t'line 3',\n\t\t\t// delete line 4\n\t\t\t'line 5',\n\t\t];\n\t\tassertComputeEdits(file1, file2);\n\t});\n\n\ttest('maintains undo for same resource and same content', () => {\n\t\tconst resource = URI.parse('file://test.txt');\n\n\t\t// create a model\n\t\tconst model1 = modelService.createModel('text', null, resource);\n\t\t// make an edit\n\t\tmodel1.pushEditOperations(null, [{ range: new Range(1, 5, 1, 5), text: '1' }], () => [new Selection(1, 5, 1, 5)]);\n\t\tassert.strictEqual(model1.getValue(), 'text1');\n\t\t// dispose it\n\t\tmodelService.destroyModel(resource);\n\n\t\t// create a new model with the same content\n\t\tconst model2 = modelService.createModel('text1', null, resource);\n\t\t// undo\n\t\tmodel2.undo();\n\t\tassert.strictEqual(model2.getValue(), 'text');\n\t});\n\n\ttest('maintains version id and alternative version id for same resource and same content', () => {\n\t\tconst resource = URI.parse('file://test.txt');\n\n\t\t// create a model\n\t\tconst model1 = modelService.createModel('text', null, resource);\n\t\t// make an edit\n\t\tmodel1.pushEditOperations(null, [{ range: new Range(1, 5, 1, 5), text: '1' }], () => [new Selection(1, 5, 1, 5)]);\n\t\tassert.strictEqual(model1.getValue(), 'text1');\n\t\tconst versionId = model1.getVersionId();\n\t\tconst alternativeVersionId = model1.getAlternativeVersionId();\n\t\t// dispose it\n\t\tmodelService.destroyModel(resource);\n\n\t\t// create a new model with the same content\n\t\tconst model2 = modelService.createModel('text1', null, resource);\n\t\tassert.strictEqual(model2.getVersionId(), versionId);\n\t\tassert.strictEqual(model2.getAlternativeVersionId(), alternativeVersionId);\n\t});\n\n\ttest('does not maintain undo for same resource and different content', () => {\n\t\tconst resource = URI.parse('file://test.txt');\n\n\t\t// create a model\n\t\tconst model1 = modelService.createModel('text', null, resource);\n\t\t// make an edit\n\t\tmodel1.pushEditOperations(null, [{ range: new Range(1, 5, 1, 5), text: '1' }], () => [new Selection(1, 5, 1, 5)]);\n\t\tassert.strictEqual(model1.getValue(), 'text1');\n\t\t// dispose it\n\t\tmodelService.destroyModel(resource);\n\n\t\t// create a new model with the same content\n\t\tconst model2 = modelService.createModel('text2', null, resource);\n\t\t// undo\n\t\tmodel2.undo();\n\t\tassert.strictEqual(model2.getValue(), 'text2');\n\t});\n\n\ttest('setValue should clear undo stack', () => {\n\t\tconst resource = URI.parse('file://test.txt');\n\n\t\tconst model = modelService.createModel('text', null, resource);\n\t\tmodel.pushEditOperations(null, [{ range: new Range(1, 5, 1, 5), text: '1' }], () => [new Selection(1, 5, 1, 5)]);\n\t\tassert.strictEqual(model.getValue(), 'text1');\n\n\t\tmodel.setValue('text2');\n\t\tmodel.undo();\n\t\tassert.strictEqual(model.getValue(), 'text2');\n\t});\n});\n\nsuite('ModelSemanticColoring', () => {\n\n\tconst disposables = new DisposableStore();\n\tconst ORIGINAL_FETCH_DOCUMENT_SEMANTIC_TOKENS_DELAY = ModelSemanticColoring.FETCH_DOCUMENT_SEMANTIC_TOKENS_DELAY;\n\tlet modelService: IModelService;\n\tlet modeService: IModeService;\n\n\tsetup(() => {\n\t\tModelSemanticColoring.FETCH_DOCUMENT_SEMANTIC_TOKENS_DELAY = 0;\n\n\t\tconst configService = new TestConfigurationService({ editor: { semanticHighlighting: true } });\n\t\tconst themeService = new TestThemeService();\n\t\tthemeService.setTheme(new TestColorTheme({}, ColorScheme.DARK, true));\n\t\tmodelService = disposables.add(new ModelServiceImpl(\n\t\t\tconfigService,\n\t\t\tnew TestTextResourcePropertiesService(configService),\n\t\t\tthemeService,\n\t\t\tnew NullLogService(),\n\t\t\tnew UndoRedoService(new TestDialogService(), new TestNotificationService())\n\t\t));\n\t\tmodeService = disposables.add(new ModeServiceImpl(false));\n\t});\n\n\tteardown(() => {\n\t\tdisposables.clear();\n\t\tModelSemanticColoring.FETCH_DOCUMENT_SEMANTIC_TOKENS_DELAY = ORIGINAL_FETCH_DOCUMENT_SEMANTIC_TOKENS_DELAY;\n\t});\n\n\ttest('DocumentSemanticTokens should be fetched when the result is empty if there are pending changes', async () => {\n\n\t\tdisposables.add(ModesRegistry.registerLanguage({ id: 'testMode' }));\n\n\t\tconst inFirstCall = new Barrier();\n\t\tconst delayFirstResult = new Barrier();\n\t\tconst secondResultProvided = new Barrier();\n\t\tlet callCount = 0;\n\n\t\tdisposables.add(DocumentSemanticTokensProviderRegistry.register('testMode', new class implements DocumentSemanticTokensProvider {\n\t\t\tgetLegend(): SemanticTokensLegend {\n\t\t\t\treturn { tokenTypes: ['class'], tokenModifiers: [] };\n\t\t\t}\n\t\t\tasync provideDocumentSemanticTokens(model: ITextModel, lastResultId: string | null, token: CancellationToken): Promise<SemanticTokens | SemanticTokensEdits | null> {\n\t\t\t\tcallCount++;\n\t\t\t\tif (callCount === 1) {\n\t\t\t\t\tassert.ok('called once');\n\t\t\t\t\tinFirstCall.open();\n\t\t\t\t\tawait delayFirstResult.wait();\n\t\t\t\t\tawait timeout(0); // wait for the simple scheduler to fire to check that we do actually get rescheduled\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tif (callCount === 2) {\n\t\t\t\t\tassert.ok('called twice');\n\t\t\t\t\tsecondResultProvided.open();\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t\tassert.fail('Unexpected call');\n\t\t\t}\n\t\t\treleaseDocumentSemanticTokens(resultId: string | undefined): void {\n\t\t\t}\n\t\t}));\n\n\t\tconst textModel = disposables.add(modelService.createModel('Hello world', modeService.create('testMode')));\n\n\t\t// wait for the provider to be called\n\t\tawait inFirstCall.wait();\n\n\t\t// the provider is now in the provide call\n\t\t// change the text buffer while the provider is running\n\t\ttextModel.applyEdits([{ range: new Range(1, 1, 1, 1), text: 'x' }]);\n\n\t\t// let the provider finish its first result\n\t\tdelayFirstResult.open();\n\n\t\t// we need to check that the provider is called again, even if it returns null\n\t\tawait secondResultProvided.wait();\n\n\t\t// assert that it got called twice\n\t\tassert.strictEqual(callCount, 2);\n\t});\n});\n\nfunction assertComputeEdits(lines1: string[], lines2: string[]): void {\n\tconst model = createTextModel(lines1.join('\\n'));\n\tconst textBuffer = createTextBuffer(lines2.join('\\n'), DefaultEndOfLine.LF).textBuffer;\n\n\t// compute required edits\n\t// let start = Date.now();\n\tconst edits = ModelServiceImpl._computeEdits(model, textBuffer);\n\t// console.log(`took ${Date.now() - start} ms.`);\n\n\t// apply edits\n\tmodel.pushEditOperations([], edits, null);\n\n\tassert.strictEqual(model.getValue(), lines2.join('\\n'));\n}\n\nfunction getRandomInt(min: number, max: number): number {\n\treturn Math.floor(Math.random() * (max - min + 1)) + min;\n}\n\nfunction getRandomString(minLength: number, maxLength: number): string {\n\tlet length = getRandomInt(minLength, maxLength);\n\tlet t = createStringBuilder(length);\n\tfor (let i = 0; i < length; i++) {\n\t\tt.appendASCII(getRandomInt(CharCode.a, CharCode.z));\n\t}\n\treturn t.build();\n}\n\nfunction generateFile(small: boolean): string[] {\n\tlet lineCount = getRandomInt(1, small ? 3 : 10000);\n\tlet lines: string[] = [];\n\tfor (let i = 0; i < lineCount; i++) {\n\t\tlines.push(getRandomString(0, small ? 3 : 10000));\n\t}\n\treturn lines;\n}\n\nif (GENERATE_TESTS) {\n\tlet number = 1;\n\twhile (true) {\n\n\t\tconsole.log('------TEST: ' + number++);\n\n\t\tconst file1 = generateFile(true);\n\t\tconst file2 = generateFile(true);\n\n\t\tconsole.log('------TEST GENERATED');\n\n\t\ttry {\n\t\t\tassertComputeEdits(file1, file2);\n\t\t} catch (err) {\n\t\t\tconsole.log(err);\n\t\t\tconsole.log(`\nconst file1 = ${JSON.stringify(file1).replace(/\"/g, '\\'')};\nconst file2 = ${JSON.stringify(file2).replace(/\"/g, '\\'')};\nassertComputeEdits(file1, file2);\n`);\n\t\t\tbreak;\n\t\t}\n\t}\n}\n"]}