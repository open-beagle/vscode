{"version":3,"file":"editorDom.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/editor/browser/editorDom.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from 'vs/base/browser/dom';\nimport { GlobalMouseMoveMonitor } from 'vs/base/browser/globalMouseMoveMonitor';\nimport { StandardMouseEvent } from 'vs/base/browser/mouseEvent';\nimport { Disposable, IDisposable } from 'vs/base/common/lifecycle';\n\n/**\n * Coordinates relative to the whole document (e.g. mouse event's pageX and pageY)\n */\nexport class PageCoordinates {\n\t_pageCoordinatesBrand: void;\n\n\tconstructor(\n\t\tpublic readonly x: number,\n\t\tpublic readonly y: number\n\t) { }\n\n\tpublic toClientCoordinates(): ClientCoordinates {\n\t\treturn new ClientCoordinates(this.x - dom.StandardWindow.scrollX, this.y - dom.StandardWindow.scrollY);\n\t}\n}\n\n/**\n * Coordinates within the application's client area (i.e. origin is document's scroll position).\n *\n * For example, clicking in the top-left corner of the client area will\n * always result in a mouse event with a client.x value of 0, regardless\n * of whether the page is scrolled horizontally.\n */\nexport class ClientCoordinates {\n\t_clientCoordinatesBrand: void;\n\n\tconstructor(\n\t\tpublic readonly clientX: number,\n\t\tpublic readonly clientY: number\n\t) { }\n\n\tpublic toPageCoordinates(): PageCoordinates {\n\t\treturn new PageCoordinates(this.clientX + dom.StandardWindow.scrollX, this.clientY + dom.StandardWindow.scrollY);\n\t}\n}\n\n/**\n * The position of the editor in the page.\n */\nexport class EditorPagePosition {\n\t_editorPagePositionBrand: void;\n\n\tconstructor(\n\t\tpublic readonly x: number,\n\t\tpublic readonly y: number,\n\t\tpublic readonly width: number,\n\t\tpublic readonly height: number\n\t) { }\n}\n\nexport function createEditorPagePosition(editorViewDomNode: HTMLElement): EditorPagePosition {\n\tconst editorPos = dom.getDomNodePagePosition(editorViewDomNode);\n\treturn new EditorPagePosition(editorPos.left, editorPos.top, editorPos.width, editorPos.height);\n}\n\nexport class EditorMouseEvent extends StandardMouseEvent {\n\t_editorMouseEventBrand: void;\n\n\t/**\n\t * Coordinates relative to the whole document.\n\t */\n\tpublic readonly pos: PageCoordinates;\n\n\t/**\n\t * Editor's coordinates relative to the whole document.\n\t */\n\tpublic readonly editorPos: EditorPagePosition;\n\n\tconstructor(e: MouseEvent, editorViewDomNode: HTMLElement) {\n\t\tsuper(e);\n\t\tthis.pos = new PageCoordinates(this.posx, this.posy);\n\t\tthis.editorPos = createEditorPagePosition(editorViewDomNode);\n\t}\n}\n\nexport interface EditorMouseEventMerger {\n\t(lastEvent: EditorMouseEvent | null, currentEvent: EditorMouseEvent): EditorMouseEvent;\n}\n\nexport class EditorMouseEventFactory {\n\n\tprivate readonly _editorViewDomNode: HTMLElement;\n\n\tconstructor(editorViewDomNode: HTMLElement) {\n\t\tthis._editorViewDomNode = editorViewDomNode;\n\t}\n\n\tprivate _create(e: MouseEvent): EditorMouseEvent {\n\t\treturn new EditorMouseEvent(e, this._editorViewDomNode);\n\t}\n\n\tpublic onContextMenu(target: HTMLElement, callback: (e: EditorMouseEvent) => void): IDisposable {\n\t\treturn dom.addDisposableListener(target, 'contextmenu', (e: MouseEvent) => {\n\t\t\tcallback(this._create(e));\n\t\t});\n\t}\n\n\tpublic onMouseUp(target: HTMLElement, callback: (e: EditorMouseEvent) => void): IDisposable {\n\t\treturn dom.addDisposableListener(target, 'mouseup', (e: MouseEvent) => {\n\t\t\tcallback(this._create(e));\n\t\t});\n\t}\n\n\tpublic onMouseDown(target: HTMLElement, callback: (e: EditorMouseEvent) => void): IDisposable {\n\t\treturn dom.addDisposableListener(target, 'mousedown', (e: MouseEvent) => {\n\t\t\tcallback(this._create(e));\n\t\t});\n\t}\n\n\tpublic onMouseLeave(target: HTMLElement, callback: (e: EditorMouseEvent) => void): IDisposable {\n\t\treturn dom.addDisposableNonBubblingMouseOutListener(target, (e: MouseEvent) => {\n\t\t\tcallback(this._create(e));\n\t\t});\n\t}\n\n\tpublic onMouseMoveThrottled(target: HTMLElement, callback: (e: EditorMouseEvent) => void, merger: EditorMouseEventMerger, minimumTimeMs: number): IDisposable {\n\t\tconst myMerger: dom.IEventMerger<EditorMouseEvent, MouseEvent> = (lastEvent: EditorMouseEvent | null, currentEvent: MouseEvent): EditorMouseEvent => {\n\t\t\treturn merger(lastEvent, this._create(currentEvent));\n\t\t};\n\t\treturn dom.addDisposableThrottledListener<EditorMouseEvent, MouseEvent>(target, 'mousemove', callback, myMerger, minimumTimeMs);\n\t}\n}\n\nexport class EditorPointerEventFactory {\n\n\tprivate readonly _editorViewDomNode: HTMLElement;\n\n\tconstructor(editorViewDomNode: HTMLElement) {\n\t\tthis._editorViewDomNode = editorViewDomNode;\n\t}\n\n\tprivate _create(e: MouseEvent): EditorMouseEvent {\n\t\treturn new EditorMouseEvent(e, this._editorViewDomNode);\n\t}\n\n\tpublic onPointerUp(target: HTMLElement, callback: (e: EditorMouseEvent) => void): IDisposable {\n\t\treturn dom.addDisposableListener(target, 'pointerup', (e: MouseEvent) => {\n\t\t\tcallback(this._create(e));\n\t\t});\n\t}\n\n\tpublic onPointerDown(target: HTMLElement, callback: (e: EditorMouseEvent) => void): IDisposable {\n\t\treturn dom.addDisposableListener(target, 'pointerdown', (e: MouseEvent) => {\n\t\t\tcallback(this._create(e));\n\t\t});\n\t}\n\n\tpublic onPointerLeave(target: HTMLElement, callback: (e: EditorMouseEvent) => void): IDisposable {\n\t\treturn dom.addDisposableNonBubblingPointerOutListener(target, (e: MouseEvent) => {\n\t\t\tcallback(this._create(e));\n\t\t});\n\t}\n\n\tpublic onPointerMoveThrottled(target: HTMLElement, callback: (e: EditorMouseEvent) => void, merger: EditorMouseEventMerger, minimumTimeMs: number): IDisposable {\n\t\tconst myMerger: dom.IEventMerger<EditorMouseEvent, MouseEvent> = (lastEvent: EditorMouseEvent | null, currentEvent: MouseEvent): EditorMouseEvent => {\n\t\t\treturn merger(lastEvent, this._create(currentEvent));\n\t\t};\n\t\treturn dom.addDisposableThrottledListener<EditorMouseEvent, MouseEvent>(target, 'pointermove', callback, myMerger, minimumTimeMs);\n\t}\n}\n\nexport class GlobalEditorMouseMoveMonitor extends Disposable {\n\n\tprivate readonly _editorViewDomNode: HTMLElement;\n\tprivate readonly _globalMouseMoveMonitor: GlobalMouseMoveMonitor<EditorMouseEvent>;\n\tprivate _keydownListener: IDisposable | null;\n\n\tconstructor(editorViewDomNode: HTMLElement) {\n\t\tsuper();\n\t\tthis._editorViewDomNode = editorViewDomNode;\n\t\tthis._globalMouseMoveMonitor = this._register(new GlobalMouseMoveMonitor<EditorMouseEvent>());\n\t\tthis._keydownListener = null;\n\t}\n\n\tpublic startMonitoring(\n\t\tinitialElement: HTMLElement,\n\t\tinitialButtons: number,\n\t\tmerger: EditorMouseEventMerger,\n\t\tmouseMoveCallback: (e: EditorMouseEvent) => void,\n\t\tonStopCallback: (browserEvent?: MouseEvent | KeyboardEvent) => void\n\t): void {\n\n\t\t// Add a <<capture>> keydown event listener that will cancel the monitoring\n\t\t// if something other than a modifier key is pressed\n\t\tthis._keydownListener = dom.addStandardDisposableListener(<any>document, 'keydown', (e) => {\n\t\t\tconst kb = e.toKeybinding();\n\t\t\tif (kb.isModifierKey()) {\n\t\t\t\t// Allow modifier keys\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._globalMouseMoveMonitor.stopMonitoring(true, e.browserEvent);\n\t\t}, true);\n\n\t\tconst myMerger: dom.IEventMerger<EditorMouseEvent, MouseEvent> = (lastEvent: EditorMouseEvent | null, currentEvent: MouseEvent): EditorMouseEvent => {\n\t\t\treturn merger(lastEvent, new EditorMouseEvent(currentEvent, this._editorViewDomNode));\n\t\t};\n\n\t\tthis._globalMouseMoveMonitor.startMonitoring(initialElement, initialButtons, myMerger, mouseMoveCallback, (e) => {\n\t\t\tthis._keydownListener!.dispose();\n\t\t\tonStopCallback(e);\n\t\t});\n\t}\n\n\tpublic stopMonitoring(): void {\n\t\tthis._globalMouseMoveMonitor.stopMonitoring(true);\n\t}\n}\n"]}