{"version":3,"file":"contentWidgets.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/editor/browser/viewParts/contentWidgets/contentWidgets.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as dom from 'vs/base/browser/dom';\nimport { FastDomNode, createFastDomNode } from 'vs/base/browser/fastDomNode';\nimport { ContentWidgetPositionPreference, IContentWidget } from 'vs/editor/browser/editorBrowser';\nimport { PartFingerprint, PartFingerprints, ViewPart } from 'vs/editor/browser/view/viewPart';\nimport { IRange, Range } from 'vs/editor/common/core/range';\nimport { Constants } from 'vs/base/common/uint';\nimport { RenderingContext, RestrictedRenderingContext } from 'vs/editor/common/view/renderingContext';\nimport { ViewContext } from 'vs/editor/common/view/viewContext';\nimport * as viewEvents from 'vs/editor/common/view/viewEvents';\nimport { ViewportData } from 'vs/editor/common/viewLayout/viewLinesViewportData';\nimport { EditorOption } from 'vs/editor/common/config/editorOptions';\nimport { IDimension } from 'vs/editor/common/editorCommon';\n\n\nclass Coordinate {\n\t_coordinateBrand: void;\n\n\tpublic readonly top: number;\n\tpublic readonly left: number;\n\n\tconstructor(top: number, left: number) {\n\t\tthis.top = top;\n\t\tthis.left = left;\n\t}\n}\n\nexport class ViewContentWidgets extends ViewPart {\n\n\tprivate readonly _viewDomNode: FastDomNode<HTMLElement>;\n\tprivate _widgets: { [key: string]: Widget; };\n\n\tpublic domNode: FastDomNode<HTMLElement>;\n\tpublic overflowingContentWidgetsDomNode: FastDomNode<HTMLElement>;\n\n\tconstructor(context: ViewContext, viewDomNode: FastDomNode<HTMLElement>) {\n\t\tsuper(context);\n\t\tthis._viewDomNode = viewDomNode;\n\t\tthis._widgets = {};\n\n\t\tthis.domNode = createFastDomNode(document.createElement('div'));\n\t\tPartFingerprints.write(this.domNode, PartFingerprint.ContentWidgets);\n\t\tthis.domNode.setClassName('contentWidgets');\n\t\tthis.domNode.setPosition('absolute');\n\t\tthis.domNode.setTop(0);\n\n\t\tthis.overflowingContentWidgetsDomNode = createFastDomNode(document.createElement('div'));\n\t\tPartFingerprints.write(this.overflowingContentWidgetsDomNode, PartFingerprint.OverflowingContentWidgets);\n\t\tthis.overflowingContentWidgetsDomNode.setClassName('overflowingContentWidgets');\n\t}\n\n\tpublic override dispose(): void {\n\t\tsuper.dispose();\n\t\tthis._widgets = {};\n\t}\n\n\t// --- begin event handlers\n\n\tpublic override onConfigurationChanged(e: viewEvents.ViewConfigurationChangedEvent): boolean {\n\t\tconst keys = Object.keys(this._widgets);\n\t\tfor (const widgetId of keys) {\n\t\t\tthis._widgets[widgetId].onConfigurationChanged(e);\n\t\t}\n\t\treturn true;\n\t}\n\tpublic override onDecorationsChanged(e: viewEvents.ViewDecorationsChangedEvent): boolean {\n\t\t// true for inline decorations that can end up relayouting text\n\t\treturn true;\n\t}\n\tpublic override onFlushed(e: viewEvents.ViewFlushedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onLineMappingChanged(e: viewEvents.ViewLineMappingChangedEvent): boolean {\n\t\tconst keys = Object.keys(this._widgets);\n\t\tfor (const widgetId of keys) {\n\t\t\tthis._widgets[widgetId].onLineMappingChanged(e);\n\t\t}\n\t\treturn true;\n\t}\n\tpublic override onLinesChanged(e: viewEvents.ViewLinesChangedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onLinesDeleted(e: viewEvents.ViewLinesDeletedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onLinesInserted(e: viewEvents.ViewLinesInsertedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onScrollChanged(e: viewEvents.ViewScrollChangedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onZonesChanged(e: viewEvents.ViewZonesChangedEvent): boolean {\n\t\treturn true;\n\t}\n\n\t// ---- end view event handlers\n\n\tpublic addWidget(_widget: IContentWidget): void {\n\t\tconst myWidget = new Widget(this._context, this._viewDomNode, _widget);\n\t\tthis._widgets[myWidget.id] = myWidget;\n\n\t\tif (myWidget.allowEditorOverflow) {\n\t\t\tthis.overflowingContentWidgetsDomNode.appendChild(myWidget.domNode);\n\t\t} else {\n\t\t\tthis.domNode.appendChild(myWidget.domNode);\n\t\t}\n\n\t\tthis.setShouldRender();\n\t}\n\n\tpublic setWidgetPosition(widget: IContentWidget, range: IRange | null, preference: ContentWidgetPositionPreference[] | null): void {\n\t\tconst myWidget = this._widgets[widget.getId()];\n\t\tmyWidget.setPosition(range, preference);\n\n\t\tthis.setShouldRender();\n\t}\n\n\tpublic removeWidget(widget: IContentWidget): void {\n\t\tconst widgetId = widget.getId();\n\t\tif (this._widgets.hasOwnProperty(widgetId)) {\n\t\t\tconst myWidget = this._widgets[widgetId];\n\t\t\tdelete this._widgets[widgetId];\n\n\t\t\tconst domNode = myWidget.domNode.domNode;\n\t\t\tdomNode.parentNode!.removeChild(domNode);\n\t\t\tdomNode.removeAttribute('monaco-visible-content-widget');\n\n\t\t\tthis.setShouldRender();\n\t\t}\n\t}\n\n\tpublic shouldSuppressMouseDownOnWidget(widgetId: string): boolean {\n\t\tif (this._widgets.hasOwnProperty(widgetId)) {\n\t\t\treturn this._widgets[widgetId].suppressMouseDown;\n\t\t}\n\t\treturn false;\n\t}\n\n\tpublic onBeforeRender(viewportData: ViewportData): void {\n\t\tconst keys = Object.keys(this._widgets);\n\t\tfor (const widgetId of keys) {\n\t\t\tthis._widgets[widgetId].onBeforeRender(viewportData);\n\t\t}\n\t}\n\n\tpublic prepareRender(ctx: RenderingContext): void {\n\t\tconst keys = Object.keys(this._widgets);\n\t\tfor (const widgetId of keys) {\n\t\t\tthis._widgets[widgetId].prepareRender(ctx);\n\t\t}\n\t}\n\n\tpublic render(ctx: RestrictedRenderingContext): void {\n\t\tconst keys = Object.keys(this._widgets);\n\t\tfor (const widgetId of keys) {\n\t\t\tthis._widgets[widgetId].render(ctx);\n\t\t}\n\t}\n}\n\ninterface IBoxLayoutResult {\n\tfitsAbove: boolean;\n\taboveTop: number;\n\taboveLeft: number;\n\n\tfitsBelow: boolean;\n\tbelowTop: number;\n\tbelowLeft: number;\n}\n\ninterface IRenderData {\n\tcoordinate: Coordinate,\n\tposition: ContentWidgetPositionPreference\n}\n\nclass Widget {\n\tprivate readonly _context: ViewContext;\n\tprivate readonly _viewDomNode: FastDomNode<HTMLElement>;\n\tprivate readonly _actual: IContentWidget;\n\n\tpublic readonly domNode: FastDomNode<HTMLElement>;\n\tpublic readonly id: string;\n\tpublic readonly allowEditorOverflow: boolean;\n\tpublic readonly suppressMouseDown: boolean;\n\n\tprivate readonly _fixedOverflowWidgets: boolean;\n\tprivate _contentWidth: number;\n\tprivate _contentLeft: number;\n\tprivate _lineHeight: number;\n\n\tprivate _range: IRange | null;\n\tprivate _viewRange: Range | null;\n\tprivate _preference: ContentWidgetPositionPreference[] | null;\n\tprivate _cachedDomNodeClientWidth: number;\n\tprivate _cachedDomNodeClientHeight: number;\n\tprivate _maxWidth: number;\n\tprivate _isVisible: boolean;\n\n\tprivate _renderData: IRenderData | null;\n\n\tconstructor(context: ViewContext, viewDomNode: FastDomNode<HTMLElement>, actual: IContentWidget) {\n\t\tthis._context = context;\n\t\tthis._viewDomNode = viewDomNode;\n\t\tthis._actual = actual;\n\n\t\tthis.domNode = createFastDomNode(this._actual.getDomNode());\n\t\tthis.id = this._actual.getId();\n\t\tthis.allowEditorOverflow = this._actual.allowEditorOverflow || false;\n\t\tthis.suppressMouseDown = this._actual.suppressMouseDown || false;\n\n\t\tconst options = this._context.configuration.options;\n\t\tconst layoutInfo = options.get(EditorOption.layoutInfo);\n\n\t\tthis._fixedOverflowWidgets = options.get(EditorOption.fixedOverflowWidgets);\n\t\tthis._contentWidth = layoutInfo.contentWidth;\n\t\tthis._contentLeft = layoutInfo.contentLeft;\n\t\tthis._lineHeight = options.get(EditorOption.lineHeight);\n\n\t\tthis._range = null;\n\t\tthis._viewRange = null;\n\t\tthis._preference = [];\n\t\tthis._cachedDomNodeClientWidth = -1;\n\t\tthis._cachedDomNodeClientHeight = -1;\n\t\tthis._maxWidth = this._getMaxWidth();\n\t\tthis._isVisible = false;\n\t\tthis._renderData = null;\n\n\t\tthis.domNode.setPosition((this._fixedOverflowWidgets && this.allowEditorOverflow) ? 'fixed' : 'absolute');\n\t\tthis.domNode.setVisibility('hidden');\n\t\tthis.domNode.setAttribute('widgetId', this.id);\n\t\tthis.domNode.setMaxWidth(this._maxWidth);\n\t}\n\n\tpublic onConfigurationChanged(e: viewEvents.ViewConfigurationChangedEvent): void {\n\t\tconst options = this._context.configuration.options;\n\t\tthis._lineHeight = options.get(EditorOption.lineHeight);\n\t\tif (e.hasChanged(EditorOption.layoutInfo)) {\n\t\t\tconst layoutInfo = options.get(EditorOption.layoutInfo);\n\t\t\tthis._contentLeft = layoutInfo.contentLeft;\n\t\t\tthis._contentWidth = layoutInfo.contentWidth;\n\t\t\tthis._maxWidth = this._getMaxWidth();\n\t\t}\n\t}\n\n\tpublic onLineMappingChanged(e: viewEvents.ViewLineMappingChangedEvent): void {\n\t\tthis._setPosition(this._range);\n\t}\n\n\tprivate _setPosition(range: IRange | null): void {\n\t\tthis._range = range;\n\t\tthis._viewRange = null;\n\n\t\tif (this._range) {\n\t\t\t// Do not trust that widgets give a valid position\n\t\t\tconst validModelRange = this._context.model.validateModelRange(this._range);\n\t\t\tif (this._context.model.coordinatesConverter.modelPositionIsVisible(validModelRange.getStartPosition()) || this._context.model.coordinatesConverter.modelPositionIsVisible(validModelRange.getEndPosition())) {\n\t\t\t\tthis._viewRange = this._context.model.coordinatesConverter.convertModelRangeToViewRange(validModelRange);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _getMaxWidth(): number {\n\t\treturn (\n\t\t\tthis.allowEditorOverflow\n\t\t\t\t? window.innerWidth || document.documentElement!.clientWidth || document.body.clientWidth\n\t\t\t\t: this._contentWidth\n\t\t);\n\t}\n\n\tpublic setPosition(range: IRange | null, preference: ContentWidgetPositionPreference[] | null): void {\n\t\tthis._setPosition(range);\n\t\tthis._preference = preference;\n\t\tthis._cachedDomNodeClientWidth = -1;\n\t\tthis._cachedDomNodeClientHeight = -1;\n\t}\n\n\tprivate _layoutBoxInViewport(topLeft: Coordinate, bottomLeft: Coordinate, width: number, height: number, ctx: RenderingContext): IBoxLayoutResult {\n\t\t// Our visible box is split horizontally by the current line => 2 boxes\n\n\t\t// a) the box above the line\n\t\tconst aboveLineTop = topLeft.top;\n\t\tconst heightAboveLine = aboveLineTop;\n\n\t\t// b) the box under the line\n\t\tconst underLineTop = bottomLeft.top + this._lineHeight;\n\t\tconst heightUnderLine = ctx.viewportHeight - underLineTop;\n\n\t\tconst aboveTop = aboveLineTop - height;\n\t\tconst fitsAbove = (heightAboveLine >= height);\n\t\tconst belowTop = underLineTop;\n\t\tconst fitsBelow = (heightUnderLine >= height);\n\n\t\t// And its left\n\t\tlet actualAboveLeft = topLeft.left;\n\t\tlet actualBelowLeft = bottomLeft.left;\n\t\tif (actualAboveLeft + width > ctx.scrollLeft + ctx.viewportWidth) {\n\t\t\tactualAboveLeft = ctx.scrollLeft + ctx.viewportWidth - width;\n\t\t}\n\t\tif (actualBelowLeft + width > ctx.scrollLeft + ctx.viewportWidth) {\n\t\t\tactualBelowLeft = ctx.scrollLeft + ctx.viewportWidth - width;\n\t\t}\n\t\tif (actualAboveLeft < ctx.scrollLeft) {\n\t\t\tactualAboveLeft = ctx.scrollLeft;\n\t\t}\n\t\tif (actualBelowLeft < ctx.scrollLeft) {\n\t\t\tactualBelowLeft = ctx.scrollLeft;\n\t\t}\n\n\t\treturn {\n\t\t\tfitsAbove: fitsAbove,\n\t\t\taboveTop: aboveTop,\n\t\t\taboveLeft: actualAboveLeft,\n\n\t\t\tfitsBelow: fitsBelow,\n\t\t\tbelowTop: belowTop,\n\t\t\tbelowLeft: actualBelowLeft,\n\t\t};\n\t}\n\n\tprivate _layoutHorizontalSegmentInPage(windowSize: dom.Dimension, domNodePosition: dom.IDomNodePagePosition, left: number, width: number): [number, number] {\n\t\t// Initially, the limits are defined as the dom node limits\n\t\tconst MIN_LIMIT = Math.max(0, domNodePosition.left - width);\n\t\tconst MAX_LIMIT = Math.min(domNodePosition.left + domNodePosition.width + width, windowSize.width);\n\n\t\tlet absoluteLeft = domNodePosition.left + left - dom.StandardWindow.scrollX;\n\n\t\tif (absoluteLeft + width > MAX_LIMIT) {\n\t\t\tconst delta = absoluteLeft - (MAX_LIMIT - width);\n\t\t\tabsoluteLeft -= delta;\n\t\t\tleft -= delta;\n\t\t}\n\n\t\tif (absoluteLeft < MIN_LIMIT) {\n\t\t\tconst delta = absoluteLeft - MIN_LIMIT;\n\t\t\tabsoluteLeft -= delta;\n\t\t\tleft -= delta;\n\t\t}\n\n\t\treturn [left, absoluteLeft];\n\t}\n\n\tprivate _layoutBoxInPage(topLeft: Coordinate, bottomLeft: Coordinate, width: number, height: number, ctx: RenderingContext): IBoxLayoutResult | null {\n\t\tconst aboveTop = topLeft.top - height;\n\t\tconst belowTop = bottomLeft.top + this._lineHeight;\n\n\t\tconst domNodePosition = dom.getDomNodePagePosition(this._viewDomNode.domNode);\n\t\tconst absoluteAboveTop = domNodePosition.top + aboveTop - dom.StandardWindow.scrollY;\n\t\tconst absoluteBelowTop = domNodePosition.top + belowTop - dom.StandardWindow.scrollY;\n\n\t\tconst windowSize = dom.getClientArea(document.body);\n\t\tconst [aboveLeft, absoluteAboveLeft] = this._layoutHorizontalSegmentInPage(windowSize, domNodePosition, topLeft.left - ctx.scrollLeft + this._contentLeft, width);\n\t\tconst [belowLeft, absoluteBelowLeft] = this._layoutHorizontalSegmentInPage(windowSize, domNodePosition, bottomLeft.left - ctx.scrollLeft + this._contentLeft, width);\n\n\t\t// Leave some clearance to the top/bottom\n\t\tconst TOP_PADDING = 22;\n\t\tconst BOTTOM_PADDING = 22;\n\n\t\tconst fitsAbove = (absoluteAboveTop >= TOP_PADDING);\n\t\tconst fitsBelow = (absoluteBelowTop + height <= windowSize.height - BOTTOM_PADDING);\n\n\t\tif (this._fixedOverflowWidgets) {\n\t\t\treturn {\n\t\t\t\tfitsAbove,\n\t\t\t\taboveTop: Math.max(absoluteAboveTop, TOP_PADDING),\n\t\t\t\taboveLeft: absoluteAboveLeft,\n\t\t\t\tfitsBelow,\n\t\t\t\tbelowTop: absoluteBelowTop,\n\t\t\t\tbelowLeft: absoluteBelowLeft\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tfitsAbove,\n\t\t\taboveTop: aboveTop,\n\t\t\taboveLeft,\n\t\t\tfitsBelow,\n\t\t\tbelowTop,\n\t\t\tbelowLeft\n\t\t};\n\t}\n\n\tprivate _prepareRenderWidgetAtExactPositionOverflowing(topLeft: Coordinate): Coordinate {\n\t\treturn new Coordinate(topLeft.top, topLeft.left + this._contentLeft);\n\t}\n\n\t/**\n\t * Compute `this._topLeft`\n\t */\n\tprivate _getTopAndBottomLeft(ctx: RenderingContext): [Coordinate, Coordinate] | [null, null] {\n\t\tif (!this._viewRange) {\n\t\t\treturn [null, null];\n\t\t}\n\n\t\tconst visibleRangesForRange = ctx.linesVisibleRangesForRange(this._viewRange, false);\n\t\tif (!visibleRangesForRange || visibleRangesForRange.length === 0) {\n\t\t\treturn [null, null];\n\t\t}\n\n\t\tlet firstLine = visibleRangesForRange[0];\n\t\tlet lastLine = visibleRangesForRange[0];\n\t\tfor (const visibleRangesForLine of visibleRangesForRange) {\n\t\t\tif (visibleRangesForLine.lineNumber < firstLine.lineNumber) {\n\t\t\t\tfirstLine = visibleRangesForLine;\n\t\t\t}\n\t\t\tif (visibleRangesForLine.lineNumber > lastLine.lineNumber) {\n\t\t\t\tlastLine = visibleRangesForLine;\n\t\t\t}\n\t\t}\n\n\t\tlet firstLineMinLeft = Constants.MAX_SAFE_SMALL_INTEGER;//firstLine.Constants.MAX_SAFE_SMALL_INTEGER;\n\t\tfor (const visibleRange of firstLine.ranges) {\n\t\t\tif (visibleRange.left < firstLineMinLeft) {\n\t\t\t\tfirstLineMinLeft = visibleRange.left;\n\t\t\t}\n\t\t}\n\n\t\tlet lastLineMinLeft = Constants.MAX_SAFE_SMALL_INTEGER;//lastLine.Constants.MAX_SAFE_SMALL_INTEGER;\n\t\tfor (const visibleRange of lastLine.ranges) {\n\t\t\tif (visibleRange.left < lastLineMinLeft) {\n\t\t\t\tlastLineMinLeft = visibleRange.left;\n\t\t\t}\n\t\t}\n\n\t\tconst topForPosition = ctx.getVerticalOffsetForLineNumber(firstLine.lineNumber) - ctx.scrollTop;\n\t\tconst topLeft = new Coordinate(topForPosition, firstLineMinLeft);\n\n\t\tconst topForBottomLine = ctx.getVerticalOffsetForLineNumber(lastLine.lineNumber) - ctx.scrollTop;\n\t\tconst bottomLeft = new Coordinate(topForBottomLine, lastLineMinLeft);\n\n\t\treturn [topLeft, bottomLeft];\n\t}\n\n\tprivate _prepareRenderWidget(ctx: RenderingContext): IRenderData | null {\n\t\tconst [topLeft, bottomLeft] = this._getTopAndBottomLeft(ctx);\n\t\tif (!topLeft || !bottomLeft) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif (this._cachedDomNodeClientWidth === -1 || this._cachedDomNodeClientHeight === -1) {\n\n\t\t\tlet preferredDimensions: IDimension | null = null;\n\t\t\tif (typeof this._actual.beforeRender === 'function') {\n\t\t\t\tpreferredDimensions = safeInvoke(this._actual.beforeRender, this._actual);\n\t\t\t}\n\t\t\tif (preferredDimensions) {\n\t\t\t\tthis._cachedDomNodeClientWidth = preferredDimensions.width;\n\t\t\t\tthis._cachedDomNodeClientHeight = preferredDimensions.height;\n\t\t\t} else {\n\t\t\t\tconst domNode = this.domNode.domNode;\n\t\t\t\tthis._cachedDomNodeClientWidth = domNode.clientWidth;\n\t\t\t\tthis._cachedDomNodeClientHeight = domNode.clientHeight;\n\t\t\t}\n\t\t}\n\n\t\tlet placement: IBoxLayoutResult | null;\n\t\tif (this.allowEditorOverflow) {\n\t\t\tplacement = this._layoutBoxInPage(topLeft, bottomLeft, this._cachedDomNodeClientWidth, this._cachedDomNodeClientHeight, ctx);\n\t\t} else {\n\t\t\tplacement = this._layoutBoxInViewport(topLeft, bottomLeft, this._cachedDomNodeClientWidth, this._cachedDomNodeClientHeight, ctx);\n\t\t}\n\n\t\t// Do two passes, first for perfect fit, second picks first option\n\t\tif (this._preference) {\n\t\t\tfor (let pass = 1; pass <= 2; pass++) {\n\t\t\t\tfor (const pref of this._preference) {\n\t\t\t\t\t// placement\n\t\t\t\t\tif (pref === ContentWidgetPositionPreference.ABOVE) {\n\t\t\t\t\t\tif (!placement) {\n\t\t\t\t\t\t\t// Widget outside of viewport\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (pass === 2 || placement.fitsAbove) {\n\t\t\t\t\t\t\treturn { coordinate: new Coordinate(placement.aboveTop, placement.aboveLeft), position: ContentWidgetPositionPreference.ABOVE };\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (pref === ContentWidgetPositionPreference.BELOW) {\n\t\t\t\t\t\tif (!placement) {\n\t\t\t\t\t\t\t// Widget outside of viewport\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (pass === 2 || placement.fitsBelow) {\n\t\t\t\t\t\t\treturn { coordinate: new Coordinate(placement.belowTop, placement.belowLeft), position: ContentWidgetPositionPreference.BELOW };\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (this.allowEditorOverflow) {\n\t\t\t\t\t\t\treturn { coordinate: this._prepareRenderWidgetAtExactPositionOverflowing(topLeft), position: ContentWidgetPositionPreference.EXACT };\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn { coordinate: topLeft, position: ContentWidgetPositionPreference.EXACT };\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * On this first pass, we ensure that the content widget (if it is in the viewport) has the max width set correctly.\n\t */\n\tpublic onBeforeRender(viewportData: ViewportData): void {\n\t\tif (!this._viewRange || !this._preference) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (this._viewRange.endLineNumber < viewportData.startLineNumber || this._viewRange.startLineNumber > viewportData.endLineNumber) {\n\t\t\t// Outside of viewport\n\t\t\treturn;\n\t\t}\n\n\t\tthis.domNode.setMaxWidth(this._maxWidth);\n\t}\n\n\tpublic prepareRender(ctx: RenderingContext): void {\n\t\tthis._renderData = this._prepareRenderWidget(ctx);\n\t}\n\n\tpublic render(ctx: RestrictedRenderingContext): void {\n\t\tif (!this._renderData) {\n\t\t\t// This widget should be invisible\n\t\t\tif (this._isVisible) {\n\t\t\t\tthis.domNode.removeAttribute('monaco-visible-content-widget');\n\t\t\t\tthis._isVisible = false;\n\t\t\t\tthis.domNode.setVisibility('hidden');\n\t\t\t}\n\n\t\t\tif (typeof this._actual.afterRender === 'function') {\n\t\t\t\tsafeInvoke(this._actual.afterRender, this._actual, null);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\t// This widget should be visible\n\t\tif (this.allowEditorOverflow) {\n\t\t\tthis.domNode.setTop(this._renderData.coordinate.top);\n\t\t\tthis.domNode.setLeft(this._renderData.coordinate.left);\n\t\t} else {\n\t\t\tthis.domNode.setTop(this._renderData.coordinate.top + ctx.scrollTop - ctx.bigNumbersDelta);\n\t\t\tthis.domNode.setLeft(this._renderData.coordinate.left);\n\t\t}\n\n\t\tif (!this._isVisible) {\n\t\t\tthis.domNode.setVisibility('inherit');\n\t\t\tthis.domNode.setAttribute('monaco-visible-content-widget', 'true');\n\t\t\tthis._isVisible = true;\n\t\t}\n\n\t\tif (typeof this._actual.afterRender === 'function') {\n\t\t\tsafeInvoke(this._actual.afterRender, this._actual, this._renderData.position);\n\t\t}\n\t}\n}\n\nfunction safeInvoke<T extends (...args: any[]) => any>(fn: T, thisArg: ThisParameterType<T>, ...args: Parameters<T>): ReturnType<T> | null {\n\ttry {\n\t\treturn fn.call(thisArg, ...args);\n\t} catch {\n\t\t// ignore\n\t\treturn null;\n\t}\n}\n"]}