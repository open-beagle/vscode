{"version":3,"file":"viewCursors.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/editor/browser/viewParts/viewCursors/viewCursors.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./viewCursors';\nimport { FastDomNode, createFastDomNode } from 'vs/base/browser/fastDomNode';\nimport { IntervalTimer, TimeoutTimer } from 'vs/base/common/async';\nimport { ViewPart } from 'vs/editor/browser/view/viewPart';\nimport { IViewCursorRenderData, ViewCursor } from 'vs/editor/browser/viewParts/viewCursors/viewCursor';\nimport { TextEditorCursorBlinkingStyle, TextEditorCursorStyle, EditorOption } from 'vs/editor/common/config/editorOptions';\nimport { Position } from 'vs/editor/common/core/position';\nimport { editorCursorBackground, editorCursorForeground } from 'vs/editor/common/view/editorColorRegistry';\nimport { RenderingContext, RestrictedRenderingContext } from 'vs/editor/common/view/renderingContext';\nimport { ViewContext } from 'vs/editor/common/view/viewContext';\nimport * as viewEvents from 'vs/editor/common/view/viewEvents';\nimport { registerThemingParticipant } from 'vs/platform/theme/common/themeService';\n\nexport class ViewCursors extends ViewPart {\n\n\tstatic readonly BLINK_INTERVAL = 500;\n\n\tprivate _readOnly: boolean;\n\tprivate _cursorBlinking: TextEditorCursorBlinkingStyle;\n\tprivate _cursorStyle: TextEditorCursorStyle;\n\tprivate _cursorSmoothCaretAnimation: boolean;\n\tprivate _selectionIsEmpty: boolean;\n\tprivate _isComposingInput: boolean;\n\n\tprivate _isVisible: boolean;\n\n\tprivate readonly _domNode: FastDomNode<HTMLElement>;\n\n\tprivate readonly _startCursorBlinkAnimation: TimeoutTimer;\n\tprivate readonly _cursorFlatBlinkInterval: IntervalTimer;\n\tprivate _blinkingEnabled: boolean;\n\n\tprivate _editorHasFocus: boolean;\n\n\tprivate readonly _primaryCursor: ViewCursor;\n\tprivate readonly _secondaryCursors: ViewCursor[];\n\tprivate _renderData: IViewCursorRenderData[];\n\n\tconstructor(context: ViewContext) {\n\t\tsuper(context);\n\n\t\tconst options = this._context.configuration.options;\n\t\tthis._readOnly = options.get(EditorOption.readOnly);\n\t\tthis._cursorBlinking = options.get(EditorOption.cursorBlinking);\n\t\tthis._cursorStyle = options.get(EditorOption.cursorStyle);\n\t\tthis._cursorSmoothCaretAnimation = options.get(EditorOption.cursorSmoothCaretAnimation);\n\t\tthis._selectionIsEmpty = true;\n\t\tthis._isComposingInput = false;\n\n\t\tthis._isVisible = false;\n\n\t\tthis._primaryCursor = new ViewCursor(this._context);\n\t\tthis._secondaryCursors = [];\n\t\tthis._renderData = [];\n\n\t\tthis._domNode = createFastDomNode(document.createElement('div'));\n\t\tthis._domNode.setAttribute('role', 'presentation');\n\t\tthis._domNode.setAttribute('aria-hidden', 'true');\n\t\tthis._updateDomClassName();\n\n\t\tthis._domNode.appendChild(this._primaryCursor.getDomNode());\n\n\t\tthis._startCursorBlinkAnimation = new TimeoutTimer();\n\t\tthis._cursorFlatBlinkInterval = new IntervalTimer();\n\n\t\tthis._blinkingEnabled = false;\n\n\t\tthis._editorHasFocus = false;\n\t\tthis._updateBlinking();\n\t}\n\n\tpublic override dispose(): void {\n\t\tsuper.dispose();\n\t\tthis._startCursorBlinkAnimation.dispose();\n\t\tthis._cursorFlatBlinkInterval.dispose();\n\t}\n\n\tpublic getDomNode(): FastDomNode<HTMLElement> {\n\t\treturn this._domNode;\n\t}\n\n\t// --- begin event handlers\n\tpublic override onCompositionStart(e: viewEvents.ViewCompositionStartEvent): boolean {\n\t\tthis._isComposingInput = true;\n\t\tthis._updateBlinking();\n\t\treturn true;\n\t}\n\tpublic override onCompositionEnd(e: viewEvents.ViewCompositionEndEvent): boolean {\n\t\tthis._isComposingInput = false;\n\t\tthis._updateBlinking();\n\t\treturn true;\n\t}\n\tpublic override onConfigurationChanged(e: viewEvents.ViewConfigurationChangedEvent): boolean {\n\t\tconst options = this._context.configuration.options;\n\n\t\tthis._readOnly = options.get(EditorOption.readOnly);\n\t\tthis._cursorBlinking = options.get(EditorOption.cursorBlinking);\n\t\tthis._cursorStyle = options.get(EditorOption.cursorStyle);\n\t\tthis._cursorSmoothCaretAnimation = options.get(EditorOption.cursorSmoothCaretAnimation);\n\n\t\tthis._updateBlinking();\n\t\tthis._updateDomClassName();\n\n\t\tthis._primaryCursor.onConfigurationChanged(e);\n\t\tfor (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\n\t\t\tthis._secondaryCursors[i].onConfigurationChanged(e);\n\t\t}\n\t\treturn true;\n\t}\n\tprivate _onCursorPositionChanged(position: Position, secondaryPositions: Position[]): void {\n\t\tthis._primaryCursor.onCursorPositionChanged(position);\n\t\tthis._updateBlinking();\n\n\t\tif (this._secondaryCursors.length < secondaryPositions.length) {\n\t\t\t// Create new cursors\n\t\t\tconst addCnt = secondaryPositions.length - this._secondaryCursors.length;\n\t\t\tfor (let i = 0; i < addCnt; i++) {\n\t\t\t\tconst newCursor = new ViewCursor(this._context);\n\t\t\t\tthis._domNode.domNode.insertBefore(newCursor.getDomNode().domNode, this._primaryCursor.getDomNode().domNode.nextSibling);\n\t\t\t\tthis._secondaryCursors.push(newCursor);\n\t\t\t}\n\t\t} else if (this._secondaryCursors.length > secondaryPositions.length) {\n\t\t\t// Remove some cursors\n\t\t\tconst removeCnt = this._secondaryCursors.length - secondaryPositions.length;\n\t\t\tfor (let i = 0; i < removeCnt; i++) {\n\t\t\t\tthis._domNode.removeChild(this._secondaryCursors[0].getDomNode());\n\t\t\t\tthis._secondaryCursors.splice(0, 1);\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0; i < secondaryPositions.length; i++) {\n\t\t\tthis._secondaryCursors[i].onCursorPositionChanged(secondaryPositions[i]);\n\t\t}\n\n\t}\n\tpublic override onCursorStateChanged(e: viewEvents.ViewCursorStateChangedEvent): boolean {\n\t\tconst positions: Position[] = [];\n\t\tfor (let i = 0, len = e.selections.length; i < len; i++) {\n\t\t\tpositions[i] = e.selections[i].getPosition();\n\t\t}\n\t\tthis._onCursorPositionChanged(positions[0], positions.slice(1));\n\n\t\tconst selectionIsEmpty = e.selections[0].isEmpty();\n\t\tif (this._selectionIsEmpty !== selectionIsEmpty) {\n\t\t\tthis._selectionIsEmpty = selectionIsEmpty;\n\t\t\tthis._updateDomClassName();\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tpublic override onDecorationsChanged(e: viewEvents.ViewDecorationsChangedEvent): boolean {\n\t\t// true for inline decorations that can end up relayouting text\n\t\treturn true;\n\t}\n\tpublic override onFlushed(e: viewEvents.ViewFlushedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onFocusChanged(e: viewEvents.ViewFocusChangedEvent): boolean {\n\t\tthis._editorHasFocus = e.isFocused;\n\t\tthis._updateBlinking();\n\t\treturn false;\n\t}\n\tpublic override onLinesChanged(e: viewEvents.ViewLinesChangedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onLinesDeleted(e: viewEvents.ViewLinesDeletedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onLinesInserted(e: viewEvents.ViewLinesInsertedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onScrollChanged(e: viewEvents.ViewScrollChangedEvent): boolean {\n\t\treturn true;\n\t}\n\tpublic override onTokensChanged(e: viewEvents.ViewTokensChangedEvent): boolean {\n\t\tconst shouldRender = (position: Position) => {\n\t\t\tfor (let i = 0, len = e.ranges.length; i < len; i++) {\n\t\t\t\tif (e.ranges[i].fromLineNumber <= position.lineNumber && position.lineNumber <= e.ranges[i].toLineNumber) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tif (shouldRender(this._primaryCursor.getPosition())) {\n\t\t\treturn true;\n\t\t}\n\t\tfor (const secondaryCursor of this._secondaryCursors) {\n\t\t\tif (shouldRender(secondaryCursor.getPosition())) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\tpublic override onZonesChanged(e: viewEvents.ViewZonesChangedEvent): boolean {\n\t\treturn true;\n\t}\n\n\t// --- end event handlers\n\n\t// ---- blinking logic\n\n\tprivate _getCursorBlinking(): TextEditorCursorBlinkingStyle {\n\t\tif (this._isComposingInput) {\n\t\t\t// avoid double cursors\n\t\t\treturn TextEditorCursorBlinkingStyle.Hidden;\n\t\t}\n\t\tif (!this._editorHasFocus) {\n\t\t\treturn TextEditorCursorBlinkingStyle.Hidden;\n\t\t}\n\t\tif (this._readOnly) {\n\t\t\treturn TextEditorCursorBlinkingStyle.Solid;\n\t\t}\n\t\treturn this._cursorBlinking;\n\t}\n\n\tprivate _updateBlinking(): void {\n\t\tthis._startCursorBlinkAnimation.cancel();\n\t\tthis._cursorFlatBlinkInterval.cancel();\n\n\t\tconst blinkingStyle = this._getCursorBlinking();\n\n\t\t// hidden and solid are special as they involve no animations\n\t\tconst isHidden = (blinkingStyle === TextEditorCursorBlinkingStyle.Hidden);\n\t\tconst isSolid = (blinkingStyle === TextEditorCursorBlinkingStyle.Solid);\n\n\t\tif (isHidden) {\n\t\t\tthis._hide();\n\t\t} else {\n\t\t\tthis._show();\n\t\t}\n\n\t\tthis._blinkingEnabled = false;\n\t\tthis._updateDomClassName();\n\n\t\tif (!isHidden && !isSolid) {\n\t\t\tif (blinkingStyle === TextEditorCursorBlinkingStyle.Blink) {\n\t\t\t\t// flat blinking is handled by JavaScript to save battery life due to Chromium step timing issue https://bugs.chromium.org/p/chromium/issues/detail?id=361587\n\t\t\t\tthis._cursorFlatBlinkInterval.cancelAndSet(() => {\n\t\t\t\t\tif (this._isVisible) {\n\t\t\t\t\t\tthis._hide();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._show();\n\t\t\t\t\t}\n\t\t\t\t}, ViewCursors.BLINK_INTERVAL);\n\t\t\t} else {\n\t\t\t\tthis._startCursorBlinkAnimation.setIfNotSet(() => {\n\t\t\t\t\tthis._blinkingEnabled = true;\n\t\t\t\t\tthis._updateDomClassName();\n\t\t\t\t}, ViewCursors.BLINK_INTERVAL);\n\t\t\t}\n\t\t}\n\t}\n\t// --- end blinking logic\n\n\tprivate _updateDomClassName(): void {\n\t\tthis._domNode.setClassName(this._getClassName());\n\t}\n\n\tprivate _getClassName(): string {\n\t\tlet result = 'cursors-layer';\n\t\tif (!this._selectionIsEmpty) {\n\t\t\tresult += ' has-selection';\n\t\t}\n\t\tswitch (this._cursorStyle) {\n\t\t\tcase TextEditorCursorStyle.Line:\n\t\t\t\tresult += ' cursor-line-style';\n\t\t\t\tbreak;\n\t\t\tcase TextEditorCursorStyle.Block:\n\t\t\t\tresult += ' cursor-block-style';\n\t\t\t\tbreak;\n\t\t\tcase TextEditorCursorStyle.Underline:\n\t\t\t\tresult += ' cursor-underline-style';\n\t\t\t\tbreak;\n\t\t\tcase TextEditorCursorStyle.LineThin:\n\t\t\t\tresult += ' cursor-line-thin-style';\n\t\t\t\tbreak;\n\t\t\tcase TextEditorCursorStyle.BlockOutline:\n\t\t\t\tresult += ' cursor-block-outline-style';\n\t\t\t\tbreak;\n\t\t\tcase TextEditorCursorStyle.UnderlineThin:\n\t\t\t\tresult += ' cursor-underline-thin-style';\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tresult += ' cursor-line-style';\n\t\t}\n\t\tif (this._blinkingEnabled) {\n\t\t\tswitch (this._getCursorBlinking()) {\n\t\t\t\tcase TextEditorCursorBlinkingStyle.Blink:\n\t\t\t\t\tresult += ' cursor-blink';\n\t\t\t\t\tbreak;\n\t\t\t\tcase TextEditorCursorBlinkingStyle.Smooth:\n\t\t\t\t\tresult += ' cursor-smooth';\n\t\t\t\t\tbreak;\n\t\t\t\tcase TextEditorCursorBlinkingStyle.Phase:\n\t\t\t\t\tresult += ' cursor-phase';\n\t\t\t\t\tbreak;\n\t\t\t\tcase TextEditorCursorBlinkingStyle.Expand:\n\t\t\t\t\tresult += ' cursor-expand';\n\t\t\t\t\tbreak;\n\t\t\t\tcase TextEditorCursorBlinkingStyle.Solid:\n\t\t\t\t\tresult += ' cursor-solid';\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tresult += ' cursor-solid';\n\t\t\t}\n\t\t} else {\n\t\t\tresult += ' cursor-solid';\n\t\t}\n\t\tif (this._cursorSmoothCaretAnimation) {\n\t\t\tresult += ' cursor-smooth-caret-animation';\n\t\t}\n\t\treturn result;\n\t}\n\n\tprivate _show(): void {\n\t\tthis._primaryCursor.show();\n\t\tfor (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\n\t\t\tthis._secondaryCursors[i].show();\n\t\t}\n\t\tthis._isVisible = true;\n\t}\n\n\tprivate _hide(): void {\n\t\tthis._primaryCursor.hide();\n\t\tfor (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\n\t\t\tthis._secondaryCursors[i].hide();\n\t\t}\n\t\tthis._isVisible = false;\n\t}\n\n\t// ---- IViewPart implementation\n\n\tpublic prepareRender(ctx: RenderingContext): void {\n\t\tthis._primaryCursor.prepareRender(ctx);\n\t\tfor (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\n\t\t\tthis._secondaryCursors[i].prepareRender(ctx);\n\t\t}\n\t}\n\n\tpublic render(ctx: RestrictedRenderingContext): void {\n\t\tlet renderData: IViewCursorRenderData[] = [], renderDataLen = 0;\n\n\t\tconst primaryRenderData = this._primaryCursor.render(ctx);\n\t\tif (primaryRenderData) {\n\t\t\trenderData[renderDataLen++] = primaryRenderData;\n\t\t}\n\n\t\tfor (let i = 0, len = this._secondaryCursors.length; i < len; i++) {\n\t\t\tconst secondaryRenderData = this._secondaryCursors[i].render(ctx);\n\t\t\tif (secondaryRenderData) {\n\t\t\t\trenderData[renderDataLen++] = secondaryRenderData;\n\t\t\t}\n\t\t}\n\n\t\tthis._renderData = renderData;\n\t}\n\n\tpublic getLastRenderData(): IViewCursorRenderData[] {\n\t\treturn this._renderData;\n\t}\n}\n\nregisterThemingParticipant((theme, collector) => {\n\tconst caret = theme.getColor(editorCursorForeground);\n\tif (caret) {\n\t\tlet caretBackground = theme.getColor(editorCursorBackground);\n\t\tif (!caretBackground) {\n\t\t\tcaretBackground = caret.opposite();\n\t\t}\n\t\tcollector.addRule(`.monaco-editor .cursors-layer .cursor { background-color: ${caret}; border-color: ${caret}; color: ${caretBackground}; }`);\n\t\tif (theme.type === 'hc') {\n\t\t\tcollector.addRule(`.monaco-editor .cursors-layer.has-selection .cursor { border-left: 1px solid ${caretBackground}; border-right: 1px solid ${caretBackground}; }`);\n\t\t}\n\t}\n\n});\n"]}