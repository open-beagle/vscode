{"version":3,"file":"markerDecorationsServiceImpl.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/editor/common/services/markerDecorationsServiceImpl.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IMarkerService, IMarker, MarkerSeverity, MarkerTag } from 'vs/platform/markers/common/markers';\nimport { Disposable, toDisposable } from 'vs/base/common/lifecycle';\nimport { URI } from 'vs/base/common/uri';\nimport { IModelDeltaDecoration, ITextModel, IModelDecorationOptions, TrackedRangeStickiness, OverviewRulerLane, IModelDecoration, MinimapPosition, IModelDecorationMinimapOptions } from 'vs/editor/common/model';\nimport { ClassName } from 'vs/editor/common/model/intervalTree';\nimport { themeColorFromId, ThemeColor } from 'vs/platform/theme/common/themeService';\nimport { overviewRulerWarning, overviewRulerInfo, overviewRulerError } from 'vs/editor/common/view/editorColorRegistry';\nimport { IModelService } from 'vs/editor/common/services/modelService';\nimport { Range } from 'vs/editor/common/core/range';\nimport { IMarkerDecorationsService } from 'vs/editor/common/services/markersDecorationService';\nimport { Schemas } from 'vs/base/common/network';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { minimapWarning, minimapError } from 'vs/platform/theme/common/colorRegistry';\n\nfunction MODEL_ID(resource: URI): string {\n\treturn resource.toString();\n}\n\nclass MarkerDecorations extends Disposable {\n\n\tprivate readonly _markersData: Map<string, IMarker> = new Map<string, IMarker>();\n\n\tconstructor(\n\t\treadonly model: ITextModel\n\t) {\n\t\tsuper();\n\t\tthis._register(toDisposable(() => {\n\t\t\tthis.model.deltaDecorations([...this._markersData.keys()], []);\n\t\t\tthis._markersData.clear();\n\t\t}));\n\t}\n\n\tpublic update(markers: IMarker[], newDecorations: IModelDeltaDecoration[]): boolean {\n\t\tconst oldIds = [...this._markersData.keys()];\n\t\tthis._markersData.clear();\n\t\tconst ids = this.model.deltaDecorations(oldIds, newDecorations);\n\t\tfor (let index = 0; index < ids.length; index++) {\n\t\t\tthis._markersData.set(ids[index], markers[index]);\n\t\t}\n\t\treturn oldIds.length !== 0 || ids.length !== 0;\n\t}\n\n\tgetMarker(decoration: IModelDecoration): IMarker | undefined {\n\t\treturn this._markersData.get(decoration.id);\n\t}\n\n\tgetMarkers(): [Range, IMarker][] {\n\t\tconst res: [Range, IMarker][] = [];\n\t\tthis._markersData.forEach((marker, id) => {\n\t\t\tlet range = this.model.getDecorationRange(id);\n\t\t\tif (range) {\n\t\t\t\tres.push([range, marker]);\n\t\t\t}\n\t\t});\n\t\treturn res;\n\t}\n}\n\nexport class MarkerDecorationsService extends Disposable implements IMarkerDecorationsService {\n\n\tdeclare readonly _serviceBrand: undefined;\n\n\tprivate readonly _onDidChangeMarker = this._register(new Emitter<ITextModel>());\n\treadonly onDidChangeMarker: Event<ITextModel> = this._onDidChangeMarker.event;\n\n\tprivate readonly _markerDecorations = new Map<string, MarkerDecorations>();\n\n\tconstructor(\n\t\t@IModelService modelService: IModelService,\n\t\t@IMarkerService private readonly _markerService: IMarkerService\n\t) {\n\t\tsuper();\n\t\tmodelService.getModels().forEach(model => this._onModelAdded(model));\n\t\tthis._register(modelService.onModelAdded(this._onModelAdded, this));\n\t\tthis._register(modelService.onModelRemoved(this._onModelRemoved, this));\n\t\tthis._register(this._markerService.onMarkerChanged(this._handleMarkerChange, this));\n\t}\n\n\toverride dispose() {\n\t\tsuper.dispose();\n\t\tthis._markerDecorations.forEach(value => value.dispose());\n\t\tthis._markerDecorations.clear();\n\t}\n\n\tgetMarker(uri: URI, decoration: IModelDecoration): IMarker | null {\n\t\tconst markerDecorations = this._markerDecorations.get(MODEL_ID(uri));\n\t\treturn markerDecorations ? (markerDecorations.getMarker(decoration) || null) : null;\n\t}\n\n\tgetLiveMarkers(uri: URI): [Range, IMarker][] {\n\t\tconst markerDecorations = this._markerDecorations.get(MODEL_ID(uri));\n\t\treturn markerDecorations ? markerDecorations.getMarkers() : [];\n\t}\n\n\tprivate _handleMarkerChange(changedResources: readonly URI[]): void {\n\t\tchangedResources.forEach((resource) => {\n\t\t\tconst markerDecorations = this._markerDecorations.get(MODEL_ID(resource));\n\t\t\tif (markerDecorations) {\n\t\t\t\tthis._updateDecorations(markerDecorations);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _onModelAdded(model: ITextModel): void {\n\t\tconst markerDecorations = new MarkerDecorations(model);\n\t\tthis._markerDecorations.set(MODEL_ID(model.uri), markerDecorations);\n\t\tthis._updateDecorations(markerDecorations);\n\t}\n\n\tprivate _onModelRemoved(model: ITextModel): void {\n\t\tconst markerDecorations = this._markerDecorations.get(MODEL_ID(model.uri));\n\t\tif (markerDecorations) {\n\t\t\tmarkerDecorations.dispose();\n\t\t\tthis._markerDecorations.delete(MODEL_ID(model.uri));\n\t\t}\n\n\t\t// clean up markers for internal, transient models\n\t\tif (model.uri.scheme === Schemas.inMemory\n\t\t\t|| model.uri.scheme === Schemas.internal\n\t\t\t|| model.uri.scheme === Schemas.vscode) {\n\t\t\tif (this._markerService) {\n\t\t\t\tthis._markerService.read({ resource: model.uri }).map(marker => marker.owner).forEach(owner => this._markerService.remove(owner, [model.uri]));\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _updateDecorations(markerDecorations: MarkerDecorations): void {\n\t\t// Limit to the first 500 errors/warnings\n\t\tconst markers = this._markerService.read({ resource: markerDecorations.model.uri, take: 500 });\n\t\tlet newModelDecorations: IModelDeltaDecoration[] = markers.map((marker) => {\n\t\t\treturn {\n\t\t\t\trange: this._createDecorationRange(markerDecorations.model, marker),\n\t\t\t\toptions: this._createDecorationOption(marker)\n\t\t\t};\n\t\t});\n\t\tif (markerDecorations.update(markers, newModelDecorations)) {\n\t\t\tthis._onDidChangeMarker.fire(markerDecorations.model);\n\t\t}\n\t}\n\n\tprivate _createDecorationRange(model: ITextModel, rawMarker: IMarker): Range {\n\n\t\tlet ret = Range.lift(rawMarker);\n\n\t\tif (rawMarker.severity === MarkerSeverity.Hint && !this._hasMarkerTag(rawMarker, MarkerTag.Unnecessary) && !this._hasMarkerTag(rawMarker, MarkerTag.Deprecated)) {\n\t\t\t// * never render hints on multiple lines\n\t\t\t// * make enough space for three dots\n\t\t\tret = ret.setEndPosition(ret.startLineNumber, ret.startColumn + 2);\n\t\t}\n\n\t\tret = model.validateRange(ret);\n\n\t\tif (ret.isEmpty()) {\n\t\t\tlet word = model.getWordAtPosition(ret.getStartPosition());\n\t\t\tif (word) {\n\t\t\t\tret = new Range(ret.startLineNumber, word.startColumn, ret.endLineNumber, word.endColumn);\n\t\t\t} else {\n\t\t\t\tlet maxColumn = model.getLineLastNonWhitespaceColumn(ret.startLineNumber) ||\n\t\t\t\t\tmodel.getLineMaxColumn(ret.startLineNumber);\n\n\t\t\t\tif (maxColumn === 1) {\n\t\t\t\t\t// empty line\n\t\t\t\t\t// console.warn('marker on empty line:', marker);\n\t\t\t\t} else if (ret.endColumn >= maxColumn) {\n\t\t\t\t\t// behind eol\n\t\t\t\t\tret = new Range(ret.startLineNumber, maxColumn - 1, ret.endLineNumber, maxColumn);\n\t\t\t\t} else {\n\t\t\t\t\t// extend marker to width = 1\n\t\t\t\t\tret = new Range(ret.startLineNumber, ret.startColumn, ret.endLineNumber, ret.endColumn + 1);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (rawMarker.endColumn === Number.MAX_VALUE && rawMarker.startColumn === 1 && ret.startLineNumber === ret.endLineNumber) {\n\t\t\tlet minColumn = model.getLineFirstNonWhitespaceColumn(rawMarker.startLineNumber);\n\t\t\tif (minColumn < ret.endColumn) {\n\t\t\t\tret = new Range(ret.startLineNumber, minColumn, ret.endLineNumber, ret.endColumn);\n\t\t\t\trawMarker.startColumn = minColumn;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n\n\tprivate _createDecorationOption(marker: IMarker): IModelDecorationOptions {\n\n\t\tlet className: string | undefined;\n\t\tlet color: ThemeColor | undefined = undefined;\n\t\tlet zIndex: number;\n\t\tlet inlineClassName: string | undefined = undefined;\n\t\tlet minimap: IModelDecorationMinimapOptions | undefined;\n\n\t\tswitch (marker.severity) {\n\t\t\tcase MarkerSeverity.Hint:\n\t\t\t\tif (this._hasMarkerTag(marker, MarkerTag.Deprecated)) {\n\t\t\t\t\tclassName = undefined;\n\t\t\t\t} else if (this._hasMarkerTag(marker, MarkerTag.Unnecessary)) {\n\t\t\t\t\tclassName = ClassName.EditorUnnecessaryDecoration;\n\t\t\t\t} else {\n\t\t\t\t\tclassName = ClassName.EditorHintDecoration;\n\t\t\t\t}\n\t\t\t\tzIndex = 0;\n\t\t\t\tbreak;\n\t\t\tcase MarkerSeverity.Warning:\n\t\t\t\tclassName = ClassName.EditorWarningDecoration;\n\t\t\t\tcolor = themeColorFromId(overviewRulerWarning);\n\t\t\t\tzIndex = 20;\n\t\t\t\tminimap = {\n\t\t\t\t\tcolor: themeColorFromId(minimapWarning),\n\t\t\t\t\tposition: MinimapPosition.Inline\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase MarkerSeverity.Info:\n\t\t\t\tclassName = ClassName.EditorInfoDecoration;\n\t\t\t\tcolor = themeColorFromId(overviewRulerInfo);\n\t\t\t\tzIndex = 10;\n\t\t\t\tbreak;\n\t\t\tcase MarkerSeverity.Error:\n\t\t\tdefault:\n\t\t\t\tclassName = ClassName.EditorErrorDecoration;\n\t\t\t\tcolor = themeColorFromId(overviewRulerError);\n\t\t\t\tzIndex = 30;\n\t\t\t\tminimap = {\n\t\t\t\t\tcolor: themeColorFromId(minimapError),\n\t\t\t\t\tposition: MinimapPosition.Inline\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (marker.tags) {\n\t\t\tif (marker.tags.indexOf(MarkerTag.Unnecessary) !== -1) {\n\t\t\t\tinlineClassName = ClassName.EditorUnnecessaryInlineDecoration;\n\t\t\t}\n\t\t\tif (marker.tags.indexOf(MarkerTag.Deprecated) !== -1) {\n\t\t\t\tinlineClassName = ClassName.EditorDeprecatedInlineDecoration;\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\t\tclassName,\n\t\t\tshowIfCollapsed: true,\n\t\t\toverviewRuler: {\n\t\t\t\tcolor,\n\t\t\t\tposition: OverviewRulerLane.Right\n\t\t\t},\n\t\t\tminimap,\n\t\t\tzIndex,\n\t\t\tinlineClassName,\n\t\t};\n\t}\n\n\tprivate _hasMarkerTag(marker: IMarker, tag: MarkerTag): boolean {\n\t\tif (marker.tags) {\n\t\t\treturn marker.tags.indexOf(tag) >= 0;\n\t\t}\n\t\treturn false;\n\t}\n}\n"]}