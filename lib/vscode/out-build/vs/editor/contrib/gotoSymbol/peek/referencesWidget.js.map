{"version":3,"sources":["vs/editor/contrib/gotoSymbol/peek/referencesWidget.ts"],"names":[],"mappings":"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","file":"referencesWidget.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./referencesWidget';\nimport * as dom from 'vs/base/browser/dom';\nimport { IMouseEvent } from 'vs/base/browser/mouseEvent';\nimport { Orientation } from 'vs/base/browser/ui/sash/sash';\nimport { Color } from 'vs/base/common/color';\nimport { Emitter, Event } from 'vs/base/common/event';\nimport { dispose, IDisposable, IReference, DisposableStore } from 'vs/base/common/lifecycle';\nimport { Schemas } from 'vs/base/common/network';\nimport { basenameOrAuthority, dirname } from 'vs/base/common/resources';\nimport { ICodeEditor } from 'vs/editor/browser/editorBrowser';\nimport { EmbeddedCodeEditorWidget } from 'vs/editor/browser/widget/embeddedCodeEditorWidget';\nimport { IEditorOptions } from 'vs/editor/common/config/editorOptions';\nimport { IRange, Range } from 'vs/editor/common/core/range';\nimport { ScrollType } from 'vs/editor/common/editorCommon';\nimport { IModelDeltaDecoration, TrackedRangeStickiness } from 'vs/editor/common/model';\nimport { ModelDecorationOptions, TextModel } from 'vs/editor/common/model/textModel';\nimport { Location } from 'vs/editor/common/modes';\nimport { ITextEditorModel, ITextModelService } from 'vs/editor/common/services/resolverService';\nimport { AccessibilityProvider, DataSource, Delegate, FileReferencesRenderer, OneReferenceRenderer, TreeElement, StringRepresentationProvider, IdentityProvider } from 'vs/editor/contrib/gotoSymbol/peek/referencesTree';\nimport * as nls from 'vs/nls';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { ILabelService } from 'vs/platform/label/common/label';\nimport { WorkbenchAsyncDataTree, IWorkbenchAsyncDataTreeOptions } from 'vs/platform/list/browser/listService';\nimport { activeContrastBorder } from 'vs/platform/theme/common/colorRegistry';\nimport { IColorTheme, IThemeService, registerThemingParticipant } from 'vs/platform/theme/common/themeService';\nimport * as peekView from 'vs/editor/contrib/peekView/peekView';\nimport { FileReferences, OneReference, ReferencesModel } from '../referencesModel';\nimport { FuzzyScore } from 'vs/base/common/filters';\nimport { SplitView, Sizing } from 'vs/base/browser/ui/splitview/splitview';\nimport { IUndoRedoService } from 'vs/platform/undoRedo/common/undoRedo';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { KeyCode } from 'vs/base/common/keyCodes';\n\n\nclass DecorationsManager implements IDisposable {\n\n\tprivate static readonly DecorationOptions = ModelDecorationOptions.register({\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tclassName: 'reference-decoration'\n\t});\n\n\tprivate _decorations = new Map<string, OneReference>();\n\tprivate _decorationIgnoreSet = new Set<string>();\n\tprivate readonly _callOnDispose = new DisposableStore();\n\tprivate readonly _callOnModelChange = new DisposableStore();\n\n\tconstructor(private _editor: ICodeEditor, private _model: ReferencesModel) {\n\t\tthis._callOnDispose.add(this._editor.onDidChangeModel(() => this._onModelChanged()));\n\t\tthis._onModelChanged();\n\t}\n\n\tdispose(): void {\n\t\tthis._callOnModelChange.dispose();\n\t\tthis._callOnDispose.dispose();\n\t\tthis.removeDecorations();\n\t}\n\n\tprivate _onModelChanged(): void {\n\t\tthis._callOnModelChange.clear();\n\t\tconst model = this._editor.getModel();\n\t\tif (!model) {\n\t\t\treturn;\n\t\t}\n\t\tfor (let ref of this._model.references) {\n\t\t\tif (ref.uri.toString() === model.uri.toString()) {\n\t\t\t\tthis._addDecorations(ref.parent);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _addDecorations(reference: FileReferences): void {\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\t\tthis._callOnModelChange.add(this._editor.getModel().onDidChangeDecorations(() => this._onDecorationChanged()));\n\n\t\tconst newDecorations: IModelDeltaDecoration[] = [];\n\t\tconst newDecorationsActualIndex: number[] = [];\n\n\t\tfor (let i = 0, len = reference.children.length; i < len; i++) {\n\t\t\tlet oneReference = reference.children[i];\n\t\t\tif (this._decorationIgnoreSet.has(oneReference.id)) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (oneReference.uri.toString() !== this._editor.getModel().uri.toString()) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tnewDecorations.push({\n\t\t\t\trange: oneReference.range,\n\t\t\t\toptions: DecorationsManager.DecorationOptions\n\t\t\t});\n\t\t\tnewDecorationsActualIndex.push(i);\n\t\t}\n\n\t\tconst decorations = this._editor.deltaDecorations([], newDecorations);\n\t\tfor (let i = 0; i < decorations.length; i++) {\n\t\t\tthis._decorations.set(decorations[i], reference.children[newDecorationsActualIndex[i]]);\n\t\t}\n\t}\n\n\tprivate _onDecorationChanged(): void {\n\t\tconst toRemove: string[] = [];\n\n\t\tconst model = this._editor.getModel();\n\t\tif (!model) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (let [decorationId, reference] of this._decorations) {\n\n\t\t\tconst newRange = model.getDecorationRange(decorationId);\n\n\t\t\tif (!newRange) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tlet ignore = false;\n\t\t\tif (Range.equalsRange(newRange, reference.range)) {\n\t\t\t\tcontinue;\n\n\t\t\t}\n\n\t\t\tif (Range.spansMultipleLines(newRange)) {\n\t\t\t\tignore = true;\n\n\t\t\t} else {\n\t\t\t\tconst lineLength = reference.range.endColumn - reference.range.startColumn;\n\t\t\t\tconst newLineLength = newRange.endColumn - newRange.startColumn;\n\n\t\t\t\tif (lineLength !== newLineLength) {\n\t\t\t\t\tignore = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (ignore) {\n\t\t\t\tthis._decorationIgnoreSet.add(reference.id);\n\t\t\t\ttoRemove.push(decorationId);\n\t\t\t} else {\n\t\t\t\treference.range = newRange;\n\t\t\t}\n\t\t}\n\n\t\tfor (let i = 0, len = toRemove.length; i < len; i++) {\n\t\t\tthis._decorations.delete(toRemove[i]);\n\t\t}\n\t\tthis._editor.deltaDecorations(toRemove, []);\n\t}\n\n\tremoveDecorations(): void {\n\t\tthis._editor.deltaDecorations([...this._decorations.keys()], []);\n\t\tthis._decorations.clear();\n\t}\n}\n\nexport class LayoutData {\n\tratio: number = 0.7;\n\theightInLines: number = 18;\n\n\tstatic fromJSON(raw: string): LayoutData {\n\t\tlet ratio: number | undefined;\n\t\tlet heightInLines: number | undefined;\n\t\ttry {\n\t\t\tconst data = <LayoutData>JSON.parse(raw);\n\t\t\tratio = data.ratio;\n\t\t\theightInLines = data.heightInLines;\n\t\t} catch {\n\t\t\t//\n\t\t}\n\t\treturn {\n\t\t\tratio: ratio || 0.7,\n\t\t\theightInLines: heightInLines || 18\n\t\t};\n\t}\n}\n\nexport interface SelectionEvent {\n\treadonly kind: 'goto' | 'show' | 'side' | 'open';\n\treadonly source: 'editor' | 'tree' | 'title';\n\treadonly element?: Location;\n}\n\nclass ReferencesTree extends WorkbenchAsyncDataTree<ReferencesModel | FileReferences, TreeElement, FuzzyScore> { }\n\n/**\n * ZoneWidget that is shown inside the editor\n */\nexport class ReferenceWidget extends peekView.PeekViewWidget {\n\n\tprivate _model?: ReferencesModel;\n\tprivate _decorationsManager?: DecorationsManager;\n\n\tprivate readonly _disposeOnNewModel = new DisposableStore();\n\tprivate readonly _callOnDispose = new DisposableStore();\n\n\tprivate readonly _onDidSelectReference = new Emitter<SelectionEvent>();\n\treadonly onDidSelectReference = this._onDidSelectReference.event;\n\n\tprivate _tree!: ReferencesTree;\n\tprivate _treeContainer!: HTMLElement;\n\tprivate _splitView!: SplitView;\n\tprivate _preview!: ICodeEditor;\n\tprivate _previewModelReference!: IReference<ITextEditorModel>;\n\tprivate _previewNotAvailableMessage!: TextModel;\n\tprivate _previewContainer!: HTMLElement;\n\tprivate _messageContainer!: HTMLElement;\n\tprivate _dim = new dom.Dimension(0, 0);\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\tprivate _defaultTreeKeyboardSupport: boolean,\n\t\tpublic layoutData: LayoutData,\n\t\t@IThemeService themeService: IThemeService,\n\t\t@ITextModelService private readonly _textModelResolverService: ITextModelService,\n\t\t@IInstantiationService private readonly _instantiationService: IInstantiationService,\n\t\t@peekView.IPeekViewService private readonly _peekViewService: peekView.IPeekViewService,\n\t\t@ILabelService private readonly _uriLabel: ILabelService,\n\t\t@IUndoRedoService private readonly _undoRedoService: IUndoRedoService,\n\t\t@IKeybindingService private readonly _keybindingService: IKeybindingService,\n\t) {\n\t\tsuper(editor, { showFrame: false, showArrow: true, isResizeable: true, isAccessible: true }, _instantiationService);\n\n\t\tthis._applyTheme(themeService.getColorTheme());\n\t\tthis._callOnDispose.add(themeService.onDidColorThemeChange(this._applyTheme.bind(this)));\n\t\tthis._peekViewService.addExclusiveWidget(editor, this);\n\t\tthis.create();\n\t}\n\n\toverride dispose(): void {\n\t\tthis.setModel(undefined);\n\t\tthis._callOnDispose.dispose();\n\t\tthis._disposeOnNewModel.dispose();\n\t\tdispose(this._preview);\n\t\tdispose(this._previewNotAvailableMessage);\n\t\tdispose(this._tree);\n\t\tdispose(this._previewModelReference);\n\t\tthis._splitView.dispose();\n\t\tsuper.dispose();\n\t}\n\n\tprivate _applyTheme(theme: IColorTheme) {\n\t\tconst borderColor = theme.getColor(peekView.peekViewBorder) || Color.transparent;\n\t\tthis.style({\n\t\t\tarrowColor: borderColor,\n\t\t\tframeColor: borderColor,\n\t\t\theaderBackgroundColor: theme.getColor(peekView.peekViewTitleBackground) || Color.transparent,\n\t\t\tprimaryHeadingColor: theme.getColor(peekView.peekViewTitleForeground),\n\t\t\tsecondaryHeadingColor: theme.getColor(peekView.peekViewTitleInfoForeground)\n\t\t});\n\t}\n\n\toverride show(where: IRange) {\n\t\tthis.editor.revealRangeInCenterIfOutsideViewport(where, ScrollType.Smooth);\n\t\tsuper.show(where, this.layoutData.heightInLines || 18);\n\t}\n\n\tfocusOnReferenceTree(): void {\n\t\tthis._tree.domFocus();\n\t}\n\n\tfocusOnPreviewEditor(): void {\n\t\tthis._preview.focus();\n\t}\n\n\tisPreviewEditorFocused(): boolean {\n\t\treturn this._preview.hasTextFocus();\n\t}\n\n\tprotected override _onTitleClick(e: IMouseEvent): void {\n\t\tif (this._preview && this._preview.getModel()) {\n\t\t\tthis._onDidSelectReference.fire({\n\t\t\t\telement: this._getFocusedReference(),\n\t\t\t\tkind: e.ctrlKey || e.metaKey || e.altKey ? 'side' : 'open',\n\t\t\t\tsource: 'title'\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected _fillBody(containerElement: HTMLElement): void {\n\t\tthis.setCssClass('reference-zone-widget');\n\n\t\t// message pane\n\t\tthis._messageContainer = dom.append(containerElement, dom.$('div.messages'));\n\t\tdom.hide(this._messageContainer);\n\n\t\tthis._splitView = new SplitView(containerElement, { orientation: Orientation.HORIZONTAL });\n\n\t\t// editor\n\t\tthis._previewContainer = dom.append(containerElement, dom.$('div.preview.inline'));\n\t\tlet options: IEditorOptions = {\n\t\t\tscrollBeyondLastLine: false,\n\t\t\tscrollbar: {\n\t\t\t\tverticalScrollbarSize: 14,\n\t\t\t\thorizontal: 'auto',\n\t\t\t\tuseShadows: true,\n\t\t\t\tverticalHasArrows: false,\n\t\t\t\thorizontalHasArrows: false,\n\t\t\t\talwaysConsumeMouseWheel: false\n\t\t\t},\n\t\t\toverviewRulerLanes: 2,\n\t\t\tfixedOverflowWidgets: true,\n\t\t\tminimap: {\n\t\t\t\tenabled: false\n\t\t\t}\n\t\t};\n\t\tthis._preview = this._instantiationService.createInstance(EmbeddedCodeEditorWidget, this._previewContainer, options, this.editor);\n\t\tdom.hide(this._previewContainer);\n\t\tthis._previewNotAvailableMessage = new TextModel(nls.localize('missingPreviewMessage', \"no preview available\"), TextModel.DEFAULT_CREATION_OPTIONS, null, null, this._undoRedoService);\n\n\t\t// tree\n\t\tthis._treeContainer = dom.append(containerElement, dom.$('div.ref-tree.inline'));\n\t\tconst treeOptions: IWorkbenchAsyncDataTreeOptions<TreeElement, FuzzyScore> = {\n\t\t\tkeyboardSupport: this._defaultTreeKeyboardSupport,\n\t\t\taccessibilityProvider: new AccessibilityProvider(),\n\t\t\tkeyboardNavigationLabelProvider: this._instantiationService.createInstance(StringRepresentationProvider),\n\t\t\tidentityProvider: new IdentityProvider(),\n\t\t\topenOnSingleClick: true,\n\t\t\tselectionNavigation: true,\n\t\t\toverrideStyles: {\n\t\t\t\tlistBackground: peekView.peekViewResultsBackground\n\t\t\t}\n\t\t};\n\t\tif (this._defaultTreeKeyboardSupport) {\n\t\t\t// the tree will consume `Escape` and prevent the widget from closing\n\t\t\tthis._callOnDispose.add(dom.addStandardDisposableListener(this._treeContainer, 'keydown', (e) => {\n\t\t\t\tif (e.equals(KeyCode.Escape)) {\n\t\t\t\t\tthis._keybindingService.dispatchEvent(e, e.target);\n\t\t\t\t\te.stopPropagation();\n\t\t\t\t}\n\t\t\t}, true));\n\t\t}\n\t\tthis._tree = this._instantiationService.createInstance(\n\t\t\tReferencesTree,\n\t\t\t'ReferencesWidget',\n\t\t\tthis._treeContainer,\n\t\t\tnew Delegate(),\n\t\t\t[\n\t\t\t\tthis._instantiationService.createInstance(FileReferencesRenderer),\n\t\t\t\tthis._instantiationService.createInstance(OneReferenceRenderer),\n\t\t\t],\n\t\t\tthis._instantiationService.createInstance(DataSource),\n\t\t\ttreeOptions,\n\t\t);\n\n\t\t// split stuff\n\t\tthis._splitView.addView({\n\t\t\tonDidChange: Event.None,\n\t\t\telement: this._previewContainer,\n\t\t\tminimumSize: 200,\n\t\t\tmaximumSize: Number.MAX_VALUE,\n\t\t\tlayout: (width) => {\n\t\t\t\tthis._preview.layout({ height: this._dim.height, width });\n\t\t\t}\n\t\t}, Sizing.Distribute);\n\n\t\tthis._splitView.addView({\n\t\t\tonDidChange: Event.None,\n\t\t\telement: this._treeContainer,\n\t\t\tminimumSize: 100,\n\t\t\tmaximumSize: Number.MAX_VALUE,\n\t\t\tlayout: (width) => {\n\t\t\t\tthis._treeContainer.style.height = `${this._dim.height}px`;\n\t\t\t\tthis._treeContainer.style.width = `${width}px`;\n\t\t\t\tthis._tree.layout(this._dim.height, width);\n\t\t\t}\n\t\t}, Sizing.Distribute);\n\n\t\tthis._disposables.add(this._splitView.onDidSashChange(() => {\n\t\t\tif (this._dim.width) {\n\t\t\t\tthis.layoutData.ratio = this._splitView.getViewSize(0) / this._dim.width;\n\t\t\t}\n\t\t}, undefined));\n\n\t\t// listen on selection and focus\n\t\tlet onEvent = (element: any, kind: 'show' | 'goto' | 'side') => {\n\t\t\tif (element instanceof OneReference) {\n\t\t\t\tif (kind === 'show') {\n\t\t\t\t\tthis._revealReference(element, false);\n\t\t\t\t}\n\t\t\t\tthis._onDidSelectReference.fire({ element, kind, source: 'tree' });\n\t\t\t}\n\t\t};\n\t\tthis._tree.onDidOpen(e => {\n\t\t\tif (e.sideBySide) {\n\t\t\t\tonEvent(e.element, 'side');\n\t\t\t} else if (e.editorOptions.pinned) {\n\t\t\t\tonEvent(e.element, 'goto');\n\t\t\t} else {\n\t\t\t\tonEvent(e.element, 'show');\n\t\t\t}\n\t\t});\n\n\t\tdom.hide(this._treeContainer);\n\t}\n\n\tprotected override _onWidth(width: number) {\n\t\tif (this._dim) {\n\t\t\tthis._doLayoutBody(this._dim.height, width);\n\t\t}\n\t}\n\n\tprotected override _doLayoutBody(heightInPixel: number, widthInPixel: number): void {\n\t\tsuper._doLayoutBody(heightInPixel, widthInPixel);\n\t\tthis._dim = new dom.Dimension(widthInPixel, heightInPixel);\n\t\tthis.layoutData.heightInLines = this._viewZone ? this._viewZone.heightInLines : this.layoutData.heightInLines;\n\t\tthis._splitView.layout(widthInPixel);\n\t\tthis._splitView.resizeView(0, widthInPixel * this.layoutData.ratio);\n\t}\n\n\tsetSelection(selection: OneReference): Promise<any> {\n\t\treturn this._revealReference(selection, true).then(() => {\n\t\t\tif (!this._model) {\n\t\t\t\t// disposed\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// show in tree\n\t\t\tthis._tree.setSelection([selection]);\n\t\t\tthis._tree.setFocus([selection]);\n\t\t});\n\t}\n\n\tsetModel(newModel: ReferencesModel | undefined): Promise<any> {\n\t\t// clean up\n\t\tthis._disposeOnNewModel.clear();\n\t\tthis._model = newModel;\n\t\tif (this._model) {\n\t\t\treturn this._onNewModel();\n\t\t}\n\t\treturn Promise.resolve();\n\t}\n\n\tprivate _onNewModel(): Promise<any> {\n\t\tif (!this._model) {\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tif (this._model.isEmpty) {\n\t\t\tthis.setTitle('');\n\t\t\tthis._messageContainer.innerText = nls.localize('noResults', \"No results\");\n\t\t\tdom.show(this._messageContainer);\n\t\t\treturn Promise.resolve(undefined);\n\t\t}\n\n\t\tdom.hide(this._messageContainer);\n\t\tthis._decorationsManager = new DecorationsManager(this._preview, this._model);\n\t\tthis._disposeOnNewModel.add(this._decorationsManager);\n\n\t\t// listen on model changes\n\t\tthis._disposeOnNewModel.add(this._model.onDidChangeReferenceRange(reference => this._tree.rerender(reference)));\n\n\t\t// listen on editor\n\t\tthis._disposeOnNewModel.add(this._preview.onMouseDown(e => {\n\t\t\tconst { event, target } = e;\n\t\t\tif (event.detail !== 2) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst element = this._getFocusedReference();\n\t\t\tif (!element) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis._onDidSelectReference.fire({\n\t\t\t\telement: { uri: element.uri, range: target.range! },\n\t\t\t\tkind: (event.ctrlKey || event.metaKey || event.altKey) ? 'side' : 'open',\n\t\t\t\tsource: 'editor'\n\t\t\t});\n\t\t}));\n\n\t\t// make sure things are rendered\n\t\tthis.container!.classList.add('results-loaded');\n\t\tdom.show(this._treeContainer);\n\t\tdom.show(this._previewContainer);\n\t\tthis._splitView.layout(this._dim.width);\n\t\tthis.focusOnReferenceTree();\n\n\t\t// pick input and a reference to begin with\n\t\treturn this._tree.setInput(this._model.groups.length === 1 ? this._model.groups[0] : this._model);\n\t}\n\n\tprivate _getFocusedReference(): OneReference | undefined {\n\t\tconst [element] = this._tree.getFocus();\n\t\tif (element instanceof OneReference) {\n\t\t\treturn element;\n\t\t} else if (element instanceof FileReferences) {\n\t\t\tif (element.children.length > 0) {\n\t\t\t\treturn element.children[0];\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tasync revealReference(reference: OneReference): Promise<void> {\n\t\tawait this._revealReference(reference, false);\n\t\tthis._onDidSelectReference.fire({ element: reference, kind: 'goto', source: 'tree' });\n\t}\n\n\tprivate _revealedReference?: OneReference;\n\n\tprivate async _revealReference(reference: OneReference, revealParent: boolean): Promise<void> {\n\n\t\t// check if there is anything to do...\n\t\tif (this._revealedReference === reference) {\n\t\t\treturn;\n\t\t}\n\t\tthis._revealedReference = reference;\n\n\t\t// Update widget header\n\t\tif (reference.uri.scheme !== Schemas.inMemory) {\n\t\t\tthis.setTitle(basenameOrAuthority(reference.uri), this._uriLabel.getUriLabel(dirname(reference.uri)));\n\t\t} else {\n\t\t\tthis.setTitle(nls.localize('peekView.alternateTitle', \"References\"));\n\t\t}\n\n\t\tconst promise = this._textModelResolverService.createModelReference(reference.uri);\n\n\t\tif (this._tree.getInput() === reference.parent) {\n\t\t\tthis._tree.reveal(reference);\n\t\t} else {\n\t\t\tif (revealParent) {\n\t\t\t\tthis._tree.reveal(reference.parent);\n\t\t\t}\n\t\t\tawait this._tree.expand(reference.parent);\n\t\t\tthis._tree.reveal(reference);\n\t\t}\n\n\t\tconst ref = await promise;\n\n\t\tif (!this._model) {\n\t\t\t// disposed\n\t\t\tref.dispose();\n\t\t\treturn;\n\t\t}\n\n\t\tdispose(this._previewModelReference);\n\n\t\t// show in editor\n\t\tconst model = ref.object;\n\t\tif (model) {\n\t\t\tconst scrollType = this._preview.getModel() === model.textEditorModel ? ScrollType.Smooth : ScrollType.Immediate;\n\t\t\tconst sel = Range.lift(reference.range).collapseToStart();\n\t\t\tthis._previewModelReference = ref;\n\t\t\tthis._preview.setModel(model.textEditorModel);\n\t\t\tthis._preview.setSelection(sel);\n\t\t\tthis._preview.revealRangeInCenter(sel, scrollType);\n\t\t} else {\n\t\t\tthis._preview.setModel(this._previewNotAvailableMessage);\n\t\t\tref.dispose();\n\t\t}\n\t}\n}\n\n// theming\n\n\nregisterThemingParticipant((theme, collector) => {\n\tconst findMatchHighlightColor = theme.getColor(peekView.peekViewResultsMatchHighlight);\n\tif (findMatchHighlightColor) {\n\t\tcollector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { background-color: ${findMatchHighlightColor}; }`);\n\t}\n\tconst referenceHighlightColor = theme.getColor(peekView.peekViewEditorMatchHighlight);\n\tif (referenceHighlightColor) {\n\t\tcollector.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { background-color: ${referenceHighlightColor}; }`);\n\t}\n\tconst referenceHighlightBorder = theme.getColor(peekView.peekViewEditorMatchHighlightBorder);\n\tif (referenceHighlightBorder) {\n\t\tcollector.addRule(`.monaco-editor .reference-zone-widget .preview .reference-decoration { border: 2px solid ${referenceHighlightBorder}; box-sizing: border-box; }`);\n\t}\n\tconst hcOutline = theme.getColor(activeContrastBorder);\n\tif (hcOutline) {\n\t\tcollector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .referenceMatch .highlight { border: 1px dotted ${hcOutline}; box-sizing: border-box; }`);\n\t}\n\tconst resultsBackground = theme.getColor(peekView.peekViewResultsBackground);\n\tif (resultsBackground) {\n\t\tcollector.addRule(`.monaco-editor .reference-zone-widget .ref-tree { background-color: ${resultsBackground}; }`);\n\t}\n\tconst resultsMatchForeground = theme.getColor(peekView.peekViewResultsMatchForeground);\n\tif (resultsMatchForeground) {\n\t\tcollector.addRule(`.monaco-editor .reference-zone-widget .ref-tree { color: ${resultsMatchForeground}; }`);\n\t}\n\tconst resultsFileForeground = theme.getColor(peekView.peekViewResultsFileForeground);\n\tif (resultsFileForeground) {\n\t\tcollector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .reference-file { color: ${resultsFileForeground}; }`);\n\t}\n\tconst resultsSelectedBackground = theme.getColor(peekView.peekViewResultsSelectionBackground);\n\tif (resultsSelectedBackground) {\n\t\tcollector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { background-color: ${resultsSelectedBackground}; }`);\n\t}\n\tconst resultsSelectedForeground = theme.getColor(peekView.peekViewResultsSelectionForeground);\n\tif (resultsSelectedForeground) {\n\t\tcollector.addRule(`.monaco-editor .reference-zone-widget .ref-tree .monaco-list:focus .monaco-list-rows > .monaco-list-row.selected:not(.highlighted) { color: ${resultsSelectedForeground} !important; }`);\n\t}\n\tconst editorBackground = theme.getColor(peekView.peekViewEditorBackground);\n\tif (editorBackground) {\n\t\tcollector.addRule(\n\t\t\t`.monaco-editor .reference-zone-widget .preview .monaco-editor .monaco-editor-background,` +\n\t\t\t`.monaco-editor .reference-zone-widget .preview .monaco-editor .inputarea.ime-input {` +\n\t\t\t`\tbackground-color: ${editorBackground};` +\n\t\t\t`}`);\n\t}\n\tconst editorGutterBackground = theme.getColor(peekView.peekViewEditorGutterBackground);\n\tif (editorGutterBackground) {\n\t\tcollector.addRule(\n\t\t\t`.monaco-editor .reference-zone-widget .preview .monaco-editor .margin {` +\n\t\t\t`\tbackground-color: ${editorGutterBackground};` +\n\t\t\t`}`);\n\t}\n});\n"]}