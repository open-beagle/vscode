{"version":3,"sources":["vs/editor/contrib/gotoSymbol/link/goToDefinitionAtPosition.ts"],"names":[],"mappings":"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","file":"goToDefinitionAtPosition.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./goToDefinitionAtPosition';\nimport * as nls from 'vs/nls';\nimport { createCancelablePromise, CancelablePromise } from 'vs/base/common/async';\nimport { CancellationToken } from 'vs/base/common/cancellation';\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { MarkdownString } from 'vs/base/common/htmlContent';\nimport { IModeService } from 'vs/editor/common/services/modeService';\nimport { Range, IRange } from 'vs/editor/common/core/range';\nimport { IEditorContribution } from 'vs/editor/common/editorCommon';\nimport { DefinitionProviderRegistry, LocationLink } from 'vs/editor/common/modes';\nimport { ICodeEditor, MouseTargetType } from 'vs/editor/browser/editorBrowser';\nimport { registerEditorContribution } from 'vs/editor/browser/editorExtensions';\nimport { getDefinitionsAtPosition } from '../goToSymbol';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { ITextModelService } from 'vs/editor/common/services/resolverService';\nimport { registerThemingParticipant } from 'vs/platform/theme/common/themeService';\nimport { editorActiveLinkForeground } from 'vs/platform/theme/common/colorRegistry';\nimport { EditorState, CodeEditorStateFlag } from 'vs/editor/browser/core/editorState';\nimport { DefinitionAction } from '../goToCommands';\nimport { ClickLinkGesture, ClickLinkMouseEvent, ClickLinkKeyboardEvent } from 'vs/editor/contrib/gotoSymbol/link/clickLinkGesture';\nimport { IWordAtPosition, IModelDeltaDecoration, ITextModel, IFoundBracket } from 'vs/editor/common/model';\nimport { Position } from 'vs/editor/common/core/position';\nimport { withNullAsUndefined } from 'vs/base/common/types';\nimport { IKeyboardEvent } from 'vs/base/browser/keyboardEvent';\nimport { EditorOption } from 'vs/editor/common/config/editorOptions';\nimport { PeekContext } from 'vs/editor/contrib/peekView/peekView';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { ServicesAccessor } from 'vs/platform/instantiation/common/instantiation';\n\nexport class GotoDefinitionAtPositionEditorContribution implements IEditorContribution {\n\n\tpublic static readonly ID = 'editor.contrib.gotodefinitionatposition';\n\tstatic readonly MAX_SOURCE_PREVIEW_LINES = 8;\n\n\tprivate readonly editor: ICodeEditor;\n\tprivate readonly toUnhook = new DisposableStore();\n\tprivate readonly toUnhookForKeyboard = new DisposableStore();\n\tprivate linkDecorations: string[] = [];\n\tprivate currentWordAtPosition: IWordAtPosition | null = null;\n\tprivate previousPromise: CancelablePromise<LocationLink[] | null> | null = null;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\t@ITextModelService private readonly textModelResolverService: ITextModelService,\n\t\t@IModeService private readonly modeService: IModeService\n\t) {\n\t\tthis.editor = editor;\n\n\t\tlet linkGesture = new ClickLinkGesture(editor);\n\t\tthis.toUnhook.add(linkGesture);\n\n\t\tthis.toUnhook.add(linkGesture.onMouseMoveOrRelevantKeyDown(([mouseEvent, keyboardEvent]) => {\n\t\t\tthis.startFindDefinitionFromMouse(mouseEvent, withNullAsUndefined(keyboardEvent));\n\t\t}));\n\n\t\tthis.toUnhook.add(linkGesture.onExecute((mouseEvent: ClickLinkMouseEvent) => {\n\t\t\tif (this.isEnabled(mouseEvent)) {\n\t\t\t\tthis.gotoDefinition(mouseEvent.target.position!, mouseEvent.hasSideBySideModifier).then(() => {\n\t\t\t\t\tthis.removeLinkDecorations();\n\t\t\t\t}, (error: Error) => {\n\t\t\t\t\tthis.removeLinkDecorations();\n\t\t\t\t\tonUnexpectedError(error);\n\t\t\t\t});\n\t\t\t}\n\t\t}));\n\n\t\tthis.toUnhook.add(linkGesture.onCancel(() => {\n\t\t\tthis.removeLinkDecorations();\n\t\t\tthis.currentWordAtPosition = null;\n\t\t}));\n\t}\n\n\tstatic get(editor: ICodeEditor): GotoDefinitionAtPositionEditorContribution {\n\t\treturn editor.getContribution<GotoDefinitionAtPositionEditorContribution>(GotoDefinitionAtPositionEditorContribution.ID);\n\t}\n\n\tstartFindDefinitionFromCursor(position: Position) {\n\t\t// For issue: https://github.com/microsoft/vscode/issues/46257\n\t\t// equivalent to mouse move with meta/ctrl key\n\n\t\t// First find the definition and add decorations\n\t\t// to the editor to be shown with the content hover widget\n\t\treturn this.startFindDefinition(position).then(() => {\n\n\t\t\t// Add listeners for editor cursor move and key down events\n\t\t\t// Dismiss the \"extended\" editor decorations when the user hides\n\t\t\t// the hover widget. There is no event for the widget itself so these\n\t\t\t// serve as a best effort. After removing the link decorations, the hover\n\t\t\t// widget is clean and will only show declarations per next request.\n\t\t\tthis.toUnhookForKeyboard.add(this.editor.onDidChangeCursorPosition(() => {\n\t\t\t\tthis.currentWordAtPosition = null;\n\t\t\t\tthis.removeLinkDecorations();\n\t\t\t\tthis.toUnhookForKeyboard.clear();\n\t\t\t}));\n\n\t\t\tthis.toUnhookForKeyboard.add(this.editor.onKeyDown((e: IKeyboardEvent) => {\n\t\t\t\tif (e) {\n\t\t\t\t\tthis.currentWordAtPosition = null;\n\t\t\t\t\tthis.removeLinkDecorations();\n\t\t\t\t\tthis.toUnhookForKeyboard.clear();\n\t\t\t\t}\n\t\t\t}));\n\t\t});\n\t}\n\n\tprivate startFindDefinitionFromMouse(mouseEvent: ClickLinkMouseEvent, withKey?: ClickLinkKeyboardEvent): void {\n\n\t\t// check if we are active and on a content widget\n\t\tif (mouseEvent.target.type === MouseTargetType.CONTENT_WIDGET && this.linkDecorations.length > 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this.editor.hasModel() || !this.isEnabled(mouseEvent, withKey)) {\n\t\t\tthis.currentWordAtPosition = null;\n\t\t\tthis.removeLinkDecorations();\n\t\t\treturn;\n\t\t}\n\n\t\tconst position = mouseEvent.target.position!;\n\n\t\tthis.startFindDefinition(position);\n\t}\n\n\tprivate startFindDefinition(position: Position): Promise<number | undefined> {\n\n\t\t// Dispose listeners for updating decorations when using keyboard to show definition hover\n\t\tthis.toUnhookForKeyboard.clear();\n\n\t\t// Find word at mouse position\n\t\tconst word = position ? this.editor.getModel()?.getWordAtPosition(position) : null;\n\t\tif (!word) {\n\t\t\tthis.currentWordAtPosition = null;\n\t\t\tthis.removeLinkDecorations();\n\t\t\treturn Promise.resolve(0);\n\t\t}\n\n\t\t// Return early if word at position is still the same\n\t\tif (this.currentWordAtPosition && this.currentWordAtPosition.startColumn === word.startColumn && this.currentWordAtPosition.endColumn === word.endColumn && this.currentWordAtPosition.word === word.word) {\n\t\t\treturn Promise.resolve(0);\n\t\t}\n\n\t\tthis.currentWordAtPosition = word;\n\n\t\t// Find definition and decorate word if found\n\t\tlet state = new EditorState(this.editor, CodeEditorStateFlag.Position | CodeEditorStateFlag.Value | CodeEditorStateFlag.Selection | CodeEditorStateFlag.Scroll);\n\n\t\tif (this.previousPromise) {\n\t\t\tthis.previousPromise.cancel();\n\t\t\tthis.previousPromise = null;\n\t\t}\n\n\t\tthis.previousPromise = createCancelablePromise(token => this.findDefinition(position, token));\n\n\t\treturn this.previousPromise.then(results => {\n\t\t\tif (!results || !results.length || !state.validate(this.editor)) {\n\t\t\t\tthis.removeLinkDecorations();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Multiple results\n\t\t\tif (results.length > 1) {\n\t\t\t\tthis.addDecoration(\n\t\t\t\t\tnew Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn),\n\t\t\t\t\tnew MarkdownString().appendText(nls.localize('multipleResults', \"Click to show {0} definitions.\", results.length))\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Single result\n\t\t\telse {\n\t\t\t\tlet result = results[0];\n\n\t\t\t\tif (!result.uri) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis.textModelResolverService.createModelReference(result.uri).then(ref => {\n\n\t\t\t\t\tif (!ref.object || !ref.object.textEditorModel) {\n\t\t\t\t\t\tref.dispose();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst { object: { textEditorModel } } = ref;\n\t\t\t\t\tconst { startLineNumber } = result.range;\n\n\t\t\t\t\tif (startLineNumber < 1 || startLineNumber > textEditorModel.getLineCount()) {\n\t\t\t\t\t\t// invalid range\n\t\t\t\t\t\tref.dispose();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst previewValue = this.getPreviewValue(textEditorModel, startLineNumber, result);\n\n\t\t\t\t\tlet wordRange: Range;\n\t\t\t\t\tif (result.originSelectionRange) {\n\t\t\t\t\t\twordRange = Range.lift(result.originSelectionRange);\n\t\t\t\t\t} else {\n\t\t\t\t\t\twordRange = new Range(position.lineNumber, word.startColumn, position.lineNumber, word.endColumn);\n\t\t\t\t\t}\n\n\t\t\t\t\tconst modeId = this.modeService.getModeIdByFilepathOrFirstLine(textEditorModel.uri);\n\t\t\t\t\tthis.addDecoration(\n\t\t\t\t\t\twordRange,\n\t\t\t\t\t\tnew MarkdownString().appendCodeblock(modeId ? modeId : '', previewValue)\n\t\t\t\t\t);\n\t\t\t\t\tref.dispose();\n\t\t\t\t});\n\t\t\t}\n\t\t}).then(undefined, onUnexpectedError);\n\t}\n\n\tprivate getPreviewValue(textEditorModel: ITextModel, startLineNumber: number, result: LocationLink) {\n\t\tlet rangeToUse = result.targetSelectionRange ? result.range : this.getPreviewRangeBasedOnBrackets(textEditorModel, startLineNumber);\n\t\tconst numberOfLinesInRange = rangeToUse.endLineNumber - rangeToUse.startLineNumber;\n\t\tif (numberOfLinesInRange >= GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES) {\n\t\t\trangeToUse = this.getPreviewRangeBasedOnIndentation(textEditorModel, startLineNumber);\n\t\t}\n\n\t\tconst previewValue = this.stripIndentationFromPreviewRange(textEditorModel, startLineNumber, rangeToUse);\n\t\treturn previewValue;\n\t}\n\n\tprivate stripIndentationFromPreviewRange(textEditorModel: ITextModel, startLineNumber: number, previewRange: IRange) {\n\t\tconst startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n\t\tlet minIndent = startIndent;\n\n\t\tfor (let endLineNumber = startLineNumber + 1; endLineNumber < previewRange.endLineNumber; endLineNumber++) {\n\t\t\tconst endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n\t\t\tminIndent = Math.min(minIndent, endIndent);\n\t\t}\n\n\t\tconst previewValue = textEditorModel.getValueInRange(previewRange).replace(new RegExp(`^\\\\s{${minIndent - 1}}`, 'gm'), '').trim();\n\t\treturn previewValue;\n\t}\n\n\tprivate getPreviewRangeBasedOnIndentation(textEditorModel: ITextModel, startLineNumber: number) {\n\t\tconst startIndent = textEditorModel.getLineFirstNonWhitespaceColumn(startLineNumber);\n\t\tconst maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\n\t\tlet endLineNumber = startLineNumber + 1;\n\n\t\tfor (; endLineNumber < maxLineNumber; endLineNumber++) {\n\t\t\tlet endIndent = textEditorModel.getLineFirstNonWhitespaceColumn(endLineNumber);\n\n\t\t\tif (startIndent === endIndent) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\treturn new Range(startLineNumber, 1, endLineNumber + 1, 1);\n\t}\n\n\tprivate getPreviewRangeBasedOnBrackets(textEditorModel: ITextModel, startLineNumber: number) {\n\t\tconst maxLineNumber = Math.min(textEditorModel.getLineCount(), startLineNumber + GotoDefinitionAtPositionEditorContribution.MAX_SOURCE_PREVIEW_LINES);\n\n\t\tconst brackets: IFoundBracket[] = [];\n\n\t\tlet ignoreFirstEmpty = true;\n\t\tlet currentBracket = textEditorModel.findNextBracket(new Position(startLineNumber, 1));\n\t\twhile (currentBracket !== null) {\n\n\t\t\tif (brackets.length === 0) {\n\t\t\t\tbrackets.push(currentBracket);\n\t\t\t} else {\n\t\t\t\tconst lastBracket = brackets[brackets.length - 1];\n\t\t\t\tif (lastBracket.open[0] === currentBracket.open[0] && lastBracket.isOpen && !currentBracket.isOpen) {\n\t\t\t\t\tbrackets.pop();\n\t\t\t\t} else {\n\t\t\t\t\tbrackets.push(currentBracket);\n\t\t\t\t}\n\n\t\t\t\tif (brackets.length === 0) {\n\t\t\t\t\tif (ignoreFirstEmpty) {\n\t\t\t\t\t\tignoreFirstEmpty = false;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn new Range(startLineNumber, 1, currentBracket.range.endLineNumber + 1, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst maxColumn = textEditorModel.getLineMaxColumn(startLineNumber);\n\t\t\tlet nextLineNumber = currentBracket.range.endLineNumber;\n\t\t\tlet nextColumn = currentBracket.range.endColumn;\n\t\t\tif (maxColumn === currentBracket.range.endColumn) {\n\t\t\t\tnextLineNumber++;\n\t\t\t\tnextColumn = 1;\n\t\t\t}\n\n\t\t\tif (nextLineNumber > maxLineNumber) {\n\t\t\t\treturn new Range(startLineNumber, 1, maxLineNumber + 1, 1);\n\t\t\t}\n\n\t\t\tcurrentBracket = textEditorModel.findNextBracket(new Position(nextLineNumber, nextColumn));\n\t\t}\n\n\t\treturn new Range(startLineNumber, 1, maxLineNumber + 1, 1);\n\t}\n\n\tprivate addDecoration(range: Range, hoverMessage: MarkdownString): void {\n\n\t\tconst newDecorations: IModelDeltaDecoration = {\n\t\t\trange: range,\n\t\t\toptions: {\n\t\t\t\tinlineClassName: 'goto-definition-link',\n\t\t\t\thoverMessage\n\t\t\t}\n\t\t};\n\n\t\tthis.linkDecorations = this.editor.deltaDecorations(this.linkDecorations, [newDecorations]);\n\t}\n\n\tprivate removeLinkDecorations(): void {\n\t\tif (this.linkDecorations.length > 0) {\n\t\t\tthis.linkDecorations = this.editor.deltaDecorations(this.linkDecorations, []);\n\t\t}\n\t}\n\n\tprivate isEnabled(mouseEvent: ClickLinkMouseEvent, withKey?: ClickLinkKeyboardEvent): boolean {\n\t\treturn this.editor.hasModel() &&\n\t\t\tmouseEvent.isNoneOrSingleMouseDown &&\n\t\t\t(mouseEvent.target.type === MouseTargetType.CONTENT_TEXT) &&\n\t\t\t(mouseEvent.hasTriggerModifier || (withKey ? withKey.keyCodeIsTriggerKey : false)) &&\n\t\t\tDefinitionProviderRegistry.has(this.editor.getModel());\n\t}\n\n\tprivate findDefinition(position: Position, token: CancellationToken): Promise<LocationLink[] | null> {\n\t\tconst model = this.editor.getModel();\n\t\tif (!model) {\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\n\t\treturn getDefinitionsAtPosition(model, position, token);\n\t}\n\n\tprivate gotoDefinition(position: Position, openToSide: boolean): Promise<any> {\n\t\tthis.editor.setPosition(position);\n\t\treturn this.editor.invokeWithinContext((accessor) => {\n\t\t\tconst canPeek = !openToSide && this.editor.getOption(EditorOption.definitionLinkOpensInPeek) && !this.isInPeekEditor(accessor);\n\t\t\tconst action = new DefinitionAction({ openToSide, openInPeek: canPeek, muteMessage: true }, { alias: '', label: '', id: '', precondition: undefined });\n\t\t\treturn action.run(accessor, this.editor);\n\t\t});\n\t}\n\n\tprivate isInPeekEditor(accessor: ServicesAccessor): boolean | undefined {\n\t\tconst contextKeyService = accessor.get(IContextKeyService);\n\t\treturn PeekContext.inPeekEditor.getValue(contextKeyService);\n\t}\n\n\tpublic dispose(): void {\n\t\tthis.toUnhook.dispose();\n\t}\n}\n\nregisterEditorContribution(GotoDefinitionAtPositionEditorContribution.ID, GotoDefinitionAtPositionEditorContribution);\n\nregisterThemingParticipant((theme, collector) => {\n\tconst activeLinkForeground = theme.getColor(editorActiveLinkForeground);\n\tif (activeLinkForeground) {\n\t\tcollector.addRule(`.monaco-editor .goto-definition-link { color: ${activeLinkForeground} !important; }`);\n\t}\n});\n"]}