{"version":3,"sources":["vs/editor/contrib/rename/renameInputField.ts"],"names":[],"mappings":"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","file":"renameInputField.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./renameInputField';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { ContentWidgetPositionPreference, ICodeEditor, IContentWidget, IContentWidgetPosition } from 'vs/editor/browser/editorBrowser';\nimport { Position } from 'vs/editor/common/core/position';\nimport { IRange } from 'vs/editor/common/core/range';\nimport { ScrollType } from 'vs/editor/common/editorCommon';\nimport { localize } from 'vs/nls';\nimport { IContextKey, IContextKeyService, RawContextKey } from 'vs/platform/contextkey/common/contextkey';\nimport { inputBackground, inputBorder, inputForeground, widgetShadow, editorWidgetBackground } from 'vs/platform/theme/common/colorRegistry';\nimport { IColorTheme, IThemeService } from 'vs/platform/theme/common/themeService';\nimport { EditorOption } from 'vs/editor/common/config/editorOptions';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { CancellationToken } from 'vs/base/common/cancellation';\n\nexport const CONTEXT_RENAME_INPUT_VISIBLE = new RawContextKey<boolean>('renameInputVisible', false, localize('renameInputVisible', \"Whether the rename input widget is visible\"));\n\nexport interface RenameInputFieldResult {\n\tnewName: string;\n\twantsPreview?: boolean;\n}\n\nexport class RenameInputField implements IContentWidget {\n\n\tprivate _position?: Position;\n\tprivate _domNode?: HTMLElement;\n\tprivate _input?: HTMLInputElement;\n\tprivate _label?: HTMLDivElement;\n\tprivate _visible?: boolean;\n\tprivate readonly _visibleContextKey: IContextKey<boolean>;\n\tprivate readonly _disposables = new DisposableStore();\n\n\treadonly allowEditorOverflow: boolean = true;\n\n\tconstructor(\n\t\tprivate readonly _editor: ICodeEditor,\n\t\tprivate readonly _acceptKeybindings: [string, string],\n\t\t@IThemeService private readonly _themeService: IThemeService,\n\t\t@IKeybindingService private readonly _keybindingService: IKeybindingService,\n\t\t@IContextKeyService contextKeyService: IContextKeyService,\n\t) {\n\t\tthis._visibleContextKey = CONTEXT_RENAME_INPUT_VISIBLE.bindTo(contextKeyService);\n\n\t\tthis._editor.addContentWidget(this);\n\n\t\tthis._disposables.add(this._editor.onDidChangeConfiguration(e => {\n\t\t\tif (e.hasChanged(EditorOption.fontInfo)) {\n\t\t\t\tthis._updateFont();\n\t\t\t}\n\t\t}));\n\n\t\tthis._disposables.add(_themeService.onDidColorThemeChange(this._updateStyles, this));\n\t}\n\n\tdispose(): void {\n\t\tthis._disposables.dispose();\n\t\tthis._editor.removeContentWidget(this);\n\t}\n\n\tgetId(): string {\n\t\treturn '__renameInputWidget';\n\t}\n\n\tgetDomNode(): HTMLElement {\n\t\tif (!this._domNode) {\n\t\t\tthis._domNode = document.createElement('div');\n\t\t\tthis._domNode.className = 'monaco-editor rename-box';\n\n\t\t\tthis._input = document.createElement('input');\n\t\t\tthis._input.className = 'rename-input';\n\t\t\tthis._input.type = 'text';\n\t\t\tthis._input.setAttribute('aria-label', localize('renameAriaLabel', \"Rename input. Type new name and press Enter to commit.\"));\n\t\t\tthis._domNode.appendChild(this._input);\n\n\t\t\tthis._label = document.createElement('div');\n\t\t\tthis._label.className = 'rename-label';\n\t\t\tthis._domNode.appendChild(this._label);\n\t\t\tconst updateLabel = () => {\n\t\t\t\tconst [accept, preview] = this._acceptKeybindings;\n\t\t\t\tthis._keybindingService.lookupKeybinding(accept);\n\t\t\t\tthis._label!.innerText = localize({ key: 'label', comment: ['placeholders are keybindings, e.g \"F2 to Rename, Shift+F2 to Preview\"'] }, \"{0} to Rename, {1} to Preview\", this._keybindingService.lookupKeybinding(accept)?.getLabel(), this._keybindingService.lookupKeybinding(preview)?.getLabel());\n\t\t\t};\n\t\t\tupdateLabel();\n\t\t\tthis._disposables.add(this._keybindingService.onDidUpdateKeybindings(updateLabel));\n\n\t\t\tthis._updateFont();\n\t\t\tthis._updateStyles(this._themeService.getColorTheme());\n\t\t}\n\t\treturn this._domNode;\n\t}\n\n\tprivate _updateStyles(theme: IColorTheme): void {\n\t\tif (!this._input || !this._domNode) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst widgetShadowColor = theme.getColor(widgetShadow);\n\t\tthis._domNode.style.backgroundColor = String(theme.getColor(editorWidgetBackground) ?? '');\n\t\tthis._domNode.style.boxShadow = widgetShadowColor ? ` 0 0 8px 2px ${widgetShadowColor}` : '';\n\t\tthis._domNode.style.color = String(theme.getColor(inputForeground) ?? '');\n\n\t\tthis._input.style.backgroundColor = String(theme.getColor(inputBackground) ?? '');\n\t\t// this._input.style.color = String(theme.getColor(inputForeground) ?? '');\n\t\tconst border = theme.getColor(inputBorder);\n\t\tthis._input.style.borderWidth = border ? '1px' : '0px';\n\t\tthis._input.style.borderStyle = border ? 'solid' : 'none';\n\t\tthis._input.style.borderColor = border?.toString() ?? 'none';\n\t}\n\n\tprivate _updateFont(): void {\n\t\tif (!this._input || !this._label) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst fontInfo = this._editor.getOption(EditorOption.fontInfo);\n\t\tthis._input.style.fontFamily = fontInfo.fontFamily;\n\t\tthis._input.style.fontWeight = fontInfo.fontWeight;\n\t\tthis._input.style.fontSize = `${fontInfo.fontSize}px`;\n\n\t\tthis._label.style.fontSize = `${fontInfo.fontSize * 0.8}px`;\n\t}\n\n\tgetPosition(): IContentWidgetPosition | null {\n\t\tif (!this._visible) {\n\t\t\treturn null;\n\t\t}\n\t\treturn {\n\t\t\tposition: this._position!,\n\t\t\tpreference: [ContentWidgetPositionPreference.BELOW, ContentWidgetPositionPreference.ABOVE]\n\t\t};\n\t}\n\n\tafterRender(position: ContentWidgetPositionPreference | null): void {\n\t\tif (!position) {\n\t\t\t// cancel rename when input widget isn't rendered anymore\n\t\t\tthis.cancelInput(true);\n\t\t}\n\t}\n\n\n\tprivate _currentAcceptInput?: (wantsPreview: boolean) => void;\n\tprivate _currentCancelInput?: (focusEditor: boolean) => void;\n\n\tacceptInput(wantsPreview: boolean): void {\n\t\tif (this._currentAcceptInput) {\n\t\t\tthis._currentAcceptInput(wantsPreview);\n\t\t}\n\t}\n\n\tcancelInput(focusEditor: boolean): void {\n\t\tif (this._currentCancelInput) {\n\t\t\tthis._currentCancelInput(focusEditor);\n\t\t}\n\t}\n\n\tgetInput(where: IRange, value: string, selectionStart: number, selectionEnd: number, supportPreview: boolean, token: CancellationToken): Promise<RenameInputFieldResult | boolean> {\n\n\t\tthis._domNode!.classList.toggle('preview', supportPreview);\n\n\t\tthis._position = new Position(where.startLineNumber, where.startColumn);\n\t\tthis._input!.value = value;\n\t\tthis._input!.setAttribute('selectionStart', selectionStart.toString());\n\t\tthis._input!.setAttribute('selectionEnd', selectionEnd.toString());\n\t\tthis._input!.size = Math.max((where.endColumn - where.startColumn) * 1.1, 20);\n\n\t\tconst disposeOnDone = new DisposableStore();\n\n\t\treturn new Promise<RenameInputFieldResult | boolean>(resolve => {\n\n\t\t\tthis._currentCancelInput = (focusEditor) => {\n\t\t\t\tthis._currentAcceptInput = undefined;\n\t\t\t\tthis._currentCancelInput = undefined;\n\t\t\t\tresolve(focusEditor);\n\t\t\t\treturn true;\n\t\t\t};\n\n\t\t\tthis._currentAcceptInput = (wantsPreview) => {\n\t\t\t\tif (this._input!.value.trim().length === 0 || this._input!.value === value) {\n\t\t\t\t\t// empty or whitespace only or not changed\n\t\t\t\t\tthis.cancelInput(true);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis._currentAcceptInput = undefined;\n\t\t\t\tthis._currentCancelInput = undefined;\n\t\t\t\tresolve({\n\t\t\t\t\tnewName: this._input!.value,\n\t\t\t\t\twantsPreview: supportPreview && wantsPreview\n\t\t\t\t});\n\t\t\t};\n\n\t\t\ttoken.onCancellationRequested(() => this.cancelInput(true));\n\t\t\tdisposeOnDone.add(this._editor.onDidBlurEditorWidget(() => this.cancelInput(false)));\n\n\t\t\tthis._show();\n\n\t\t}).finally(() => {\n\t\t\tdisposeOnDone.dispose();\n\t\t\tthis._hide();\n\t\t});\n\t}\n\n\tprivate _show(): void {\n\t\tthis._editor.revealLineInCenterIfOutsideViewport(this._position!.lineNumber, ScrollType.Smooth);\n\t\tthis._visible = true;\n\t\tthis._visibleContextKey.set(true);\n\t\tthis._editor.layoutContentWidget(this);\n\n\t\tsetTimeout(() => {\n\t\t\tthis._input!.focus();\n\t\t\tthis._input!.setSelectionRange(\n\t\t\t\tparseInt(this._input!.getAttribute('selectionStart')!),\n\t\t\t\tparseInt(this._input!.getAttribute('selectionEnd')!));\n\t\t}, 100);\n\t}\n\n\tprivate _hide(): void {\n\t\tthis._visible = false;\n\t\tthis._visibleContextKey.reset();\n\t\tthis._editor.layoutContentWidget(this);\n\t}\n}\n"]}