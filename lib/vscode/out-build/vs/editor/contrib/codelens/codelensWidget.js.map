{"version":3,"file":"codelensWidget.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/editor/contrib/codelens/codelensWidget.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./codelensWidget';\nimport * as dom from 'vs/base/browser/dom';\nimport { IViewZone, IContentWidget, IActiveCodeEditor, IContentWidgetPosition, ContentWidgetPositionPreference, IViewZoneChangeAccessor } from 'vs/editor/browser/editorBrowser';\nimport { Range } from 'vs/editor/common/core/range';\nimport { IModelDecorationsChangeAccessor, IModelDeltaDecoration, ITextModel } from 'vs/editor/common/model';\nimport { ModelDecorationOptions } from 'vs/editor/common/model/textModel';\nimport { Command, CodeLens } from 'vs/editor/common/modes';\nimport { editorCodeLensForeground } from 'vs/editor/common/view/editorColorRegistry';\nimport { CodeLensItem } from 'vs/editor/contrib/codelens/codelens';\nimport { editorActiveLinkForeground } from 'vs/platform/theme/common/colorRegistry';\nimport { registerThemingParticipant } from 'vs/platform/theme/common/themeService';\nimport { renderLabelWithIcons } from 'vs/base/browser/ui/iconLabel/iconLabels';\n\nclass CodeLensViewZone implements IViewZone {\n\n\treadonly suppressMouseDown: boolean;\n\treadonly domNode: HTMLElement;\n\n\tafterLineNumber: number;\n\theightInPx: number;\n\n\tprivate _lastHeight?: number;\n\tprivate readonly _onHeight: () => void;\n\n\tconstructor(afterLineNumber: number, heightInPx: number, onHeight: () => void) {\n\t\tthis.afterLineNumber = afterLineNumber;\n\t\tthis.heightInPx = heightInPx;\n\n\t\tthis._onHeight = onHeight;\n\t\tthis.suppressMouseDown = true;\n\t\tthis.domNode = document.createElement('div');\n\t}\n\n\tonComputedHeight(height: number): void {\n\t\tif (this._lastHeight === undefined) {\n\t\t\tthis._lastHeight = height;\n\t\t} else if (this._lastHeight !== height) {\n\t\t\tthis._lastHeight = height;\n\t\t\tthis._onHeight();\n\t\t}\n\t}\n}\n\nclass CodeLensContentWidget implements IContentWidget {\n\n\tprivate static _idPool: number = 0;\n\n\t// Editor.IContentWidget.allowEditorOverflow\n\treadonly allowEditorOverflow: boolean = false;\n\treadonly suppressMouseDown: boolean = true;\n\n\tprivate readonly _id: string;\n\tprivate readonly _domNode: HTMLElement;\n\tprivate readonly _editor: IActiveCodeEditor;\n\tprivate readonly _commands = new Map<string, Command>();\n\n\tprivate _widgetPosition?: IContentWidgetPosition;\n\tprivate _isEmpty: boolean = true;\n\n\tconstructor(\n\t\teditor: IActiveCodeEditor,\n\t\tclassName: string,\n\t\tline: number,\n\t) {\n\t\tthis._editor = editor;\n\t\tthis._id = `codelens.widget-${(CodeLensContentWidget._idPool++)}`;\n\n\t\tthis.updatePosition(line);\n\n\t\tthis._domNode = document.createElement('span');\n\t\tthis._domNode.className = `codelens-decoration ${className}`;\n\t}\n\n\twithCommands(lenses: Array<CodeLens | undefined | null>, animate: boolean): void {\n\t\tthis._commands.clear();\n\n\t\tlet children: HTMLElement[] = [];\n\t\tlet hasSymbol = false;\n\t\tfor (let i = 0; i < lenses.length; i++) {\n\t\t\tconst lens = lenses[i];\n\t\t\tif (!lens) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\thasSymbol = true;\n\t\t\tif (lens.command) {\n\t\t\t\tconst title = renderLabelWithIcons(lens.command.title.trim());\n\t\t\t\tif (lens.command.id) {\n\t\t\t\t\tchildren.push(dom.$('a', { id: String(i), title: lens.command.tooltip }, ...title));\n\t\t\t\t\tthis._commands.set(String(i), lens.command);\n\t\t\t\t} else {\n\t\t\t\t\tchildren.push(dom.$('span', { title: lens.command.tooltip }, ...title));\n\t\t\t\t}\n\t\t\t\tif (i + 1 < lenses.length) {\n\t\t\t\t\tchildren.push(dom.$('span', undefined, '\\u00a0|\\u00a0'));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (!hasSymbol) {\n\t\t\t// symbols but no commands\n\t\t\tdom.reset(this._domNode, dom.$('span', undefined, 'no commands'));\n\n\t\t} else {\n\t\t\t// symbols and commands\n\t\t\tdom.reset(this._domNode, ...children);\n\t\t\tif (this._isEmpty && animate) {\n\t\t\t\tthis._domNode.classList.add('fadein');\n\t\t\t}\n\t\t\tthis._isEmpty = false;\n\t\t}\n\t}\n\n\tgetCommand(link: HTMLLinkElement): Command | undefined {\n\t\treturn link.parentElement === this._domNode\n\t\t\t? this._commands.get(link.id)\n\t\t\t: undefined;\n\t}\n\n\tgetId(): string {\n\t\treturn this._id;\n\t}\n\n\tgetDomNode(): HTMLElement {\n\t\treturn this._domNode;\n\t}\n\n\tupdatePosition(line: number): void {\n\t\tconst column = this._editor.getModel().getLineFirstNonWhitespaceColumn(line);\n\t\tthis._widgetPosition = {\n\t\t\tposition: { lineNumber: line, column: column },\n\t\t\tpreference: [ContentWidgetPositionPreference.ABOVE]\n\t\t};\n\t}\n\n\tgetPosition(): IContentWidgetPosition | null {\n\t\treturn this._widgetPosition || null;\n\t}\n}\n\nexport interface IDecorationIdCallback {\n\t(decorationId: string): void;\n}\n\nexport class CodeLensHelper {\n\n\tprivate readonly _removeDecorations: string[];\n\tprivate readonly _addDecorations: IModelDeltaDecoration[];\n\tprivate readonly _addDecorationsCallbacks: IDecorationIdCallback[];\n\n\tconstructor() {\n\t\tthis._removeDecorations = [];\n\t\tthis._addDecorations = [];\n\t\tthis._addDecorationsCallbacks = [];\n\t}\n\n\taddDecoration(decoration: IModelDeltaDecoration, callback: IDecorationIdCallback): void {\n\t\tthis._addDecorations.push(decoration);\n\t\tthis._addDecorationsCallbacks.push(callback);\n\t}\n\n\tremoveDecoration(decorationId: string): void {\n\t\tthis._removeDecorations.push(decorationId);\n\t}\n\n\tcommit(changeAccessor: IModelDecorationsChangeAccessor): void {\n\t\tlet resultingDecorations = changeAccessor.deltaDecorations(this._removeDecorations, this._addDecorations);\n\t\tfor (let i = 0, len = resultingDecorations.length; i < len; i++) {\n\t\t\tthis._addDecorationsCallbacks[i](resultingDecorations[i]);\n\t\t}\n\t}\n}\n\nexport class CodeLensWidget {\n\n\tprivate readonly _editor: IActiveCodeEditor;\n\tprivate readonly _className: string;\n\tprivate readonly _viewZone: CodeLensViewZone;\n\tprivate readonly _viewZoneId: string;\n\n\tprivate _contentWidget?: CodeLensContentWidget;\n\tprivate _decorationIds: string[];\n\tprivate _data: CodeLensItem[];\n\tprivate _isDisposed: boolean = false;\n\n\tconstructor(\n\t\tdata: CodeLensItem[],\n\t\teditor: IActiveCodeEditor,\n\t\tclassName: string,\n\t\thelper: CodeLensHelper,\n\t\tviewZoneChangeAccessor: IViewZoneChangeAccessor,\n\t\theightInPx: number,\n\t\tupdateCallback: () => void\n\t) {\n\t\tthis._editor = editor;\n\t\tthis._className = className;\n\t\tthis._data = data;\n\n\t\t// create combined range, track all ranges with decorations,\n\t\t// check if there is already something to render\n\t\tthis._decorationIds = [];\n\t\tlet range: Range | undefined;\n\t\tlet lenses: CodeLens[] = [];\n\n\t\tthis._data.forEach((codeLensData, i) => {\n\n\t\t\tif (codeLensData.symbol.command) {\n\t\t\t\tlenses.push(codeLensData.symbol);\n\t\t\t}\n\n\t\t\thelper.addDecoration({\n\t\t\t\trange: codeLensData.symbol.range,\n\t\t\t\toptions: ModelDecorationOptions.EMPTY\n\t\t\t}, id => this._decorationIds[i] = id);\n\n\t\t\t// the range contains all lenses on this line\n\t\t\tif (!range) {\n\t\t\t\trange = Range.lift(codeLensData.symbol.range);\n\t\t\t} else {\n\t\t\t\trange = Range.plusRange(range, codeLensData.symbol.range);\n\t\t\t}\n\t\t});\n\n\t\tthis._viewZone = new CodeLensViewZone(range!.startLineNumber - 1, heightInPx, updateCallback);\n\t\tthis._viewZoneId = viewZoneChangeAccessor.addZone(this._viewZone);\n\n\t\tif (lenses.length > 0) {\n\t\t\tthis._createContentWidgetIfNecessary();\n\t\t\tthis._contentWidget!.withCommands(lenses, false);\n\t\t}\n\t}\n\n\tprivate _createContentWidgetIfNecessary(): void {\n\t\tif (!this._contentWidget) {\n\t\t\tthis._contentWidget = new CodeLensContentWidget(this._editor, this._className, this._viewZone.afterLineNumber + 1);\n\t\t\tthis._editor.addContentWidget(this._contentWidget);\n\t\t} else {\n\t\t\tthis._editor.layoutContentWidget(this._contentWidget);\n\t\t}\n\t}\n\n\tdispose(helper: CodeLensHelper, viewZoneChangeAccessor?: IViewZoneChangeAccessor): void {\n\t\tthis._decorationIds.forEach(helper.removeDecoration, helper);\n\t\tthis._decorationIds = [];\n\t\tif (viewZoneChangeAccessor) {\n\t\t\tviewZoneChangeAccessor.removeZone(this._viewZoneId);\n\t\t}\n\t\tif (this._contentWidget) {\n\t\t\tthis._editor.removeContentWidget(this._contentWidget);\n\t\t\tthis._contentWidget = undefined;\n\t\t}\n\t\tthis._isDisposed = true;\n\t}\n\n\tisDisposed(): boolean {\n\t\treturn this._isDisposed;\n\t}\n\n\tisValid(): boolean {\n\t\treturn this._decorationIds.some((id, i) => {\n\t\t\tconst range = this._editor.getModel().getDecorationRange(id);\n\t\t\tconst symbol = this._data[i].symbol;\n\t\t\treturn !!(range && Range.isEmpty(symbol.range) === range.isEmpty());\n\t\t});\n\t}\n\n\tupdateCodeLensSymbols(data: CodeLensItem[], helper: CodeLensHelper): void {\n\t\tthis._decorationIds.forEach(helper.removeDecoration, helper);\n\t\tthis._decorationIds = [];\n\t\tthis._data = data;\n\t\tthis._data.forEach((codeLensData, i) => {\n\t\t\thelper.addDecoration({\n\t\t\t\trange: codeLensData.symbol.range,\n\t\t\t\toptions: ModelDecorationOptions.EMPTY\n\t\t\t}, id => this._decorationIds[i] = id);\n\t\t});\n\t}\n\n\tupdateHeight(height: number, viewZoneChangeAccessor: IViewZoneChangeAccessor): void {\n\t\tthis._viewZone.heightInPx = height;\n\t\tviewZoneChangeAccessor.layoutZone(this._viewZoneId);\n\t\tif (this._contentWidget) {\n\t\t\tthis._editor.layoutContentWidget(this._contentWidget);\n\t\t}\n\t}\n\n\tcomputeIfNecessary(model: ITextModel): CodeLensItem[] | null {\n\t\tif (!this._viewZone.domNode.hasAttribute('monaco-visible-view-zone')) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// Read editor current state\n\t\tfor (let i = 0; i < this._decorationIds.length; i++) {\n\t\t\tconst range = model.getDecorationRange(this._decorationIds[i]);\n\t\t\tif (range) {\n\t\t\t\tthis._data[i].symbol.range = range;\n\t\t\t}\n\t\t}\n\t\treturn this._data;\n\t}\n\n\tupdateCommands(symbols: Array<CodeLens | undefined | null>): void {\n\n\t\tthis._createContentWidgetIfNecessary();\n\t\tthis._contentWidget!.withCommands(symbols, true);\n\n\t\tfor (let i = 0; i < this._data.length; i++) {\n\t\t\tconst resolved = symbols[i];\n\t\t\tif (resolved) {\n\t\t\t\tconst { symbol } = this._data[i];\n\t\t\t\tsymbol.command = resolved.command || symbol.command;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetCommand(link: HTMLLinkElement): Command | undefined {\n\t\treturn this._contentWidget?.getCommand(link);\n\t}\n\n\tgetLineNumber(): number {\n\t\tconst range = this._editor.getModel().getDecorationRange(this._decorationIds[0]);\n\t\tif (range) {\n\t\t\treturn range.startLineNumber;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tupdate(viewZoneChangeAccessor: IViewZoneChangeAccessor): void {\n\t\tif (this.isValid()) {\n\t\t\tconst range = this._editor.getModel().getDecorationRange(this._decorationIds[0]);\n\t\t\tif (range) {\n\t\t\t\tthis._viewZone.afterLineNumber = range.startLineNumber - 1;\n\t\t\t\tviewZoneChangeAccessor.layoutZone(this._viewZoneId);\n\n\t\t\t\tif (this._contentWidget) {\n\t\t\t\t\tthis._contentWidget.updatePosition(range.startLineNumber);\n\t\t\t\t\tthis._editor.layoutContentWidget(this._contentWidget);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetItems(): CodeLensItem[] {\n\t\treturn this._data;\n\t}\n}\n\nregisterThemingParticipant((theme, collector) => {\n\tconst codeLensForeground = theme.getColor(editorCodeLensForeground);\n\tif (codeLensForeground) {\n\t\tcollector.addRule(`.monaco-editor .codelens-decoration { color: ${codeLensForeground}; }`);\n\t\tcollector.addRule(`.monaco-editor .codelens-decoration .codicon { color: ${codeLensForeground}; }`);\n\t}\n\tconst activeLinkForeground = theme.getColor(editorActiveLinkForeground);\n\tif (activeLinkForeground) {\n\t\tcollector.addRule(`.monaco-editor .codelens-decoration > a:hover { color: ${activeLinkForeground} !important; }`);\n\t\tcollector.addRule(`.monaco-editor .codelens-decoration > a:hover .codicon { color: ${activeLinkForeground} !important; }`);\n\t}\n});\n"]}