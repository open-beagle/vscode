{"version":3,"sources":["vs/editor/contrib/codelens/codelensController.ts"],"names":[],"mappings":"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","file":"codelensController.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { CancelablePromise, RunOnceScheduler, createCancelablePromise, disposableTimeout } from 'vs/base/common/async';\nimport { onUnexpectedError, onUnexpectedExternalError } from 'vs/base/common/errors';\nimport { toDisposable, DisposableStore } from 'vs/base/common/lifecycle';\nimport { StableEditorScrollState } from 'vs/editor/browser/core/editorState';\nimport { ICodeEditor, MouseTargetType, IViewZoneChangeAccessor, IActiveCodeEditor } from 'vs/editor/browser/editorBrowser';\nimport { registerEditorContribution, ServicesAccessor, registerEditorAction, EditorAction } from 'vs/editor/browser/editorExtensions';\nimport { IEditorContribution } from 'vs/editor/common/editorCommon';\nimport { IModelDecorationsChangeAccessor } from 'vs/editor/common/model';\nimport { CodeLensProviderRegistry, CodeLens, Command } from 'vs/editor/common/modes';\nimport { CodeLensModel, getCodeLensModel, CodeLensItem } from 'vs/editor/contrib/codelens/codelens';\nimport { CodeLensWidget, CodeLensHelper } from 'vs/editor/contrib/codelens/codelensWidget';\nimport { ICommandService } from 'vs/platform/commands/common/commands';\nimport { INotificationService } from 'vs/platform/notification/common/notification';\nimport { ICodeLensCache } from 'vs/editor/contrib/codelens/codeLensCache';\nimport { EditorOption } from 'vs/editor/common/config/editorOptions';\nimport * as dom from 'vs/base/browser/dom';\nimport { hash } from 'vs/base/common/hash';\nimport { IQuickInputService } from 'vs/platform/quickinput/common/quickInput';\nimport { localize } from 'vs/nls';\nimport { EditorContextKeys } from 'vs/editor/common/editorContextKeys';\nimport { LanguageFeatureRequestDelays } from 'vs/editor/common/modes/languageFeatureRegistry';\n\nexport class CodeLensContribution implements IEditorContribution {\n\n\tstatic readonly ID: string = 'css.editor.codeLens';\n\n\tprivate readonly _disposables = new DisposableStore();\n\tprivate readonly _localToDispose = new DisposableStore();\n\tprivate readonly _styleElement: HTMLStyleElement;\n\tprivate readonly _styleClassName: string;\n\tprivate readonly _lenses: CodeLensWidget[] = [];\n\n\tprivate readonly _getCodeLensModelDelays = new LanguageFeatureRequestDelays(CodeLensProviderRegistry, 250, 2500);\n\tprivate _getCodeLensModelPromise: CancelablePromise<CodeLensModel> | undefined;\n\tprivate _oldCodeLensModels = new DisposableStore();\n\tprivate _currentCodeLensModel: CodeLensModel | undefined;\n\tprivate readonly _resolveCodeLensesDelays = new LanguageFeatureRequestDelays(CodeLensProviderRegistry, 250, 2500);\n\tprivate readonly _resolveCodeLensesScheduler = new RunOnceScheduler(() => this._resolveCodeLensesInViewport(), this._resolveCodeLensesDelays.min);\n\tprivate _resolveCodeLensesPromise: CancelablePromise<any> | undefined;\n\n\tconstructor(\n\t\tprivate readonly _editor: ICodeEditor,\n\t\t@ICommandService private readonly _commandService: ICommandService,\n\t\t@INotificationService private readonly _notificationService: INotificationService,\n\t\t@ICodeLensCache private readonly _codeLensCache: ICodeLensCache\n\t) {\n\n\t\tthis._disposables.add(this._editor.onDidChangeModel(() => this._onModelChange()));\n\t\tthis._disposables.add(this._editor.onDidChangeModelLanguage(() => this._onModelChange()));\n\t\tthis._disposables.add(this._editor.onDidChangeConfiguration((e) => {\n\t\t\tif (e.hasChanged(EditorOption.fontInfo) || e.hasChanged(EditorOption.codeLensFontSize) || e.hasChanged(EditorOption.codeLensFontFamily)) {\n\t\t\t\tthis._updateLensStyle();\n\t\t\t}\n\t\t\tif (e.hasChanged(EditorOption.codeLens)) {\n\t\t\t\tthis._onModelChange();\n\t\t\t}\n\t\t}));\n\t\tthis._disposables.add(CodeLensProviderRegistry.onDidChange(this._onModelChange, this));\n\t\tthis._onModelChange();\n\n\t\tthis._styleClassName = '_' + hash(this._editor.getId()).toString(16);\n\t\tthis._styleElement = dom.createStyleSheet(\n\t\t\tdom.isInShadowDOM(this._editor.getContainerDomNode())\n\t\t\t\t? this._editor.getContainerDomNode()\n\t\t\t\t: undefined\n\t\t);\n\t\tthis._updateLensStyle();\n\t}\n\n\tdispose(): void {\n\t\tthis._localDispose();\n\t\tthis._disposables.dispose();\n\t\tthis._oldCodeLensModels.dispose();\n\t\tthis._currentCodeLensModel?.dispose();\n\t\tthis._styleElement.remove();\n\t}\n\n\tprivate _getLayoutInfo() {\n\t\tlet fontSize = this._editor.getOption(EditorOption.codeLensFontSize);\n\t\tlet codeLensHeight: number;\n\t\tif (!fontSize || fontSize < 5) {\n\t\t\tfontSize = (this._editor.getOption(EditorOption.fontSize) * .9) | 0;\n\t\t\tcodeLensHeight = this._editor.getOption(EditorOption.lineHeight);\n\t\t} else {\n\t\t\tcodeLensHeight = (fontSize * Math.max(1.3, this._editor.getOption(EditorOption.lineHeight) / this._editor.getOption(EditorOption.fontSize))) | 0;\n\t\t}\n\t\treturn { codeLensHeight, fontSize };\n\t}\n\n\tprivate _updateLensStyle(): void {\n\n\t\tconst { codeLensHeight, fontSize } = this._getLayoutInfo();\n\t\tconst fontFamily = this._editor.getOption(EditorOption.codeLensFontFamily);\n\t\tconst editorFontInfo = this._editor.getOption(EditorOption.fontInfo);\n\n\t\tconst fontFamilyVar = `--codelens-font-family${this._styleClassName}`;\n\t\tconst fontFeaturesVar = `--codelens-font-features${this._styleClassName}`;\n\n\t\tlet newStyle = `\n\t\t.monaco-editor .codelens-decoration.${this._styleClassName} { line-height: ${codeLensHeight}px; font-size: ${fontSize}px; padding-right: ${Math.round(fontSize * 0.5)}px; font-feature-settings: var(${fontFeaturesVar}) }\n\t\t.monaco-editor .codelens-decoration.${this._styleClassName} span.codicon { line-height: ${codeLensHeight}px; font-size: ${fontSize}px; }\n\t\t`;\n\t\tif (fontFamily) {\n\t\t\tnewStyle += `.monaco-editor .codelens-decoration.${this._styleClassName} { font-family: var(${fontFamilyVar})}`;\n\t\t}\n\t\tthis._styleElement.textContent = newStyle;\n\t\tthis._editor.getContainerDomNode().style.setProperty(fontFamilyVar, fontFamily ?? 'inherit');\n\t\tthis._editor.getContainerDomNode().style.setProperty(fontFeaturesVar, editorFontInfo.fontFeatureSettings);\n\n\t\t//\n\t\tthis._editor.changeViewZones(accessor => {\n\t\t\tfor (let lens of this._lenses) {\n\t\t\t\tlens.updateHeight(codeLensHeight, accessor);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _localDispose(): void {\n\t\tthis._getCodeLensModelPromise?.cancel();\n\t\tthis._getCodeLensModelPromise = undefined;\n\t\tthis._resolveCodeLensesPromise?.cancel();\n\t\tthis._resolveCodeLensesPromise = undefined;\n\t\tthis._localToDispose.clear();\n\t\tthis._oldCodeLensModels.clear();\n\t\tthis._currentCodeLensModel?.dispose();\n\t}\n\n\tprivate _onModelChange(): void {\n\n\t\tthis._localDispose();\n\n\t\tconst model = this._editor.getModel();\n\t\tif (!model) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._editor.getOption(EditorOption.codeLens)) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst cachedLenses = this._codeLensCache.get(model);\n\t\tif (cachedLenses) {\n\t\t\tthis._renderCodeLensSymbols(cachedLenses);\n\t\t}\n\n\t\tif (!CodeLensProviderRegistry.has(model)) {\n\t\t\t// no provider -> return but check with\n\t\t\t// cached lenses. they expire after 30 seconds\n\t\t\tif (cachedLenses) {\n\t\t\t\tthis._localToDispose.add(disposableTimeout(() => {\n\t\t\t\t\tconst cachedLensesNow = this._codeLensCache.get(model);\n\t\t\t\t\tif (cachedLenses === cachedLensesNow) {\n\t\t\t\t\t\tthis._codeLensCache.delete(model);\n\t\t\t\t\t\tthis._onModelChange();\n\t\t\t\t\t}\n\t\t\t\t}, 30 * 1000));\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const provider of CodeLensProviderRegistry.all(model)) {\n\t\t\tif (typeof provider.onDidChange === 'function') {\n\t\t\t\tlet registration = provider.onDidChange(() => scheduler.schedule());\n\t\t\t\tthis._localToDispose.add(registration);\n\t\t\t}\n\t\t}\n\n\t\tconst scheduler = new RunOnceScheduler(() => {\n\t\t\tconst t1 = Date.now();\n\n\t\t\tthis._getCodeLensModelPromise?.cancel();\n\t\t\tthis._getCodeLensModelPromise = createCancelablePromise(token => getCodeLensModel(model, token));\n\n\t\t\tthis._getCodeLensModelPromise.then(result => {\n\t\t\t\tif (this._currentCodeLensModel) {\n\t\t\t\t\tthis._oldCodeLensModels.add(this._currentCodeLensModel);\n\t\t\t\t}\n\t\t\t\tthis._currentCodeLensModel = result;\n\n\t\t\t\t// cache model to reduce flicker\n\t\t\t\tthis._codeLensCache.put(model, result);\n\n\t\t\t\t// update moving average\n\t\t\t\tconst newDelay = this._getCodeLensModelDelays.update(model, Date.now() - t1);\n\t\t\t\tscheduler.delay = newDelay;\n\n\t\t\t\t// render lenses\n\t\t\t\tthis._renderCodeLensSymbols(result);\n\t\t\t\tthis._resolveCodeLensesInViewport();\n\t\t\t}, onUnexpectedError);\n\n\t\t}, this._getCodeLensModelDelays.get(model));\n\n\t\tthis._localToDispose.add(scheduler);\n\t\tthis._localToDispose.add(toDisposable(() => this._resolveCodeLensesScheduler.cancel()));\n\t\tthis._localToDispose.add(this._editor.onDidChangeModelContent(() => {\n\t\t\tthis._editor.changeDecorations(decorationsAccessor => {\n\t\t\t\tthis._editor.changeViewZones(viewZonesAccessor => {\n\t\t\t\t\tlet toDispose: CodeLensWidget[] = [];\n\t\t\t\t\tlet lastLensLineNumber: number = -1;\n\n\t\t\t\t\tthis._lenses.forEach((lens) => {\n\t\t\t\t\t\tif (!lens.isValid() || lastLensLineNumber === lens.getLineNumber()) {\n\t\t\t\t\t\t\t// invalid -> lens collapsed, attach range doesn't exist anymore\n\t\t\t\t\t\t\t// line_number -> lenses should never be on the same line\n\t\t\t\t\t\t\ttoDispose.push(lens);\n\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlens.update(viewZonesAccessor);\n\t\t\t\t\t\t\tlastLensLineNumber = lens.getLineNumber();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tlet helper = new CodeLensHelper();\n\t\t\t\t\ttoDispose.forEach((l) => {\n\t\t\t\t\t\tl.dispose(helper, viewZonesAccessor);\n\t\t\t\t\t\tthis._lenses.splice(this._lenses.indexOf(l), 1);\n\t\t\t\t\t});\n\t\t\t\t\thelper.commit(decorationsAccessor);\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// Ask for all references again\n\t\t\tscheduler.schedule();\n\t\t}));\n\t\tthis._localToDispose.add(this._editor.onDidFocusEditorWidget(() => {\n\t\t\tscheduler.schedule();\n\t\t}));\n\t\tthis._localToDispose.add(this._editor.onDidScrollChange(e => {\n\t\t\tif (e.scrollTopChanged && this._lenses.length > 0) {\n\t\t\t\tthis._resolveCodeLensesInViewportSoon();\n\t\t\t}\n\t\t}));\n\t\tthis._localToDispose.add(this._editor.onDidLayoutChange(() => {\n\t\t\tthis._resolveCodeLensesInViewportSoon();\n\t\t}));\n\t\tthis._localToDispose.add(toDisposable(() => {\n\t\t\tif (this._editor.getModel()) {\n\t\t\t\tconst scrollState = StableEditorScrollState.capture(this._editor);\n\t\t\t\tthis._editor.changeDecorations(decorationsAccessor => {\n\t\t\t\t\tthis._editor.changeViewZones(viewZonesAccessor => {\n\t\t\t\t\t\tthis._disposeAllLenses(decorationsAccessor, viewZonesAccessor);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\tscrollState.restore(this._editor);\n\t\t\t} else {\n\t\t\t\t// No accessors available\n\t\t\t\tthis._disposeAllLenses(undefined, undefined);\n\t\t\t}\n\t\t}));\n\t\tthis._localToDispose.add(this._editor.onMouseDown(e => {\n\t\t\tif (e.target.type !== MouseTargetType.CONTENT_WIDGET) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet target = e.target.element;\n\t\t\tif (target?.tagName === 'SPAN') {\n\t\t\t\ttarget = target.parentElement;\n\t\t\t}\n\t\t\tif (target?.tagName === 'A') {\n\t\t\t\tfor (const lens of this._lenses) {\n\t\t\t\t\tlet command = lens.getCommand(target as HTMLLinkElement);\n\t\t\t\t\tif (command) {\n\t\t\t\t\t\tthis._commandService.executeCommand(command.id, ...(command.arguments || [])).catch(err => this._notificationService.error(err));\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tscheduler.schedule();\n\t}\n\n\tprivate _disposeAllLenses(decChangeAccessor: IModelDecorationsChangeAccessor | undefined, viewZoneChangeAccessor: IViewZoneChangeAccessor | undefined): void {\n\t\tconst helper = new CodeLensHelper();\n\t\tfor (const lens of this._lenses) {\n\t\t\tlens.dispose(helper, viewZoneChangeAccessor);\n\t\t}\n\t\tif (decChangeAccessor) {\n\t\t\thelper.commit(decChangeAccessor);\n\t\t}\n\t\tthis._lenses.length = 0;\n\t}\n\n\tprivate _renderCodeLensSymbols(symbols: CodeLensModel): void {\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet maxLineNumber = this._editor.getModel().getLineCount();\n\t\tlet groups: CodeLensItem[][] = [];\n\t\tlet lastGroup: CodeLensItem[] | undefined;\n\n\t\tfor (let symbol of symbols.lenses) {\n\t\t\tlet line = symbol.symbol.range.startLineNumber;\n\t\t\tif (line < 1 || line > maxLineNumber) {\n\t\t\t\t// invalid code lens\n\t\t\t\tcontinue;\n\t\t\t} else if (lastGroup && lastGroup[lastGroup.length - 1].symbol.range.startLineNumber === line) {\n\t\t\t\t// on same line as previous\n\t\t\t\tlastGroup.push(symbol);\n\t\t\t} else {\n\t\t\t\t// on later line as previous\n\t\t\t\tlastGroup = [symbol];\n\t\t\t\tgroups.push(lastGroup);\n\t\t\t}\n\t\t}\n\n\t\tconst scrollState = StableEditorScrollState.capture(this._editor);\n\t\tconst layoutInfo = this._getLayoutInfo();\n\n\t\tthis._editor.changeDecorations(decorationsAccessor => {\n\t\t\tthis._editor.changeViewZones(viewZoneAccessor => {\n\n\t\t\t\tconst helper = new CodeLensHelper();\n\t\t\t\tlet codeLensIndex = 0;\n\t\t\t\tlet groupsIndex = 0;\n\n\t\t\t\twhile (groupsIndex < groups.length && codeLensIndex < this._lenses.length) {\n\n\t\t\t\t\tlet symbolsLineNumber = groups[groupsIndex][0].symbol.range.startLineNumber;\n\t\t\t\t\tlet codeLensLineNumber = this._lenses[codeLensIndex].getLineNumber();\n\n\t\t\t\t\tif (codeLensLineNumber < symbolsLineNumber) {\n\t\t\t\t\t\tthis._lenses[codeLensIndex].dispose(helper, viewZoneAccessor);\n\t\t\t\t\t\tthis._lenses.splice(codeLensIndex, 1);\n\t\t\t\t\t} else if (codeLensLineNumber === symbolsLineNumber) {\n\t\t\t\t\t\tthis._lenses[codeLensIndex].updateCodeLensSymbols(groups[groupsIndex], helper);\n\t\t\t\t\t\tgroupsIndex++;\n\t\t\t\t\t\tcodeLensIndex++;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._lenses.splice(codeLensIndex, 0, new CodeLensWidget(groups[groupsIndex], <IActiveCodeEditor>this._editor, this._styleClassName, helper, viewZoneAccessor, layoutInfo.codeLensHeight, () => this._resolveCodeLensesInViewportSoon()));\n\t\t\t\t\t\tcodeLensIndex++;\n\t\t\t\t\t\tgroupsIndex++;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Delete extra code lenses\n\t\t\t\twhile (codeLensIndex < this._lenses.length) {\n\t\t\t\t\tthis._lenses[codeLensIndex].dispose(helper, viewZoneAccessor);\n\t\t\t\t\tthis._lenses.splice(codeLensIndex, 1);\n\t\t\t\t}\n\n\t\t\t\t// Create extra symbols\n\t\t\t\twhile (groupsIndex < groups.length) {\n\t\t\t\t\tthis._lenses.push(new CodeLensWidget(groups[groupsIndex], <IActiveCodeEditor>this._editor, this._styleClassName, helper, viewZoneAccessor, layoutInfo.codeLensHeight, () => this._resolveCodeLensesInViewportSoon()));\n\t\t\t\t\tgroupsIndex++;\n\t\t\t\t}\n\n\t\t\t\thelper.commit(decorationsAccessor);\n\t\t\t});\n\t\t});\n\n\t\tscrollState.restore(this._editor);\n\t}\n\n\tprivate _resolveCodeLensesInViewportSoon(): void {\n\t\tconst model = this._editor.getModel();\n\t\tif (model) {\n\t\t\tthis._resolveCodeLensesScheduler.schedule();\n\t\t}\n\t}\n\n\tprivate _resolveCodeLensesInViewport(): void {\n\n\t\tthis._resolveCodeLensesPromise?.cancel();\n\t\tthis._resolveCodeLensesPromise = undefined;\n\n\t\tconst model = this._editor.getModel();\n\t\tif (!model) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst toResolve: CodeLensItem[][] = [];\n\t\tconst lenses: CodeLensWidget[] = [];\n\t\tthis._lenses.forEach((lens) => {\n\t\t\tconst request = lens.computeIfNecessary(model);\n\t\t\tif (request) {\n\t\t\t\ttoResolve.push(request);\n\t\t\t\tlenses.push(lens);\n\t\t\t}\n\t\t});\n\n\t\tif (toResolve.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst t1 = Date.now();\n\n\t\tconst resolvePromise = createCancelablePromise(token => {\n\n\t\t\tconst promises = toResolve.map((request, i) => {\n\n\t\t\t\tconst resolvedSymbols = new Array<CodeLens | undefined | null>(request.length);\n\t\t\t\tconst promises = request.map((request, i) => {\n\t\t\t\t\tif (!request.symbol.command && typeof request.provider.resolveCodeLens === 'function') {\n\t\t\t\t\t\treturn Promise.resolve(request.provider.resolveCodeLens(model, request.symbol, token)).then(symbol => {\n\t\t\t\t\t\t\tresolvedSymbols[i] = symbol;\n\t\t\t\t\t\t}, onUnexpectedExternalError);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolvedSymbols[i] = request.symbol;\n\t\t\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\treturn Promise.all(promises).then(() => {\n\t\t\t\t\tif (!token.isCancellationRequested && !lenses[i].isDisposed()) {\n\t\t\t\t\t\tlenses[i].updateCommands(resolvedSymbols);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\treturn Promise.all(promises);\n\t\t});\n\t\tthis._resolveCodeLensesPromise = resolvePromise;\n\n\t\tthis._resolveCodeLensesPromise.then(() => {\n\n\t\t\t// update moving average\n\t\t\tconst newDelay = this._resolveCodeLensesDelays.update(model, Date.now() - t1);\n\t\t\tthis._resolveCodeLensesScheduler.delay = newDelay;\n\n\t\t\tif (this._currentCodeLensModel) { // update the cached state with new resolved items\n\t\t\t\tthis._codeLensCache.put(model, this._currentCodeLensModel);\n\t\t\t}\n\t\t\tthis._oldCodeLensModels.clear(); // dispose old models once we have updated the UI with the current model\n\t\t\tif (resolvePromise === this._resolveCodeLensesPromise) {\n\t\t\t\tthis._resolveCodeLensesPromise = undefined;\n\t\t\t}\n\t\t}, err => {\n\t\t\tonUnexpectedError(err); // can also be cancellation!\n\t\t\tif (resolvePromise === this._resolveCodeLensesPromise) {\n\t\t\t\tthis._resolveCodeLensesPromise = undefined;\n\t\t\t}\n\t\t});\n\t}\n\n\tgetLenses(): readonly CodeLensWidget[] {\n\t\treturn this._lenses;\n\t}\n}\n\nregisterEditorContribution(CodeLensContribution.ID, CodeLensContribution);\n\nregisterEditorAction(class ShowLensesInCurrentLine extends EditorAction {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'codelens.showLensesInCurrentLine',\n\t\t\tprecondition: EditorContextKeys.hasCodeLensProvider,\n\t\t\tlabel: localize('showLensOnLine', \"Show CodeLens Commands For Current Line\"),\n\t\t\talias: 'Show CodeLens Commands For Current Line',\n\t\t});\n\t}\n\n\tasync run(accessor: ServicesAccessor, editor: ICodeEditor): Promise<void> {\n\n\t\tif (!editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst quickInputService = accessor.get(IQuickInputService);\n\t\tconst commandService = accessor.get(ICommandService);\n\t\tconst notificationService = accessor.get(INotificationService);\n\n\t\tconst lineNumber = editor.getSelection().positionLineNumber;\n\t\tconst codelensController = editor.getContribution<CodeLensContribution>(CodeLensContribution.ID);\n\t\tconst items: { label: string, command: Command }[] = [];\n\n\t\tfor (let lens of codelensController.getLenses()) {\n\t\t\tif (lens.getLineNumber() === lineNumber) {\n\t\t\t\tfor (let item of lens.getItems()) {\n\t\t\t\t\tconst { command } = item.symbol;\n\t\t\t\t\tif (command) {\n\t\t\t\t\t\titems.push({\n\t\t\t\t\t\t\tlabel: command.title,\n\t\t\t\t\t\t\tcommand: command\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (items.length === 0) {\n\t\t\t// We dont want an empty picker\n\t\t\treturn;\n\t\t}\n\n\t\tconst item = await quickInputService.pick(items, { canPickMany: false });\n\t\tif (!item) {\n\t\t\t// Nothing picked\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tawait commandService.executeCommand(item.command.id, ...(item.command.arguments || []));\n\t\t} catch (err) {\n\t\t\tnotificationService.error(err);\n\t\t}\n\t}\n});\n"]}