{"version":3,"file":"suggest.test.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/editor/contrib/suggest/test/suggest.test.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nimport * as assert from 'assert';\nimport { URI } from 'vs/base/common/uri';\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { CompletionProviderRegistry, CompletionItemKind, CompletionItemProvider } from 'vs/editor/common/modes';\nimport { provideSuggestionItems, SnippetSortOrder, CompletionOptions } from 'vs/editor/contrib/suggest/suggest';\nimport { Position } from 'vs/editor/common/core/position';\nimport { TextModel } from 'vs/editor/common/model/textModel';\nimport { Range } from 'vs/editor/common/core/range';\nimport { createTextModel } from 'vs/editor/test/common/editorTestUtils';\n\n\nsuite('Suggest', function () {\n\n\tlet model: TextModel;\n\tlet registration: IDisposable;\n\n\tsetup(function () {\n\n\t\tmodel = createTextModel('FOO\\nbar\\BAR\\nfoo', undefined, undefined, URI.parse('foo:bar/path'));\n\t\tregistration = CompletionProviderRegistry.register({ pattern: 'bar/path', scheme: 'foo' }, {\n\t\t\tprovideCompletionItems(_doc, pos) {\n\t\t\t\treturn {\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'aaa',\n\t\t\t\t\t\tkind: CompletionItemKind.Snippet,\n\t\t\t\t\t\tinsertText: 'aaa',\n\t\t\t\t\t\trange: Range.fromPositions(pos)\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: 'zzz',\n\t\t\t\t\t\tkind: CompletionItemKind.Snippet,\n\t\t\t\t\t\tinsertText: 'zzz',\n\t\t\t\t\t\trange: Range.fromPositions(pos)\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: 'fff',\n\t\t\t\t\t\tkind: CompletionItemKind.Property,\n\t\t\t\t\t\tinsertText: 'fff',\n\t\t\t\t\t\trange: Range.fromPositions(pos)\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t});\n\t});\n\n\tteardown(() => {\n\t\tregistration.dispose();\n\t\tmodel.dispose();\n\t});\n\n\ttest('sort - snippet inline', async function () {\n\t\tconst { items } = await provideSuggestionItems(model, new Position(1, 1), new CompletionOptions(SnippetSortOrder.Inline));\n\t\tassert.strictEqual(items.length, 3);\n\t\tassert.strictEqual(items[0].completion.label, 'aaa');\n\t\tassert.strictEqual(items[1].completion.label, 'fff');\n\t\tassert.strictEqual(items[2].completion.label, 'zzz');\n\t});\n\n\ttest('sort - snippet top', async function () {\n\t\tconst { items } = await provideSuggestionItems(model, new Position(1, 1), new CompletionOptions(SnippetSortOrder.Top));\n\t\tassert.strictEqual(items.length, 3);\n\t\tassert.strictEqual(items[0].completion.label, 'aaa');\n\t\tassert.strictEqual(items[1].completion.label, 'zzz');\n\t\tassert.strictEqual(items[2].completion.label, 'fff');\n\t});\n\n\ttest('sort - snippet bottom', async function () {\n\t\tconst { items } = await provideSuggestionItems(model, new Position(1, 1), new CompletionOptions(SnippetSortOrder.Bottom));\n\t\tassert.strictEqual(items.length, 3);\n\t\tassert.strictEqual(items[0].completion.label, 'fff');\n\t\tassert.strictEqual(items[1].completion.label, 'aaa');\n\t\tassert.strictEqual(items[2].completion.label, 'zzz');\n\t});\n\n\ttest('sort - snippet none', async function () {\n\t\tconst { items } = await provideSuggestionItems(model, new Position(1, 1), new CompletionOptions(undefined, new Set<CompletionItemKind>().add(CompletionItemKind.Snippet)));\n\t\tassert.strictEqual(items.length, 1);\n\t\tassert.strictEqual(items[0].completion.label, 'fff');\n\t});\n\n\ttest('only from', function () {\n\n\t\tconst foo: any = {\n\t\t\ttriggerCharacters: [],\n\t\t\tprovideCompletionItems() {\n\t\t\t\treturn {\n\t\t\t\t\tcurrentWord: '',\n\t\t\t\t\tincomplete: false,\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'jjj',\n\t\t\t\t\t\ttype: 'property',\n\t\t\t\t\t\tinsertText: 'jjj'\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\t\tconst registration = CompletionProviderRegistry.register({ pattern: 'bar/path', scheme: 'foo' }, foo);\n\n\t\tprovideSuggestionItems(model, new Position(1, 1), new CompletionOptions(undefined, undefined, new Set<CompletionItemProvider>().add(foo))).then(({ items }) => {\n\t\t\tregistration.dispose();\n\n\t\t\tassert.strictEqual(items.length, 1);\n\t\t\tassert.ok(items[0].provider === foo);\n\t\t});\n\t});\n\n\ttest('Ctrl+space completions stopped working with the latest Insiders, #97650', async function () {\n\n\n\t\tconst foo = new class implements CompletionItemProvider {\n\n\t\t\ttriggerCharacters = [];\n\n\t\t\tprovideCompletionItems() {\n\t\t\t\treturn {\n\t\t\t\t\tsuggestions: [{\n\t\t\t\t\t\tlabel: 'one',\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tinsertText: 'one',\n\t\t\t\t\t\trange: {\n\t\t\t\t\t\t\tinsert: new Range(0, 0, 0, 0),\n\t\t\t\t\t\t\treplace: new Range(0, 0, 0, 10)\n\t\t\t\t\t\t}\n\t\t\t\t\t}, {\n\t\t\t\t\t\tlabel: 'two',\n\t\t\t\t\t\tkind: CompletionItemKind.Class,\n\t\t\t\t\t\tinsertText: 'two',\n\t\t\t\t\t\trange: {\n\t\t\t\t\t\t\tinsert: new Range(0, 0, 0, 0),\n\t\t\t\t\t\t\treplace: new Range(0, 1, 0, 10)\n\t\t\t\t\t\t}\n\t\t\t\t\t}]\n\t\t\t\t};\n\t\t\t}\n\t\t};\n\n\t\tconst registration = CompletionProviderRegistry.register({ pattern: 'bar/path', scheme: 'foo' }, foo);\n\t\tconst { items } = await provideSuggestionItems(model, new Position(0, 0), new CompletionOptions(undefined, undefined, new Set<CompletionItemProvider>().add(foo)));\n\t\tregistration.dispose();\n\n\t\tassert.strictEqual(items.length, 2);\n\t\tconst [a, b] = items;\n\n\t\tassert.strictEqual(a.completion.label, 'one');\n\t\tassert.strictEqual(a.isInvalid, false);\n\t\tassert.strictEqual(b.completion.label, 'two');\n\t\tassert.strictEqual(b.isInvalid, true);\n\t});\n});\n"]}