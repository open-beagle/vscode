{"version":3,"sources":["vs/editor/contrib/suggest/suggestWidget.ts"],"names":[],"mappings":"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","file":"suggestWidget.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport 'vs/css!./media/suggest';\nimport 'vs/base/browser/ui/codicons/codiconStyles'; // The codicon symbol styles are defined here and must be loaded\nimport 'vs/editor/contrib/symbolIcons/symbolIcons'; // The codicon symbol colors are defined here and must be loaded to get colors\nimport * as nls from 'vs/nls';\nimport * as strings from 'vs/base/common/strings';\nimport * as dom from 'vs/base/browser/dom';\nimport { Event, Emitter } from 'vs/base/common/event';\nimport { onUnexpectedError } from 'vs/base/common/errors';\nimport { IDisposable, DisposableStore } from 'vs/base/common/lifecycle';\nimport { IListEvent, IListMouseEvent, IListGestureEvent } from 'vs/base/browser/ui/list/list';\nimport { List } from 'vs/base/browser/ui/list/listWidget';\nimport { IContextKey, IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { EditorOption } from 'vs/editor/common/config/editorOptions';\nimport { ContentWidgetPositionPreference, ICodeEditor, IContentWidget, IContentWidgetPosition, IEditorMouseEvent } from 'vs/editor/browser/editorBrowser';\nimport { Context as SuggestContext, CompletionItem } from './suggest';\nimport { CompletionModel } from './completionModel';\nimport { attachListStyler } from 'vs/platform/theme/common/styler';\nimport { IThemeService, IColorTheme, registerThemingParticipant } from 'vs/platform/theme/common/themeService';\nimport { registerColor, editorWidgetBackground, quickInputListFocusBackground, activeContrastBorder, listHighlightForeground, editorForeground, editorWidgetBorder, focusBorder, textLinkForeground, textCodeBlockBackground } from 'vs/platform/theme/common/colorRegistry';\nimport { IStorageService, StorageScope, StorageTarget } from 'vs/platform/storage/common/storage';\nimport { TimeoutTimer, CancelablePromise, createCancelablePromise, disposableTimeout } from 'vs/base/common/async';\nimport { IInstantiationService } from 'vs/platform/instantiation/common/instantiation';\nimport { IKeyboardEvent } from 'vs/base/browser/keyboardEvent';\nimport { SuggestDetailsWidget, canExpandCompletionItem, SuggestDetailsOverlay } from './suggestWidgetDetails';\nimport { SuggestWidgetStatus } from 'vs/editor/contrib/suggest/suggestWidgetStatus';\nimport { getAriaId, ItemRenderer } from './suggestWidgetRenderer';\nimport { ResizableHTMLElement } from './resizable';\nimport { EmbeddedCodeEditorWidget } from 'vs/editor/browser/widget/embeddedCodeEditorWidget';\nimport { IPosition } from 'vs/editor/common/core/position';\nimport { clamp } from 'vs/base/common/numbers';\n\n/**\n * Suggest widget colors\n */\nexport const editorSuggestWidgetBackground = registerColor('editorSuggestWidget.background', { dark: editorWidgetBackground, light: editorWidgetBackground, hc: editorWidgetBackground }, nls.localize('editorSuggestWidgetBackground', 'Background color of the suggest widget.'));\nexport const editorSuggestWidgetBorder = registerColor('editorSuggestWidget.border', { dark: editorWidgetBorder, light: editorWidgetBorder, hc: editorWidgetBorder }, nls.localize('editorSuggestWidgetBorder', 'Border color of the suggest widget.'));\nexport const editorSuggestWidgetForeground = registerColor('editorSuggestWidget.foreground', { dark: editorForeground, light: editorForeground, hc: editorForeground }, nls.localize('editorSuggestWidgetForeground', 'Foreground color of the suggest widget.'));\nexport const editorSuggestWidgetSelectedBackground = registerColor('editorSuggestWidget.selectedBackground', { dark: quickInputListFocusBackground, light: quickInputListFocusBackground, hc: quickInputListFocusBackground }, nls.localize('editorSuggestWidgetSelectedBackground', 'Background color of the selected entry in the suggest widget.'));\nexport const editorSuggestWidgetHighlightForeground = registerColor('editorSuggestWidget.highlightForeground', { dark: listHighlightForeground, light: listHighlightForeground, hc: listHighlightForeground }, nls.localize('editorSuggestWidgetHighlightForeground', 'Color of the match highlights in the suggest widget.'));\n\nconst enum State {\n\tHidden,\n\tLoading,\n\tEmpty,\n\tOpen,\n\tFrozen,\n\tDetails\n}\n\nexport interface ISelectedSuggestion {\n\titem: CompletionItem;\n\tindex: number;\n\tmodel: CompletionModel;\n}\n\nclass PersistedWidgetSize {\n\n\tprivate readonly _key: string;\n\n\tconstructor(\n\t\tprivate readonly _service: IStorageService,\n\t\teditor: ICodeEditor\n\t) {\n\t\tthis._key = `suggestWidget.size/${editor.getEditorType()}/${editor instanceof EmbeddedCodeEditorWidget}`;\n\t}\n\n\trestore(): dom.Dimension | undefined {\n\t\tconst raw = this._service.get(this._key, StorageScope.GLOBAL) ?? '';\n\t\ttry {\n\t\t\tconst obj = JSON.parse(raw);\n\t\t\tif (dom.Dimension.is(obj)) {\n\t\t\t\treturn dom.Dimension.lift(obj);\n\t\t\t}\n\t\t} catch {\n\t\t\t// ignore\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tstore(size: dom.Dimension) {\n\t\tthis._service.store(this._key, JSON.stringify(size), StorageScope.GLOBAL, StorageTarget.MACHINE);\n\t}\n\n\treset(): void {\n\t\tthis._service.remove(this._key, StorageScope.GLOBAL);\n\t}\n}\n\nexport class SuggestWidget implements IDisposable {\n\n\tprivate static LOADING_MESSAGE: string = nls.localize('suggestWidget.loading', \"Loading...\");\n\tprivate static NO_SUGGESTIONS_MESSAGE: string = nls.localize('suggestWidget.noSuggestions', \"No suggestions.\");\n\n\tprivate _state: State = State.Hidden;\n\tprivate _isAuto: boolean = false;\n\tprivate _loadingTimeout?: IDisposable;\n\tprivate _currentSuggestionDetails?: CancelablePromise<void>;\n\tprivate _focusedItem?: CompletionItem;\n\tprivate _ignoreFocusEvents: boolean = false;\n\tprivate _completionModel?: CompletionModel;\n\tprivate _cappedHeight?: { wanted: number; capped: number; };\n\tprivate _explainMode: boolean = false;\n\n\treadonly element: ResizableHTMLElement;\n\tprivate readonly _messageElement: HTMLElement;\n\tprivate readonly _listElement: HTMLElement;\n\tprivate readonly _list: List<CompletionItem>;\n\tprivate readonly _status: SuggestWidgetStatus;\n\tprivate readonly _details: SuggestDetailsOverlay;\n\tprivate readonly _contentWidget: SuggestContentWidget;\n\tprivate readonly _persistedSize: PersistedWidgetSize;\n\n\tprivate readonly _ctxSuggestWidgetVisible: IContextKey<boolean>;\n\tprivate readonly _ctxSuggestWidgetDetailsVisible: IContextKey<boolean>;\n\tprivate readonly _ctxSuggestWidgetMultipleSuggestions: IContextKey<boolean>;\n\n\tprivate readonly _showTimeout = new TimeoutTimer();\n\tprivate readonly _disposables = new DisposableStore();\n\n\n\tprivate readonly _onDidSelect = new Emitter<ISelectedSuggestion>();\n\tprivate readonly _onDidFocus = new Emitter<ISelectedSuggestion>();\n\tprivate readonly _onDidHide = new Emitter<this>();\n\tprivate readonly _onDidShow = new Emitter<this>();\n\n\treadonly onDidSelect: Event<ISelectedSuggestion> = this._onDidSelect.event;\n\treadonly onDidFocus: Event<ISelectedSuggestion> = this._onDidFocus.event;\n\treadonly onDidHide: Event<this> = this._onDidHide.event;\n\treadonly onDidShow: Event<this> = this._onDidShow.event;\n\n\tprivate readonly _onDetailsKeydown = new Emitter<IKeyboardEvent>();\n\treadonly onDetailsKeyDown: Event<IKeyboardEvent> = this._onDetailsKeydown.event;\n\n\tprivate _detailsFocusBorderColor?: string;\n\tprivate _detailsBorderColor?: string;\n\n\tconstructor(\n\t\tprivate readonly editor: ICodeEditor,\n\t\t@IStorageService private readonly _storageService: IStorageService,\n\t\t@IContextKeyService _contextKeyService: IContextKeyService,\n\t\t@IThemeService _themeService: IThemeService,\n\t\t@IInstantiationService instantiationService: IInstantiationService,\n\t) {\n\t\tthis.element = new ResizableHTMLElement();\n\t\tthis.element.domNode.classList.add('editor-widget', 'suggest-widget');\n\n\t\tthis._contentWidget = new SuggestContentWidget(this, editor);\n\t\tthis._persistedSize = new PersistedWidgetSize(_storageService, editor);\n\n\t\tclass ResizeState {\n\t\t\tconstructor(\n\t\t\t\treadonly persistedSize: dom.Dimension | undefined,\n\t\t\t\treadonly currentSize: dom.Dimension,\n\t\t\t\tpublic persistHeight = false,\n\t\t\t\tpublic persistWidth = false,\n\t\t\t) { }\n\t\t}\n\n\t\tlet state: ResizeState | undefined;\n\t\tthis._disposables.add(this.element.onDidWillResize(() => {\n\t\t\tthis._contentWidget.lockPreference();\n\t\t\tstate = new ResizeState(this._persistedSize.restore(), this.element.size);\n\t\t}));\n\t\tthis._disposables.add(this.element.onDidResize(e => {\n\n\t\t\tthis._resize(e.dimension.width, e.dimension.height);\n\n\t\t\tif (state) {\n\t\t\t\tstate.persistHeight = state.persistHeight || !!e.north || !!e.south;\n\t\t\t\tstate.persistWidth = state.persistWidth || !!e.east || !!e.west;\n\t\t\t}\n\n\t\t\tif (!e.done) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (state) {\n\t\t\t\t// only store width or height value that have changed and also\n\t\t\t\t// only store changes that are above a certain threshold\n\t\t\t\tconst { itemHeight, defaultSize } = this.getLayoutInfo();\n\t\t\t\tconst threshold = Math.round(itemHeight / 2);\n\t\t\t\tlet { width, height } = this.element.size;\n\t\t\t\tif (!state.persistHeight || Math.abs(state.currentSize.height - height) <= threshold) {\n\t\t\t\t\theight = state.persistedSize?.height ?? defaultSize.height;\n\t\t\t\t}\n\t\t\t\tif (!state.persistWidth || Math.abs(state.currentSize.width - width) <= threshold) {\n\t\t\t\t\twidth = state.persistedSize?.width ?? defaultSize.width;\n\t\t\t\t}\n\t\t\t\tthis._persistedSize.store(new dom.Dimension(width, height));\n\t\t\t}\n\n\t\t\t// reset working state\n\t\t\tthis._contentWidget.unlockPreference();\n\t\t\tstate = undefined;\n\t\t}));\n\n\t\tthis._messageElement = dom.append(this.element.domNode, dom.$('.message'));\n\t\tthis._listElement = dom.append(this.element.domNode, dom.$('.tree'));\n\n\t\tconst details = instantiationService.createInstance(SuggestDetailsWidget, this.editor);\n\t\tdetails.onDidClose(this.toggleDetails, this, this._disposables);\n\t\tthis._details = new SuggestDetailsOverlay(details, this.editor);\n\n\t\tconst applyIconStyle = () => this.element.domNode.classList.toggle('no-icons', !this.editor.getOption(EditorOption.suggest).showIcons);\n\t\tapplyIconStyle();\n\n\t\tconst renderer = instantiationService.createInstance(ItemRenderer, this.editor);\n\t\tthis._disposables.add(renderer);\n\t\tthis._disposables.add(renderer.onDidToggleDetails(() => this.toggleDetails()));\n\n\t\tthis._list = new List('SuggestWidget', this._listElement, {\n\t\t\tgetHeight: (_element: CompletionItem): number => this.getLayoutInfo().itemHeight,\n\t\t\tgetTemplateId: (_element: CompletionItem): string => 'suggestion'\n\t\t}, [renderer], {\n\t\t\talwaysConsumeMouseWheel: true,\n\t\t\tuseShadows: false,\n\t\t\tmouseSupport: false,\n\t\t\taccessibilityProvider: {\n\t\t\t\tgetRole: () => 'option',\n\t\t\t\tgetAriaLabel: (item: CompletionItem) => {\n\t\t\t\t\tif (item.isResolved && this._isDetailsVisible()) {\n\t\t\t\t\t\tconst { documentation, detail } = item.completion;\n\t\t\t\t\t\tconst docs = strings.format(\n\t\t\t\t\t\t\t'{0}{1}',\n\t\t\t\t\t\t\tdetail || '',\n\t\t\t\t\t\t\tdocumentation ? (typeof documentation === 'string' ? documentation : documentation.value) : '');\n\n\t\t\t\t\t\treturn nls.localize('ariaCurrenttSuggestionReadDetails', \"{0}, docs: {1}\", item.textLabel, docs);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn item.textLabel;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tgetWidgetAriaLabel: () => nls.localize('suggest', \"Suggest\"),\n\t\t\t\tgetWidgetRole: () => 'listbox'\n\t\t\t}\n\t\t});\n\n\t\tthis._status = instantiationService.createInstance(SuggestWidgetStatus, this.element.domNode);\n\t\tconst applyStatusBarStyle = () => this.element.domNode.classList.toggle('with-status-bar', this.editor.getOption(EditorOption.suggest).showStatusBar);\n\t\tapplyStatusBarStyle();\n\n\t\tthis._disposables.add(attachListStyler(this._list, _themeService, {\n\t\t\tlistInactiveFocusBackground: editorSuggestWidgetSelectedBackground,\n\t\t\tlistInactiveFocusOutline: activeContrastBorder\n\t\t}));\n\t\tthis._disposables.add(_themeService.onDidColorThemeChange(t => this._onThemeChange(t)));\n\t\tthis._onThemeChange(_themeService.getColorTheme());\n\n\t\tthis._disposables.add(this._list.onMouseDown(e => this._onListMouseDownOrTap(e)));\n\t\tthis._disposables.add(this._list.onTap(e => this._onListMouseDownOrTap(e)));\n\t\tthis._disposables.add(this._list.onDidChangeSelection(e => this._onListSelection(e)));\n\t\tthis._disposables.add(this._list.onDidChangeFocus(e => this._onListFocus(e)));\n\t\tthis._disposables.add(this.editor.onDidChangeCursorSelection(() => this._onCursorSelectionChanged()));\n\t\tthis._disposables.add(this.editor.onDidChangeConfiguration(e => {\n\t\t\tif (e.hasChanged(EditorOption.suggest)) {\n\t\t\t\tapplyStatusBarStyle();\n\t\t\t\tapplyIconStyle();\n\t\t\t}\n\t\t}));\n\n\t\tthis._ctxSuggestWidgetVisible = SuggestContext.Visible.bindTo(_contextKeyService);\n\t\tthis._ctxSuggestWidgetDetailsVisible = SuggestContext.DetailsVisible.bindTo(_contextKeyService);\n\t\tthis._ctxSuggestWidgetMultipleSuggestions = SuggestContext.MultipleSuggestions.bindTo(_contextKeyService);\n\n\n\t\tthis._disposables.add(dom.addStandardDisposableListener(this._details.widget.domNode, 'keydown', e => {\n\t\t\tthis._onDetailsKeydown.fire(e);\n\t\t}));\n\n\t\tthis._disposables.add(this.editor.onMouseDown((e: IEditorMouseEvent) => this._onEditorMouseDown(e)));\n\t}\n\n\tdispose(): void {\n\t\tthis._details.widget.dispose();\n\t\tthis._details.dispose();\n\t\tthis._list.dispose();\n\t\tthis._status.dispose();\n\t\tthis._disposables.dispose();\n\t\tthis._loadingTimeout?.dispose();\n\t\tthis._showTimeout.dispose();\n\t\tthis._contentWidget.dispose();\n\t\tthis.element.dispose();\n\t}\n\n\tprivate _onEditorMouseDown(mouseEvent: IEditorMouseEvent): void {\n\t\tif (this._details.widget.domNode.contains(mouseEvent.target.element)) {\n\t\t\t// Clicking inside details\n\t\t\tthis._details.widget.domNode.focus();\n\t\t} else {\n\t\t\t// Clicking outside details and inside suggest\n\t\t\tif (this.element.domNode.contains(mouseEvent.target.element)) {\n\t\t\t\tthis.editor.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate _onCursorSelectionChanged(): void {\n\t\tif (this._state !== State.Hidden) {\n\t\t\tthis._contentWidget.layout();\n\t\t}\n\t}\n\n\tprivate _onListMouseDownOrTap(e: IListMouseEvent<CompletionItem> | IListGestureEvent<CompletionItem>): void {\n\t\tif (typeof e.element === 'undefined' || typeof e.index === 'undefined') {\n\t\t\treturn;\n\t\t}\n\n\t\t// prevent stealing browser focus from the editor\n\t\te.browserEvent.preventDefault();\n\t\te.browserEvent.stopPropagation();\n\n\t\tthis._select(e.element, e.index);\n\t}\n\n\tprivate _onListSelection(e: IListEvent<CompletionItem>): void {\n\t\tif (e.elements.length) {\n\t\t\tthis._select(e.elements[0], e.indexes[0]);\n\t\t}\n\t}\n\n\tprivate _select(item: CompletionItem, index: number): void {\n\t\tconst completionModel = this._completionModel;\n\t\tif (completionModel) {\n\t\t\tthis._onDidSelect.fire({ item, index, model: completionModel });\n\t\t\tthis.editor.focus();\n\t\t}\n\t}\n\n\tprivate _onThemeChange(theme: IColorTheme) {\n\t\tconst backgroundColor = theme.getColor(editorSuggestWidgetBackground);\n\t\tif (backgroundColor) {\n\t\t\tthis.element.domNode.style.backgroundColor = backgroundColor.toString();\n\t\t\tthis._messageElement.style.backgroundColor = backgroundColor.toString();\n\t\t\tthis._details.widget.domNode.style.backgroundColor = backgroundColor.toString();\n\t\t}\n\t\tconst borderColor = theme.getColor(editorSuggestWidgetBorder);\n\t\tif (borderColor) {\n\t\t\tthis.element.domNode.style.borderColor = borderColor.toString();\n\t\t\tthis._messageElement.style.borderColor = borderColor.toString();\n\t\t\tthis._status.element.style.borderTopColor = borderColor.toString();\n\t\t\tthis._details.widget.domNode.style.borderColor = borderColor.toString();\n\t\t\tthis._detailsBorderColor = borderColor.toString();\n\t\t}\n\t\tconst focusBorderColor = theme.getColor(focusBorder);\n\t\tif (focusBorderColor) {\n\t\t\tthis._detailsFocusBorderColor = focusBorderColor.toString();\n\t\t}\n\t\tthis._details.widget.borderWidth = theme.type === 'hc' ? 2 : 1;\n\t}\n\n\tprivate _onListFocus(e: IListEvent<CompletionItem>): void {\n\t\tif (this._ignoreFocusEvents) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!e.elements.length) {\n\t\t\tif (this._currentSuggestionDetails) {\n\t\t\t\tthis._currentSuggestionDetails.cancel();\n\t\t\t\tthis._currentSuggestionDetails = undefined;\n\t\t\t\tthis._focusedItem = undefined;\n\t\t\t}\n\n\t\t\tthis.editor.setAriaOptions({ activeDescendant: undefined });\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._completionModel) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst item = e.elements[0];\n\t\tconst index = e.indexes[0];\n\n\t\tif (item !== this._focusedItem) {\n\n\t\t\tthis._currentSuggestionDetails?.cancel();\n\t\t\tthis._currentSuggestionDetails = undefined;\n\n\t\t\tthis._focusedItem = item;\n\n\t\t\tthis._list.reveal(index);\n\n\t\t\tthis._currentSuggestionDetails = createCancelablePromise(async token => {\n\t\t\t\tconst loading = disposableTimeout(() => {\n\t\t\t\t\tif (this._isDetailsVisible()) {\n\t\t\t\t\t\tthis.showDetails(true);\n\t\t\t\t\t}\n\t\t\t\t}, 250);\n\t\t\t\ttoken.onCancellationRequested(() => loading.dispose());\n\t\t\t\tconst result = await item.resolve(token);\n\t\t\t\tloading.dispose();\n\t\t\t\treturn result;\n\t\t\t});\n\n\t\t\tthis._currentSuggestionDetails.then(() => {\n\t\t\t\tif (index >= this._list.length || item !== this._list.element(index)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// item can have extra information, so re-render\n\t\t\t\tthis._ignoreFocusEvents = true;\n\t\t\t\tthis._list.splice(index, 1, [item]);\n\t\t\t\tthis._list.setFocus([index]);\n\t\t\t\tthis._ignoreFocusEvents = false;\n\n\t\t\t\tif (this._isDetailsVisible()) {\n\t\t\t\t\tthis.showDetails(false);\n\t\t\t\t} else {\n\t\t\t\t\tthis.element.domNode.classList.remove('docs-side');\n\t\t\t\t}\n\n\t\t\t\tthis.editor.setAriaOptions({ activeDescendant: getAriaId(index) });\n\t\t\t}).catch(onUnexpectedError);\n\t\t}\n\n\t\t// emit an event\n\t\tthis._onDidFocus.fire({ item, index, model: this._completionModel });\n\t}\n\n\tprivate _setState(state: State): void {\n\n\t\tif (this._state === state) {\n\t\t\treturn;\n\t\t}\n\t\tthis._state = state;\n\n\t\tthis.element.domNode.classList.toggle('frozen', state === State.Frozen);\n\t\tthis.element.domNode.classList.remove('message');\n\n\t\tswitch (state) {\n\t\t\tcase State.Hidden:\n\t\t\t\tdom.hide(this._messageElement, this._listElement, this._status.element);\n\t\t\t\tthis._details.hide(true);\n\t\t\t\tthis._status.hide();\n\t\t\t\tthis._contentWidget.hide();\n\t\t\t\tthis._ctxSuggestWidgetVisible.reset();\n\t\t\t\tthis._ctxSuggestWidgetMultipleSuggestions.reset();\n\t\t\t\tthis._showTimeout.cancel();\n\t\t\t\tthis.element.domNode.classList.remove('visible');\n\t\t\t\tthis._list.splice(0, this._list.length);\n\t\t\t\tthis._focusedItem = undefined;\n\t\t\t\tthis._cappedHeight = undefined;\n\t\t\t\tthis._explainMode = false;\n\t\t\t\tbreak;\n\t\t\tcase State.Loading:\n\t\t\t\tthis.element.domNode.classList.add('message');\n\t\t\t\tthis._messageElement.textContent = SuggestWidget.LOADING_MESSAGE;\n\t\t\t\tdom.hide(this._listElement, this._status.element);\n\t\t\t\tdom.show(this._messageElement);\n\t\t\t\tthis._details.hide();\n\t\t\t\tthis._show();\n\t\t\t\tthis._focusedItem = undefined;\n\t\t\t\tbreak;\n\t\t\tcase State.Empty:\n\t\t\t\tthis.element.domNode.classList.add('message');\n\t\t\t\tthis._messageElement.textContent = SuggestWidget.NO_SUGGESTIONS_MESSAGE;\n\t\t\t\tdom.hide(this._listElement, this._status.element);\n\t\t\t\tdom.show(this._messageElement);\n\t\t\t\tthis._details.hide();\n\t\t\t\tthis._show();\n\t\t\t\tthis._focusedItem = undefined;\n\t\t\t\tbreak;\n\t\t\tcase State.Open:\n\t\t\t\tdom.hide(this._messageElement);\n\t\t\t\tdom.show(this._listElement, this._status.element);\n\t\t\t\tthis._show();\n\t\t\t\tbreak;\n\t\t\tcase State.Frozen:\n\t\t\t\tdom.hide(this._messageElement);\n\t\t\t\tdom.show(this._listElement, this._status.element);\n\t\t\t\tthis._show();\n\t\t\t\tbreak;\n\t\t\tcase State.Details:\n\t\t\t\tdom.hide(this._messageElement);\n\t\t\t\tdom.show(this._listElement, this._status.element);\n\t\t\t\tthis._details.show();\n\t\t\t\tthis._show();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tprivate _show(): void {\n\t\tthis._status.show();\n\t\tthis._contentWidget.show();\n\t\tthis._layout(this._persistedSize.restore());\n\t\tthis._ctxSuggestWidgetVisible.set(true);\n\n\t\tthis._showTimeout.cancelAndSet(() => {\n\t\t\tthis.element.domNode.classList.add('visible');\n\t\t\tthis._onDidShow.fire(this);\n\t\t}, 100);\n\t}\n\n\tshowTriggered(auto: boolean, delay: number) {\n\t\tif (this._state !== State.Hidden) {\n\t\t\treturn;\n\t\t}\n\t\tthis._contentWidget.setPosition(this.editor.getPosition());\n\t\tthis._isAuto = !!auto;\n\n\t\tif (!this._isAuto) {\n\t\t\tthis._loadingTimeout = disposableTimeout(() => this._setState(State.Loading), delay);\n\t\t}\n\t}\n\n\tshowSuggestions(completionModel: CompletionModel, selectionIndex: number, isFrozen: boolean, isAuto: boolean): void {\n\n\t\tthis._contentWidget.setPosition(this.editor.getPosition());\n\t\tthis._loadingTimeout?.dispose();\n\n\t\tthis._currentSuggestionDetails?.cancel();\n\t\tthis._currentSuggestionDetails = undefined;\n\n\t\tif (this._completionModel !== completionModel) {\n\t\t\tthis._completionModel = completionModel;\n\t\t}\n\n\t\tif (isFrozen && this._state !== State.Empty && this._state !== State.Hidden) {\n\t\t\tthis._setState(State.Frozen);\n\t\t\treturn;\n\t\t}\n\n\t\tconst visibleCount = this._completionModel.items.length;\n\t\tconst isEmpty = visibleCount === 0;\n\t\tthis._ctxSuggestWidgetMultipleSuggestions.set(visibleCount > 1);\n\n\t\tif (isEmpty) {\n\t\t\tthis._setState(isAuto ? State.Hidden : State.Empty);\n\t\t\tthis._completionModel = undefined;\n\t\t\treturn;\n\t\t}\n\n\t\tthis._focusedItem = undefined;\n\t\tthis._list.splice(0, this._list.length, this._completionModel.items);\n\t\tthis._setState(isFrozen ? State.Frozen : State.Open);\n\t\tthis._list.reveal(selectionIndex, 0);\n\t\tthis._list.setFocus([selectionIndex]);\n\n\t\tthis._layout(this.element.size);\n\t\t// Reset focus border\n\t\tif (this._detailsBorderColor) {\n\t\t\tthis._details.widget.domNode.style.borderColor = this._detailsBorderColor;\n\t\t}\n\t}\n\n\tselectNextPage(): boolean {\n\t\tswitch (this._state) {\n\t\t\tcase State.Hidden:\n\t\t\t\treturn false;\n\t\t\tcase State.Details:\n\t\t\t\tthis._details.widget.pageDown();\n\t\t\t\treturn true;\n\t\t\tcase State.Loading:\n\t\t\t\treturn !this._isAuto;\n\t\t\tdefault:\n\t\t\t\tthis._list.focusNextPage();\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tselectNext(): boolean {\n\t\tswitch (this._state) {\n\t\t\tcase State.Hidden:\n\t\t\t\treturn false;\n\t\t\tcase State.Loading:\n\t\t\t\treturn !this._isAuto;\n\t\t\tdefault:\n\t\t\t\tthis._list.focusNext(1, true);\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tselectLast(): boolean {\n\t\tswitch (this._state) {\n\t\t\tcase State.Hidden:\n\t\t\t\treturn false;\n\t\t\tcase State.Details:\n\t\t\t\tthis._details.widget.scrollBottom();\n\t\t\t\treturn true;\n\t\t\tcase State.Loading:\n\t\t\t\treturn !this._isAuto;\n\t\t\tdefault:\n\t\t\t\tthis._list.focusLast();\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tselectPreviousPage(): boolean {\n\t\tswitch (this._state) {\n\t\t\tcase State.Hidden:\n\t\t\t\treturn false;\n\t\t\tcase State.Details:\n\t\t\t\tthis._details.widget.pageUp();\n\t\t\t\treturn true;\n\t\t\tcase State.Loading:\n\t\t\t\treturn !this._isAuto;\n\t\t\tdefault:\n\t\t\t\tthis._list.focusPreviousPage();\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tselectPrevious(): boolean {\n\t\tswitch (this._state) {\n\t\t\tcase State.Hidden:\n\t\t\t\treturn false;\n\t\t\tcase State.Loading:\n\t\t\t\treturn !this._isAuto;\n\t\t\tdefault:\n\t\t\t\tthis._list.focusPrevious(1, true);\n\t\t\t\treturn false;\n\t\t}\n\t}\n\n\tselectFirst(): boolean {\n\t\tswitch (this._state) {\n\t\t\tcase State.Hidden:\n\t\t\t\treturn false;\n\t\t\tcase State.Details:\n\t\t\t\tthis._details.widget.scrollTop();\n\t\t\t\treturn true;\n\t\t\tcase State.Loading:\n\t\t\t\treturn !this._isAuto;\n\t\t\tdefault:\n\t\t\t\tthis._list.focusFirst();\n\t\t\t\treturn true;\n\t\t}\n\t}\n\n\tgetFocusedItem(): ISelectedSuggestion | undefined {\n\t\tif (this._state !== State.Hidden\n\t\t\t&& this._state !== State.Empty\n\t\t\t&& this._state !== State.Loading\n\t\t\t&& this._completionModel\n\t\t) {\n\n\t\t\treturn {\n\t\t\t\titem: this._list.getFocusedElements()[0],\n\t\t\t\tindex: this._list.getFocus()[0],\n\t\t\t\tmodel: this._completionModel\n\t\t\t};\n\t\t}\n\t\treturn undefined;\n\t}\n\n\ttoggleDetailsFocus(): void {\n\t\tif (this._state === State.Details) {\n\t\t\tthis._setState(State.Open);\n\t\t\tif (this._detailsBorderColor) {\n\t\t\t\tthis._details.widget.domNode.style.borderColor = this._detailsBorderColor;\n\t\t\t}\n\t\t} else if (this._state === State.Open && this._isDetailsVisible()) {\n\t\t\tthis._setState(State.Details);\n\t\t\tif (this._detailsFocusBorderColor) {\n\t\t\t\tthis._details.widget.domNode.style.borderColor = this._detailsFocusBorderColor;\n\t\t\t}\n\t\t}\n\t}\n\n\ttoggleDetails(): void {\n\t\tif (this._isDetailsVisible()) {\n\t\t\t// hide details widget\n\t\t\tthis._ctxSuggestWidgetDetailsVisible.set(false);\n\t\t\tthis._setDetailsVisible(false);\n\t\t\tthis._details.hide();\n\t\t\tthis.element.domNode.classList.remove('shows-details');\n\n\t\t} else if ((canExpandCompletionItem(this._list.getFocusedElements()[0]) || this._explainMode) && (this._state === State.Open || this._state === State.Details || this._state === State.Frozen)) {\n\t\t\t// show details widget (iff possible)\n\t\t\tthis._ctxSuggestWidgetDetailsVisible.set(true);\n\t\t\tthis._setDetailsVisible(true);\n\t\t\tthis.showDetails(false);\n\t\t}\n\t}\n\n\tshowDetails(loading: boolean): void {\n\t\tthis._details.show();\n\t\tif (loading) {\n\t\t\tthis._details.widget.renderLoading();\n\t\t} else {\n\t\t\tthis._details.widget.renderItem(this._list.getFocusedElements()[0], this._explainMode);\n\t\t}\n\t\tthis._positionDetails();\n\t\tthis.editor.focus();\n\t\tthis.element.domNode.classList.add('shows-details');\n\t}\n\n\ttoggleExplainMode(): void {\n\t\tif (this._list.getFocusedElements()[0]) {\n\t\t\tthis._explainMode = !this._explainMode;\n\t\t\tif (!this._isDetailsVisible()) {\n\t\t\t\tthis.toggleDetails();\n\t\t\t} else {\n\t\t\t\tthis.showDetails(false);\n\t\t\t}\n\t\t}\n\t}\n\n\tresetPersistedSize(): void {\n\t\tthis._persistedSize.reset();\n\t}\n\n\thideWidget(): void {\n\t\tthis._loadingTimeout?.dispose();\n\t\tthis._setState(State.Hidden);\n\t\tthis._onDidHide.fire(this);\n\t\tthis.element.clearSashHoverState();\n\n\t\t// ensure that a reasonable widget height is persisted so that\n\t\t// accidential \"resize-to-single-items\" cases aren't happening\n\t\tconst dim = this._persistedSize.restore();\n\t\tconst minPersistedHeight = Math.ceil(this.getLayoutInfo().itemHeight * 4.3);\n\t\tif (dim && dim.height < minPersistedHeight) {\n\t\t\tthis._persistedSize.store(dim.with(undefined, minPersistedHeight));\n\t\t}\n\t}\n\n\tisFrozen(): boolean {\n\t\treturn this._state === State.Frozen;\n\t}\n\n\t_afterRender(position: ContentWidgetPositionPreference | null) {\n\t\tif (position === null) {\n\t\t\tif (this._isDetailsVisible()) {\n\t\t\t\tthis._details.hide(); //todo@jrieken soft-hide\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif (this._state === State.Empty || this._state === State.Loading) {\n\t\t\t// no special positioning when widget isn't showing list\n\t\t\treturn;\n\t\t}\n\t\tif (this._isDetailsVisible()) {\n\t\t\tthis._details.show();\n\t\t}\n\t\tthis._positionDetails();\n\t}\n\n\tprivate _layout(size: dom.Dimension | undefined): void {\n\t\tif (!this.editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\t\tif (!this.editor.getDomNode()) {\n\t\t\t// happens when running tests\n\t\t\treturn;\n\t\t}\n\n\t\tconst bodyBox = dom.getClientArea(document.body);\n\t\tconst info = this.getLayoutInfo();\n\n\t\tif (!size) {\n\t\t\tsize = info.defaultSize;\n\t\t}\n\n\t\tlet height = size.height;\n\t\tlet width = size.width;\n\n\t\t// status bar\n\t\tthis._status.element.style.lineHeight = `${info.itemHeight}px`;\n\n\t\tif (this._state === State.Empty || this._state === State.Loading) {\n\t\t\t// showing a message only\n\t\t\theight = info.itemHeight + info.borderHeight;\n\t\t\twidth = info.defaultSize.width / 2;\n\t\t\tthis.element.enableSashes(false, false, false, false);\n\t\t\tthis.element.minSize = this.element.maxSize = new dom.Dimension(width, height);\n\t\t\tthis._contentWidget.setPreference(ContentWidgetPositionPreference.BELOW);\n\n\t\t} else {\n\t\t\t// showing items\n\n\t\t\t// width math\n\t\t\tconst maxWidth = bodyBox.width - info.borderHeight - 2 * info.horizontalPadding;\n\t\t\tif (width > maxWidth) {\n\t\t\t\twidth = maxWidth;\n\t\t\t}\n\t\t\tconst preferredWidth = this._completionModel ? this._completionModel.stats.pLabelLen * info.typicalHalfwidthCharacterWidth : width;\n\n\t\t\t// height math\n\t\t\tconst fullHeight = info.statusBarHeight + this._list.contentHeight + info.borderHeight;\n\t\t\tconst minHeight = info.itemHeight + info.statusBarHeight;\n\t\t\tconst editorBox = dom.getDomNodePagePosition(this.editor.getDomNode());\n\t\t\tconst cursorBox = this.editor.getScrolledVisiblePosition(this.editor.getPosition());\n\t\t\tconst cursorBottom = editorBox.top + cursorBox.top + cursorBox.height;\n\t\t\tconst maxHeightBelow = Math.min(bodyBox.height - cursorBottom - info.verticalPadding, fullHeight);\n\t\t\tconst maxHeightAbove = Math.min(editorBox.top + cursorBox.top - info.verticalPadding, fullHeight);\n\t\t\tlet maxHeight = Math.min(Math.max(maxHeightAbove, maxHeightBelow) + info.borderHeight, fullHeight);\n\n\t\t\tif (height === this._cappedHeight?.capped) {\n\t\t\t\t// Restore the old (wanted) height when the current\n\t\t\t\t// height is capped to fit\n\t\t\t\theight = this._cappedHeight.wanted;\n\t\t\t}\n\n\t\t\tif (height < minHeight) {\n\t\t\t\theight = minHeight;\n\t\t\t}\n\t\t\tif (height > maxHeight) {\n\t\t\t\theight = maxHeight;\n\t\t\t}\n\n\t\t\tif (height > maxHeightBelow) {\n\t\t\t\tthis._contentWidget.setPreference(ContentWidgetPositionPreference.ABOVE);\n\t\t\t\tthis.element.enableSashes(true, true, false, false);\n\t\t\t\tmaxHeight = maxHeightAbove;\n\n\t\t\t} else {\n\t\t\t\tthis._contentWidget.setPreference(ContentWidgetPositionPreference.BELOW);\n\t\t\t\tthis.element.enableSashes(false, true, true, false);\n\t\t\t\tmaxHeight = maxHeightBelow;\n\t\t\t}\n\t\t\tthis.element.preferredSize = new dom.Dimension(preferredWidth, info.defaultSize.height);\n\t\t\tthis.element.maxSize = new dom.Dimension(maxWidth, maxHeight);\n\t\t\tthis.element.minSize = new dom.Dimension(220, minHeight);\n\n\t\t\t// Know when the height was capped to fit and remember\n\t\t\t// the wanted height for later. This is required when going\n\t\t\t// left to widen suggestions.\n\t\t\tthis._cappedHeight = height === fullHeight\n\t\t\t\t? { wanted: this._cappedHeight?.wanted ?? size.height, capped: height }\n\t\t\t\t: undefined;\n\t\t}\n\t\tthis._resize(width, height);\n\t}\n\n\tprivate _resize(width: number, height: number): void {\n\n\t\tconst { width: maxWidth, height: maxHeight } = this.element.maxSize;\n\t\twidth = Math.min(maxWidth, width);\n\t\theight = Math.min(maxHeight, height);\n\n\t\tconst { statusBarHeight } = this.getLayoutInfo();\n\t\tthis._list.layout(height - statusBarHeight, width);\n\t\tthis._listElement.style.height = `${height - statusBarHeight}px`;\n\t\tthis.element.layout(height, width);\n\t\tthis._contentWidget.layout();\n\n\t\tthis._positionDetails();\n\t}\n\n\tprivate _positionDetails(): void {\n\t\tif (this._isDetailsVisible()) {\n\t\t\tthis._details.placeAtAnchor(this.element.domNode);\n\t\t}\n\t}\n\n\tgetLayoutInfo() {\n\t\tconst fontInfo = this.editor.getOption(EditorOption.fontInfo);\n\t\tconst itemHeight = clamp(this.editor.getOption(EditorOption.suggestLineHeight) || fontInfo.lineHeight, 8, 1000);\n\t\tconst statusBarHeight = !this.editor.getOption(EditorOption.suggest).showStatusBar || this._state === State.Empty || this._state === State.Loading ? 0 : itemHeight;\n\t\tconst borderWidth = this._details.widget.borderWidth;\n\t\tconst borderHeight = 2 * borderWidth;\n\n\t\treturn {\n\t\t\titemHeight,\n\t\t\tstatusBarHeight,\n\t\t\tborderWidth,\n\t\t\tborderHeight,\n\t\t\ttypicalHalfwidthCharacterWidth: fontInfo.typicalHalfwidthCharacterWidth,\n\t\t\tverticalPadding: 22,\n\t\t\thorizontalPadding: 14,\n\t\t\tdefaultSize: new dom.Dimension(430, statusBarHeight + 12 * itemHeight + borderHeight)\n\t\t};\n\t}\n\n\tprivate _isDetailsVisible(): boolean {\n\t\treturn this._storageService.getBoolean('expandSuggestionDocs', StorageScope.GLOBAL, false);\n\t}\n\n\tprivate _setDetailsVisible(value: boolean) {\n\t\tthis._storageService.store('expandSuggestionDocs', value, StorageScope.GLOBAL, StorageTarget.USER);\n\t}\n}\n\nexport class SuggestContentWidget implements IContentWidget {\n\n\treadonly allowEditorOverflow = true;\n\treadonly suppressMouseDown = false;\n\n\tprivate _position?: IPosition | null;\n\tprivate _preference?: ContentWidgetPositionPreference;\n\tprivate _preferenceLocked = false;\n\n\tprivate _added: boolean = false;\n\tprivate _hidden: boolean = false;\n\n\tconstructor(\n\t\tprivate readonly _widget: SuggestWidget,\n\t\tprivate readonly _editor: ICodeEditor\n\t) { }\n\n\tdispose(): void {\n\t\tif (this._added) {\n\t\t\tthis._added = false;\n\t\t\tthis._editor.removeContentWidget(this);\n\t\t}\n\t}\n\n\tgetId(): string {\n\t\treturn 'editor.widget.suggestWidget';\n\t}\n\n\tgetDomNode(): HTMLElement {\n\t\treturn this._widget.element.domNode;\n\t}\n\n\tshow(): void {\n\t\tthis._hidden = false;\n\t\tif (!this._added) {\n\t\t\tthis._added = true;\n\t\t\tthis._editor.addContentWidget(this);\n\t\t}\n\t}\n\n\thide(): void {\n\t\tif (!this._hidden) {\n\t\t\tthis._hidden = true;\n\t\t\tthis.layout();\n\t\t}\n\t}\n\n\tlayout(): void {\n\t\tthis._editor.layoutContentWidget(this);\n\t}\n\n\tgetPosition(): IContentWidgetPosition | null {\n\t\tif (this._hidden || !this._position || !this._preference) {\n\t\t\treturn null;\n\t\t}\n\t\treturn {\n\t\t\tposition: this._position,\n\t\t\tpreference: [this._preference]\n\t\t};\n\t}\n\n\tbeforeRender() {\n\t\tconst { height, width } = this._widget.element.size;\n\t\tconst { borderWidth, horizontalPadding } = this._widget.getLayoutInfo();\n\t\treturn new dom.Dimension(width + 2 * borderWidth + horizontalPadding, height + 2 * borderWidth);\n\t}\n\n\tafterRender(position: ContentWidgetPositionPreference | null) {\n\t\tthis._widget._afterRender(position);\n\t}\n\n\tsetPreference(preference: ContentWidgetPositionPreference) {\n\t\tif (!this._preferenceLocked) {\n\t\t\tthis._preference = preference;\n\t\t}\n\t}\n\n\tlockPreference() {\n\t\tthis._preferenceLocked = true;\n\t}\n\n\tunlockPreference() {\n\t\tthis._preferenceLocked = false;\n\t}\n\n\tsetPosition(position: IPosition | null): void {\n\t\tthis._position = position;\n\t}\n}\n\nregisterThemingParticipant((theme, collector) => {\n\tconst matchHighlight = theme.getColor(editorSuggestWidgetHighlightForeground);\n\tif (matchHighlight) {\n\t\tcollector.addRule(`.monaco-editor .suggest-widget .monaco-list .monaco-list-row .monaco-highlighted-label .highlight { color: ${matchHighlight}; }`);\n\t}\n\tconst foreground = theme.getColor(editorSuggestWidgetForeground);\n\tif (foreground) {\n\t\tcollector.addRule(`.monaco-editor .suggest-widget, .monaco-editor .suggest-details { color: ${foreground}; }`);\n\t}\n\n\tconst link = theme.getColor(textLinkForeground);\n\tif (link) {\n\t\tcollector.addRule(`.monaco-editor .suggest-details a { color: ${link}; }`);\n\t}\n\n\tconst codeBackground = theme.getColor(textCodeBlockBackground);\n\tif (codeBackground) {\n\t\tcollector.addRule(`.monaco-editor .suggest-details code { background-color: ${codeBackground}; }`);\n\t}\n});\n"]}