{"version":3,"file":"findDecorations.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sources":["vs/editor/contrib/find/findDecorations.ts"],"names":[],"mappings":"AAAA;;;gGAGgG;;;;;IAWhG,MAAa,eAAe;QAU3B,YAAY,MAAyB;YACpC,IAAI,CAAC,OAAO,GAAG,MAAM,CAAC;YACtB,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;YACvB,IAAI,CAAC,oCAAoC,GAAG,EAAE,CAAC;YAC/C,IAAI,CAAC,uBAAuB,GAAG,EAAE,CAAC;YAClC,IAAI,CAAC,2BAA2B,GAAG,IAAI,CAAC;YACxC,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC;YACrC,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC;QAClD,CAAC;QAEM,OAAO;YACb,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,IAAI,CAAC,eAAe,EAAE,EAAE,EAAE,CAAC,CAAC;YAE1D,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;YACvB,IAAI,CAAC,oCAAoC,GAAG,EAAE,CAAC;YAC/C,IAAI,CAAC,uBAAuB,GAAG,EAAE,CAAC;YAClC,IAAI,CAAC,2BAA2B,GAAG,IAAI,CAAC;YACxC,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC;QACtC,CAAC;QAEM,KAAK;YACX,IAAI,CAAC,YAAY,GAAG,EAAE,CAAC;YACvB,IAAI,CAAC,oCAAoC,GAAG,EAAE,CAAC;YAC/C,IAAI,CAAC,uBAAuB,GAAG,EAAE,CAAC;YAClC,IAAI,CAAC,2BAA2B,GAAG,IAAI,CAAC;YACxC,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC;QACtC,CAAC;QAEM,QAAQ;YACd,OAAO,IAAI,CAAC,YAAY,CAAC,MAAM,CAAC;QACjC,CAAC;QAED,mEAAmE;QAC5D,YAAY;YAClB,IAAI,IAAI,CAAC,uBAAuB,CAAC,CAAC,CAAC,EAAE;gBACpC,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,kBAAkB,CAAC,IAAI,CAAC,uBAAuB,CAAC,CAAC,CAAC,CAAC,CAAC;aACnF;YACD,OAAO,IAAI,CAAC;QACb,CAAC;QAEM,aAAa;YACnB,IAAI,IAAI,CAAC,uBAAuB,CAAC,MAAM,EAAE;gBACxC,MAAM,MAAM,GAAG,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,qBAAqB,CAAC,EAAE,CACvE,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,kBAAkB,CAAC,qBAAqB,CAAC,CACjE,CAAC,MAAM,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC;gBAC/B,IAAI,MAAM,CAAC,MAAM,EAAE;oBAClB,OAAO,MAAiB,CAAC;iBACzB;aACD;YACD,OAAO,IAAI,CAAC;QACb,CAAC;QAEM,gBAAgB;YACtB,OAAO,IAAI,CAAC,cAAc,CAAC;QAC5B,CAAC;QAEM,gBAAgB,CAAC,gBAA0B;YACjD,IAAI,CAAC,cAAc,GAAG,gBAAgB,CAAC;YACvC,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;QAChC,CAAC;QAEO,mBAAmB,CAAC,YAAoB;YAC/C,MAAM,KAAK,GAAG,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;YACtD,IAAI,KAAK,IAAI,CAAC,EAAE;gBACf,OAAO,KAAK,GAAG,CAAC,CAAC;aACjB;YACD,OAAO,CAAC,CAAC;QACV,CAAC;QAEM,yBAAyB,CAAC,YAAmB;YACnD,IAAI,UAAU,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,qBAAqB,CAAC,YAAY,CAAC,CAAC;YAC7E,KAAK,MAAM,SAAS,IAAI,UAAU,EAAE;gBACnC,MAAM,aAAa,GAAG,SAAS,CAAC,OAAO,CAAC;gBACxC,IAAI,aAAa,KAAK,eAAe,CAAC,sBAAsB,IAAI,aAAa,KAAK,eAAe,CAAC,8BAA8B,EAAE;oBACjI,OAAO,IAAI,CAAC,mBAAmB,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;iBAC9C;aACD;YACD,uFAAuF;YACvF,OAAO,CAAC,CAAC;QACV,CAAC;QAEM,mBAAmB,CAAC,SAAuB;YACjD,IAAI,sBAAsB,GAAkB,IAAI,CAAC;YACjD,IAAI,aAAa,GAAG,CAAC,CAAC;YACtB,IAAI,SAAS,EAAE;gBACd,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;oBAC7D,IAAI,KAAK,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,kBAAkB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;oBAC7E,IAAI,SAAS,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE;wBACjC,sBAAsB,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;wBAC9C,aAAa,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;wBACxB,MAAM;qBACN;iBACD;aACD;YAED,IAAI,IAAI,CAAC,wBAAwB,KAAK,IAAI,IAAI,sBAAsB,KAAK,IAAI,EAAE;gBAC9E,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,cAA+C,EAAE,EAAE;oBAClF,IAAI,IAAI,CAAC,wBAAwB,KAAK,IAAI,EAAE;wBAC3C,cAAc,CAAC,uBAAuB,CAAC,IAAI,CAAC,wBAAwB,EAAE,eAAe,CAAC,sBAAsB,CAAC,CAAC;wBAC9G,IAAI,CAAC,wBAAwB,GAAG,IAAI,CAAC;qBACrC;oBACD,IAAI,sBAAsB,KAAK,IAAI,EAAE;wBACpC,IAAI,CAAC,wBAAwB,GAAG,sBAAsB,CAAC;wBACvD,cAAc,CAAC,uBAAuB,CAAC,IAAI,CAAC,wBAAwB,EAAE,eAAe,CAAC,8BAA8B,CAAC,CAAC;qBACtH;oBACD,IAAI,IAAI,CAAC,2BAA2B,KAAK,IAAI,EAAE;wBAC9C,cAAc,CAAC,gBAAgB,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAC;wBAClE,IAAI,CAAC,2BAA2B,GAAG,IAAI,CAAC;qBACxC;oBACD,IAAI,sBAAsB,KAAK,IAAI,EAAE;wBACpC,IAAI,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,kBAAkB,CAAC,sBAAsB,CAAE,CAAC;wBAC9E,IAAI,GAAG,CAAC,eAAe,KAAK,GAAG,CAAC,aAAa,IAAI,GAAG,CAAC,SAAS,KAAK,CAAC,EAAE;4BACrE,IAAI,aAAa,GAAG,GAAG,CAAC,aAAa,GAAG,CAAC,CAAC;4BAC1C,IAAI,sBAAsB,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,gBAAgB,CAAC,aAAa,CAAC,CAAC;4BACrF,GAAG,GAAG,IAAI,aAAK,CAAC,GAAG,CAAC,eAAe,EAAE,GAAG,CAAC,WAAW,EAAE,aAAa,EAAE,sBAAsB,CAAC,CAAC;yBAC7F;wBACD,IAAI,CAAC,2BAA2B,GAAG,cAAc,CAAC,aAAa,CAAC,GAAG,EAAE,eAAe,CAAC,2BAA2B,CAAC,CAAC;qBAClH;gBACF,CAAC,CAAC,CAAC;aACH;YAED,OAAO,aAAa,CAAC;QACtB,CAAC;QAEM,GAAG,CAAC,WAAwB,EAAE,UAA0B;YAC9D,IAAI,CAAC,OAAO,CAAC,iBAAiB,CAAC,CAAC,QAAQ,EAAE,EAAE;gBAE3C,IAAI,kBAAkB,GAA2B,eAAe,CAAC,sBAAsB,CAAC;gBACxF,IAAI,sCAAsC,GAA4B,EAAE,CAAC;gBAEzE,IAAI,WAAW,CAAC,MAAM,GAAG,IAAI,EAAE;oBAC9B,4EAA4E;oBAC5E,kHAAkH;oBAClH,kBAAkB,GAAG,eAAe,CAAC,kCAAkC,CAAC;oBAExE,iEAAiE;oBACjE,MAAM,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,YAAY,EAAE,CAAC;oBACzD,MAAM,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,CAAC,MAAM,CAAC;oBACnD,MAAM,mBAAmB,GAAG,MAAM,GAAG,SAAS,CAAC;oBAC/C,MAAM,eAAe,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC,GAAG,mBAAmB,CAAC,CAAC,CAAC;oBAExE,wCAAwC;oBACxC,IAAI,mBAAmB,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,eAAe,CAAC;oBAC/D,IAAI,iBAAiB,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,aAAa,CAAC;oBAC3D,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;wBACvD,MAAM,KAAK,GAAG,WAAW,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;wBACnC,IAAI,iBAAiB,GAAG,eAAe,IAAI,KAAK,CAAC,eAAe,EAAE;4BACjE,IAAI,KAAK,CAAC,aAAa,GAAG,iBAAiB,EAAE;gCAC5C,iBAAiB,GAAG,KAAK,CAAC,aAAa,CAAC;6BACxC;yBACD;6BAAM;4BACN,sCAAsC,CAAC,IAAI,CAAC;gCAC3C,KAAK,EAAE,IAAI,aAAK,CAAC,mBAAmB,EAAE,CAAC,EAAE,iBAAiB,EAAE,CAAC,CAAC;gCAC9D,OAAO,EAAE,eAAe,CAAC,oCAAoC;6BAC7D,CAAC,CAAC;4BACH,mBAAmB,GAAG,KAAK,CAAC,eAAe,CAAC;4BAC5C,iBAAiB,GAAG,KAAK,CAAC,aAAa,CAAC;yBACxC;qBACD;oBAED,sCAAsC,CAAC,IAAI,CAAC;wBAC3C,KAAK,EAAE,IAAI,aAAK,CAAC,mBAAmB,EAAE,CAAC,EAAE,iBAAiB,EAAE,CAAC,CAAC;wBAC9D,OAAO,EAAE,eAAe,CAAC,oCAAoC;qBAC7D,CAAC,CAAC;iBACH;gBAED,eAAe;gBACf,IAAI,yBAAyB,GAA4B,IAAI,KAAK,CAAwB,WAAW,CAAC,MAAM,CAAC,CAAC;gBAC9G,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,WAAW,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;oBACvD,yBAAyB,CAAC,CAAC,CAAC,GAAG;wBAC9B,KAAK,EAAE,WAAW,CAAC,CAAC,CAAC,CAAC,KAAK;wBAC3B,OAAO,EAAE,kBAAkB;qBAC3B,CAAC;iBACF;gBACD,IAAI,CAAC,YAAY,GAAG,QAAQ,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,EAAE,yBAAyB,CAAC,CAAC;gBAE5F,yCAAyC;gBACzC,IAAI,CAAC,oCAAoC,GAAG,QAAQ,CAAC,gBAAgB,CAAC,IAAI,CAAC,oCAAoC,EAAE,sCAAsC,CAAC,CAAC;gBAEzJ,kBAAkB;gBAClB,IAAI,IAAI,CAAC,2BAA2B,EAAE;oBACrC,QAAQ,CAAC,gBAAgB,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAC;oBAC5D,IAAI,CAAC,2BAA2B,GAAG,IAAI,CAAC;iBACxC;gBAED,aAAa;gBACb,IAAI,IAAI,CAAC,uBAAuB,CAAC,MAAM,EAAE;oBACxC,IAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC,qBAAqB,CAAC,EAAE,CAAC,QAAQ,CAAC,gBAAgB,CAAC,qBAAqB,CAAC,CAAC,CAAC;oBAChH,IAAI,CAAC,uBAAuB,GAAG,EAAE,CAAC;iBAClC;gBACD,IAAI,UAAU,aAAV,UAAU,uBAAV,UAAU,CAAE,MAAM,EAAE;oBACvB,IAAI,CAAC,uBAAuB,GAAG,UAAU,CAAC,GAAG,CAAC,SAAS,CAAC,EAAE,CAAC,QAAQ,CAAC,aAAa,CAAC,SAAS,EAAE,eAAe,CAAC,sBAAsB,CAAC,CAAC,CAAC;iBACtI;YACF,CAAC,CAAC,CAAC;QACJ,CAAC;QAEM,mBAAmB,CAAC,QAAkB;YAC5C,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,KAAK,CAAC,EAAE;gBACnC,OAAO,IAAI,CAAC;aACZ;YACD,KAAK,IAAI,CAAC,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;gBACvD,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;gBACxC,IAAI,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,kBAAkB,CAAC,YAAY,CAAC,CAAC;gBACjE,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,aAAa,GAAG,QAAQ,CAAC,UAAU,EAAE;oBAChD,SAAS;iBACT;gBACD,IAAI,CAAC,CAAC,aAAa,GAAG,QAAQ,CAAC,UAAU,EAAE;oBAC1C,OAAO,CAAC,CAAC;iBACT;gBACD,IAAI,CAAC,CAAC,SAAS,GAAG,QAAQ,CAAC,MAAM,EAAE;oBAClC,SAAS;iBACT;gBACD,OAAO,CAAC,CAAC;aACT;YAED,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,kBAAkB,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC;QACpG,CAAC;QAEM,kBAAkB,CAAC,QAAkB;YAC3C,IAAI,IAAI,CAAC,YAAY,CAAC,MAAM,KAAK,CAAC,EAAE;gBACnC,OAAO,IAAI,CAAC;aACZ;YACD,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,GAAG,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE;gBAC7D,IAAI,YAAY,GAAG,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;gBACxC,IAAI,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,kBAAkB,CAAC,YAAY,CAAC,CAAC;gBACjE,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,eAAe,GAAG,QAAQ,CAAC,UAAU,EAAE;oBAClD,SAAS;iBACT;gBACD,IAAI,CAAC,CAAC,eAAe,GAAG,QAAQ,CAAC,UAAU,EAAE;oBAC5C,OAAO,CAAC,CAAC;iBACT;gBACD,IAAI,CAAC,CAAC,WAAW,GAAG,QAAQ,CAAC,MAAM,EAAE;oBACpC,SAAS;iBACT;gBACD,OAAO,CAAC,CAAC;aACT;YAED,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,EAAE,CAAC,kBAAkB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,CAAC;QACzE,CAAC;QAEO,eAAe;YACtB,IAAI,MAAM,GAAa,EAAE,CAAC;YAC1B,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YAC1C,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,oCAAoC,CAAC,CAAC;YAClE,IAAI,IAAI,CAAC,uBAAuB,CAAC,MAAM,EAAE;gBACxC,MAAM,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,uBAAuB,CAAC,CAAC;aAC7C;YACD,IAAI,IAAI,CAAC,2BAA2B,EAAE;gBACrC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,2BAA2B,CAAC,CAAC;aAC9C;YACD,OAAO,MAAM,CAAC;QACf,CAAC;;IArQF,0CA4TC;IArDuB,8CAA8B,GAAG,kCAAsB,CAAC,QAAQ,CAAC;QACvF,UAAU,qCAAoD;QAC9D,MAAM,EAAE,EAAE;QACV,SAAS,EAAE,kBAAkB;QAC7B,eAAe,EAAE,IAAI;QACrB,aAAa,EAAE;YACd,KAAK,EAAE,CAAA,GAAA,+BAAgB,CAAA,CAAC,gDAAgC,CAAC;YACzD,QAAQ,EAAE,yBAAiB,CAAC,MAAM;SAClC;QACD,OAAO,EAAE;YACR,KAAK,EAAE,CAAA,GAAA,+BAAgB,CAAA,CAAC,gCAAgB,CAAC;YACzC,QAAQ,EAAE,uBAAe,CAAC,MAAM;SAChC;KACD,CAAC,CAAC;IAEoB,sCAAsB,GAAG,kCAAsB,CAAC,QAAQ,CAAC;QAC/E,UAAU,qCAAoD;QAC9D,SAAS,EAAE,WAAW;QACtB,eAAe,EAAE,IAAI;QACrB,aAAa,EAAE;YACd,KAAK,EAAE,CAAA,GAAA,+BAAgB,CAAA,CAAC,gDAAgC,CAAC;YACzD,QAAQ,EAAE,yBAAiB,CAAC,MAAM;SAClC;QACD,OAAO,EAAE;YACR,KAAK,EAAE,CAAA,GAAA,+BAAgB,CAAA,CAAC,gCAAgB,CAAC;YACzC,QAAQ,EAAE,uBAAe,CAAC,MAAM;SAChC;KACD,CAAC,CAAC;IAEoB,kDAAkC,GAAG,kCAAsB,CAAC,QAAQ,CAAC;QAC3F,UAAU,qCAAoD;QAC9D,SAAS,EAAE,WAAW;QACtB,eAAe,EAAE,IAAI;KACrB,CAAC,CAAC;IAEqB,oDAAoC,GAAG,kCAAsB,CAAC,QAAQ,CAAC;QAC9F,UAAU,qCAAoD;QAC9D,aAAa,EAAE;YACd,KAAK,EAAE,CAAA,GAAA,+BAAgB,CAAA,CAAC,gDAAgC,CAAC;YACzD,QAAQ,EAAE,yBAAiB,CAAC,MAAM;SAClC;KACD,CAAC,CAAC;IAEqB,2CAA2B,GAAG,kCAAsB,CAAC,QAAQ,CAAC;QACrF,UAAU,qCAAoD;QAC9D,SAAS,EAAE,gBAAgB;QAC3B,WAAW,EAAE,IAAI;KACjB,CAAC,CAAC;IAEqB,sCAAsB,GAAG,kCAAsB,CAAC,QAAQ,CAAC;QAChF,SAAS,EAAE,WAAW;QACtB,WAAW,EAAE,IAAI;KACjB,CAAC,CAAC","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport { IDisposable } from 'vs/base/common/lifecycle';\nimport { IActiveCodeEditor } from 'vs/editor/browser/editorBrowser';\nimport { Position } from 'vs/editor/common/core/position';\nimport { Range } from 'vs/editor/common/core/range';\nimport { FindMatch, IModelDecorationsChangeAccessor, IModelDeltaDecoration, OverviewRulerLane, TrackedRangeStickiness, MinimapPosition } from 'vs/editor/common/model';\nimport { ModelDecorationOptions } from 'vs/editor/common/model/textModel';\nimport { overviewRulerFindMatchForeground, minimapFindMatch } from 'vs/platform/theme/common/colorRegistry';\nimport { themeColorFromId } from 'vs/platform/theme/common/themeService';\n\nexport class FindDecorations implements IDisposable {\n\n\tprivate readonly _editor: IActiveCodeEditor;\n\tprivate _decorations: string[];\n\tprivate _overviewRulerApproximateDecorations: string[];\n\tprivate _findScopeDecorationIds: string[];\n\tprivate _rangeHighlightDecorationId: string | null;\n\tprivate _highlightedDecorationId: string | null;\n\tprivate _startPosition: Position;\n\n\tconstructor(editor: IActiveCodeEditor) {\n\t\tthis._editor = editor;\n\t\tthis._decorations = [];\n\t\tthis._overviewRulerApproximateDecorations = [];\n\t\tthis._findScopeDecorationIds = [];\n\t\tthis._rangeHighlightDecorationId = null;\n\t\tthis._highlightedDecorationId = null;\n\t\tthis._startPosition = this._editor.getPosition();\n\t}\n\n\tpublic dispose(): void {\n\t\tthis._editor.deltaDecorations(this._allDecorations(), []);\n\n\t\tthis._decorations = [];\n\t\tthis._overviewRulerApproximateDecorations = [];\n\t\tthis._findScopeDecorationIds = [];\n\t\tthis._rangeHighlightDecorationId = null;\n\t\tthis._highlightedDecorationId = null;\n\t}\n\n\tpublic reset(): void {\n\t\tthis._decorations = [];\n\t\tthis._overviewRulerApproximateDecorations = [];\n\t\tthis._findScopeDecorationIds = [];\n\t\tthis._rangeHighlightDecorationId = null;\n\t\tthis._highlightedDecorationId = null;\n\t}\n\n\tpublic getCount(): number {\n\t\treturn this._decorations.length;\n\t}\n\n\t/** @deprecated use getFindScopes to support multiple selections */\n\tpublic getFindScope(): Range | null {\n\t\tif (this._findScopeDecorationIds[0]) {\n\t\t\treturn this._editor.getModel().getDecorationRange(this._findScopeDecorationIds[0]);\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic getFindScopes(): Range[] | null {\n\t\tif (this._findScopeDecorationIds.length) {\n\t\t\tconst scopes = this._findScopeDecorationIds.map(findScopeDecorationId =>\n\t\t\t\tthis._editor.getModel().getDecorationRange(findScopeDecorationId)\n\t\t\t).filter(element => !!element);\n\t\t\tif (scopes.length) {\n\t\t\t\treturn scopes as Range[];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic getStartPosition(): Position {\n\t\treturn this._startPosition;\n\t}\n\n\tpublic setStartPosition(newStartPosition: Position): void {\n\t\tthis._startPosition = newStartPosition;\n\t\tthis.setCurrentFindMatch(null);\n\t}\n\n\tprivate _getDecorationIndex(decorationId: string): number {\n\t\tconst index = this._decorations.indexOf(decorationId);\n\t\tif (index >= 0) {\n\t\t\treturn index + 1;\n\t\t}\n\t\treturn 1;\n\t}\n\n\tpublic getCurrentMatchesPosition(desiredRange: Range): number {\n\t\tlet candidates = this._editor.getModel().getDecorationsInRange(desiredRange);\n\t\tfor (const candidate of candidates) {\n\t\t\tconst candidateOpts = candidate.options;\n\t\t\tif (candidateOpts === FindDecorations._FIND_MATCH_DECORATION || candidateOpts === FindDecorations._CURRENT_FIND_MATCH_DECORATION) {\n\t\t\t\treturn this._getDecorationIndex(candidate.id);\n\t\t\t}\n\t\t}\n\t\t// We don't know the current match position, so returns zero to show '?' in find widget\n\t\treturn 0;\n\t}\n\n\tpublic setCurrentFindMatch(nextMatch: Range | null): number {\n\t\tlet newCurrentDecorationId: string | null = null;\n\t\tlet matchPosition = 0;\n\t\tif (nextMatch) {\n\t\t\tfor (let i = 0, len = this._decorations.length; i < len; i++) {\n\t\t\t\tlet range = this._editor.getModel().getDecorationRange(this._decorations[i]);\n\t\t\t\tif (nextMatch.equalsRange(range)) {\n\t\t\t\t\tnewCurrentDecorationId = this._decorations[i];\n\t\t\t\t\tmatchPosition = (i + 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (this._highlightedDecorationId !== null || newCurrentDecorationId !== null) {\n\t\t\tthis._editor.changeDecorations((changeAccessor: IModelDecorationsChangeAccessor) => {\n\t\t\t\tif (this._highlightedDecorationId !== null) {\n\t\t\t\t\tchangeAccessor.changeDecorationOptions(this._highlightedDecorationId, FindDecorations._FIND_MATCH_DECORATION);\n\t\t\t\t\tthis._highlightedDecorationId = null;\n\t\t\t\t}\n\t\t\t\tif (newCurrentDecorationId !== null) {\n\t\t\t\t\tthis._highlightedDecorationId = newCurrentDecorationId;\n\t\t\t\t\tchangeAccessor.changeDecorationOptions(this._highlightedDecorationId, FindDecorations._CURRENT_FIND_MATCH_DECORATION);\n\t\t\t\t}\n\t\t\t\tif (this._rangeHighlightDecorationId !== null) {\n\t\t\t\t\tchangeAccessor.removeDecoration(this._rangeHighlightDecorationId);\n\t\t\t\t\tthis._rangeHighlightDecorationId = null;\n\t\t\t\t}\n\t\t\t\tif (newCurrentDecorationId !== null) {\n\t\t\t\t\tlet rng = this._editor.getModel().getDecorationRange(newCurrentDecorationId)!;\n\t\t\t\t\tif (rng.startLineNumber !== rng.endLineNumber && rng.endColumn === 1) {\n\t\t\t\t\t\tlet lineBeforeEnd = rng.endLineNumber - 1;\n\t\t\t\t\t\tlet lineBeforeEndMaxColumn = this._editor.getModel().getLineMaxColumn(lineBeforeEnd);\n\t\t\t\t\t\trng = new Range(rng.startLineNumber, rng.startColumn, lineBeforeEnd, lineBeforeEndMaxColumn);\n\t\t\t\t\t}\n\t\t\t\t\tthis._rangeHighlightDecorationId = changeAccessor.addDecoration(rng, FindDecorations._RANGE_HIGHLIGHT_DECORATION);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn matchPosition;\n\t}\n\n\tpublic set(findMatches: FindMatch[], findScopes: Range[] | null): void {\n\t\tthis._editor.changeDecorations((accessor) => {\n\n\t\t\tlet findMatchesOptions: ModelDecorationOptions = FindDecorations._FIND_MATCH_DECORATION;\n\t\t\tlet newOverviewRulerApproximateDecorations: IModelDeltaDecoration[] = [];\n\n\t\t\tif (findMatches.length > 1000) {\n\t\t\t\t// we go into a mode where the overview ruler gets \"approximate\" decorations\n\t\t\t\t// the reason is that the overview ruler paints all the decorations in the file and we don't want to cause freezes\n\t\t\t\tfindMatchesOptions = FindDecorations._FIND_MATCH_NO_OVERVIEW_DECORATION;\n\n\t\t\t\t// approximate a distance in lines where matches should be merged\n\t\t\t\tconst lineCount = this._editor.getModel().getLineCount();\n\t\t\t\tconst height = this._editor.getLayoutInfo().height;\n\t\t\t\tconst approxPixelsPerLine = height / lineCount;\n\t\t\t\tconst mergeLinesDelta = Math.max(2, Math.ceil(3 / approxPixelsPerLine));\n\n\t\t\t\t// merge decorations as much as possible\n\t\t\t\tlet prevStartLineNumber = findMatches[0].range.startLineNumber;\n\t\t\t\tlet prevEndLineNumber = findMatches[0].range.endLineNumber;\n\t\t\t\tfor (let i = 1, len = findMatches.length; i < len; i++) {\n\t\t\t\t\tconst range = findMatches[i].range;\n\t\t\t\t\tif (prevEndLineNumber + mergeLinesDelta >= range.startLineNumber) {\n\t\t\t\t\t\tif (range.endLineNumber > prevEndLineNumber) {\n\t\t\t\t\t\t\tprevEndLineNumber = range.endLineNumber;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnewOverviewRulerApproximateDecorations.push({\n\t\t\t\t\t\t\trange: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\n\t\t\t\t\t\t\toptions: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\n\t\t\t\t\t\t});\n\t\t\t\t\t\tprevStartLineNumber = range.startLineNumber;\n\t\t\t\t\t\tprevEndLineNumber = range.endLineNumber;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tnewOverviewRulerApproximateDecorations.push({\n\t\t\t\t\trange: new Range(prevStartLineNumber, 1, prevEndLineNumber, 1),\n\t\t\t\t\toptions: FindDecorations._FIND_MATCH_ONLY_OVERVIEW_DECORATION\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Find matches\n\t\t\tlet newFindMatchesDecorations: IModelDeltaDecoration[] = new Array<IModelDeltaDecoration>(findMatches.length);\n\t\t\tfor (let i = 0, len = findMatches.length; i < len; i++) {\n\t\t\t\tnewFindMatchesDecorations[i] = {\n\t\t\t\t\trange: findMatches[i].range,\n\t\t\t\t\toptions: findMatchesOptions\n\t\t\t\t};\n\t\t\t}\n\t\t\tthis._decorations = accessor.deltaDecorations(this._decorations, newFindMatchesDecorations);\n\n\t\t\t// Overview ruler approximate decorations\n\t\t\tthis._overviewRulerApproximateDecorations = accessor.deltaDecorations(this._overviewRulerApproximateDecorations, newOverviewRulerApproximateDecorations);\n\n\t\t\t// Range highlight\n\t\t\tif (this._rangeHighlightDecorationId) {\n\t\t\t\taccessor.removeDecoration(this._rangeHighlightDecorationId);\n\t\t\t\tthis._rangeHighlightDecorationId = null;\n\t\t\t}\n\n\t\t\t// Find scope\n\t\t\tif (this._findScopeDecorationIds.length) {\n\t\t\t\tthis._findScopeDecorationIds.forEach(findScopeDecorationId => accessor.removeDecoration(findScopeDecorationId));\n\t\t\t\tthis._findScopeDecorationIds = [];\n\t\t\t}\n\t\t\tif (findScopes?.length) {\n\t\t\t\tthis._findScopeDecorationIds = findScopes.map(findScope => accessor.addDecoration(findScope, FindDecorations._FIND_SCOPE_DECORATION));\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic matchBeforePosition(position: Position): Range | null {\n\t\tif (this._decorations.length === 0) {\n\t\t\treturn null;\n\t\t}\n\t\tfor (let i = this._decorations.length - 1; i >= 0; i--) {\n\t\t\tlet decorationId = this._decorations[i];\n\t\t\tlet r = this._editor.getModel().getDecorationRange(decorationId);\n\t\t\tif (!r || r.endLineNumber > position.lineNumber) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (r.endLineNumber < position.lineNumber) {\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tif (r.endColumn > position.column) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\treturn r;\n\t\t}\n\n\t\treturn this._editor.getModel().getDecorationRange(this._decorations[this._decorations.length - 1]);\n\t}\n\n\tpublic matchAfterPosition(position: Position): Range | null {\n\t\tif (this._decorations.length === 0) {\n\t\t\treturn null;\n\t\t}\n\t\tfor (let i = 0, len = this._decorations.length; i < len; i++) {\n\t\t\tlet decorationId = this._decorations[i];\n\t\t\tlet r = this._editor.getModel().getDecorationRange(decorationId);\n\t\t\tif (!r || r.startLineNumber < position.lineNumber) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif (r.startLineNumber > position.lineNumber) {\n\t\t\t\treturn r;\n\t\t\t}\n\t\t\tif (r.startColumn < position.column) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\treturn r;\n\t\t}\n\n\t\treturn this._editor.getModel().getDecorationRange(this._decorations[0]);\n\t}\n\n\tprivate _allDecorations(): string[] {\n\t\tlet result: string[] = [];\n\t\tresult = result.concat(this._decorations);\n\t\tresult = result.concat(this._overviewRulerApproximateDecorations);\n\t\tif (this._findScopeDecorationIds.length) {\n\t\t\tresult.push(...this._findScopeDecorationIds);\n\t\t}\n\t\tif (this._rangeHighlightDecorationId) {\n\t\t\tresult.push(this._rangeHighlightDecorationId);\n\t\t}\n\t\treturn result;\n\t}\n\n\tpublic static readonly _CURRENT_FIND_MATCH_DECORATION = ModelDecorationOptions.register({\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tzIndex: 13,\n\t\tclassName: 'currentFindMatch',\n\t\tshowIfCollapsed: true,\n\t\toverviewRuler: {\n\t\t\tcolor: themeColorFromId(overviewRulerFindMatchForeground),\n\t\t\tposition: OverviewRulerLane.Center\n\t\t},\n\t\tminimap: {\n\t\t\tcolor: themeColorFromId(minimapFindMatch),\n\t\t\tposition: MinimapPosition.Inline\n\t\t}\n\t});\n\n\tpublic static readonly _FIND_MATCH_DECORATION = ModelDecorationOptions.register({\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tclassName: 'findMatch',\n\t\tshowIfCollapsed: true,\n\t\toverviewRuler: {\n\t\t\tcolor: themeColorFromId(overviewRulerFindMatchForeground),\n\t\t\tposition: OverviewRulerLane.Center\n\t\t},\n\t\tminimap: {\n\t\t\tcolor: themeColorFromId(minimapFindMatch),\n\t\t\tposition: MinimapPosition.Inline\n\t\t}\n\t});\n\n\tpublic static readonly _FIND_MATCH_NO_OVERVIEW_DECORATION = ModelDecorationOptions.register({\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tclassName: 'findMatch',\n\t\tshowIfCollapsed: true\n\t});\n\n\tprivate static readonly _FIND_MATCH_ONLY_OVERVIEW_DECORATION = ModelDecorationOptions.register({\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\toverviewRuler: {\n\t\t\tcolor: themeColorFromId(overviewRulerFindMatchForeground),\n\t\t\tposition: OverviewRulerLane.Center\n\t\t}\n\t});\n\n\tprivate static readonly _RANGE_HIGHLIGHT_DECORATION = ModelDecorationOptions.register({\n\t\tstickiness: TrackedRangeStickiness.NeverGrowsWhenTypingAtEdges,\n\t\tclassName: 'rangeHighlight',\n\t\tisWholeLine: true\n\t});\n\n\tprivate static readonly _FIND_SCOPE_DECORATION = ModelDecorationOptions.register({\n\t\tclassName: 'findScope',\n\t\tisWholeLine: true\n\t});\n}\n"]}