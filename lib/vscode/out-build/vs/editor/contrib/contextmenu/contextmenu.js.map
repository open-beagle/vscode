{"version":3,"sources":["vs/editor/contrib/contextmenu/contextmenu.ts"],"names":[],"mappings":"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","file":"contextmenu.js","sourceRoot":"file:///go/src/gitlab.wodcloud.com/cloud/vscode/lib/vscode/src","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as nls from 'vs/nls';\nimport * as dom from 'vs/base/browser/dom';\nimport { IKeyboardEvent } from 'vs/base/browser/keyboardEvent';\nimport { IAnchor } from 'vs/base/browser/ui/contextview/contextview';\nimport { IAction, Separator, SubmenuAction } from 'vs/base/common/actions';\nimport { KeyCode, KeyMod, ResolvedKeybinding } from 'vs/base/common/keyCodes';\nimport { DisposableStore } from 'vs/base/common/lifecycle';\nimport { ICodeEditor, IEditorMouseEvent, MouseTargetType } from 'vs/editor/browser/editorBrowser';\nimport { EditorAction, ServicesAccessor, registerEditorAction, registerEditorContribution } from 'vs/editor/browser/editorExtensions';\nimport { IEditorContribution, ScrollType } from 'vs/editor/common/editorCommon';\nimport { EditorContextKeys } from 'vs/editor/common/editorContextKeys';\nimport { IMenuService, MenuId, SubmenuItemAction } from 'vs/platform/actions/common/actions';\nimport { IContextKeyService } from 'vs/platform/contextkey/common/contextkey';\nimport { IContextMenuService, IContextViewService } from 'vs/platform/contextview/browser/contextView';\nimport { IKeybindingService } from 'vs/platform/keybinding/common/keybinding';\nimport { KeybindingWeight } from 'vs/platform/keybinding/common/keybindingsRegistry';\nimport { ITextModel } from 'vs/editor/common/model';\nimport { IMouseWheelEvent } from 'vs/base/browser/mouseEvent';\nimport { EditorOption } from 'vs/editor/common/config/editorOptions';\nimport { ActionViewItem } from 'vs/base/browser/ui/actionbar/actionViewItems';\n\nexport class ContextMenuController implements IEditorContribution {\n\n\tpublic static readonly ID = 'editor.contrib.contextmenu';\n\n\tpublic static get(editor: ICodeEditor): ContextMenuController {\n\t\treturn editor.getContribution<ContextMenuController>(ContextMenuController.ID);\n\t}\n\n\tprivate readonly _toDispose = new DisposableStore();\n\tprivate _contextMenuIsBeingShownCount: number = 0;\n\tprivate readonly _editor: ICodeEditor;\n\n\tconstructor(\n\t\teditor: ICodeEditor,\n\t\t@IContextMenuService private readonly _contextMenuService: IContextMenuService,\n\t\t@IContextViewService private readonly _contextViewService: IContextViewService,\n\t\t@IContextKeyService private readonly _contextKeyService: IContextKeyService,\n\t\t@IKeybindingService private readonly _keybindingService: IKeybindingService,\n\t\t@IMenuService private readonly _menuService: IMenuService\n\t) {\n\t\tthis._editor = editor;\n\n\t\tthis._toDispose.add(this._editor.onContextMenu((e: IEditorMouseEvent) => this._onContextMenu(e)));\n\t\tthis._toDispose.add(this._editor.onMouseWheel((e: IMouseWheelEvent) => {\n\t\t\tif (this._contextMenuIsBeingShownCount > 0) {\n\t\t\t\tconst view = this._contextViewService.getContextViewElement();\n\t\t\t\tconst target = e.srcElement as HTMLElement;\n\n\t\t\t\t// Event triggers on shadow root host first\n\t\t\t\t// Check if the context view is under this host before hiding it #103169\n\t\t\t\tif (!(target.shadowRoot && dom.getShadowRoot(view) === target.shadowRoot)) {\n\t\t\t\t\tthis._contextViewService.hideContextView();\n\t\t\t\t}\n\t\t\t}\n\t\t}));\n\t\tthis._toDispose.add(this._editor.onKeyDown((e: IKeyboardEvent) => {\n\t\t\tif (e.keyCode === KeyCode.ContextMenu) {\n\t\t\t\t// Chrome is funny like that\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.showContextMenu();\n\t\t\t}\n\t\t}));\n\t}\n\n\tprivate _onContextMenu(e: IEditorMouseEvent): void {\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._editor.getOption(EditorOption.contextmenu)) {\n\t\t\tthis._editor.focus();\n\t\t\t// Ensure the cursor is at the position of the mouse click\n\t\t\tif (e.target.position && !this._editor.getSelection().containsPosition(e.target.position)) {\n\t\t\t\tthis._editor.setPosition(e.target.position);\n\t\t\t}\n\t\t\treturn; // Context menu is turned off through configuration\n\t\t}\n\n\t\tif (e.target.type === MouseTargetType.OVERLAY_WIDGET) {\n\t\t\treturn; // allow native menu on widgets to support right click on input field for example in find\n\t\t}\n\n\t\te.event.preventDefault();\n\n\t\tif (e.target.type !== MouseTargetType.CONTENT_TEXT && e.target.type !== MouseTargetType.CONTENT_EMPTY && e.target.type !== MouseTargetType.TEXTAREA) {\n\t\t\treturn; // only support mouse click into text or native context menu key for now\n\t\t}\n\n\t\t// Ensure the editor gets focus if it hasn't, so the right events are being sent to other contributions\n\t\tthis._editor.focus();\n\n\t\t// Ensure the cursor is at the position of the mouse click\n\t\tif (e.target.position) {\n\t\t\tlet hasSelectionAtPosition = false;\n\t\t\tfor (const selection of this._editor.getSelections()) {\n\t\t\t\tif (selection.containsPosition(e.target.position)) {\n\t\t\t\t\thasSelectionAtPosition = true;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (!hasSelectionAtPosition) {\n\t\t\t\tthis._editor.setPosition(e.target.position);\n\t\t\t}\n\t\t}\n\n\t\t// Unless the user triggerd the context menu through Shift+F10, use the mouse position as menu position\n\t\tlet anchor: IAnchor | null = null;\n\t\tif (e.target.type !== MouseTargetType.TEXTAREA) {\n\t\t\tanchor = { x: e.event.posx - 1, width: 2, y: e.event.posy - 1, height: 2 };\n\t\t}\n\n\t\t// Show the context menu\n\t\tthis.showContextMenu(anchor);\n\t}\n\n\tpublic showContextMenu(anchor?: IAnchor | null): void {\n\t\tif (!this._editor.getOption(EditorOption.contextmenu)) {\n\t\t\treturn; // Context menu is turned off through configuration\n\t\t}\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (!this._contextMenuService) {\n\t\t\tthis._editor.focus();\n\t\t\treturn;\t// We need the context menu service to function\n\t\t}\n\n\t\t// Find actions available for menu\n\t\tconst menuActions = this._getMenuActions(this._editor.getModel(), MenuId.EditorContext);\n\n\t\t// Show menu if we have actions to show\n\t\tif (menuActions.length > 0) {\n\t\t\tthis._doShowContextMenu(menuActions, anchor);\n\t\t}\n\t}\n\n\tprivate _getMenuActions(model: ITextModel, menuId: MenuId): IAction[] {\n\t\tconst result: IAction[] = [];\n\n\t\t// get menu groups\n\t\tconst menu = this._menuService.createMenu(menuId, this._contextKeyService);\n\t\tconst groups = menu.getActions({ arg: model.uri });\n\t\tmenu.dispose();\n\n\t\t// translate them into other actions\n\t\tfor (let group of groups) {\n\t\t\tconst [, actions] = group;\n\t\t\tlet addedItems = 0;\n\t\t\tfor (const action of actions) {\n\t\t\t\tif (action instanceof SubmenuItemAction) {\n\t\t\t\t\tconst subActions = this._getMenuActions(model, action.item.submenu);\n\t\t\t\t\tif (subActions.length > 0) {\n\t\t\t\t\t\tresult.push(new SubmenuAction(action.id, action.label, subActions));\n\t\t\t\t\t\taddedItems++;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tresult.push(action);\n\t\t\t\t\taddedItems++;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (addedItems) {\n\t\t\t\tresult.push(new Separator());\n\t\t\t}\n\t\t}\n\n\t\tif (result.length) {\n\t\t\tresult.pop(); // remove last separator\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprivate _doShowContextMenu(actions: IAction[], anchor: IAnchor | null = null): void {\n\t\tif (!this._editor.hasModel()) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Disable hover\n\t\tconst oldHoverSetting = this._editor.getOption(EditorOption.hover);\n\t\tthis._editor.updateOptions({\n\t\t\thover: {\n\t\t\t\tenabled: false\n\t\t\t}\n\t\t});\n\n\t\tif (!anchor) {\n\t\t\t// Ensure selection is visible\n\t\t\tthis._editor.revealPosition(this._editor.getPosition(), ScrollType.Immediate);\n\n\t\t\tthis._editor.render();\n\t\t\tconst cursorCoords = this._editor.getScrolledVisiblePosition(this._editor.getPosition());\n\n\t\t\t// Translate to absolute editor position\n\t\t\tconst editorCoords = dom.getDomNodePagePosition(this._editor.getDomNode());\n\t\t\tconst posx = editorCoords.left + cursorCoords.left;\n\t\t\tconst posy = editorCoords.top + cursorCoords.top + cursorCoords.height;\n\n\t\t\tanchor = { x: posx, y: posy };\n\t\t}\n\n\t\t// Show menu\n\t\tthis._contextMenuIsBeingShownCount++;\n\t\tthis._contextMenuService.showContextMenu({\n\t\t\tdomForShadowRoot: this._editor.getDomNode(),\n\n\t\t\tgetAnchor: () => anchor!,\n\n\t\t\tgetActions: () => actions,\n\n\t\t\tgetActionViewItem: (action) => {\n\t\t\t\tconst keybinding = this._keybindingFor(action);\n\t\t\t\tif (keybinding) {\n\t\t\t\t\treturn new ActionViewItem(action, action, { label: true, keybinding: keybinding.getLabel(), isMenu: true });\n\t\t\t\t}\n\n\t\t\t\tconst customActionViewItem = <any>action;\n\t\t\t\tif (typeof customActionViewItem.getActionViewItem === 'function') {\n\t\t\t\t\treturn customActionViewItem.getActionViewItem();\n\t\t\t\t}\n\n\t\t\t\treturn new ActionViewItem(action, action, { icon: true, label: true, isMenu: true });\n\t\t\t},\n\n\t\t\tgetKeyBinding: (action): ResolvedKeybinding | undefined => {\n\t\t\t\treturn this._keybindingFor(action);\n\t\t\t},\n\n\t\t\tonHide: (wasCancelled: boolean) => {\n\t\t\t\tthis._contextMenuIsBeingShownCount--;\n\t\t\t\tthis._editor.focus();\n\t\t\t\tthis._editor.updateOptions({\n\t\t\t\t\thover: oldHoverSetting\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate _keybindingFor(action: IAction): ResolvedKeybinding | undefined {\n\t\treturn this._keybindingService.lookupKeybinding(action.id);\n\t}\n\n\tpublic dispose(): void {\n\t\tif (this._contextMenuIsBeingShownCount > 0) {\n\t\t\tthis._contextViewService.hideContextView();\n\t\t}\n\n\t\tthis._toDispose.dispose();\n\t}\n}\n\nclass ShowContextMenu extends EditorAction {\n\n\tconstructor() {\n\t\tsuper({\n\t\t\tid: 'editor.action.showContextMenu',\n\t\t\tlabel: nls.localize('action.showContextMenu.label', \"Show Editor Context Menu\"),\n\t\t\talias: 'Show Editor Context Menu',\n\t\t\tprecondition: undefined,\n\t\t\tkbOpts: {\n\t\t\t\tkbExpr: EditorContextKeys.textInputFocus,\n\t\t\t\tprimary: KeyMod.Shift | KeyCode.F10,\n\t\t\t\tweight: KeybindingWeight.EditorContrib\n\t\t\t}\n\t\t});\n\t}\n\n\tpublic run(accessor: ServicesAccessor, editor: ICodeEditor): void {\n\t\tlet contribution = ContextMenuController.get(editor);\n\t\tcontribution.showContextMenu();\n\t}\n}\n\nregisterEditorContribution(ContextMenuController.ID, ContextMenuController);\nregisterEditorAction(ShowContextMenu);\n"]}